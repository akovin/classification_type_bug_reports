1229253532,Support for multiple browsers in one run,"### What would you like?

I would like to configure Cypress like this:

`cypress run --browsers chrome,firefox`

This would
- run the test suite in both browsers.
- It would not stop if one of those fail
- it would report test results and videos/screenshots for both of them, prefixed with the browser / in a sub directory with the name of the browser

### Why is this needed?

We run Cypress in a cypress docker container to run the tests by Ops on other systems and mount the test results on the hosts file system. I've spent considerable amount of time to do this properly to run Cypress twice and have all test reports properly available on the host.

It would be a lot easier, if cypress would support that out of the box. And I could assume that this is actually a valid use case to run a suite with different browsers

### Other

_No response_",enhancement
1227734969,Make it possible to configure `nodeIntegration` and other web preferences when testing React components in Electron browser,"### What would you like?

I am trying to configure `nodeIntegration` and other web preferences for the Electron browser using the `before:browser:launch` hook. As mentioned [here](https://docs.cypress.io/api/plugins/browser-launch-api#Changing-browser-preferences) in the Cypress documentation, `launchOptions.preferences` should be the `BrowserWindow` `options` object.

This is an extract of my **cypress/plugins/index.js**:

```js
module.exports = (on, config) => {
  if (config.testingType === 'component') {

    on('before:browser:launch', (browser = {}, launchOptions) => {
      if (browser.name === 'electron') {
        launchOptions.preferences.webPreferences.nodeIntegration = true;
        launchOptions.preferences.webPreferences.contextIsolation = false;
        launchOptions.preferences.webPreferences.enableRemoteModule = true;
      }
      return launchOptions;
    });

    // ...
  }
}
```

However, this configuration does not seem to be taken into account, and I am still getting problems with `global`, `require`, `path`, `fs`, etc. not being available in the renderer process of the Electron browser.

### Why is this needed?

I am trying to leverage the recent support for React component testing in order to test the React components of an existing Electron application.

### Other

When I run my component test, I immediately get an error from Cypress. It looks like `Cypress` is undefined when invoking `Cypress.emit(event, ...args)`.

When I select my test in the left menu, I get another error: `Uncaught ReferenceError: global is not defined`.

",enhancement
1227676986,Cypress Studio: give data-testid priority when picking up a selector for recorded interaction,"### What would you like?

Cypress Studio is an awesome feature, however it frequently picks less than optimal selector for the any particular step. Consider DOM structure like the following:

```html
<button type=""button"" aria-label=""Add New"" data-testid=""Button::Add New"">
  <span class=""style_label__O3pAy"">
    <div class=""c-h-flex"">
      <i class=""Icon_icon__R1RDX Icon_small__Q8FfZ style_pageControlIcon__3kvpN style_pageControlIconLoading__P+QzK"">
        <svg xmlns=""http://www.w3.org/2000/svg"" fill=""currentColor"" viewBox=""0 0 24 24"">
          <path fill-rule=""evenodd"" d=""M12 4c-.78 0-1.412.632-1.412 1.412v5.176H5.412a1.412 1.412 0 000 2.824h5.176v5.176a1.412 1.412 0 002.824 0v-5.176h5.176a1.412 1.412 0 000-2.824h-5.176V5.412C13.412 4.632 12.78 4 12 4z"" clip-rule=""evenodd""></path>
        </svg>
      </i>
      <p aria-hidden=""true"" class=""copy-5 style_pageControlLabel__TsIAb"">Add New</p>
    </div>
  </span>
</button>
```

As you can notice it is a button with an icon and text, some of the classes have random suffixes. But there's also a `data-testid`, on a button, however when it is clicked Cypress Studio picks: `.c-h-flex > .copy-5` instead, which - yes, is static, but far from being unique. `data-testid` (and it's alternatives like: `data-cy` and `data-test`) should be given priority. Or at least there should be a config option that would allow us to give them priority. So if any kind of `data-testid` is present, Cypress Studio should pick it instead of it's descendants or ancestors.

### Why is this needed?

It is needed to always pick the most unique selector of the element, when it is available.

### Other

_No response_",enhancement
1226319833,"Enhance Typings for Cypress.Chainable<Interception> and addCommand('myCommand', {type: 'assertion/utility'},..)}","### What would you like?

1) Export the type ""Interception"" (as used in ""Cypress.Chainable<Interception>""). Workaround is available by using types from CyHttpMessages, such as ""CyHttpMessages.IncomingRequest""

2) Due to the flexibility of ""cy.get(..)"" the expression ""cy.get('@myAlias');"" cannot return the specific type ""Cypress.Chainable<Interception>"". It would be nice to have an function like ""cy.getIntercept('@myAlias')"" that returns the alias with the type Cypress.Chainable<Interception>.

3) Typing for  ""Cypress.Commands.Add('myCommand' ,{type:'assertion', prevSubject: false},...)"" is missing (because of the ""type"" parameter).

### Why is this needed?

1) It would be much easier to write custom assertion methods based on the ""Interception"" type when using TypeScript. Right now you always need to guess how the fields are named. Use the power of TypeScript and expose the type and make it usable via a specific command for retrieving network alias

2) Is optional. Could also be by done in each project on it's own, once the type ""Interception"" is exposed. But a specific function would be handy.

3) Example usage of the ""type"" parameter in addCommand:

- https://github.com/cypress-io/cypress/blob/develop/packages/driver/src/cy/commands/aliasing.ts#L5
- https://github.com/cypress-io/cypress/blob/develop/packages/driver/src/cy/commands/asserting.ts#L133

And here is one line I found which handles the type 'assertion'.. (but I don't know if there are more places that do something with this particular type)
https://github.com/cypress-io/cypress/blob/develop/packages/driver/src/cypress/cy.ts#L806

The types in https://github.com/cypress-io/cypress/blob/develop/cli/types/cypress.d.ts#L458 should incooporate this feature and the documentation should make it clear what the type does.

### Other

_No response_",enhancement
1220285725,How to set certain ram to be used by cypress application,"### What would you like?

Hello i've a requirement, it goes like this
i want my cypress application to use certain amount of ram size for which i need to set **max-old-space-size** but how to set to below command?
`cmd /c npx cypress run *`?

### Why is this needed?

If cypress application uses more ram space then cypress application takes in less time to complete execution, so we can test more test cases in less time.

### Other

cypress: 9.1.0
windows: 7
ram size: 16gb && 8gb machines",enhancement
1214611970,Change fake video file provided by `--use-file-for-fake-video-capture` at runtime,"### What would you like?

I have a webapp that deals with uploads from the user camera and I'd like to give various video files to fully test the behavior of my app (upload OK vs upload KO).

Currently, we can only pass a single file before launching the tests using `--use-file-for-fake-video-capture`, so we currently have a workaround with all the use cases in single video and we have to manually `cy.wait` inside the test to wait for the right portion of the video.

What could we imagine to better solve that issue?

I've also seen this issue here:
https://stackoverflow.com/questions/59973591/using-fake-video-in-plugins-i-cant-using-two-video-in-a-test-flow-in-cypress

### Why is this needed?

Because we can't pass several files to Cypress via `--use-file-for-fake-video-capture`",enhancement
1213268816,windows.navigator.webdriver  How to set as false,"### What would you like?

windows.navigator.webdriver  How to set as false

### Why is this needed?

Because I want to avoid some inspection mechanisms and achieve the purpose of login application

### Other

_No response_",enhancement
1200570034,esbuild-dev-server,"### What would you like?

i would love if we could have a esbuild-dev-server 

### Why is this needed?

wy not its fast

### Other

_No response_",enhancement
1197108323,"Function as an argument to resolve the selector in cy.get, cy.contains, etc.","### What would you like?

Currenty, cy.get() and other similar functions only take static values as selector, it would be good if we could pass a fuction that could yield a selector - thus making the selector dynamic. 

For example, instead of, 

cy.get(""x"") 

it would be good if we could also write, 

cy.get(() => (""x"")) 

### Why is this needed?

Dynamic selectors can be useful when, unique id are coming from backend. 
Also on the frontend side, if we have fix relations between ids of parent and child, it would be useful write a function that computes the ids instead of having to hardcode them every time. 

### Other

Thank you very much for your consideration and the wonderful testing tool. ",enhancement
1191455628,"""A merge conflicted on path ""/cypress.json"".","### Current behavior

When I execute
`npm run ng add @cypress/schematic`
while having cypress.json file with one line:
`{}`
then I answer Yes to ""Would you like the default 'ng e2e' command to use Cypress?""
then I see: ""A merge conflicted on path ""/cypress.json"".

### Desired behavior

Display message: ""/cypress.json already exists. Merge is not possible"", instead of ""A merge conflicted on path ""/cypress.json"".

### Test code to reproduce

-

### Cypress Version

9.5.3

### Other

_No response_",enhancement
1190419236,Wayland support on Linux,"### What would you like?

It would be great to have Cypress run natively with Wayland (npx cypress open) instead of using xfvb/X11/Xwayland.

### Why is this needed?

This is required for HiDPI monitors and fractional scaling on Linux machines. This is currently only supported with Wayland for Linux, and running Cypress with Xwayland leads to a very blurry experience on a 4K monitor.

### Other

Here's a screenshot attempting to show the issue, top right is a FF window under Wayland which has crisper text, the other two Cypress windows are running under Xwayland and are blurry.
![blurry](https://user-images.githubusercontent.com/1540729/161356670-b30b30cd-743f-49a3-88cf-477569059db1.png)
",enhancement
1189979589,Ability to overload default assertions (unvalid DOM or unvalid API responses),"### What would you like?

Cypress has default assertions such as
- failure when pages/calls replies HTTP 400-500
- synthax error detections
-  etc

It make Cypress very powerful as scenario can focus on 'what is specifically expected' within the test, and not re-asserting what is 'obviously KO' for all tests all the time. But these mecanisms aren't exposed.

I'd like to be able to add default assertions to that list. One might think I just need to overwrite commands but what if I want to detect (and throw) if DOM or responses contains some elements (ex DOM contains element [id=*""error""], or DOM text contains 0x* or ...)?

### Why is this needed?

I'd like to catch (and throw) each time an DOM-alert pops into our product with a generic 'fallback' error message, to catch all unhandled errors. Today our tests pass even when such feedback arise. It's tricky to catch those. And putting this would really help us.

I'd like not to code '.should('not.exist')' each time I navigate, but even that would not be enough, as it would still miss DOM repaint.

I'd like a more global mecanisms to overload default assertions to specify a bit what a valid responses (request response and/or DOM) should never have. Even if its a fairly advanced feature to put in place on our side.

### Other

If there is a way to do that today, even very technical and poorly documented, I'd be glad to implement anything using that on our side, and help with its documentation. If you were to develop that, I can also test v0 of this if you need a guinea pig.",enhancement
1185877894,Cypress doesn't support hive and Informix DB connections,"### What would you like?

Cypress doesn't support hive and Informix DB connections. It would be great if you can add these features

### Why is this needed?

This feature is needed to perform end to end validations from database level

### Other

From https://github.com/cypress-io/cypress/issues/20484: I see plugins for MySQL, Oracle and SQL server. Any help on this would be much appreciated. For Informix, I need to provide host, port, server and DB details along with username and password",enhancement
1183070294,Ability to override config files from CLI parameter --env,"### What would you like?

Hi all, 

I would like to propose a feature that would highly benefit in the terms of customizing how cypress gets its environment variables. 

I would like to have access to CLI parameters in the plugin files, however, there is no way in my knowledge to do that. 

I have the following scenario done with the use of @bahmutov 's dependency to merge cypress.json configs. 

mobile-dev.json extends > dev.json extends > cypress.json
mobile-dev.json contains mobile-specific env vars such as userAgent, viewportHeight
dev.json contains development environment-specific vars, such as authUrl, abc, and def variables.
cypress.json contains global configuration, which should be default to any runs on any environment.

Furthermore, we are overriding variables from CLI as well in some cases such as and to have the highest precedence:
`npx cypress:open --config-file mobile-dev.json --env abc=123,def=456`

In the example above I would expect the following behavior: 
mobile-dev.json read >> it contains extends so with the `cypress-extends` dependency it reads the next >> dev.json read >> cypress.json read. >> config returned in plugin >> **CLI --env parameters gets read and cypress overrides the parameters in the returned config.**

This is however not the case. Config is correctly merged, but there is no way for me to access CLI parameters in plugins, and CLI parameters get overridden by the config or do not overwrite existing environment variables. 

The easiest solution would be to let us change this order of the sources to be read up however we like:
![image](https://user-images.githubusercontent.com/101114202/160354317-751348a6-69b6-4f58-b17b-279ae86ec608.png)

Anyone has a solution for the above-mentioned problem, or have you considered the possibility to let us configure the precedence in which order these values come from?

Cypress version:  8.6.0

### Why is this needed?

I would like to have the ability to customize our configuration however we see fit in Cypress.

### Other

_No response_",enhancement
1178669807,Modify the contents of a fixture inside cy.intercept,"### What would you like?

I'd like to be able to modify a fixture's contents inside cy.intercept. Or, modify the response of all cy.intercept calls.

```
cy.intercept(
    {
        method: 'POST',
        url: '/graphV2',
    },
    (req) => {
        const operationName = req.body.operationName;
        const fixtureName = operationNameToFixtureMap[operationName];
        if (fixtureName) {
            // I would like to load the fixture here and change the logged in username: replace ""user1"" with ""user2""
            req.reply({ fixture: fixtureName });
        }
    }
);
```

Similar question:

https://stackoverflow.com/questions/66705779/how-to-can-i-load-cypress-fixture-inside-intercept-based-on-request-data

### Why is this needed?

I'm writing UI only tests that fully mock APIs. Different users have different permissions. I'd like to be able to reuse my fixtures for different users, so I need to modify the usernames inside the fixture contents for different tests.

### Other

_No response_",enhancement
1174198273,Add Query String format option(s) to `cy.request()`,"### Current behavior

```javascript
cy.request({url: '/url', qs: { list_id: [1, 2, 3] })
```
Generates the request URI:

```
/url?list_id%5B0%5D=1&list_id%5B1%5D=2&list_id%5B2%5D=3

// decoded
/url?list_id[0]=1&list_id[1]=2&list_id[2]=3
```
However, not all environments follow the `[]` convention and `list_id=1&list_id=2&list_id=3` is widely used as well. The underlying [qs](https://www.npmjs.com/package/qs) library has an `arrayFormat: indices|brackets|repeat|comma` param which controls this behaviour, which unfortunately, isn't accessible via functions like `request()` in Cypress.

### Desired behavior

Allow customization of the query param array encoding behaviour. A top level param [here](https://github.com/cypress-io/cypress/blob/62d109cee2664da0423b665c55b62afdba0c5986/packages/driver/src/cy/commands/request.ts#L17) that controls query param encoding may be a bit awkward. A simpler solution may be to use `qs` as-is when passed as a string (encoded externally).

### Test code to reproduce

```javascript
cy.request({url: '/url', qs: { list_id: [1, 2, 3] })
```

### Cypress Version

9.5.2

### Other

_No response_",enhancement
1173487180,"Add ""duration"" property to interception.response object","### What would you like?

Hi there,
I have a use case, that during my tests, I would like to (need to) custom log response time of specific requests that I am intercepting.

Currently, I can obtain response time only from yielded response object which is provided by `cy.request()` method.

But I do not want to do another request just to get this information.

I just want to wait for given request using `cy.intercept()` then wait for the response and the retrieve the response time via some property of the `interception.response` object.

Thanks for your great work and have a nice day!

### Why is this needed?

I need to log response times of some backend apis to have a proof, that some of them have bad performance, even for testing environment. These logs would be needed by the backend team to focus on these issues and improve performance.

I do not want to write specific tests just for pinging API. 

I want to monitor api responses during frontend tests using cy.intercept and log the information of the response time.

### Other

_No response_",enhancement
1166424295,Publishing checksum of Cypress releases,"### What would you like?

I would like to check if checksum of zip with Cypress matches with checksum published on Cypress's website.

### Why is this needed?

When there is no possibility to download zip with Cypress from official source, it would be useful to check checksum of downloaded file.

### Other

_No response_",enhancement
1164268533,Add an API or event hook to track on downloads,"### What would you like?

For some tests, it would be beneficial to be able to track on downloads (i.e. when they've finished, when they've failed etc.)

### Why is this needed?

As an example, this would allow tests to be written to:

1. Download a file
2. Wait for the file to completely download
3. Check the contents of a file

Without knowing exactly when the file is downloaded, it's possible that a file could be read before the file's contents are fully written.



### Other

_No response_",enhancement
1159001256,Redirects do not honor `set-cookie` header,"### Current behavior

I have a `cy.request` that ends up doing several redirects (as intended). In one of them a cookie is set along with the redirect location. The next request to follow the redirect does not include the cookie header:

<img width=""877"" alt=""image"" src=""https://user-images.githubusercontent.com/1500684/156665684-8776e852-8cdb-4bb0-9e31-f9a2a4295022.png"">

Here's my `cy.request` call that starts this chain of redirects:

```ts
cy.request('POST', '/__tests/login', {email, firstName, team, role})
```

### Desired behavior

Cypress should behave as a browser does when following redirects for a `cy.request` call.

### Test code to reproduce

My repository is open source, you can follow the instructions here to get it set up: https://github.com/kentcdodds/kentcdodds.com/blob/main/CONTRIBUTING.md#project-setup

This is the test I ran to get the screenshot above: https://github.com/kentcdodds/kentcdodds.com/blob/main/cypress/e2e/contact.ts

### Cypress Version

9.5.1 (latest at the time of this report)

### Other

I've experienced this in another (non-public) project and had to workaround it using `cy.setCookie` manually. I'd love to not have to do that here.",enhancement
1158918095,Suggestion for Better Handling of Test Runs When Chrome Fails to Start in Parallelized Runs,"### What would you like?

When Chrome fails to start, it would be nice if the Test Runner did the following:

- Try the spec again on the same CI machine.
- If the second attempt on the same CI machine is unsuccessful, end the job but with a 0 exit code (unless there are failed tests of course).
- Try any untested spec on a different available CI machine.
- Changes such as these would go a long way towards Cypress being able to recover from this kind of problem, preventing stuck test runs and eliminating confusion on the user's part.


### Why is this needed?

Occasionally, we experience failed test runs as a result of Cypress failing to connect to Chrome DevTools (screenshot below). When something like this happens the job fails but it feels like the Test Runner should be able to recover from this problem should be pretty easy in theory. 

<img width=""754"" alt=""chrome_fail"" src=""https://user-images.githubusercontent.com/48733734/156654921-86372327-60f0-4f57-aed1-a7f63072fd3d.png"">


### Other

The specific problems that we run into when this happens are as follows:

- The spec that was attempting to run when Cypress failed to connect to Chrome isn't attempted on any of the other available Test Runners.
- Your test run doesn't recover from this problem so in the Cypress Dashboard the run remains in Running state until it times out 1+ hours later.
- Your CI job fails because this Test Runner instance exit code is 1.",enhancement
1158841543,Intercept and stub third party `<script>` tags,"### What would you like?

Our use case: Testing a third party widget on a website. 

For that, we load the widget on the third party as a `<script src='https://cdn.com/widget.js'/>` tag. What we'd like to do is intercept that JS request and replace `https://cdn.com/widget.js` with `https://localhost:3000/dist/widget.js`.

### Why is this needed?

So that we can run the cypress tests with the local version of the widget (run in CI on a PR), and make sure that the PR doesn't break the e2e tests, before merging it.
",enhancement
1158162205,Implement self healing mechanism ,"### What would you like?

We would like to have self healing feature from cypress. self-healing will apply the new object’s locators and ensure the entire script stays up-to-date with each change made to the product’s design.

### Why is this needed?

To avoid Locator Flakiness

### Other

_No response_",enhancement
1158112672,Make visit command's redirection limit configurable,"### What would you like?

When using cy.visit(), this command will automatically follow redirect. However the redirect has a limitation that it is less than / equal to 10, see [here](https://github.com/cypress-io/request/blob/master/lib/redirect.js#L13). 

The lib @cypress/request makes maxRedirects configurable, but seems cypress does not expose this configurable item to its user. I didn't find any config in [cypress configuration doc](https://docs.cypress.io/guides/references/configuration#Test-Configuration)  and  [visit command doc](https://docs.cypress.io/api/commands/visit) for this.

Please correct me if my understanding is wrong, or I missed some info while reading the doc

### Why is this needed?

Some web pages' authentication/authorization process may need more than 10 redirections.

### Other

_No response_",enhancement
1155512105,Chop test path displayed in Dashboard to reflect `integrationFolder` config,"### What would you like?

Display the test names from the path of the `integrationFolder` specified e.g. `<filename>.spec.ts` rather than `cypress/regressionTests/<filename>.spec.ts`?

### Why is this needed?

When the integration folder is the default `cypress/integration` the test result displays the name - see screenshot below. It just displays the spec file name - does not include file path.

![standard_folder](https://user-images.githubusercontent.com/48733734/156202910-1e9e39f9-aaca-4181-a6ba-9836e46325fd.png)

However when we move the spec file into another directory and update the `integrationFolder` to `cypress/regressionTests`, the result in the Cypress Dashboard displays the name - see screenshot below

![modified_folder](https://user-images.githubusercontent.com/48733734/156202968-87ebfc48-2049-4e55-9e25-a5bc2d52cebb.png)

### Other

Duplicate of [Discussion](https://github.com/cypress-io/cypress/discussions/20300)",enhancement
1155120918,Show name of currently running test next to test-file name,"### What would you like?

I keep on scrolling in the execution stack (left panel) alot to get aware of which test of my testfile is currently running. 
I would like to see the currently running test written next to the test file name so i do not need to scroll up an down and the currently running testname is always in view (sticky) like the test file name is.


### Why is this needed?

orientation,
ux,


### Other

_No response_",enhancement
1128818074,Gray out the path to system node in cypress run header,"### What would you like?

The system node path is all white and isn't very valuable on its own. Should be muted like `headless` does on the browser.
<img width=""768"" alt=""Screen Shot 2022-02-09 at 10 54 39 AM"" src=""https://user-images.githubusercontent.com/1268976/153254411-89b62ac1-e4d8-40c8-be6c-9ac6e87b0e72.png"">



### Why is this needed?

_No response_

### Other

_No response_",enhancement
1127814832,Proposal to create a new command to combine at least get & scrollIntoView,"### What would you like?

Hello!

Quite often Cypress tests will pass locally but fail in our QA environment simply because an element is present but not scrolled into view. The `should('be.visible')` assertion can succeed locally but fail elsewhere due to differences in viewport size.

This error: `Times out retrying after 10000ms: Expected to find element: [data-test=""{exampleDataTest}""], but never found it` can cause confusion around whether the element was even present on the page (as an aside, making this error more specific to the command like `Element exists on page but is not in view` might also be useful). Elements can be missing from a page for a number of reasons, meaning developers spend their time debugging this when the solution is a quick `scrollIntoView()`.

Since most users would know to scroll to see an element I find this type of failure is to be overkill (unless immediate visibility on screen is specifically being tested for), and would make good use of a command that scrolls elements into view and checks their visibility automatically.

I proposed that we create and consistently use a new custom Cypress command to get an element, scroll it into view, and assert it is visible all at once. It will be called something like `getAndScrollIntoView` and essentially be the following:
```
cy.get(element)
    .scrollIntoView()
    .should('be.visible')
```

These three would be ideal for how we use Cypress, but even just a combination of `get` and `scrollIntoView` would be appreciated.

I will be implementing this custom command for my company's project, but would naturally prefer to use a built-in Cypress command. I also assume others may have has a similar issue with this!

### Why is this needed?

* Less repetition in tests where `get`, `scrollIntoView`, and `should('be.visible`) are commonly used together
* Fewer failing tests because an element is present but just off-screen
* Less time debugging: if we see the aforementioned error, it will be easier to narrow down the issue
* Fewer re-runs of the test suite
* Among other reasons, a native Cypress command for this would be supported in future updates and be given proper documentation compared to a custom command

### Other

If there already exists a similar solution out of the box I would love to hear! Thanks!",enhancement
1122231599,feat: support cypress api,"<!-- Thanks for contributing! PLEASE...
- Read our contributing guidelines: https://github.com/cypress-io/cypress/blob/develop/CONTRIBUTING.md 
- Read our Code Review Checklist on coding standards and what needs to be done before a PR can be merged: https://github.com/cypress-io/cypress/blob/develop/CONTRIBUTING.md#Code-Review-Checklist
- Mark this PR as ""Draft"" if it is not ready for review.
- Make sure you set the correct base branch based on what packages you're changing: https://github.com/cypress-io/cypress/blob/develop/CONTRIBUTING.md#branches
-->

- Closes #19859 

### User facing changelog
<!-- 
Explain the change(s) for every user to read in our changelog. Examples: https://on.cypress.io/changelog
If the change is not user-facing, write ""n/a"".
-->

n/a

### Additional details
<!-- Examples:
- Why was this change necessary?
- What is affected by this change?
- Any implementation details to explain?
-->
#### Update 2/16/2022

The goal of this PR is to make namespaces, methods, and properties work on the Cypress API ([`Cypress.*`](https://docs.cypress.io/api/cypress-api/custom-commands)) within the `switchToDomain` context.

In order to get most of the properties to work properly, the `Cypress.config()` from the primary is now being synced with the secondary via #20102. This allows for a lot of properties, like `arch`, `platform`, `spec`, etc to match what is available in the primary, as well as default configurations registered on the new Cypress instance. 

`config`  and `env` are the only things that are synced to the spec bridge. Every other configuration method, such as `Cypress.*.defaults()` or `Cypress.env()` are NOT synced to the secondary and are considered their own isolated world where configuration changes persist between `switchToDomain` calls between the same spec bridge. 

Another important implementation detail in this PR is the outlawing of using `Cypress.Server.*` and its related methods such as `cy.server()` and `cy.route()`. We did not want to consider supporting these methods since server is deprecated and will be removed in the future. Also, `Cypress.Cookies.*` configurations are also forbidden as they do not apply to secondary domains. Likely this API is going to be replaces by `cy.session` and other related methods in the near future. Little `cy` session methods can STILL be used in `switchToDomain`.

![](https://user-images.githubusercontent.com/3980464/152235042-e016c511-2afd-4bc5-beff-e9cfd972bf85.png)

NOTE: decisions around `cy.intercept` still need to be worked out within multi-domain.

NOTE: The use of `Cypress.session.*` and `cy.session` still needs to be explored in multi-domain, and is out of scope for this PR. 

### How has the user experience changed?
<!-- Provide before and after examples of the change.
Screenshots or GIFs are preferred. -->

### PR Tasks
<!-- 
These tasks must be completed before a PR is merged.
If a task does not apply, write [na] instead of checking the box.
DO NOT DELETE the PR checklist.
-->

- [x] Have tests been added/updated?
- [ ] Has the original issue (or this PR, if no issue exists) been tagged with a release in ZenHub? (user-facing changes only)
- [ ] Has a PR for user-facing changes been opened in [`cypress-documentation`](https://github.com/cypress-io/cypress-documentation)? <!-- Link to PR here -->
- [ ] Have API changes been updated in the [`type definitions`](https://github.com/cypress-io/cypress/blob/develop/cli/types/cypress.d.ts)?
- [ ] Have new configuration options been added to the [`cypress.schema.json`](https://github.com/cypress-io/cypress/blob/develop/cli/schema/cypress.schema.json)?
",enhancement
1121563047,Show path of requests in log,"### What would you like?

Hello,
when I use `cy.request` it's shown in logs as full url with scheme, domain etc.
I think it would be better to show it the same way as `fetch` with only pathname.
![image](https://user-images.githubusercontent.com/41228762/152102652-0a35f421-9225-4c11-8611-919d21b6c3e2.png)


### Why is this needed?

When I try to investigate what was wrong by looking on screenshot it 's always pain with `cy.request`. You have to go inside the test to match steps sequence and understand what was these request.

### Other

_No response_",enhancement
1115262871,"Add support for named fixtures (""@userJson"") to intercept","### What would you like?

Currently (v9.3.1) cypress allows setting the response body for an intercepted request in many ways, but what seems to be absent  is the ability to do something like:

```
cy.fixture('customer.json').as('customerJson')
...
cy.intercept(..., { fixture: '@customerJson' })
```



### Why is this needed?

This would be useful since I share a bunch of fixtures for use in different requests in different contexts; the current mechanisms do not provide a simple way to do this without violating the concept of DRYness or raising other issues. If I've missed it in the docs, please link me to the relevant section!

For example:

```
cy.intercept(..., {
    fixture: 'user.json'   // it's not clear if this re-loads the fixture each time for different intercepts, if so, it is inefficient.
})

cy.intercept(..., {
    fixture: someJsonBlob,   // it is tricky to share someJsonBlob across test files/ contexts.
})

// etc
```

### Other

_No response_",enhancement
1113383333,DrawLine or shapes feature,"### What would you like?

To accomplish signature simulation using automation. 
 I'm looking for an api which can used to draw lines or shapes. 
Right now I'm just able to put a dot in signature window. 

something cy.get().draw(options)  will help a lot

### Why is this needed?

To accomplish signature simulation using automation. 

### Other

_No response_",enhancement
1111883883,Path parameters,"### What would you like?

It would be great for `intercept` to support path parameters with the familiar colon syntax, 

```
/api/books/:bookId/chapter/:chapterNumber
```

These parameters can then be made available on a new `parameters` property of the [request object](https://docs.cypress.io/api/commands/intercept#Request-object-properties),

```js
cy.intercept(""GET"", ""/api/books/:bookId/chapter/:chapterNumber"", (req) => {
  console.log(req.parameters.bookId)
  console.log(req.parameters.chapterNumber)
});
```



### Why is this needed?

This is needed to create more realistic stubbed responses. For example, given the `intercept` definition provided above, a more realistic stubbed response could be,

```js
req.reply({
  content: ""foo"",
  book: req.parameters.bookId,
  chapter: req.parameters.chapterNumber
})
```

### Other

_No response_",enhancement
1110226504,Allow registering the same event in plugins multiple times,"### What would you like?

I'd like to be able to register functions for an event (`on(""before:browser:launch"", ...`) several times. Currently, every time an event is registered, [any existing callback is replaced](https://github.com/cypress-io/cypress/blob/5caf747573321003b8778aa28ceec608c75f54c0/packages/server/lib/plugins/index.js#L28).

I'm a bit unsure whether this counts as a feature request or a bug report honestly, but I figured this was never really intended and so is a new feature.

### Why is this needed?

I use a third party plugin (https://github.com/meinaart/cypress-plugin-snapshots) that [registers `before:browser:launch`](https://github.com/meinaart/cypress-plugin-snapshots/blob/6b95c7a930364b99f2496922159a6d693ad684a2/plugin.js#L22). At the same time, I would like to configure the browser to have `prefers-reduced-motion` turned on.

My plugin file ended up looking like this (edited for brevity):

```js
const { initPlugin } = require(""cypress-plugin-snapshots/plugin"");

module.exports = (on, config) => {
    on(""before:browser:launch"", (browser = {}, launchOptions) => {
        if (browser.family === ""chromium"" && browser.name !== ""electron"") {
            launchOptions.args.push(""--force-prefers-reduced-motion"");
        }
        return launchOptions;
    });

    initPlugin(on, config);
    return config;
};
```

My browser never got the argument, and `console.log` showed that the function never ran. I spent a while trying to debug before I thought of checking the plugin and Cypress source code to see if I might have some kind of collision happening, which turned out to be the case.

### Other

I made a minimal repo that demos the issue: https://github.com/wkillerud/cypress-multiple-register
When running `sample_spec.js`, it would be nice to have [both the registered functions](https://github.com/wkillerud/cypress-multiple-register/blob/main/cypress/plugins/index.js) run.",enhancement
1103828915,Multi-domain: Handle 'error' and 'unhandledrejection' events,"### What would you like?

Handle 'error' and 'unhandledrejection' events occurring in the secondary domain AUT. This primarily means wiring up [this callback](https://github.com/cypress-io/cypress/blob/d8fa85d3dc9888c3fe65af9b4fb8291939f5675d/packages/driver/src/multi-domain/index.ts#L200-L202) so that it forwards any errors to the primary domain and displays them properly.

See what the [primary domain driver does for this](https://github.com/cypress-io/cypress/blob/d8fa85d3dc9888c3fe65af9b4fb8291939f5675d/packages/driver/src/cypress/cy.ts#L1077-L1093). The code there can probably be abstracted and re-used so that the secondary domain error goes through it in the primary domain before being displayed to the user.

[errors.html](https://github.com/cypress-io/cypress/blob/d8fa85d3dc9888c3fe65af9b4fb8291939f5675d/packages/driver/cypress/fixtures/errors.html) is a good fixture to use for testing this.



### Why is this needed?

_No response_

### Other

_No response_",enhancement
1102273034,Add cy.selectFolder for uploading a folder via cypress,"### What would you like?

It is great that cypress is gaining native support for file uploads via `cy.selectFile`.

However, one issue I always had with `cypress-file-upload` was that it did not support folder uploads.  Modern HTML and libraries(such as [Uppy](https://github.com/transloadit/uppy/blob/main/packages/%40uppy/utils/src/getDroppedFiles/utils/webkitGetAsEntryApi/index.js)) allow you to drag and drop an entire folder and they will handle recursively selecting the files from the dropped folder.

See original issue from cypress-file-upload: https://github.com/abramenal/cypress-file-upload/issues/141.

It would be great if it was possible to simulate dropping folders with cypress.

### Why is this needed?

Modern upload drop zones allow for dropping of folders.  This can be quite complicated to program and is currently impossible to test via cypress(as there is no way to simulate a folder drop).  It would be great if this could be tested using cypress.

### Other

_No response_",enhancement
1101913634,Multi-domain: Handle command failures,"
Currently, command failures don't currently fail the test or display in the command log. They just hang the runner.

```js
    cy.visit('/fixtures/multi-domain.html')
    cy.get('a').click()
    cy.switchToDomain('foobar.com', () => {
      cy.get('#doesnt-exist')
	})
```

results in the following:

![Screen Shot 2022-01-13 at 10 03 10 AM](https://user-images.githubusercontent.com/1157043/149355235-e50cd4c4-2381-429a-a42d-00c722fdacce.png)

Commands failing in the `switchToDomain` callback should fail the test and display an error just like command failures normally do. They should also display the code frame pointing to the failing command.

For example:

![Screen Shot 2022-01-13 at 10 08 50 AM](https://user-images.githubusercontent.com/1157043/149355779-4037ddae-c1fc-4665-9d71-cc4e62123ab0.png)


",enhancement
1100635814,Conditionally retry a test or suite,"### What would you like?

I would like the ability to natively retry a test from within the logic of a test itself. I currently accomplish this with a complete hack:

```js
if (stateIsCorrupt()) {
  cy.state('runnable')._retries = 1 // force a retry
  repairCorruptState() // fix the underlying state before retrying
  assert(false) // fail the test to start the retry
}
```

### Why is this needed?

My use case is that many of my integration tests share a server state. This is unavoidable in my particular case. 

If that shared state gets corrupted, the test will fail. Ideally, a test could detect the corrupt state, repair it manually, and retry the test.


### Other

In theory, the existing retry functionality could support this idea, but the problem is that it is all-or-nothing. Basically, it will retry for *any* failure, and not just for the failure modes that I'd like to retry on. This makes tests unnecessarily inefficient. ",enhancement
1098983673,Postinstall masks error when file specified in CYPRESS_INSTALL_BINARY doesn't exist,"### Current behavior

If you put a relative or absolute path to a file in `CYPRESS_INSTALL_BINARY` and that file doesn't exist, Cypress doesn't give an error that the file was not found. Instead, it will somehow insert the path into an URL and attempt to download that. This is very confusing.

```
C:\Users\jessef\dev\cypress-test-tiny>set CYPRESS_INSTALL_BINARY=""C:\path\to\nonexistent\file.zip""

C:\Users\jessef\dev\cypress-test-tiny>npm i cypress@9.2.1

> cypress@9.2.1 postinstall C:\Users\jessef\dev\cypress-test-tiny\node_modules\cypress
> node index.js --exec install


The Cypress App could not be downloaded.

Does your workplace require a proxy to be used to access the Internet? If so, you must configure the HTTP_PROXY environment variable before downloading Cypress. Read more: https://on.cypress.io/proxy-configuration

Otherwise, please check network connectivity and try again:

----------

URL: https://download.cypress.io/desktop/C:/path/to/nonexistent/file.zip?platform=win32&arch=x64
Error: Failed downloading the Cypress binary.
Response code: 404
Response message: Not Found

----------

Platform: win32-x64 (10.0.19042)
Cypress Version: 9.2.1
npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! cypress@9.2.1 postinstall: `node index.js --exec install`
npm ERR! Exit status 1
npm ERR!
npm ERR! Failed at the cypress@9.2.1 postinstall script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     C:\Users\jessef\AppData\Roaming\npm-cache\_logs\2022-01-11T10_37_49_234Z-debug.log
```

### Debug logs

```
C:\Users\jessef\dev\cypress-test-tiny>set DEBUG=cypress:*

C:\Users\jessef\dev\cypress-test-tiny>npm i cypress@9.2.1

> cypress@9.2.1 postinstall C:\Users\jessef\dev\cypress-test-tiny\node_modules\cypress
> node index.js --exec install

  cypress:cli installing Cypress from NPM +0ms
  cypress:cli installing with options {} +0ms
  cypress:cli version in package.json is 9.2.1 +0ms
  cypress:cli Using CYPRESS_INSTALL_BINARY from environment variable +0ms
  cypress:cli Using CYPRESS_INSTALL_BINARY from environment variable +1ms
  cypress:cli using environment variable CYPRESS_INSTALL_BINARY ""C:\path\to\nonexistent\file.zip"" +4ms
  cypress:cli Reading binary package.json from: C:\Users\jessef\AppData\Local\Cypress\Cache\9.2.1\Cypress\resources\app\package.json +0ms
  cypress:cli found npm argv json '{""remain"":[""cypress@9.2.1""],""cooked"":[""i"",""cypress@9.2.1""],""original"":[""i"",""cypress@9.2.1""]}' +159ms
  cypress:cli looking for versionSpecifier { dir: 'C:\\Users\\jessef\\dev\\cypress-test-tiny\\node_modules\\cypress' } +3ms
  cypress:cli looking for versionSpecifier { dir: 'C:\\Users\\jessef\\dev\\cypress-test-tiny\\node_modules' } +6ms
  cypress:cli looking for versionSpecifier { dir: 'C:\\Users\\jessef\\dev\\cypress-test-tiny' } +1ms
  cypress:cli finished looking for versionSpecifier { versionSpecifier: '^9.2.1' } +2ms
  cypress:cli installed version is null version needed is C:\path\to\nonexistent\file.zip +0ms
  cypress:cli no binary installed under cli version +1ms
  cypress:cli checking local file C:\path\to\nonexistent\file.zip cwd C:\Users\jessef\dev\cypress-test-tiny\node_modules\cypress +1ms
  cypress:cli preparing to download and unzip version  C:\path\to\nonexistent\file.zip to path C:\Users\jessef\AppData\Local\Cypress\Cache\9.2.1 +1ms

  cypress:cli needed Cypress version: C:\path\to\nonexistent\file.zip +0ms
  cypress:cli source url https://download.cypress.io/desktop/C:/path/to/nonexistent/file.zip?platform=win32&arch=x64 +1ms
  cypress:cli downloading cypress.zip to ""C:\Users\jessef\AppData\Local\Temp\cypress-3000.zip"" +0ms
  cypress:cli Downloading package {
  url: 'https://download.cypress.io/desktop/C:/path/to/nonexistent/file.zip?platform=win32&arch=x64',
  proxy: null,
  downloadDestination: 'C:\\Users\\jessef\\AppData\\Local\\Temp\\cypress-3000.zip'
} +3ms
  cypress:cli response code 404 +133ms
  cypress:cli URL: https://download.cypress.io/desktop/C:/path/to/nonexistent/file.zip?platform=win32&arch=x64
  cypress:cli     Error: Failed downloading the Cypress binary.
  cypress:cli Response code: 404

The Cypress App could not be downloaded.

Does your workplace require a proxy to be used to access the Internet? If so, you must configure the HTTP_PROXY environment variable before downloading Cypress. Read more: https://on.cypress.io/proxy-configuration

Otherwise, please check network connectivity and try again:

----------

URL: https://download.cypress.io/desktop/C:/path/to/nonexistent/file.zip?platform=win32&arch=x64
Error: Failed downloading the Cypress binary.
Response code: 404
Response message: Not Found

----------

Platform: win32-x64 (10.0.19042)
Cypress Version: 9.2.1
npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! cypress@9.2.1 postinstall: `node index.js --exec install`
npm ERR! Exit status 1
npm ERR!
npm ERR! Failed at the cypress@9.2.1 postinstall script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     C:\Users\jessef\AppData\Roaming\npm-cache\_logs\2022-01-11T10_39_03_653Z-debug.log
```

### Cypress Version

9.2.1

### Package Manager

npm

### Operating system

Windows

### Other

The command output above is from a machine that does not use a proxy",enhancement
1091608686,Feature Request: Enhance Stack traces to display the caller of a custom command,"### What would you like?

We use custom commands to wrap common steps and to encapsulate test logic related to 3rd party libraries. 

When a custom command fails, the stack trace only displays it and nothing else. Please consider improving the logic to also display the caller.

<img width=""1110"" alt=""image"" src=""https://user-images.githubusercontent.com/719368/147830904-8b497283-1b9e-4a44-92eb-20c9937acf2c.png"">


### Why is this needed?

Knowing the line in the test spec will allow me to find the cause of the issue sooner. Since custom commands are tried and tested, seeing only them in the stack trace is useless.

### Other

_No response_",enhancement
1087026543,Option to retry beforeAll(before) hook ,"### What would you like?

_Copied across from https://github.com/Bkucera/cypress-plugin-retries/issues/50_

 If there was an option to retry the beforeAll(before) hook when it fails that would be great.

### Why is this needed?

Currently if the `before `hook in any test suite fails, the whole E2E fails and we have to manually trigger the E2E again. This is a pain.

### Other

_No response_",enhancement
1072682954,Access cypress config from within the CLI,"# What would you like?

Various CLI commands will have to access the cypress config. We need to figure out what the implications are of evaluating the config multiple times as generally (AFAIK) the config is 

* Install: to determine what to install for `cypress install` and `cypress install <browser>`
* Info: to determine what versions we currently have installed.

We may be able to defer run and open to the service and not have to check them in the CLI. 

# Why is it needed?

Some CLI commands need access to the browser config.",enhancement
1072531331,Binary cache cleanup,"# What would you like?

Today there is no logic implemented to clean up old or unused cypress binaries from the cache. This could use up a large amount of space on a users computer unnecessarily . With the proposed addition of downloadable browser binaries this problem could get worse. The ask is to design and implement a system to remove binaries after a certian amount of time.

# Why is it needed?

To reduce hard drive burden on a users computer over time.

Cases to consider, Does a user have multiple versions of cypress across several different repositories
What does the experience look like when the binary has been removed but npm has not re-installed.

Scope: we could scope this change to just the new browser binaries, but we should at least consider it for the cypress binary as well as we're building out a design that accounts for them.
",enhancement
1071019549,Error when trying to set --config or Cypress.config for browserDependencies,"# What do you want?

Error when trying to set --config or Cypress.config for browserDependencies. Prevent users from trying to overriding the browserDependencies config. This is related to davids work in #6407

# Why do you want it?

The browser used should not be overwrite-able per test.",enhancement
1071017679,Update schema and types for new config values,"# What do you want?

Update schema and types for new config values

# Why do you want it?

We want intellisense to assist when people are writing config values.",enhancement
1071015193,Validate browserDependencies config,"# What would you like?

Validate that the `browsersDependencies` config contains known browsers, valid versions and is structured correctly..

# Why is it needed?

We want users to be alerted if they have invalid config.
",enhancement
1071003443,Allow Users to set browserDependencies in configuration file.,"# What would you like?

Users should be able to set the `browserDependencies` config in the cypress.js/ts config file.

The `browserDependencies` config should be made available in the application. 

# Why is it needed?

The `browsersDependencies` config is required to know what version of a browser a user wishes to test against.
",enhancement
1070987647,Cypress provided browser binaries,"### What would you like?

Cypress consumers install browsers today by separately downloading and installing browsers supported by Cypress either to their local machines or CI. With this project we intend to provide consumers with the ability to download a browser binary for testing through Cypress config. This is similar to, though not the same as, how [playwright](https://playwright.dev/docs/cli/#install-browsers) provides their browser binaries.

* Consumers can specify the browsers to download through config.
* Consumers can specify one of a browser.
* Browsers should be downloaded on demand.
* Browsers can be pre-installed for CI or docker containers.
* Must be an extendable pattern to support more than one browser type (chromium, firefox, webkit)

For the initial release of this feature we will only support the chromium browser.

### Why is this needed?

This is a prerequisite step for providing [webkit support](https://github.com/cypress-io/cypress/issues/6422) since we will have to distribute webkit binaries to enable support.

### Other

_No response_",enhancement
1070689633,Cypress parallelization and BitBucket Pipelines rerun failed steps,"### What would you like?

We currently use BitBucket Pipelines to run Cypress tests in parallel. Same setup as introduced here https://docs.cypress.io/guides/continuous-integration/bitbucket-pipelines

BitBucket Pipelines support to only rerun failed steps https://bitbucket.org/blog/rerun-failed-pipeline-steps It can be quite useful.

We found when rerun a few failed steps that use Cypress parallelization, they will run all specs again, not just specs assigned to the failed steps.

For example, if I have 5 specs and 5 parallel steps, each spec is assigned to one step on the first run. Step 1 to step 4 succeeded and step 5 failed. If I trigger a ""rerun failed step"" to only rerun step 5, step 5 will run all 5 specs again. I expect step 5 to only run spec 5 in this case.

### Why is this needed?

This is a useful function when tests are affected by external dependencies (e.g. a docker image that is pulled into test environment that has issues, or a BitBucket env var config has issues).

Ideally, Cypress Dashboard should remember the mapping between specs and parallel steps, and when a ""rerun failed step"" happens, only rerun the originally assigned specs.

### Other

_No response_",enhancement
1069617069,Option to see git status changes by color,"### What would you like?

User requests to have the option to see the changes in GitHub by color in the App
![image](https://user-images.githubusercontent.com/48733734/144440997-84f49dc3-7914-4a77-a836-b2761899b124.png)
similar to what is seen in the Cloud
![image](https://user-images.githubusercontent.com/48733734/144441177-19d42246-cad3-44d0-9556-6607a60ae3d9.png)


### Why is this needed?

Use case:
User would like to have a toggle button or something similar in the interface to show the changed files for locally run tests to increase productivity

### Other

Additional information is available internally via Support ticket",enhancement
1066290263,Update actionability checks to require an accessible name and role,"### What would you like?

Along the same lines of [this feature request recently opened for Playwright](https://github.com/microsoft/playwright/issues/10562), I'd like to propose extending the actionability checks for Cypress to include (optionally) checking for an [accessible name](https://www.w3.org/TR/accname-1.1/) and role.

Relevant details from the Playwright issue:

> Accessible name and role are synthesized by the browser into an accessibility tree, and normally (with the exception of experimental AOM in Chrome) aren't available to JS. However, there's work to recreate the browser accessible name and role computation in JS, e.g. https://github.com/eps1lon/dom-accessibility-api, that could be used here.

### Why is this needed?

By adding this capability to the [built-in actionability checks](https://docs.cypress.io/guides/references/configuration#Actionability) in Cypress, users could enable this for their test suite and find accessibility issues without needing to rewrite their existing tests to use better element selectors (via [testing-library](https://testing-library.com/) or similar) or run [axe-core](https://github.com/dequelabs/axe-core) validations.

With this feature enabled, my existing test suite will automatically time out if the application is not accessible to screen readers or other assistive tech due to missing accessible names and role for actionable elements.

### Other

Ideally this would be configurable [via the global actionability config](https://docs.cypress.io/guides/references/configuration#Actionability), via actionability options passed to `cy.visit`, and also at the individual selector level, but [the existing](https://docs.cypress.io/guides/core-concepts/interacting-with-elements#Forcing) `force: true` might be an acceptable solution.",enhancement
1046001354,Set CYPRESS=true as env var in child processes where Cypress runs user code in Node,"### What would you like?

We'd like a way to tell that any Node code is running within Cypress. This way we could detect we're running in Cypress by looking for `process.env.CYPRESS`

### Why is this needed?

Someone mentioned wanting the ability to set different babel config when run within Cypress specifically. 

### Other

_No response_",enhancement
1044945914,Configuration to force test to fail if an url is not mocked,"### What would you like?

Be able to set a variable to tell that I want that a test fail if there is a call to an external resource that is not mocked

### Why is this needed?

I want this because some times, when my devs code some tests, they still have the back running and the test will pass locally but not on the CI after. And, when a dev add a new API on the back called by the front, I want to force them to at least mock it empty in cypress to prevent longer test because they try to reach unexisting routes

### Other

I'm trying to perfect tests where everything is mocked to control what we do and how the application will react",enhancement
1037601160,Make Slider Interaction More Intuitive,"### What would you like?

Easily interact with slider components and set their values directly.

### Why is this needed?

Right now interacting with sliders is not intuitive. Triggering a mousedown and mousemove event is possible but does not allow selection of precise values especially with a responsive UI.

The other option that worked for me was to set the value directly and manually trigger an `input` event, but it feels like a hack and took quite a bit of time to figure out.

### Other

This is what I had to do to get it to work for me in React:

```html
<input type=""slider"" data-testid=""foo"" min=""0"" max=""100"" value={sliderValue} onInput={...} />
<span data-testid=""bar"">{sliderValue}</span>
```
```js

cy.get('[data-testid=foo]')
  .invoke('val', '123')
  .trigger('input')

cy.get('[data-testid=bar]').should('have.text', '123')
```",enhancement
1037355498,Allow for caps lock to be activated,"### What would you like?

I would like to be able to activate caps lock via Cypress. This could possibly be implemented in a similar way as the [other type modifiers](https://docs.cypress.io/api/commands/type#Arguments).

### Why is this needed?

There are use cases in which this would be useful, for example caps lock detection warnings. In javascript code, activating the caps lock should be treated as a modifier state on the key events. For example:

```js
input.addEventListener(""keyup"", function(event) {
  if (event.getModifierState(""CapsLock"")) {
    //show warning
  } else {
    //make sure warning is hidden
  }
});
```

### Other

_No response_",enhancement
1025633259,Improve startup time of Cypress and reduce time to dl/unzip,"### What would you like?

- Instant startup time of `cypress open` and `cypress run`. 
- Reduce unzip time during downloading Cypress

### Why is this needed?

This will improve the test timing of all users as well as our internal development time since we use Cypress to test Cypress itself. 

### Other

- Bundle all the modules in the app into an Electron snapshot which means they're already loaded in memory. 
- Intermediate stage for transpiling the TS files - much faster than it's done now. When we build the binary - we transpile to JS - so we want to do on the fly transpilation to do that.
- May be released for Mac/Linux first, Windows to follow. ",enhancement
1005174854,Add the option to permanently delete assets before run,"### What would you like?

I would like to be able to permanently delete assets instead of cypress moving them to the trash folder. 

### Why is this needed?

I have a windows continuous integration server on which I run cypress. To make it less time consuming I do not clear the workspace before running it. That means that the assets of the previous run will still be in the workspace. This makes cypress move them to the recycle bin and thus filling up the server's disk space.

### Other

_No response_",enhancement
996705030,Wait for page finish reloading after click,"### What would you like?

Cypress could be perfect.
In wordpress, Woocommerce reloads the checkout page (not a get request, a javascript reload) when you click a link to change billing type of user. That reload takes a while and then then DOM is rewritten. 
This means, If I do `cy.get('billingtypeofuser').click()`, then `cy.get('stripe')` is detached from the DOM and can't be found. Adding a `cy.wait(3000)` sometimes help, but just as often breaks. 

We need a reliable way to wait for a `location.reload`, kind of like the asynchronous jQuery function `$('document').on('ready', () => {})`

### Why is this needed?

Many tests fail because elements expected to be there are detached from the DOM when a page is reloading after a click. wait(time) is not reliable because in best case scenario, you waisted 4 seconds because the pageload was faster, worst case scenario, the 4s wasn't enough and the test fails.

### Other

_No response_",enhancement
991204892,Increase `quality` of screencast frames in Chrome from 80 to 100,"### What would you like?

In order to increase the quality of videos, we can increase the `quality`, an option passed when starting the screencast. Some more investigation is needed to see the impacts of this change and how it plays with `videoCompression`. 

https://github.com/cypress-io/cypress/blob/develop/packages/server/lib/browsers/cdp_automation.ts#L22:L22

### Experiments

- With quality: 100 (format: jpeg), investigate setting videoCompression 32, 28, 0 (Look at quality, performance, size)
- With quality: 80 (format: jpeg), investigate setting videoCompression 32, 0 (Look at quality, performance, size)


### Why is this needed?

_No response_

### Other

_No response_",enhancement
985216184,[Component testing] [VueJS] - make an `unmount` method available,"### What would you like?

In a test file, I want to be able to mount a component, run tests on it, then destroy/unmount it, mount a new instance of the component then run test on it

### Why is this needed?

Trying to implement a Model based testing approach in a Vue app with xState, along the lines of the following article: https://dev.to/rjdestigter/model-based-ui-tests-with-xstate-cypress-puppeteer-more-268d

```js
// Iterate the plans and paths and test each:
testPlans.forEach((plan, planIndex) => {
  describe(`Plan ${planIndex}: ${plan.description}`, () => {
    // Start with an empty list for the failur patterns for this plan.
    plan.paths.forEach((path, pathIndex) => {
      it(`Path ${pathIndex}: ${path.description}`, () => {
        cy.visit(`http://localhost:7777`);

        return new Cypress.Promise(async resolve => {
          await path.test();
          resolve();
        });
      });
    });
  });
});
```

works because `cy.visit` fully reloads a page; but replacing this line with `mount` doesn't work since the component is then mounted several times.

### Other

_No response_",enhancement
981055457,Read the PR_NUMBER from an environment variable,"### What would you like?

I'd like to be able to pass an environment variable with the PR_NUMBER related to a run, so it is recorded by Cypress. As far as I can tell, we can pass variables such as COMMIT_INFO_BRANCH to pass git related information, but for the PR ID/Number it can only be extracted from the CI engine default env vars.

That seems unfortunate as not all the CI engines record the PR Number (or do it consistently) or are included in Cypress. In our use case, we use a ""workflow_dispatch"" GH workflow that receives the PR number as an input variable... so we definitely have the value and could set any env var with it, but I don't know how to pass it to Cypress.

If this is doable and I might have misunderstood something, we might want to document it close to where we document git related info?


### Why is this needed?

This would give us greater flexibility in passing in the PR Number without being restricted to default values for each engine. 

### Other

_No response_",enhancement
978651590,Add audio to video recordings,"### What would you like?

Option to record the audio output when running tests.

### Why is this needed?

Our app makes extensive use of the Web Audio API and, just as video recordings are helpful for UI testing, audio recordings would enhance our workflow dramatically. 

### Other

Apologies if I've missed something and this is already an open or resolved issue.",enhancement
977425250,Ability to add assertions to an xhr,"### What would you like?

Similar to #16295 it would be nice to be able to click something in the sidebar that would allow for setting an assertion based on a POST/PATCH etc.

### Why is this needed?

It would cut down on non-javascript people needing to know much javascript to add meaningful tests.

### Other

_No response_",enhancement
974204916,Using Parcel as a dev server,"### Discussed in https://github.com/cypress-io/cypress/discussions/16977

<div type='discussions-op-text'>

<sup>Originally posted by **mscoobby** June 17, 2021</sup>
Hello everyone,
We've started using Cypress for testing our React based application and it works great but we are using Parcel to bundle the application and it would be nice if we don't have to introduce webpack to the project. I've looked around and tried different things but could not manage to make Cypress component testing work without webpack. I would appreciate any information on the topic.</div>",enhancement
968547678,cy.session: Caching across spec files,"### What would you like?

The new cy.session is amazing and just what we wanted - the behaviour with `cypress open` where this feature caches across spec files is something we'd like to have as an option for `cypress run` as well if possible.

### Why is this needed?

In many cases authentication sessions are reliably the same between spec files, and starting with a blank cy.session cache for each file isn't necessary. I understand that the reason may be more technical, since the runner may be opening each spec file in a brand new context where it's hard to carry session data around.

### Other

Just further thanks for cy.session! 🎉 ",enhancement
964967543,Webkit: Support file downloads,"Modify download code to support Webkit's download method, which is different from CDP.",enhancement
964966419,Webkit: Support video recording in Webkit,"Modify video recording code to support Webkit's video recording method, which is different from CDP.",enhancement
964965013,"Webkit: Write automation code to set cookies, navigate to page, navigate to tests.","Need automation code for Webkit to:

- [ ] manage cookies
- [ ] navigate to page
- [ ] navigate to tests",enhancement
964963051,Webkit: Launch webkit browser with correct options,"Part of creating automation driver for Cypress, maybe extending on cdp_automation if possible. 

",enhancement
964955655,Webkit: Have UX to explain that a peer dep is required to run Webkit,Something should indicate to the user when attempting to run Webkit browser with the experimental flag that a peer dep is required from the work in https://github.com/cypress-io/cypress/issues/17676,enhancement
964953045,Webkit: Detect if webkit browser is installed as a peer dep,Update @packages/launcher to detect installs of webkit when `experimentalWebkitSupport` is enabled.,enhancement
964948416,Webkit: Add experimental flag for users to turn on Webkit support,"Add an experimentalWebkitSupport config option that gates Webkit support/detection and makes it an opt-in experimental feature.

Add experimental flag with name and description for Webkit support to https://github.com/cypress-io/cypress/blob/develop/packages/server/lib/config_options.ts",enhancement
962865724,Command Log improvements for calls made from a within callback,"### What would you like?

When a `cy.get()` is made from a `within` callback, it would be nice if the `get` was displayed differently in the command log. I assume the `withinSubject` is going to be set in this scenario, so that seems like displaying that would be a great improvement.

Currently a get called from within will look something like this in the command log
```
get     #SomeElement
```

It would be great if it was displayed like this
```
get     #SomeElement (withinSubject #AnotherElementSelector)
```

Additionally, the error messaging could be better. At a minimum it should indicate that a call was made from a within callback, but it may also be beneficial to suggest that a failed selector may not be working due to being nested in a `within`... perhaps Cypress could run the same selector with `{withinSubject: null}` and report if an element was found elsewhere in the DOM. I think if the error messaging was more helpful and suggestive from `within` callbacks it could really help move people along when they bump into these kinds of issues. It certainly would have saved me a couple of hours yesterday and today.

### Why is this needed?

This would greatly improve the developers ability to debug a failed DOM lookup, especially when the developer is unknowingly inside of a within callback. This can happen often if you're editing functions in PageObjects/UI helpers that are called from multiple test files.

### Other

Here is an example of this same issue that a user was having. (https://github.com/cypress-io/cypress/issues/14566) The github issue was open for 10 days before someone suggested using `cy.get(selector, {withinSubject:null});` with no explanation. Four months later someone else explained why the suggested fix worked. I suspect that these subtle issues from `within` callbacks are causing developers a lot of pain.

 From the screenshot provided, you can see on line 17 that there is a `- within` but it was easily missed or not suspected to be the root cause. The test code was also provided, which included a within block that had 7 nested `get` calls.

https://user-images.githubusercontent.com/59794856/104608655-27f82380-56a8-11eb-8437-bd235b64118c.png",enhancement
962474250,Real device in browser stack with Cypress Automation,"### Current behavior

Currently we are working on Cypress Automation tool to automate the functional test cases in my project, we have a requirement to automate functional test cases using real device in browser stack. Kindly suggest can it be done using Cypress tool

### Desired behavior

not familiar with real device automation using cypress

### Test code to reproduce

not familiar with real device automation using cypress

### Cypress Version

8.2.0

### Other

_No response_",enhancement
960540767,Allow a way to configure device pixel ratio (DPR) for all headless browsers during cypress run,"### What would you like?

Allow a way to configure device pixel ratio (DPR) of the machine for all browsers via a single config.

### Why is this needed?

- Allow users to have higher DPR videos/screenshots (so they're not blurry)
- Allow users to set this for testing different DPR https://github.com/cypress-io/cypress/issues/7075

### Other

- How to we educate people that the DPR is only applying during cypress run?
- Make it global config (can expand to suite/test level config if people ask for it).
- What is the effect to setting DPR during `cypress open` mode? Is it weird? Let's not do that if it's weird.
- What happens setting DPR via the command line flags versus CDP?

### Example

These are current defaults for DPR (effectively) and would be exposed this way:

```json
{
  ""devicePixelRatio"": {
    ""runMode"": 1,
    ""openMode"": null
  }
}
```",enhancement
957768771,Add a configuration option to allow watching for fixture changes,"### What would you like?

The [docs](https://docs.cypress.io/guides/core-concepts/writing-and-organizing-tests#What-isn-t-watched) state that `cypress/fixtures` is not watched for file changes, so I would like to have a way to configure the test runner to disable this behavior and watch for file changes.

### Why is this needed?

When iterating on tests that use fixtures, it would be very useful to watch for file changes not only to the test files, but to the fixtures as well.

With the current behavior, one has to manually rerun the test on the test runner after updating a fixture - using `it.only()` to only run one test helps speed up the process, but still requires a manual step.

### Other

_No response_",enhancement
956191400,Test runner should run first test matching filter when press {enter},"### What would you like?

When I search in the test runner for a spec, I either have to move my arm waaaay over to my mouse, move it, then click it's button. Would be cool to just press enter, particularly when only one spec matches my filter.

![image](https://user-images.githubusercontent.com/8106379/127562902-fcb2500c-f683-464f-a0b4-b14eba8652da.png)


### Why is this needed?

_No response_

### Other

_No response_",enhancement
956001851,allow setting hostOnly cookie on thirdparty domain,"### Current behavior

Currently cy.setCookie `hostOnly` is controlled by the `domain` property. If omitted, the cookie will be set as `hostOnly`

However, because thirdparty cookies must have `domain` set for the user to specify which domain they want the cookie set on, it's impossible to set a `hostOnly` thirdparty cookie through the cy.setCookie api. 

Similarly, users cant tell if a cookie is `hostOnly` on from the `cy.getCookie` api because domain exists in the cookie properties for both hostOnly and non-hostOnly cookies

### Desired behavior

add a `hostOnly` property to `cy.setCookie` and `cy.getCookie` to allow users to set/distinguish a hostOnly cookie

### Test code to reproduce

cy.setCookie({ domain: 'example.com' }) // sets non-hostOnly cookie

### Cypress Version

1

### Other

_No response_",enhancement
952965702,Add is inViewport assertion,"### What would you like?

It would be great to have the ability to check if some element is not only visible, but also in the viewport.

Something like:

```
cy.get('nav')
  .should('be.inViewport')
```
There are some solutions, like https://github.com/cypress-io/cypress/issues/877#issuecomment-538708750  and https://github.com/cypress-io/cypress/issues/877#issuecomment-490504922

But it looks like a common assertion that would be great to have built in Cypress.

### Why is this needed?

Checking if some element is in the viewport is a common case that we want to check in Cypress. It would be good to have it in the Cypress core.

### Other

_No response_",enhancement
950866159,Scope `before` hooks in tests,"### What would you like?

It would solve a lot of issues if `before` hooks were scoped to `describe` blocks, instead of being hoisted out of files and into the global scope.

Especially since all those hooks fire before the global `beforeEach` hooks.

### Why is this needed?

Example: I have to define interceptors in `before` **and** `beforeEach` globally, because some tests set a variable in their `before` hook that influence the intercepts (their responses actually).

I assumed `beforeEach` would be enough for obvious reasons, but the test's `before` hook gets hoisted up and run before the global `beforeEach` is executed.

### Other

_No response_",enhancement
950849149,Add slice function,"### What would you like?

Similar to how we have the `eq` function in Cypress (https://docs.cypress.io/api/commands/eq) that match the behavior of jQuery `eq`, it would be useful to have an implementation of the `slice` function https://api.jquery.com/slice/

### Why is this needed?

There are cases where we don't need to use all the elements, but only a few of them, and sometimes, having a selector with `:nth-child` or `:nth-of-type` is not enough to select the subset. There is the `:lt` selector, but it is deprecated https://api.jquery.com/lt-selector/ and more than that, it can be confused as it is not an oficial CSS selector.

### Other

_No response_",enhancement
949544402,Cypress version in download name,"### What would you like?

It would make cypress version management more easy if the downloaded cypress zip would have the version number in the name. Instead of the fixed 'cypress.zip' something like 'cypress_8_0_0.zip' 

### Why is this needed?

As we are behind a firewall we need to download the cypress zip to install. Further more we have several projects, where not all projects use the same version. Especially when coping with breaking changes it can make a difference.
You are a very active organisation (kudo's!), and releases happen all the time. So wen we download a version, it is not always instantly clear that again, where was a new release. This caused some issues in our organization.

### Other

_No response_",enhancement
944697650,cy.origin GA release,"This issue is used for tracking work required to provide 'multidomain' support, closing https://github.com/cypress-io/cypress/issues/944

Work being done in https://github.com/cypress-io/cypress/tree/feature-multidomain branch currently.

Some issues covering this work below, but any issue prefixed with ""Mult-domain"" needs to be delivered.

- https://github.com/cypress-io/cypress/issues/16778
- https://github.com/cypress-io/cypress/issues/16773
- https://github.com/cypress-io/cypress/issues/16452
- https://github.com/cypress-io/cypress/issues/17302
- https://github.com/cypress-io/cypress/issues/17446
- https://github.com/cypress-io/cypress/issues/17945
- https://github.com/cypress-io/cypress/issues/17253
- https://github.com/cypress-io/cypress/issues/17252
- https://github.com/cypress-io/cypress/issues/16771
- https://github.com/cypress-io/cypress/issues/16777
- https://github.com/cypress-io/cypress/issues/16774
- https://github.com/cypress-io/cypress/issues/18275
- https://github.com/cypress-io/cypress/issues/16777
",enhancement
944607288,Update CLI options for when the Test Runner is opened/run via a single command,"### What would you like?

As Cypress moves Component Testing out of beta and the Test Runner into a unified opening point, we need to rethink the CLI options. 

- `cypress open` and `cypress run` - runs e2e tests
- `cypress open-ct` and `cypress run-ct` - runs component tests

We want our users to 

- not be confused
- be able to have a focused workflow to run the tests they want as fast as possible

### Why is this needed?

- We need a single command to open the Test Runner for both component tests and e2e tests
- How do we handle `cypress run` for both runners? Is it a shared command?
- Users may want to 'jump' directly to e2e or component tests during open to run instead of going through the UI to select which testing type to run.
- tangentially related: https://github.com/cypress-io/cypress/issues/1925 - Accept --spec arg during `cypress open` to focus and run the spec specified.
- how do you handle --config args with the new `cypress.config.js` changes?

### Current options

`cypress open` and `cypress open-ct` options

```
Options:
  -b, --browser <browser-path>     path to a custom browser to be added to the list of available browsers in Cypress
  -c, --config <config>            sets configuration values. separate multiple values with a comma. overrides any value in cypress.json.
  -C, --config-file <config-file>  path to JSON file where configuration values are set. defaults to ""cypress.json"". pass ""false"" to disable.
  -d, --detached [bool]            runs Cypress application in detached mode
  -e, --env <env>                  sets environment variables. separate multiple values with a comma. overrides any value in cypress.json or cypress.env.json
  --global                         force Cypress into global mode as if its globally installed
  -p, --port <port>                runs Cypress on a specific port. overrides any value in cypress.json.
  -P, --project <project-path>     path to the project
  --dev                            runs cypress in development and bypasses binary check
  -h, --help                       display help for command
```

`cypress run` and `cypress run-ct` options

```
Options:
  -b, --browser <browser-name-or-path>       runs Cypress in the browser with the given name. if a filesystem path is supplied, Cypress will attempt to use the browser at that path.
  --ci-build-id <id>                         the unique identifier for a run on your CI provider. typically a ""BUILD_ID"" env var. this value is automatically detected for most CI providers
  -c, --config <config>                      sets configuration values. separate multiple values with a comma. overrides any value in cypress.json.
  -C, --config-file <config-file>            path to JSON file where configuration values are set. defaults to ""cypress.json"". pass ""false"" to disable.
  -e, --env <env>                            sets environment variables. separate multiple values with a comma. overrides any value in cypress.json or cypress.env.json
  --group <name>                             a named group for recorded runs in the Cypress Dashboard
  -k, --key <record-key>                     your secret Record Key. you can omit this if you set a CYPRESS_RECORD_KEY environment variable.
  --headed                                   displays the browser instead of running headlessly (defaults to true for Firefox and Chromium-family browsers)
  --headless                                 hide the browser instead of running headed (defaults to true for Electron)
  --no-exit                                  keep the browser open after tests finish
  --parallel                                 enables concurrent runs and automatic load balancing of specs across multiple machines or processes
  -p, --port <port>                          runs Cypress on a specific port. overrides any value in cypress.json.
  -P, --project <project-path>               path to the project
  -q, --quiet                                run quietly, using only the configured reporter
  --record [bool]                            records the run. sends test results, screenshots and videos to your Cypress Dashboard.
  -r, --reporter <reporter>                  runs a specific mocha reporter. pass a path to use a custom reporter. defaults to ""spec""
  -o, --reporter-options <reporter-options>  options for the mocha reporter. defaults to ""null""
  -s, --spec <spec>                          runs specific spec file(s). defaults to ""all""
  -t, --tag <tag>                            named tag(s) for recorded runs in the Cypress Dashboard
  --dev                                      runs cypress in development and bypasses binary check
  -h, --help                                 display help for command
```",enhancement
944178874,Provide a way to re-run/retry an entire spec upon failure,"### What would you like?

Ability to rerun/retry an entire spec file upon failure
This is different from retrying a failed it() block. 

Currently, `retries: n` in `cypress.json` only retries the failed `it()` function. 
Sometime due to server issues, these retrying mechanism on individual it() blocks are not enough. Also this retry mechanism doesn't retry the `before()` hooks. 

I want to re-run the entire spec file once again from beginning including all hooks. 
WebdriverIO has a way of running an entire specFile via their config file: https://webdriver.io/docs/retry/#add-retries-on-a-per-specfile-basis

### Why is this needed?

Sometimes, the backend server might be re-booting or unresponsive. At that exact time, when tests run , they will fail as the server is not ready. Here the retry mechanism will not be of much help as it retries the same thing again and again, although there is no response coming from the backend. 
When we run the same spec again manually, it passes, because by that time, the server has recovered. This is a big false positive from the testing side. 

In such cases, I want to retry the entire spec as many times as I want (via a config setting as mentioned above, similar to webdriverIO).

Re-running those failed specs will prevent failed builds due to flaky servers. ",enhancement
941049241,Ability to copy request as curl,"### What would you like?

During http calls, cypress could have a button to allow us to copy the request as curl, or either, another formats.

### Why is this needed?
When testing applications as QAs Analysts, we constantly need to inspect requests and also to replicate some of them using another applications such as Postman. 

We are able to see the request opening the browser debugger. However, when doing this all day long for months, we see that we could save lots of clicks and, of course, our time.
",enhancement
924958516,Support webpack configuration of function type,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->
Currently, the `@cypress/webpack-dev-server` supports passing a [`webpackConfig`](https://github.com/cypress-io/cypress/blob/e8da6403f94b488fcdad05c515fbbe052e948a02/npm/webpack-dev-server/src/startServer.ts#L11) argument, however only `Record<string, any>` type is supported. Namely, if I pass webpack configuration of function type like:

```js
module.exports = (env) => ({
  module: { rules: [] }
})
```
It won't work.

### Why is this needed?
<!-- Remember, we are not familiar with the application you are testing, so please provide a clear description of why this would be useful to your project. -->
I have a webpack configuration of function type https://github.com/chenxsan/mindmapping/blob/main/webpack.config.js and I want to reuse it for cypress component test. But it won't work at the moment so I have to manually copy some webpack configurations to the `cypress/plugins/index.js`.

See a reproducible branch here https://github.com/chenxsan/mindmapping/pull/11.",enhancement
924355704,Add support for Playwright browsers,"### What would you like?
I would like to introduce support for using Playwright as a browser type which the Cypress runner can use to leverage. Allowing to depend on the browser builds of Playwright allows us to have parity with Playwright test scrips (both using the same build of the browser), and you can get more recent browser builds.

For this to work a few things need to be revisited in the browser detection logic of Cypress:

 - Allow to Playwright to drive the browser detection 
 - Make the use of  calling the browser binary with `--version` optional
 - Allow extra metadata in the browsers list which are relevant for Playwright

### Why is this needed?
This is a first step to introducing support for Webkit in Cypress. If this code is written Cypress runner will be able to run in Firefox, Chrome, Edge, and in the future Webkit. Currently, I am hitting a regression of able to use Webkit with Cypress.


https://user-images.githubusercontent.com/7049/122475125-1a7af880-cfbc-11eb-9f13-2fc8cb518932.mov


",enhancement
924197949,Ability to customize the indentation level of commands in Cypress log,"### What would you like?
An ability to customize the indent level of logged commands, allowing more than just `parent` and `child` levels.

### Why is this needed?
This would be a simple alternative to having a [group](https://github.com/cypress-io/cypress/issues/1260) concept, and would be useful for things like the `within` block.


Here's an example of an item I'd like to indent (right side truncated for privacy).
The first `get` is an alias, and the second `get` is a part of the page that uses a value from that alias.
I'd want to be able to indent the second `get` to the level of the `assert` (possibly without showing a dash), and the `assert` to a level further than that.
![image](https://user-images.githubusercontent.com/1697486/122449288-8e84b480-cf5a-11eb-9a78-500e6f56e981.png)

",enhancement
917195768,Support scrollBehavior option in scrollIntoView() to control position of scroll,"<!-- 👋 Use the template below to report a bug. Fill in as much info as possible. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

As an open source project with a small maintainer team, it may take some time for your issue to be addressed. Please be patient and we will respond as soon as we can. 🙏 -->

### Current behavior
<!-- A description including screenshots, stack traces, DEBUG logs, etc. 👉 https://on.cypress.io/troubleshooting -->
Let me start by saying that the new `scrollBehavior` option is awesome and a very welcome addition to Cypress 😄! It really helps to avoid elements getting scrolled under sticky menu bars and the like

However, Cypress' `scrollIntoView()` command does not seem to obey or support the `scrollBehavior` option. In fact, it does not appear to offer any option to reliably scroll an element to the center or bottom of the viewport

### Desired behavior
<!-- Remember, we are not familiar with the application you're testing, so please provide a clear description of what should happen.-->
Cypress' `scrollIntoView()` should support the `scrollBehavior` option, whether passed in the `options` argument or part of the current configuration

### Test code to reproduce
<!-- Provide test code that we can copy, paste, and run on our machine to see the issue. -->

<!-- You could also provide a repo that we can clone and run. You can fork 👉 https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork. -->
scrollBehavior.html:
```html
<body style=""height: 200vh; padding-top: 120vh;"">
    <div style=""background-color: brown; position: fixed; top: 0px; left: 0px; width: 100%; height: 30px; margin-left: 0px;""></div>
    <span style=""font-size: 50px;"">Hello</span>
</body>
```
scrollBehavior.spec.js:
```js
it('scrollBehavior center', { scrollBehavior: 'center' }, () => {
  cy.visit('scrollBehavior.html')
  cy.get('span')
    .pause()
    // This ignores the scrollBehavior specified for this test
    .scrollIntoView()
    // This, on the other hand, obeys it
    .click()
})
```

### Versions
<!-- Cypress version, last known working Cypress version (if applicable), Browser and version, Operating System, CI Provider, etc -->
<!-- If possible, please update Cypress to latest version and check if the bug is still present. -->
Cypress 7.5.0
Google Chrome 91
Windows 10
",enhancement
910923562,Wait for additional services to be available for E2E Testing,"### What would you like?
When Cypress currently starts up it checks for availability of the baseUrl. This is great because it allows teams to get fast feedback the application isn't available and should be investigated. In a microservices environment an application contains many services that make up the full E2E stack, it would be great to have a way to configure additional services that Cypress will wait to be available before running tests.

### Why is this needed?
Faster feedback loop when a critical service is down. Rather than investigating failing tests, the team should know that the service is simply down.

### Additional Notes
To go with this feature the Dashboard product should be extended to allow Slack posts for this. This would further improve the feedback loop, as teams would know instantaneously what the problem on the current test run is. 

The Current behavior on the Cypress Dashboard when the baseUrl isn't available is that the Test run will stop and there is no way to reliably know about this without checking CI. Slack updates fit this purpose perfectly. 

Maybe a Slack update like the following

`Cypress failed to run your tests because the following services were down: baseUrl, serviceA, serviceB`

Note: If you'd like me raise a separate feature request for the Dashboard Slack message, let me know.",enhancement
903943730,Add support to use browser extensions (Chrome & firefox at least),"Sometimes, we need to automate scenarios that includes browser extensions, and this is not supported at the moment by cypress (as far as I know), so the workaround is using puppeteer in parallel. So I was wondering if it's possible to add it in Cypress so it would make it easy and that would make Cypress even greater.",enhancement
901959793,Record videos after first test failure - to capture video only during retries,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->
Currently when we enable video recording, videos are recorded for all the tests (though we can choose to upload only the failed ones). Due to this the disk IOPS usage when running the tests is very high. It would be great if we have an option to record videos only when a test is being retried due to failure.

### Why is this needed?
<!-- Remember, we are not familiar with the application you are testing, so please provide a clear description of why this would be useful to your project. -->

This should help reduce disk iops usage significantly.
",enhancement
890953929,Enviroment based conditional test cases (proposal),"### What would you like?
Hello Cypress team! Me and my team have an proposal for environment based test cases. Our vision is to add additional parameter into test case definition/header, similar way how the **retries** are done at the moment. 
```js
it('Random test case', {
    retries: {
        runMode: 2,
        openMode: 0
    },
    condRun: { 
        hasComponentA: true
    }
}, () => { }
```
So basically this test will run only when variable `hasComponentA` is set up as true in my `cypress.env.json` file. It could be explained when test case or suite is wrapped in `if (hasComponentA == true) { it('Test', { }); }`. ( We are also aware of some edge case implementations such as defining enviroment variables in the test case definition next to the condition based on the same variable. )

### Why is this needed?

The example above is also the way we are currently ""bending"" the system, but we know this is not the clean way to do it. It's the main reason we would like to propose this idea. And the final execution or form of this feature can be totally different from what we are proposing (based on the problematic edge cases mentioned above). The main point is just the idea to **run test conditionally** . 

Also I didn't find any similar ticket as this one so if the majority is not interested in such a feature we totally understand that and we are okay with the way it's done now. Or maybe the solution is already out there and we just didn't find it.",enhancement
887572041,Multidomain: Create Sibling Bridge Iframe,"For multidomain support, we need to create a sibling bridge iframe.
- Add the sibling iframe to the Test Runner
- It includes the multidomain/cross domain bundle/instance/version of the Test Runner",enhancement
887446927,Inject Cypress into a Hard-coded Secondary Domain,"For multidomain support, we need the ability to inject Cypress into a secondary domain. 
- For the time being, hardcode a second domain
- Inject Cypress into that second domain
- Create new injection code that communicates with the sibling iframe
",enhancement
877664608,Upload videos of flaky tests (tests with retries),"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->

The possibility to have videos of failures uploaded even if a retry then caused it to pass.

### Why is this needed?
<!-- Remember, we are not familiar with the application you are testing, so please provide a clear description of why this would be useful to your project. -->

We currently have `""videoUploadOnPasses"": false` set to speed up and save resources for passing tests. Since these are the vast majority this is a significant improvement. However, this has made it more difficult to analyse flaky tests that only passed after being retried. These are also often difficult to reproduce locally (as the flakes may be caused by subtle timing changes between CI and developer's machines) making the video quite helpful.
",enhancement
877650477,Add support for Chrome Beta,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

As a corollary to #3096, in order to test Cypress itself in Chrome Beta, Cypress needs to support detecting and running tests in Chrome Beta. This will enable all users to test with Chrome Beta.",enhancement
875869360,cy.intercept should provide req.query since the url has the query object,"### Current behavior
`req.url` looks like `http://hostname:port/?someKey=someValue` but `req.query` is `undefined`.

### Desired behavior
`req.url` looks like `http://hostname:port/?someKey=someValue` and `req.query` is `{ someKey: 'someValue' }`.

### Test code to reproduce
```javascript
cy.intercept({ hostname }, (req) => {
  console.log(req.query) // undefined
  console.log(req.url) // http://hostname:port/?someKey=someValue
})
```

### Versions
Cypress: 7.2.0
",enhancement
874270780,Allow component tests to be run via the module API,"### Current behavior

We start our Cypress tests by using the [Cypress module API](https://docs.cypress.io/guides/guides/module-api#cypress-run). This has worked fine for us until the release Cypress 7 and its Component Test Runner. We don't know how to run the component tests from the API anymore.

### Desired behavior

I expect to be able to write `cypress.runCT({...})` in my JS script to run the component tests.

### Versions

Cypress 7.2.0",enhancement
873948971,Support Stryker-Mutator,"### What would you like?
I would like to see first class stryker-mutator support in cypress. Right now it is possible to run stryker-mutator and cypress together but there are some major issues. First it takes an extreme long time to finish because its only possible to run if you tell stryker the cypress run command and stryker will call it for every mutation. So runtime goes up really fast. Second stryker will not get any coverage analysis data that will also play in to runtime. And the last thing i could see is it does not really get the test report. So it will tell you all mutations have survived.  

### Why is this needed?
Because of the way cypress works its needed to get some first class api support for stryker so it can hook in to livecycles. Like dont start the runner for every mutation anew but hold one runner instance and run it again and again for every code mutation. Also it would give way more insights for stryker to run faster and actually capture the results from cypress.

Here is an link to the homepage: https://stryker-mutator.io/
",enhancement
871856176,Allow passing undefined or null for no options per test,"Cypress v7.2.0
Cypress allows passing per-test config options object like this

```js
it('works', { baseUrl: 'http://localhost:8000' }, () => {})
```

Turns out, if you pass `undefined` or `null` object as the second argument, the test is marked as pending, even if it has commands

```js
describe('page', () => {
  it('works', undefined, () => {
    cy.visit('https://example.cypress.io')
  })
})
```

<img width=""487"" alt=""Screen Shot 2021-04-29 at 10 38 54 PM"" src=""https://user-images.githubusercontent.com/2212006/116642062-01e74e00-a93c-11eb-8b29-13c51718ef2f.png"">

The only way to pass no options is to pass an empty object as the second argument

```js
describe('page', () => {
  it('works', {}, () => {
    cy.visit('https://example.cypress.io')
  })
})
```

<img width=""544"" alt=""Screen Shot 2021-04-29 at 10 39 09 PM"" src=""https://user-images.githubusercontent.com/2212006/116642078-10ce0080-a93c-11eb-9dd4-0b5742bd135a.png"">

## expected behavior

Allow passing undefined or null as the second argument to have no per-test options. This is also important when overwriting the `it` function, as I do in https://github.com/bahmutov/cypress-grep

## reproduction

https://github.com/cypress-io/cypress-test-tiny/tree/test-undefined-options",enhancement
868951727,Create a version of the Test Runner for Cross Domains,"### What would you like?
Create the version of the runner that would be included in the sibling iframe
- Need another Test Runner bundle for the “other” domains AUT

Implementation of this will not include the reporter or any UI
- Doesn’t need one, because it’s nested

### Why is this needed?
This is the version of the driver that will run the tests cross domain. Associated with #944 
",enhancement
864530220,Make a 1 second (1000ms) delay to show Cypress Command Log configurable globally and for commands,"Currently Cypress Command Log is shown if the command did not finish after 1 second.

Most DOM commands should execute within this time but remote requests or DOM objects depending on such requests often exceed this limit and Command Log shows up, slowing down tests considerably.

There are several timeouts available for different command types and several options for requests but none allows adjusting this 1 second show log trigger..

Reasoning behind configurable show Command Log delay is that often tests require resetting the environment/database to isolate tests from each other, in line with cypress recommendations, but this process takes time and leads to slower tests overall as needs to be performed at the very beginning of each test.

My proposal is pretty simple, in the order of importance as I can see it:

1. Add logTimeout option to the cypress.json options with a default value of 1000 (ms).
2. Add cy.request() option logTimeout which when set will override cypress.json logTimeout allowing to specify a custom delay after which Command Log will be shown for this request
3. Add logTimeout to all other functions with already have a timeout option (cy.get(), cy.click() etc) allowing to handle slow dom-triggered requests.

Having only globally configurable logTimeout (1) should be enough in most cases and since it is a global setting there is a high probability it will be easy to implement so please consider it a priority even if (2) and (3) would be a nice addition.",enhancement
857389417,Add `timings` to `cy.intercept()` objects,`cy.intercept()` seems to be missing the `Duration` property in the response. We use this to ensure our network response times are acceptable - Are there any plans to bring it back? Or are there any workarounds available to do this?,enhancement
855041157,Nunit3 reporter,"I would like Cypress had embedded Nunit3 reporter.
I use Azure Devops and it does not support upload of screenshots results unless the report file is in Nunit3 format.",enhancement
853275033,Open devtools inside the playground iframe with a simple button,"### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->
_When I want to inspect the DOM, I have to use shortcut or click right + Inspect element._
Have some latency before the devtools is opened.

And because the playground is in an iframe, it could be very nice to integrate the dev tools directly inside the iframe, because we didn't want to inspect Cypress app, only the playground.
You can see with @antfu [Vite VS Code project](https://github.com/antfu/vscode-vite) to get some inspiration for devtool integration (which would be sadly only available for Chromium based browser)

<u>Summary:</u>

- Integrate the devtools inside the playground iframe
- Add a button to open dev tools (or inspect DOM element which open the devtools directly with the element inspected visible).

### Why is this needed?
For better inspection tools and a fully tools set during TDD tests writing (especially for Component Testing !)
",enhancement
852746827,Cypress.log() lacks a way to highlight a DOM element,"**Summary:** In a custom command using `Cypress.log()` and passing `{log: false}` to all sub-comands, it is impossible to have information about the DOM elements being selected by the command or have them highlighted in the page.

## Current behavior

Here is a screenshot showing a custom command not using `Cypress.log()`:

![2021-04-07-210738](https://user-images.githubusercontent.com/217543/113922122-322d4800-97e7-11eb-8054-ce5512ff4afc.png)

You can see the seleted DOM element is highlighted in the top-right and some information is visible in the console. This is implemented by this custom command (from the [realworld-app](https://github.com/cypress-io/cypress-realworld-app/blob/v1.0.16/cypress/support/commands.ts#L35)):

```js
Cypress.Commands.add(""getBySel"", (selector, ...args) => {
  return cy.get(`[data-test=${selector}]`, ...args);
})
```
 
If you want to go fancy or just write a more complex command without polluting the command log, you would typically use the ([under documented](https://github.com/cypress-io/cypress-documentation/issues/3139)) `Cypress.log()` function. Something like this for example:

```js
Cypress.Commands.add(""getBySel"", (selector, ...args) => {
    Cypress.log({
        name: ""getBySel"",
        message: selector
    });

    return cy.get(`[data-test=${selector}]`, {log: false});
});
```

This indeed cleans up the command log a bit but now the DOM element is not highlighted anymore and the console don't show information:

![2021-04-07-211021](https://user-images.githubusercontent.com/217543/113922952-3ad24e00-97e8-11eb-95c1-7cba63dc03c9.png)

I know about the non-documented `consoleProps` option to `Cypress.log()` and the `set()` method but I don't know how to use them to get the same behavior as the standard `cy.get()` command without polluting the command log.

### Desired behavior

I would like to write custom commands that control the command log while still having a way to get the selected DOM elements highlighted in the page and get information in the console log.

### Test code to reproduce

https://github.com/DamienCassou/cypress-realworld-app/pull/1

### Versions

Cypress 7.0.1",enhancement
852239487,Add support for detecting Flatpak-installed browsers,"Dear cypress team,

I would like to test my components with cypress but it does not work as expected. When starting the test, I have got the following error:
```
npx cypress open-ct --browser chromium

(node:44501) Warning: Accessing non-existent property 'padLevels' of module exports inside circular dependency
(Use `Cypress --trace-warnings ...` to show where the warning was created)
Error: Can't run because you've entered an invalid browser name.

Browser: 'chromium' was not found on your system or is not supported by Cypress.

Cypress supports the following browsers:
- chrome
- chromium
- edge
- electron
- firefox

You can also use a custom browser: https://on.cypress.io/customize-browsers

Available browsers found on your system are:
- firefox
- electron
    at get (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/server/lib/errors.js:995:15)
    at Object.throwErr [as throw] (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/server/lib/errors.js:1013:9)
    at throwBrowserNotFound (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/server/lib/browsers/index.js:140:22)
    at /home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/server/lib/browsers/index.js:123:12
    at tryCatcher (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/util.js:16:23)
    at Promise._settlePromiseFromHandler (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/promise.js:512:31)
    at Promise._settlePromise (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/promise.js:569:18)
    at Promise._settlePromise0 (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/promise.js:614:10)
    at Promise._settlePromises (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/promise.js:694:18)
    at _drainQueueStep (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/async.js:138:12)
    at _drainQueue (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/async.js:131:9)
    at Async._drainQueues (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/async.js:147:5)
    at Immediate.Async.drainQueues [as _onImmediate] (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/async.js:17:14)
    at processImmediate (internal/timers.js:461:21)
 {
  isCypressErr: true,
  type: 'BROWSER_NOT_FOUND_BY_NAME',
  details: undefined
}
Error: Can't run because you've entered an invalid browser name.

Browser: 'chromium' was not found on your system or is not supported by Cypress.

Cypress supports the following browsers:
- chrome
- chromium
- edge
- electron
- firefox

You can also use a custom browser: https://on.cypress.io/customize-browsers

Available browsers found on your system are:
- firefox
- electron
    at get (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/server/lib/errors.js:995:15)
    at Object.throwErr [as throw] (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/server/lib/errors.js:1013:9)
    at throwBrowserNotFound (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/server/lib/browsers/index.js:140:22)
    at /home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/server/lib/browsers/index.js:123:12
    at tryCatcher (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/util.js:16:23)
    at Promise._settlePromiseFromHandler (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/promise.js:512:31)
    at Promise._settlePromise (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/promise.js:569:18)
    at Promise._settlePromise0 (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/promise.js:614:10)
    at Promise._settlePromises (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/promise.js:694:18)
    at _drainQueueStep (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/async.js:138:12)
    at _drainQueue (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/async.js:131:9)
    at Async._drainQueues (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/async.js:147:5)
    at Immediate.Async.drainQueues [as _onImmediate] (/home/developer/.cache/Cypress/7.0.0/Cypress/resources/app/packages/launcher/node_modules/bluebird/js/release/async.js:17:14)
    at processImmediate (internal/timers.js:461:21)

Done in 10.55s.
```
I have attached the files and folders.
[components.zip](https://github.com/cypress-io/cypress/files/6270667/components.zip)
I am using RollupJS, maybe that causes the problem.

I am using Visual Studio Code

Thanks

",enhancement
851889968,"fix: make ""New Spec File"" a button link style","### User facing changelog
- Changed style of ""New Spec File"" to be a link style instead of a primary button

### How has the user experience changed?

The previous style was way too aggressive to be a primary button, and distracted from the already existing primary button (which was the browser dropdown).

![image](https://user-images.githubusercontent.com/1268976/113791681-30de1b80-9712-11eb-9d9a-b154fd5ce2fd.png)

### PR Tasks
<!-- These tasks must be completed before a PR is merged.
Delete tasks if they are not applicable. -->

- [x] Have tests been added/updated?
- [x] Has the original issue or this PR been tagged with a release in ZenHub? <!-- (internal team only)-->
- [ ] Has a PR for user-facing changes been opened in [`cypress-documentation`](https://github.com/cypress-io/cypress-documentation)? <!-- Link to PR here -->
- [ ] Have API changes been updated in the [`type definitions`](https://github.com/cypress-io/cypress/blob/develop/cli/types/cypress.d.ts)?
- [ ] Have new configuration options been added to the [`cypress.schema.json`](https://github.com/cypress-io/cypress/blob/develop/cli/schema/cypress.schema.json)?
",enhancement
848283306,Support application/xhtml+xml content-type in cy.visit() command,"### What would you like?
The `cy.visit()` command only supports text/html response content-type or documents which can be parsed as HTML. We need the ability to support XHTML documents by allowing response content-type containing `application/xhtml+xml.*` and avoid the following error message.

```
cy.visit() failed trying to load:

http://localhost:5000/index.xhtml

The content-type of the response we received from your web server was:

  > application/xhtml+xml

This was considered a failure because responses must have content-type: 'text/html'
```

### Why is this needed?
Our applications run on some devices that use XHTML, which is a stricter extension of HTML based on XML, which browsers can render in the same way as text/html documents.

The content type is allowed in the accept header, but does not seem to be allowed on the response content-type. The current code that checks if the response body looks like html seems to fail to detect it as XHTML documents often begin with XML declarations.

I have had success asserting on-screen elements of XHTML documents with Cypress by disabling the current error messages and will submit a PR allowing the `application/xhtml+xml.*` response content-type.

",enhancement
836014402,Feature Request: Retry failed tests after the entire test suite has ran instead of retrying instantly,"### What would you like?

It'd be awesome if the retrying of failed tests would happen ***after*** the entire test suite has ran instead of retrying failed tests instantly.

### Why is this needed?

If there is a connection / network blip or flakiness with an internal or external API or some other integrated dependency causing a test to fail, retrying the test immediately will likely result in the test failing again as it tries again so quickly.

It would be nice to delay or postpone the retries until the end after the rest of the test suite has had a chance to run. This would allow more time in between test run attempts, giving more time for the blips and kinks to work themselves out instead of expecting those things to work themselves out nearly immediately.
",enhancement
835948931,Provide full stack trace on custom command failure,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
I would like to see the full stack trace when a custom command fails.
At the moment I see this:
![image](https://user-images.githubusercontent.com/5892508/111789216-cc6d3080-88b8-11eb-91f6-41598e4248f4.png)


So I can see the line in the custom command that failed and I can see which command was invoked, but I cannot see which line in the test was the command called from.

I'm pretty sure we already get a full stack trace for Cypress's built-in commands, taking you all the way back to the line of the test that caused them. For example if `cy.click()` fails to click an element, you get a larger stack trace including the line in the test that called the click method that failed, so I wish we would get the same just with custom commands.

### Why is this needed?
It would improve the usability of custom commands since it's time consuming to find the line on the test calling the command that failed, especially if the same test invokes the same custom command multiple times.

An example would be, we wrote a custom command that interacts with our modals and automatically selects an item from a modal with a specific data attribute tag. Because we have a lot of modals this command gets invoked multiple times per test, making it hard to figure out which exact command in the test caused the error without having to look at the logs backwards, especially if we are trying to debug an error from a CI.
",enhancement
835895141,Ability to change download folder during tests,"### What would you like?
A way to add the abitity to change the download folder during a test run

### Why is it needed?
We create Files dynamically depending of Users inputs. The backend then decides the files content.
At the moment the downloaded file gets replaced by the new one and we have no way to check the previose test runs file.

We can set the config downloadsFolder once at the beginning of the test run, but that wouldn't scale well, because we would have to run every spec seperatly.
",enhancement
829424207,Add options to customize `name` and `displayName` and `message` of some builtin commands,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
A way to customize the `name` and `displayName` and `message` attributes of some built-in commands, such as `cy.get` and `.find`.

### Why is this needed?
This can help unclutter the command log, by moving the ""key"" of what it's looking for from the message to the displayName.

![image](https://user-images.githubusercontent.com/1697486/110833320-26368080-8251-11eb-8e74-c9a446b22b92.png)

This could also be useful to partially address another feature request, by giving a way to tidy up the logging without disabling it entirely: https://github.com/cypress-io/cypress/issues/8296

I've tried doing it with a custom command, but custom commands that wrap `cy` commands aren't able to fully replicate the logging:
* Can't highlight element by setting `$el`, especially in cases where you expect it not to exist
* Can't call a callback each time the selector result is checked (`.then` only happens after element exists, and `.should` breaks default assertions)
* Can't call a callback when the chained assertions fail (need something like `.onFail`: it would be block-scoped, and would allow logging, but [not allow canceling the failure](https://github.com/cypress-io/cypress/issues/395#issuecomment-275499926))
* Can't use `verifyUpcomingAssertions` on the return value of `.get` (because that mixes synchronous and asynchronous code)
* Can't use `verifyUpcomingAssertions` in a `.should` block ([because it causes an infinite loop](https://github.com/cypress-io/cypress/issues/3109#issuecomment-792981403))


As an experiment, I managed to get something like what I want by copying the code of the `.get()` method, but that's too messy, and all the shadowDom stuff seemed not to be publicly exposed.



",enhancement
828902112,Expose setSystemTime from lolex,"### What would you like?
I would like to be able to do:

```javascript
cy.clock().then(clock => clock.setSystemTime(12345));
```

### Why is this needed?
I am testing a timer, and I realized that when I wanted to test it also displays hours correctly, I did cy.tick(4*60*60*1000) and Cypress froze because it was running thousands of setInterval callbacks in a row. `setSystemTime` allows me to skip forward in time, and I can still use tick for small increment testing.

I'm happy to do the implementing
",enhancement
826749012,Cypress should expose list of runnables!,"I've been trying to figure out how to get a list of 'runnables' from a given spec to no avail. However, internally the Cypress app gets this list and then just iterates over it. You can see that the Cypress app actually compiles a list when using cypress:open

![Screen Shot 2021-03-08 at 4 49 48 PM](https://user-images.githubusercontent.com/331553/110548426-64af2c80-80e5-11eb-992d-803e40d55316.png)

Before any tests actually start running the list is displayed. 

Even if you run cypress in debug mode you can't parse this information out on the fly before tests are run. Using the DEBUG=cypress:server:reporter option you'll see that this information is only exposed prior to 'each' test running. Using DEBUG:cypress:* does not give any further info into how to gain this list of tests.

Unless I'm missing something here the only way I can see of gaining access to the list is to possibly alter the Cypress app to log the list using the built-in debug() function.
",enhancement
816844766,New file download feature: downloads should be organized into sub-directories just like videos,"It seems that all downloads go into the same folder, which is inconsistent with other artifacts, like screenshots and videos, which are organized into folders based on the test file name. How do we get downloads to automatically go into those same per-test folders?

Dumping all downloads into a single folder doesn't seem like a good idea to me, for the same reason you wouldn't dump all screenshots or videos into a single folder: it makes organization and triage much more difficult than it needs to be. We regularly run 50-60 test suites, comprising ~600 tests, and we'd like to start testing downloads in several tests. I think it makes sense that downloaded files get organized correctly, so if something goes wrong, we can easily find the downloaded files with our other artifacts in the same directory. Without this, we'd have to match up timestamps, which seems unnecessarily annoying.",enhancement
815906539,cy.intercept / force404,"Cypress should allow disabling forwarding of requests which are unmatched with cy.intercept.

This will prevent unwanted latency and make it easier to spot missing stubs. This used to be supported with cy.server(). 

Related to:

https://github.com/cypress-io/cypress/issues/9358#issuecomment-750231567
https://github.com/cypress-io/cypress/issues/9302

",enhancement
813650332,Add log: boolean option to cy.tick,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
```js
cy.tick(2000, { log: false });
```
Currently there is no log option on tick, as I had expected while working on customizing my log. Was wondering if it was an oversight or on purpose?

### Why is this needed?
To align with the feature set surrounding allowing you to customize your log, most commands support this option so I was expecting this one to have it too, and would be nice to silence this one in a specific custom command I'm building though I'll of course live without it
",enhancement
811003127,"Also run lifecycle hooks (before:run, after:run, before:spec, after:spec) in plugins while in interactive mode","<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->
As described in the last comment of [issue 6665](https://github.com/cypress-io/cypress/issues/6665) the lifecycle hooks `before:run`, `after:run`, `before:spec` and `after:spec` in a plugin don't run while in interactive mode. 
I don't really get the reasoning behind this choice. Maybe this is hard to do technically. But I would like these events to be triggered when running in any mode. 

### Why is this needed?
The reason I would like to use these events is to subscribe and unsubscribe to some of my own events that get triggered by my system to do some integration tests. Another use case I would assume is to prep some data or clear some data that is managed by a plugin, so not to use the beforeEach and stuff of the tests themself but from the plugin.

",enhancement
801586873,"Report the CPU type and number in ""cypress info"" command","Currently, in Cypress v6 we report just the amount of memory on the machine, 

```
Cypress Version: 6.4.0
System Platform: darwin (19.5.0)
System Memory: 17.2 GB free 260 MB
```

It would be so nice to report the number of CPU cores and their type:

```
$ node -p 'os.cpus()'
[
  {
    model: 'Intel(R) Core(TM) i7-4870HQ CPU @ 2.50GHz',
    speed: 2500,
    times: { user: 72341610, nice: 0, sys: 40531250, idle: 435841580, irq: 0 }
  },
```

https://nodejs.org/api/os.html#os_os_cpus",enhancement
799098062,Add support to get downloaded file when its name is not known.,"It would be useful to have an option to parse downloaded files when their name is not known at the moment of download. I tried to create a helper function (task) for that which returns the latest file, however, it's not reliable as it's executed when file is not there yet:

```js
// plugins/index.js
const getLastDownloadFilePath = () => {
  const dirPath = 'cypress/downloads';
  const filesOrdered = readdirSync(dirPath)
    .map(entry => path.join(dirPath, entry))
    .filter(entryWithPath => lstatSync(entryWithPath).isFile())
    .map(fileName => ({ fileName, mtime: lstatSync(fileName).mtime }))
    .sort((a, b) => b.mtime.getTime() - a.mtime.getTime());

  return filesOrdered.length ? filesOrdered[0].fileName : false;
};
```

I believe it may be useful to have the ability to:
1. wait for file download,
2. get the name of the downloaded file.

These two should allow handling such cases.",enhancement
796313074,Open Browser Extension Feature,"### What would you like?
I want a feature to be able to click on a chrome extension and open it. Similar to where people visit a page, visit/open a chrome extension.

### Why is this needed?
I want to use cypress to test our chrome extension, and from querying https://gitter.im/cypress-io/cypress# it looks like I'm far from being the only one who wants this.

You have [plugin code](https://docs.cypress.io/api/plugins/browser-launch-api.html#Modify-browser-launch-arguments-preferences-and-extensions) letting users load their chrome extensions, but then don't have any documentation showing users how to then open it. 

And users then read through your docs assuming you support this and then find nothing on opening it. They then go to your customer chat and get no replies back time and time again ( I stopped looking at past requests after 5 of them were ignored). It's a very frustrating experience.

Please add the functionality to open the extension. You're almost there for supporting extension users, and you already tackled the hard part already.",enhancement
791685974,Cancel button should appear under error for failed tests in Studio,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
The cancel button (that usually appears in the same line as the ""Save Commands"" button) should appear when a test has finished running in Studio mode even if the test does not pass.

When a test has passed and is actively being edited:

![Screen Shot 2021-01-21 at 11 22 00 PM](https://user-images.githubusercontent.com/7033952/105446134-83de2180-5c3f-11eb-8882-56d6ca28abb8.png)

### Why is this needed?
The controls on the right side are less noticeable and may be missed in this situation. When a test passes, this button is available in the bottom left so it only makes sense that it would if the test fails since the user is most likely looking for the quickest way to exit.

This is what that state currently looks like, with the only exit being the 'X' in the top right:

![Screen Shot 2021-01-21 at 11 18 16 PM](https://user-images.githubusercontent.com/7033952/105446025-44afd080-5c3f-11eb-8354-33cc9bb62d87.png)

",enhancement
791644292,Studio should not add .click() before .type(),"<!-- 👋 Use the template below to report a bug. Fill in as much info as possible. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

As an open source project with a small maintainer team, it may take some time for your issue to be addressed. Please be patient and we will respond as soon as we can. 🙏 -->

### Current behavior
Currently Studio will add a `cy.click()` before a `cy.type()` when an input is clicked. However, Cypress automatically clicks an input before typing, so it's redundant for studio to generate this command.

![ezgif-3-551b311e75cd](https://user-images.githubusercontent.com/7033952/105437532-4376a780-5c2f-11eb-9fc4-5bec78332dda.gif)

### Desired behavior
Studio should not add a `cy.click()` before a `cy.type()` (on the same element)
",enhancement
791143533,Add option to mountHook to use custom mount method,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->
It would be great to have the option to use a custom `mount` method when using `mountHook`. 

### Why is this needed?
<!-- Remember, we are not familiar with the application you are testing, so please provide a clear description of why this would be useful to your project. -->
Currently I have to `mount` a component to test hooks that depend on a `React.Context` or a Provider. With a custom version of `mount` as described in https://github.com/cypress-io/cypress/blob/develop/npm/react/docs/providers-and-composition.md, this would be  possible without creating components.",enhancement
785644164,Add options to prune command,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
We'd like some options added to the `prune` command that would allow some flexibility in regards to which versions it deletes. We would like to add this to our CI pipeline but would run into the issue where if two branches had different versions of Cypress running (e.g. one on 6.2.0 and one just updated to 6.2.1) that they would each delete the other install. 

I was thinking something along the lines of one option that would allow you to disable deleting higher versions (e.g. an old branch with Cypress 3.6.0 runs and doesn't kill our current version of 6.2.1) and an option to keep the last version or two of Cypress installed (e.g. one branch updates from 6.2.0 to 6.2.1 and it doesn't delete 6.2.0 as it is just one version behind).


### Why is this needed?
Allow running command as part of CI pipeline, see above.

<hr/>

I'd be willing to have a go at the PR if this feature sounds reasonable.
",enhancement
785139006,Opening with folders collapsed,"Hi, 

Love the tool and have no issues with it this is just a minor request. I have a lot of different tests and folders for each (around 40 tests or so) my request is that it would be nice to have a feature which allows the user to select how the ""cypress-open"" applications opens. It would be nice if it opened with just the folders for each, right now it feels like it's screaming at me with all my files open and exposed. 
Again, not a huge deal but just wanted to bring this up. 
Best,

Alex",enhancement
784972908,cy.intercept by request cause,"### What would you like?

Allow matching routes by its cause (e. g. `image` or `xmlhttprequest`):

```js
cy.intercept({
  url: ""/orders"",
  cause: ""xmlhttprequest"",
});
```

### Why is this needed?

My current application uses same URLs on API and UI side (e. g. `https://127.0.0.1:3000/orders` on the frontend queries `https://127.0.0.1:4000/orders` on the backend). I need to stub the API call, then open the page on the frontend as usual.

`cy.route` was handling only API requests, so simple `cy.route(""/orders"")` would work alright independent of the environment – if the backend was on a different hostname (e. g. CI could use a staging instance instead of localhost), `cy.route` would still match it. With `cy.intercept`, the only way to match API calls right now is to add a hostname, e. g.:

```js
const apiRoot = Cypress.env(""api_root"");
cy.intercept(""${apiRoot}/orders"");
```

This looks acceptable but it's another configuration variable to keep up to date, and can be avoided. :-)

### Implementation suggestion

If I get this correctly, this can't be implemented using just the current setup with running a proxy server. However, we could use the extension running in the browser to match the routes we need using the `webRequest.onBeforeRequest` ([Mozdev][mdn], [Chrome docs][chr]) API. If we can't move all intercepting business to the extension (why?), we could use it to add an HTTP header to all requests (`X-Cypress-Cause: xmlhttprequest`) and match that on the proxy side as usual.

P. S. Thank you all for your great work!

[mdn]: https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest
[chr]: https://developer.chrome.com/docs/extensions/reference/webRequest/",enhancement
781270028,[Feature request] make cy.clearCookie() yield list of deleted cookies,"**Origin**
This is a followup to https://github.com/cypress-io/cypress-documentation/issues/2508

**Description**
Currently cy.clearCookie() yields null. It would be handy if it returned list of deleted cookies as confirmation of what has been done by the command.

**Docs:**
https://docs.cypress.io/api/commands/clearcookie.html",enhancement
776703677,Allow setting multiple instances of the same header in intercepted requests,"### What would you like?

Setting multiple cookies in the intercepted request, which requires ability to set the same header (`Set-Cookie`) multiple times. Currently, headers is a map of string to string so setting same header multiple times is not possible.

Suggestion: change signature from `headers?: { [key: string]: string }` to `headers?: { [key: string]: string } | { [key: string]: string }[]` to allow specifying an array (which will turn into multiple instances of the same header). This should be backwards compatible as well.

### Why is this needed?

Primarily, as a workaround to authentication woes I'm having (https://github.com/cypress-io/cypress/issues/1342#issuecomment-752807091). With multiple domains support I might not need this feature.
",enhancement
773466092,Snowpack preprocessor,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
In a similar way that there are preprocessors for Webpack, Browserify, Rollup, and Parcel, I would like to request a preprocessor for Snowpack. Snowpack is going to be included as a part of the next-gen [SvelteKit](https://svelte.dev/blog/whats-the-deal-with-sveltekit) web application framework, so it will most probably become a standard in the Svelte community. I took a look at the Webpack preprocessor but I'm not experienced with TypeScript, so it seems difficult to quickly adapt. Also, I'm still new to all Snowpack options. I opened a [ticket in the Snowpack repository](https://github.com/snowpackjs/snowpack/discussions/2095) as well in case a collaboration across projects is possible.

### Why is this needed?
This would allow us to implement cypress-svelte-unit-test within our build process using Snowpack.",enhancement
772192882,Option To Configure/Bypass Final Courtesy Check For Running Server,"<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?

As discussed [here](https://github.com/cypress-io/cypress/discussions/14233) cypress checks for the sever running at `baseUrl`. If this check fails it exits. The number of retries is not configurable, nor can the check be bypassed.

- An option to suppress this check (nice to have -- ability to change it a ""warning"") 
- An option to configure the number of retries (nice to have -- retry-until-success).  

### Why is this needed?

- So that other mechanisms for ensuring that the server is already running during test are not superseded by this non-optional check.

- Avoid introducing dependencies on, e.g. `wait-on`, `start-server-and-test`",enhancement
770993448,Better handling of unexpected HTTP call responses,"### What would you like?
Built-in, simplified checks for http responses. In particular, status codes. 

### Why is this needed?
It is not enough to intercept an http call and ensure that it returns. It should return with a specific code. If you expect a 200 and get a 500, you should know immediately, rather than failing later because some DOM element doesn't exist. 

Forcing customers to write their own commands for this will produce inconsistency for what should be a basic feature. 

Additionally, if a status code does not match, we would like to see the HTTP details. This would include the body of the call, and the response. 

Here is an example of a command that I've started writing. it is a work in progress.

```js
Cypress.Commands.add(
  'withStatusCode',
  {
    prevSubject: true,
  },
  (subject, status) => {
    // If you wait for an array of calls,
    if (Array.isArray(subject)) {
      cy.wrap(subject).then((subjects) =>
        subjects.forEach((_subject) => {
          // Log the body, because we probably got a 500 or 400 that we need to debug now
          if (_subject.response.statusCode !== status) {
            cy.log(_subject.response.body);
          }
          cy.wrap(_subject).its('response.statusCode').should('eq', status);
        }),
      );
      // else, if you wait for a single call
    } else {
      // Log the body, because we probably got a 500 or 400 that we need to debug now
      if (subject.response.statusCode !== status) {
        cy.log(subject.response.body);
      }
      return cy.wrap(subject).its('response.statusCode').should('eq', status);
    }
  },
);
```

Example of usage: 
```js
      // This is an array of waits, so the command above will check that all the results are 200 in the first part of the if statement
      cy.wait(['@load1', '@load2']).withStatus(200);

     // A single wait, which is the else part of the command above
      cy.wait('@load').withStatus(200);
```

If the status is not 200, it will produce a cypress log with the body of the response. I'd like it to include the response and the request body as well. Additionally, I'd like to see it in the Cypress Dashboard, without having to view the replay video. 


If you could take this, clean it up a bit, and format it really nicely in the dashboard, it would go a LONG way to solving several of the bugs that we have had much faster. We frequently get errors in CICD that do not appear locally, which this would be ideal for. ",enhancement
766329584,Test Runner: Expand and highlight matched get elements,"### What would you like?
When using the [test runner](https://docs.cypress.io/guides/core-concepts/test-runner.html#Spies), the get command returns all matches for an element which can be cycled through with the eq() method. This however can be improved if each match on the DOM snapshot could be labelled according to which index exactly it matches. 

### Why is this needed?
Usually the selection process for eq() method is to get all element matches then guess which element matches the eq() index from 0 to ... Lots of trial and error here that can be solved by labelling each element matched  y its index or by allowing the get log to expand into a more detailed list per item.

![Screen Shot 2020-12-14 at 12 28 58](https://user-images.githubusercontent.com/11727537/102076663-5617e880-3e08-11eb-9f12-3953a19ee201.png) 
",enhancement
752027858,"Is there an equivalent of cy.server({ignore: (xhr) => bool}) to disable logging, after moving to cy.intercept?","<!-- 👋 Use the template below to request a feature. 

Have a question? Start a new discussion 👉 https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. 🙏 -->

### What would you like?
I would like to continue to be able to disable logging of some routes after moving to `cy.intercept()`.

### Why is this needed?
A nice side-effect of calling `cy.server({ignore: (xhr) => bool})` to disable stubbing is that it also disables logging of matching routes. This helps decluttering the logs when we're running interactive tests.

Examples are ping-pong requests with back-end server, webpack-dev-server's sockjs route, etc.
",enhancement
749898549,Unable to install Cypress via NPM on Rapsberry Pi OS,"Strange, I am unable to install cypress.. Here are the logs:
```
1711 verbose stack Error: cypress@5.6.0 postinstall: `node index.js --exec install`
1711 verbose stack Exit status 1
1711 verbose stack     at EventEmitter.<anonymous> (/usr/local/lib/node_modules/npm/node_modules/npm-lifecycle/index.js:332:16)
1711 verbose stack     at EventEmitter.emit (events.js:315:20)
1711 verbose stack     at ChildProcess.<anonymous> (/usr/local/lib/node_modules/npm/node_modules/npm-lifecycle/lib/spawn.js:55:14)
1711 verbose stack     at ChildProcess.emit (events.js:315:20)
1711 verbose stack     at maybeClose (internal/child_process.js:1048:16)
1711 verbose stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:288:5)
1712 verbose pkgid cypress@5.6.0
1713 verbose cwd /home/pi/twilio-react-app/react-client
1714 verbose Linux 5.4.72-v7l+
1715 verbose argv ""/usr/local/bin/node"" ""/usr/local/bin/npm"" ""install"" ""cypress"" ""--save-dev""
1716 verbose node v14.15.1
1717 verbose npm  v6.14.8
1718 error code ELIFECYCLE
1719 error errno 1
1720 error cypress@5.6.0 postinstall: `node index.js --exec install`
1720 error Exit status 1
```
any advice will be helpful..",enhancement
747773189,Automatically include CORS headers for network stubbing,"<!-- :wave: Use the template below to request a feature. 

Have a question? Start a new discussion :point_right: https://github.com/cypress-io/cypress/discussions

Please be patient and we will respond as soon as we can. :pray: -->

### What would you like?
Currently, users must specify CORS headers manually, if needed:

https://github.com/cypress-io/cypress-realworld-app/commit/2df6ef737ce16a6c81a0a51e415ddb38d3a47399

```js
    // Before: cy.route(""GET"", ""/bankAccounts"", []).as(""getBankAccounts"");
    cy.intercept(
      { method: ""GET"", url: ""/bankAccounts"" },
      {
        // TODO: automatically handle applying these headers
        headers: {
          ""access-control-allow-origin"": window.location.origin,
          ""Access-Control-Allow-Credentials"": ""true"",
        },
        body: { results: [] },
      }
    ).as(""getBankAccounts"");
```

This is some manual work that could probably be avoided in 99% of cases.

We should set `Access-Control-Allow-Origin: ${request's origin header}` and `Access-Control-Allow-Credentials: true` by default on stubbed responses so users don't need to do this manually.

",enhancement
747667065,Expose command timing,"### What would you like?

I would like to know how long every command took to execute during the test to figure out how to speed things up. Was it the `cy.visit`? Or `cy.request`? Or `cy.get('selector').should('be.visible')`? 

We do have this information already - read https://www.cypress.io/blog/2020/05/22/where-does-the-test-spend-its-time/ and could provide it to the user either on demand, or by default

As the first step, I think we could simply add command timing to the DevTools Console output when clicking on the command

<img width=""1127"" alt=""Screen Shot 2020-11-20 at 12 16 16 PM"" src=""https://user-images.githubusercontent.com/2212006/99829535-6818ab00-2b2a-11eb-95ba-026c094305d9.png"">

We already report duration for some commands, like `cy.request`, but could report it for all of them.

Second step would show those durations for every command in the reporter, like this

<img width=""1159"" alt=""Screen Shot 2020-11-20 at 12 23 23 PM"" src=""https://user-images.githubusercontent.com/2212006/99830107-3ce28b80-2b2b-11eb-89f6-1e2cbdd6cc18.png"">

### Why is this needed?

People complain about Cypress being slow - https://twitter.com/sunpietro/status/1329545832262152203 is one example, and the first step to answering this question is understanding where the test is spending its time.

",enhancement
745908719,"UX improvement, highlight the current test running (and maybe the line?)","### What would you like?
The name of the current test running should always be clearly visible somewhere on top of the side panel.

### Why is this needed?
When watching the video of a test is extremely tedious to find the place where a given test is being executed, and scanning a video of 15/20 minutes searching for a single frame is not easy at all. 

Reporting at least the name of the test being run at that moment, big on top, would help.

The current line of the test would be incredibly good, but that's probably asking too much, even if you have it cause it's then reported in errors. 

The current workaround is to:
- Search on the source which one is the NEXT test from the one I need to watch
- Check here and there until the NEXT one is the first of the list of stuff to execute
- Then try to go back until I don't find the start of the test I'm looking for",enhancement
745001514,Cypress Custom Commands with dots or brackets,"What about prefer
```javascript
_.set(cy, name, fn);
```
over
https://github.com/cypress-io/cypress/blob/052892d79f95f9792e00d426722a9d904b572df4/packages/driver/src/cypress/cy.js#L1051

I think it would be awesome being able to have something like
```javascript
Cypress.Commands.add(""modal.close"", () => {...});
// ...
cy.modal.close();
```
How about you guys?",enhancement
744058991,"Print specific component's version when using ""cypress version"" command","Building on top of https://github.com/cypress-io/cypress/issues/9180

Right now `cypress version` prints 4 versions

```text
$ npx cypress version
Cypress package version: 6.0.0
Cypress binary version: 6.0.0
Electron version: 10.1.2
Bundled Node version: 12.16.3
```

To make checking versions in cypress-docker-images easier, it would be nice to be able to specify which version we want to print and print just that (even without newline)

Something like 

```
$ npx cypress version --component package
6.0.0
$ npx cypress version --component binary
6.0.0
$ npx cypress version --component electron
10.1.2
$ npx cypress version --component node
12.16.3
```",enhancement
743164279,Add global before and after hooks (including parallel run via Dashboard),"### What would you like?
Add global ""before"" and ""after"" hooks, which will be executed before all specs and after all specs respectively, including case with a parallel run: each hook should be called once per whole specs run, not for each cypress instance. 

### Why is this needed?
I want to use a third-party service inside cypress tests. This service must be inited with init() command before build start and deinited after last test with deinit() to finalise build, generate report and send status to a GitHub. And now there is no place in Cypress where I can inject this init() and deinit() service functions, especially for a parallel run case.

I can't run it before and after each spec (using your default global hooks), because this service need to know when the last test is finished to send final status to the GitHub. I also can't use some kind of process finish hooks, because I can have 2 or 3 or 10 parallel Cypress processes on a different boxes in my CI. 

Probably, the best solution for this issue is to add **beforeSuite()** and **afterSuite()** cypress hooks, which will be called before and after all specs run. As I know it was already implemented for a non-parallel run in a Cypress v2 [#818](https://github.com/cypress-io/cypress-documentation/issues/818) but was broken in a v3. Also I see that ""run:end"" event was added to a v4 (#2331), but looks it was removed later. Why?

As for parallel run - it can be a little tricky but still possible: Cypress Dashboard managing specs order, so when Dashboard sends first spec to an instance - you can just add ""isFirst:true"" flag to this request. And this flag will fire **beforeSuite()** hook only on one Cypress instance. Same for last spec - Dashboard is also know that current spec is a last in a specs queue, so just send ""isLast:true"" to fire **afterSuite()** hook for a specific instance.

Current non-friendly approach is already caused a lot of pain to the third-party plugins authors ([Happo folks](https://github.com/happo/happo-cypress/pull/4) for example). I also looked into Applitools and Percy plugins - poor guys manage suite state on its own service side! It's totally not cool when we have a Dashboard to manage state, but still need to additionally manage it in other places. Cypress has a great architecture, so you must know that it always better to manage the state in a one place. More user confusion examples: [a recent issue](https://github.com/cypress-io/cypress/issues/5160), [first SO question](https://stackoverflow.com/questions/56006940/executing-a-task-after-all-test-are-launch-cypress), [second](https://stackoverflow.com/questions/60772352/how-to-run-cy-task-after-all-siutes), [third](https://stackoverflow.com/questions/48110258/how-can-i-execute-code-before-all-tests-suite-with-cypress), [fourth](https://stackoverflow.com/questions/54160356/cypress-how-to-run-code-once-before-all-tests-on-tests-start), [fifth...](https://stackoverflow.com/questions/58760050/run-before-all-tests?rq=1#comment103831368_58761723) and [unanswered discussion](https://github.com/cypress-io/cypress/discussions/9191) here.

Probably I missed something and solution without ""you can write your own test runner"" is already exist, but I can't find it :( If I can help somehow (e.g. contribute some code) - I am ready. But it looks that full support is impossible without small Dashboard adjustments. ",enhancement
736246183,Minify css/js in production bundle,"### What would you like?
Minification of JS/CSS when the application is bundled for production.

### Why is this needed?
Decreases overall bundle size and improves parsing time in browsers.

I'll provide a PR.",enhancement
731834300,Ability to obtain a stack trace with relative paths,"### What would you like?

As a preprocessor-maintainer, I would like to have the ability to programmatically obtain a stack trace with relative paths as they appear in the source map, in the test-runtime, similar to the stack traces you show upon uncaught exceptions, as shown below.

![2020-10-28-231548_5120x1440_scrot](https://user-images.githubusercontent.com/730419/97502573-a976ca00-1973-11eb-8f17-aac482507955.png)

As seen in the screenshot, Cypress is successfully able to determine the correct, relative location of the origin of the error.

### Why is this needed?

Let me give a bit of background information to begin with. I'm contributing to `cypress-cucumber-preprocessor`, which is a preprocessor for mimicking Cucumber behavior with Cypress. Cucumber is essentially a mapping between step definitions (regular expressions) and function bodies. If a step in your feature matches more than one definition, then an ambiguity error is thrown, containing the location of the matched definitions. This behavior is specified in their [tests](https://github.com/cucumber/cucumber-js/blob/master/features/ambiguous_step.feature).

I'm trying mimic this behavior. However, if I use eg. `stacktrace-parser` to parse `new Error().stack`, as seen [here](https://github.com/badeball/cypress-cucumber-preprocessor/commit/865bba6), I obviously get useless output, as shown below.

```
Multiple matching step definitions for: foo
 foo - http://localhost:5000/__cypress/tests?p=cypress/integration/foo.feature:6649
 /foo/ - http://localhost:5000/__cypress/tests?p=cypress/integration/foo.feature:6649
```

If I manually import `source-map-support/register`, they get a little better.

```
Multiple matching step definitions for: foo
 foo - http://localhost:5000/__cypress/tests?p=cypress/integration/cypress/integration/step_definitions/foo.ts:3
 /foo/ - http://localhost:5000/__cypress/tests?p=cypress/integration/cypress/integration/step_definitions/foo.ts:5
```

It's not perfect though and this is due to `source-map-support` taking the source origin into consideration, which for `http://localhost:5000/__cypress/tests?p=cypress/integration/foo.feature` is `http://localhost:5000/__cypress/tests?p=cypress/integration`. This source is prefixed to all relative paths in the source maps, making the stack a bit odd.",enhancement
731807578,Expose configuration through module API,"### What would you like?

As a preprocessor-maintainer, I would like to have configuration resolvement exposed through the module API, like shown below.

```js
const cypress = require(""cypress"");

await cypress.resolveConfiguration([""--config"", ""numTestsKeptInMemory=10""], process.env);

/**
 * => {
 *  baseUrl: null,
 *  numTestsKeptInMemory: 10,
 *  integrationFolder: ""cypress/integration"",
 *   
 *   ...
 * 
 * }
 */
```

### Why is this needed?

To make stuff like [this](https://github.com/TheBrainFamily/cypress-cucumber-preprocessor/blob/v4.0.0/cypress-tags.js#L40-L47) more water-tight. We can only attempt to re-implement the resolvement process, but it's obviously always going to be flaky, unrobust and surprising to the end-user.",enhancement
731701793,Cypress Test spec timeout threshold,"<!-- Use the template below to request a feature. Please be patient and we will respond as soon as we can. -->

### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->

I would like a configurable way to specify the maximum amount of time a test spec should take in seconds.

This should be on the spec level since we use batch execution of multiple specs in a suite to optimize for overhead.

eg with:
`defaultSpecTimeout`: 50

Spec 1: 40s -> No Exception 

Spec 2: 54s -> Test Result failed and ""Test has failed due to going over maximum duration threshold""

It is critical these tests still produce results in JUNIT and we continue execution.


### Why is this needed?

We have problems with `Uber` tests being created that test multiple scenarios and edge cases, this is not a bad thing for coverage of the product but it makes test case sharding into multiple phases problematic. It also has a big problem that if the beginning of the test fails then the entire coverage is gone.

Creating a maximum spec threshold would create an upper bound for developers to follow when creating tests.
",enhancement
731422002,Accessibility: Copy to clipboard buttons in Cypress GUI,"### What would you like?
To improve accessibility, it would be great if I could quickly copy the Project Id JSON and the Record Key command (in the desktop GUI under Settings) by simply clicking once. 

### Why is this needed?
This is needed to improve accessibility. This way, it is no longer necessary to manually select and copy the text.

I'll gladly contribute and implement this.
",enhancement
731221103,Shorthand syntax for action commands: cy.click('Login'),"<!-- Use the template below to request a feature. Please be patient and we will respond as soon as we can. -->

### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->
I am inspired by CodeCeption which we use at work. 
In CodeCeption you can use this syntax:
```PHP
// Click on an element with the text ""Login""
$I->click('Login');
// Click on an element with the id ""submit_button""
$I->click('submit_button');
// Fill the field with label ""Username"" with ""Miles""
$I->fillField('Username', 'Miles');
```

A shorthand notation in Cypress could follow the following rule to achieve a similar syntax:  

**If a string is added to an action (click, type, select, ...) as the first argument, this string is read as one of:**
* **the css selector of an element (comparable with `.get()`)**
* **the textual content of an element (comparable with `.contains`)**
* **the textual content of the label `<label for=""elementname"">` of an input element**

**The action will be performed on the found element**

This way test code like this:

```javascript
cy.get('#username').type('John');
cy.get('#password').type('MySuperSecret');
cy.contains('label', 'Remember me').find('input[type=""checkbox""]').check();
cy.contains('Login').click();
```
Can be written like this:

```javascript
cy.type('Username:', 'John');
cy.type('Password', 'MySuperSecret');
cy.check('Remember me');
cy.click('Login');
```

### Why is this needed?
<!-- Remember, we are not familiar with the application you are testing, so please provide a clear description of why this would be useful to your project. -->
It would make tests more readable.
",enhancement
730842032,Single video file recording,"#8044 
# What would you like?
Possibility to record a single video file. 

### Why is this needed?
Other frameworks like testcafe support this option where you can tell the test runner itself to be able to record a single file or a file per spec, or even only on fail. 
https://devexpress.github.io/testcafe/documentation/guides/advanced-guides/screenshots-and-videos.html#basic-video-options
",enhancement
730374355,Feature Request: Dropdown in cypress to easily change enviroments,"### What would you like?
I would like to have a feature in which I can quickly change between Enviroments (e.g dev and e2e).
A way to achive this would be to add a dropdown (near the browser dropdown) to choose between configurable envs (and maybe set a default env).
You can configure your envs inside cypress.json (maybe make baseUrl an Object like: `baseUrl:{ dev: ""www.dev.site.com"", local: ""localhost:8080"", e2e: www.e2e.site.com""}`

![featurereq](https://user-images.githubusercontent.com/12174661/97296901-97046f80-1851-11eb-8047-9434589ecc2f.PNG)



### Why is this needed?
To change between enviroments I have to change the baseUrl in the cypress.json which is cumbersome and not very user friendly.",enhancement
730221509,Allow to specify Minimatch options,"### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->
Cypress automatically includes minimatch and exposes it as Cypress.minimatch.
However I am not able to choose options of minimatch https://github.com/isaacs/minimatch/tree/master#options as they are hardcoded:
```
MINIMATCH_OPTIONS = { dot: true, matchBase: true }
```
### Why is this needed?
I want to be able to set globally, within spec file or on individual  `cy.route()` command `minimatch.options {}`  
In particular I wish to specify nocase https://github.com/isaacs/minimatch/tree/master#nocase for glob matches.
However I think that other minimatch options will be useful as well
",enhancement
729980369,Yield context to test functions,"### What would you like?

Yield context as the first argument to a test function, much like `this` is bound to non-arrow functions `function() {}`.

e.g.

```js
it(""uses this to get aliases"", function() {
  console.log(this.myAlias);
});

it(""uses context argument to get aliases"", context => {
  // context is the same thing that would have been bound
  // to `this` if the test body was not an arrow function.
  console.log(context.myAlias); 
});
```

### Why is this needed?

Currently the only way to get the value of aliases is to use:

1. a `function() {}` style test body and use `this.myAlias`. Many people prefer not to use `this` and/or `function` syntax as they find it less descriptive.
2. `cy.get(""@myAlias"")`, which has the potential to introduce a lot of nesting tests with a lot of aliases.

I believe part of this issue (related to aliases, but not to selectors) covers these concerns: https://github.com/cypress-io/cypress/issues/1417

Given that nothing appears(?) to be passed as an argument to test functions now, I think this should be fully backwards compatible.",enhancement
726583449,Add option to disable browser cookies in `cy.request`.,"<!-- Use the template below to request a feature. Please be patient and we will respond as soon as we can. -->

### What would you like?
<!-- A clear description of the feature or enhancement wanted in Cypress -->

[`cy.request` automatically sends and sets browser cookies](https://docs.cypress.io/api/commands/request.html#Cookies-are-automatically-sent-and-received). I'm proposing to add an option to disable this behaviour.

### Why is this needed?
<!-- Remember, we are not familiar with the application you are testing, so please provide a clear description of why this would be useful to your project. -->

After running some actions via the UI, I would like to make an API request to the same domain as the tests are running on. However, I would like to make this API request as an external user, therefore I would not like to send and set browser cookies.",enhancement
726465366,Support to detect touch supported devices,"<!-- Use the template below to request a feature. Please be patient and we will respond as soon as we can. -->

### What would you like?
Can we add support for [pointer](https://developer.mozilla.org/en-US/docs/Web/CSS/@media/pointer) media queries

### Why is this needed?
I am using [window.matchMedia](https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia) to detect devices with a coarse primary pointer and then perform some action if it returns true. I tried using `cy.viewport()` but it does not simulate a touch supported device
",enhancement
726104131,Webpack 5 support,"<!-- Use the template below to request a feature. Please be patient and we will respond as soon as we can. -->

### What would you like?
Webpack 5 is released 2 weeks ago. https://webpack.js.org/blog/2020-10-10-webpack-5-release/, does Cypress has any plan upgrade its webpack preprocessor to support webpack 5?

### Why is this needed?
Most of the open-source projects are moving towards webpack 5. For a project that already using webpack 5 it will be great to have it work out of the box.
",enhancement
721198482,Code coverage instrumentation with cy.intercept(),"It's mentioned in [this official webcast](https://youtu.be/C8g5X4vCZJA) that automated code coverage instrumentation would be enabled by full network request stubbing or `cy.route2()` (#687). There is, however, no documentation or examples for this, and no discussion that I could find, so it'd be helpful to either have docs or a confirmation that this feature is planned or dropped.",enhancement
720084520,Save console output to file,"Hey there,

First off, your product is amazing and something I dreamt of for more than 10 years. Having said that, the stated in the subject is a must.

I have a test that fails only in ci and passes when I run the same config locally, and the only way to get insight into what's going on is to take a look at my app's logs and exceptions in the console.

I know this has been raised in the past here https://github.com/cypress-io/cypress/issues/300 and here https://github.com/cypress-io/cypress/issues/448 already 3 years ago, but no resolution as of yet.

I'm going to implement it myself by intercepting the console and send the logs to a cypress node task which saves the logs to a file, but this, for me, has to become part of the core.

Best,
Ronen",enhancement
717580288,Feature Request: Ability to stop and/or restart paused runs via the GUI,"### Current behavior
You can resume paused runs but you can't stop them or restart them from the GUI.

### Desired behavior
- Make the stop button visible to stop a paused run. 
- Make the restart button visible to restart a paused run. This would be useful if you are testing the reliability of a particular code block like what you see below. I want to run this code a few times and make sure it's behaving as expected. Having a restart button will avoid having to write temporary test (loop) code and/or spoofing code changes to trigger restarts.

```js
Cypress.Commands.add('MyCommand', (myvar1= 'value1' ) => {
    cy.visit('/')
    cy.get('#myelem1').should('have.value', 'mydomain.com')
    cy.get('#myelem1').select(environment)
    cy.pause()
    cy.get('#myelem2').select('abv')
```
Mockup UI:
![image](https://user-images.githubusercontent.com/71399342/95500075-20173d80-095b-11eb-94a0-39cc36e33da5.png)

Ideal Workflow:
0. Have cypress GUI open and running normally.
1. Add pause to code
2. Wait for initial auto-execution to reach pause
3. Click restart and repeat steps 1-3 as needed.

This feature request will be even more useful when we can restart individual tests.

### Versions
Cypress package version: 5.3.0
Cypress binary version: 5.3.0
",enhancement
716840901,Feature request: Trash screenshots folder before running tests via UI (cypress open),"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior
1. Add cy.screenshot() to your test case
2. npx cypress open
3. Press the button to run your test. Repeat.
4. Your screenshot folder will have multiple screenshots

### Desired behavior
1. Have a config to allow you to trash the screenshots folder before tests are run. There is a config value that does work with npx cypress run but not when running tests with cypress open

### Test code to reproduce
See above

### Versions
cypress@5.3.0
",enhancement
712924114,Feature Request cy.all to work with multiple commands in parallel,"### Summary
Sometimes you want to work with multiple cypress commands but want to wait for all comands to finish before proceeding with another task

### Current behavior
currently you have to chain these commands and pass the fetched data from promiselike to promiselike.

```js
cy.fixture('filea.json').then((fileAContents) => {
  cy.fixture('fileb.json').then((fileBContents => {
    ....
    cy.request... with fileAContents, fileBContents, fileCContents ...
  }
}
```

### Desired behavior
like Bluebirds props method or my favorite 
```js
import { zipObject } from 'lodash'

export async function makePromiseFromObject(obj: { [key: string]: Promise<any> }) {
  return zipObject(Object.keys(obj), await Promise.all(Object.values(obj)))
}
```

we could aggregate all comand responses into one object with cy.all
```js
cy.all({
  fileAContents: cy.fixture('filea.json'),
  fileBContents: cy.fixture('fileb.json'),
  ...
).then(props => cy.request( with ...props))
```

Relates to: https://github.com/cypress-io/cypress/issues/915",enhancement
707989123,Manage specs groups in cypress.json,"### Feature Request
Allow to group specs in the cypress.json file


### Versions
Cypress 5.2.0

### Feature
It would be very helpful to allow arrange/categorize specs in groups in the cypress.json file.
I know it is possible to use package selectors to select test group, but not always it is possible to arrange related specs in the same package.
Sometimes there are other criteria to group tests, for example, you would like to group tests by test run duration, 
so you can split tests in more efficient way for parallel run, or any other logic.

So, instead (or additionally) of providing array in `'testFiles'` we should accept an object:

```js
""testFiles"": {
		group1: [
			""test1"",
			""test8"",
			""test3"", ],
		group2: [
			""test2"",
			""test9"",
			""test6"",],
		group3: [
			""test1"",
			""test4"",
			""test5"",]
	}
```

Then, we can run: `cypress run --record --group group2`

Once this implemented, it will be nice to have the tests in the 'cypress open' arranged in a tree view, so at development time we can select specific group.

",enhancement
705627114,Request for a native API recording feature for Cypress,"### Current behavior:

I am currently using the following package to record API requests from our app, so they can be played back offline during test runs using Cypress:

https://github.com/scottschafer/cypressautomocker

The author has expressed that he does not plan to maintain this project going forward, although this is a very valuable package for us. It allows us to run our testing scripts while the API responses get recorded from our backend. Once they are recorded, we can run the tests while disconnected to our backend altogether, making it easier to run our scripts in CI/CD.

### Desired behavior:

It would be nice to have similar functionality natively within the Cypress testing framework.

### Test code to reproduce

Please refer to the package to see how it works.

### Versions

I am using ""cypress"": ""4.8.0""",enhancement
704335242,Support for testing Picture-in-picture ,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

- Implement a feature in the project where `requestPictureInPicture` is called
  - E.g. this sample https://googlechrome.github.io/samples/picture-in-picture/
- Write a Cypress test to run `cy.get('.the-toggle-button').click()`
- In the test, include `cy.document().its('pictureInPictureElement').should('not.equal', null)`
- Run the Cypress test
- The `should` assertion fails and the following error shows in the console:

```
DOMException: Failed to execute 'requestPictureInPicture' on 'HTMLVideoElement': Must be 
handling a user gesture if there isn't already an element in Picture-in-Picture.
```

### Desired behavior:

- `cy.document().its('pictureInPictureElement').should('not.equal', null)` passes
- No error is shown in the console

### Test code to reproduce

I may edit this issue soon to give full reproduction assets, but for now, I know it's as simple as:

- Visit https://googlechrome.github.io/samples/picture-in-picture/ or an equivalent webapp
- Run `cy.get('.the-toggle-button').click()`
- Run `cy.document().its('pictureInPictureElement').should('not.equal', null)`

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

### Versions

<!-- Cypress, operating system, browser -->

Cypress: 4.4.0
(Cypress) browser: Chrome 85
Operating system: Ubuntu 18.04.5 `x86_64`
Node: 10.15.3",enhancement
702776508,Hooks should either allow config browser options or error nicely,"Cypress v5.1.0

After using `context('no firefox', {browser: '!firefox'}, () => {...})` I noticed that my `beforeEach` hook also has logic for browser filter

```js
beforeEach(() => {
  cy.task('clearDownloads')

  // The next command allow downloads in Electron, Chrome, and Edge
  // without any users popups or file save dialogs.
  if (Cypress.browser.name !== 'firefox') {
    // since this call returns a promise, must tell Cypress to wait
    // for it to be resolved
    cy.wrap(
      Cypress.automation('remote:debugger:protocol',
        {
          command: 'Page.setDownloadBehavior',
          params: { behavior: 'allow', downloadPath: downloadsFolder },
        }),
      { log: false }
    )
  }
})
```

So I foolishly thought: maybe hooks too allow filtering by browser, so I tried this

```js
beforeEach(() => {
  cy.task('clearDownloads')
})

beforeEach({ browser: '!firefox' }, () => {
  cy.wrap(
    Cypress.automation('remote:debugger:protocol',
      {
        command: 'Page.setDownloadBehavior',
        params: { behavior: 'allow', downloadPath: downloadsFolder },
      }),
    { log: false }
  )
})
```

and it tried to run in Firefox

<img width=""619"" alt=""Screen Shot 2020-09-16 at 9 39 46 AM"" src=""https://user-images.githubusercontent.com/2212006/93345235-8f888a00-f800-11ea-890a-de9076fc012f.png"">

## What I think should happen

1. It would be nice if hooks allowed filtering by browser just like suites and tests

or

2. when trying to call `beforeEach(object, hook)` it did NOT run and instead threw a nice message",enhancement
700516298,expand all/collapse all button for tests in Command Log,"### Desired behavior:
expand all/collapse all buttons

### Versions
Cypres:5.1.0

In the test runner window toolbar, it would be very helpful to add expand all/collapse all buttons:

![image](https://user-images.githubusercontent.com/47978855/93012782-966a8f00-f5ab-11ea-9351-5c4dbd75ec0d.png)



",enhancement
699966952,Add option to cy.intercept() to match request body,"I was trying to `cy.wait()` some specific GraphQL requests that were made using `fetch` and using `cy.route2()` but I don't see an option to add a matcher for the request body. [According to the type definition there's not `body` param](https://github.com/cypress-io/cypress/blob/master/packages/net-stubbing/lib/external-types.ts#L126-L167)

The closest thing is `query` but it doesn't consider the request body. Is this by design or there are plans to add it?

### Current behavior:
All GraphQL queries go to the same endpoint ""server.com/graphql"" using the `POST` method. The query itself is sent in the request payload and it's a JSON-like string as follows:

```gql
{
  ""query"": ""query ($limit: Int) {
    searchShippingTemplate(limit: $limit) {
      shippingTemplates {
        id
      }
    }
  }"",
  ""variables"": {
    ""limit"": 25
  }
}
```

My plan was add a match for  `searchShippingTemplate` like:

```js
cy.route2({
  url: ""http://localhost:3000/graphql"",
  method: ""POST"",
  body: ""*searchShippingTemplate*"",
}).as(""getQuery"");
```

But there's no way to do that.

### Desired behavior:
Add `body` option to `RouteMatcherOptions` in order to match a string in the request body.

It would be even better to be able to pass a function (for debugging purposes) since there's no easy way to know what exactly is `.route2()` making the comparison against for each `RouteMatcherOptions` option. 

```js
cy.route2({
  url: ""http://localhost:3000/graphql"",
  method: ""POST"",
  body: (bodyString) => {
    console.log(bodyString); // In theory we could even mutate the request
    return bodyString;
  },
}).as(""getQuery"");

```

### Test code to reproduce
This is not a bug and more like a feature request. 

### Versions
```
""cypress"": ""^5.1.0""
```

",enhancement
697488565,cy.intercept() logs do not display as expected,"```javascript
describe(""Test mocking of api requests using route2"", () => {
    it(""Launch Website and mock meta.json api using route2"", () => {
        cy.fixture(""meta.json"").as(""meta.json.mock.response"");
        // cy.route2(""GET"",""**/meta.json"",""@meta.json.mock.response"");
        cy.route2(
            ""GET"",
            ""**/meta.json"",
            `{
            ""loggedIn"": true,
            ""displayName"": ""vivek"",
            ""clubActive"": false,
            ""flybuysLinked"": false,
            ""cartItemCount"": ""100"",
            ""wishlistItemCount"": 1,
            ""messageCount"": 0
        }`
        );
        homePage.navigateToUrl(""https://www.catch.com.au/"");
        //WHEN PAGE IS LOADED THE CART COUNT SHOULD BE = 100
    });
});
```

So couple of issues here:
1) When I supply the mock json file using alias, the mocking of ""/meta.json"" doesn't happen. However when I supply the whole response body it works.
2) As can be seen in the attached image, when the mocking happens by supplying the response explicitly, the time travel doesn't indicate it as a (xhr stub)

![](https://user-images.githubusercontent.com/20886136/92688426-a5b9c480-f380-11ea-9530-4304457124e3.PNG)
});

",enhancement
696834299,Add API for cy.intercept() to only reply to the first N requests,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
To change the response for a route over time, currently, the user must implement counting themselves:

```js
      let k = 0;
      cy.intercept('/favorite-fruits', (req) => {
        k += 1
        switch (k) {
          case 1:
            return req.reply(['apples 🍎'])
          case 2:
            return req.reply(['grapes 🍇'])
          case 3:
            return req.reply(['kiwi 🥝'])
          default:
            return
        }
      })
```

### Desired behavior:
There is an API for the user to specify the number of times to use a route's handler. Something like this:

```js
cy.intercept({ url: '/favorite-fruits', times: 1 }, ['apples 🍎'])
cy.intercept({ url: '/favorite-fruits', times: 1 }, ['grapes 🍇'])
cy.intercept({ url: '/favorite-fruits', times: 1 }, ['kiwi 🥝'])
```

",enhancement
688089981,Feature: Add global config option for including shadow DOM in commands,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

Currently, to enable shadow dom support, it's necessary to pass `includeShadowDom` into a command that supports it every time it's used.

```javascript
cy.get('.in-shadow-dom', { includeShadowDom: true })
cy.get('.shadow-root').find('.in-shadow-dom', { includeShadowDom: true })
```

### Desired behavior:

Enable configuring shadow dom inclusion globally, per-suite, per-test, or programmatically. Still need to decide on a name for it.

_cypress.json_

Turns on inclusion behavior for all tests

```json
{
  ""includeShadowDom"": true
}
```

_Per Suite_

Turns on inclusion behavior for all tests and commands within the suite

```javascript
describe('shadow dom tests', { includeShadowDom: true }, () => {
  it(...)
  it(...)
})
```

_Per Test_

Turns on inclusion behavior for all commands within the test

```javascript
it('shadow dom tests', { includeShadowDom: true }, () => {
  cy.get(...)
  cy.get(...).find(...)
})
```

_Programmatically_

Turns on inclusion behavior conditionally based on where it's used (before, beforeEach, etc)

```javascript
before(() => {
  Cypress.config('includeShadowDom', true)
})
```
",enhancement
686164283,No retry attempts are logged in stdout when setting different reporter other than `spec`,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

`cypress run` doesn't output retries logging in the terminal when using reporters other than `spec`.
<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

### Desired behavior:
Having `cypress run` to always output retries logging in the terminal (at least be able to enable it).

[This was possible in the cypress retries plugin with this](https://www.npmjs.com/package/cypress-plugin-retries#optional-installation):
```js
module.exports = (on, config) => {
  require('cypress-plugin-retries/lib/plugin')(on)
}
```

<!-- A clear description of what you want to happen -->

### Test code to reproduce
run a failing test with any mocha reporter except `spec`
e.g `cypress run --reporter list`

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

### Versions
Cypress 5.0.0
<!-- Cypress, operating system, browser -->
",enhancement
685547483,expose current retry attempt with test / hook to programatically handle retries,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

Prior to v5.0.0 and using `cypress-retries-plugin` the retry attempt could be programmatically obtained through `Cypress.currentTest.currentRetry()`

Have tried using Mocha's `this.test._currentRetry` but this is only usable within the tests (.it) and not the hooks where much of our test setup resides. 

Interestingly keeping the plugin installed as a dependency seems to be working, although not sure what other consequences this might cause. 

### Desired behavior:

The same feature being made available natively through Cypress. Would be great to be made available on the Cypress global as before. 

### Test code to reproduce

Previous usage documented [here](https://github.com/Bkucera/cypress-plugin-retries/issues/32).

### Versions

Cypress v5.0.0
",enhancement
683387592,Add an easy way (on the final report with all the specs) to see the retries tests. ,"### Current behavior:
On the new release 5.0 the retries functionality was added and it works really great. I would love an easy way to see how many tests needed a retry (not the number of retries I have set but the current test failures that needed a retry) on the final report. The only way I have it now is to look on the logs for the screenshots (or have a look on the report folder) and see how many screenshots were done to know exactly the number of tests that failed on the first attempt. 

### Desired behavior:
It will be great to add an extra column or just a note at the end with the tests failed that needed retries. 

### Test code to reproduce
Any project with the new version applied and the retries functionality active on the run mode. 

### Versions
5.0

",enhancement
680355190,"Add `session` API for snapshotting/restoring session related data (cookies, localStorage, sessionStorage)","## Summary

We would like to implement solutions for authentication and switching between user sessions.

To accomplish those objectives, we need to save checkpoints that represent the browser’s state at the end of some steps the user has performed. After saving the state we will be able to go back and forth between points in time.

For the time being we will call this a **Session**, though the name is up for debate.

---

Currently, if your tests rely on having set session related data (e.g. cookies, localStorage, sessionStorage), you have two choices:

- ""build up"" session data through UI interactions (similar to Page Object Pattern). For multiple tests that use the same session data, this leads to either slower tests (steps done in `beforeEach` every test) or leads to tests that can't run in isolation (requiring previous tests to build up state).
- use `cy.request`/`cy.setCookie` to programmatically set session data. For multiple tests, this reduces execution time drastically compared to Page Object Pattern. However this requires more knowledge about your app's auth to setup, can potentially be a maintenance burden, and covers less your app.

`cy.session` is meant to merge the simplicity of Page-Object-Pattern to the execution speed of programmatic auth. With `cy.session`, you'll be able to perform UI interactions before taking a ""snapshot"" of all the session related data and ""restore"" it before each test. 


## Proposal

### Defining a Session 
Sessions should be defined at the root level of your Cypress project, within `cypress/sessions.js`. A best practice is to define all of your sessions here instead of in individual spec files.

### Defining a Single Session

The proposed API for defining a single Session looks like this:

```ts
export const admin = cy.defineSession({
  name: 'admin',
  steps() {
    cy.get('#username').type('my-username')
    cy.get('#password').type('my-password')
    cy.get('#login').click()
  },
})
```

### Defining Multiple Sessions

Some alternate syntaxes utilize a `Cypress.defineSessions()` method to add many sessions at once. The keys in this object are the session names, and the value can either be a function or a Session Object.

```ts
// The keys in this map to session names
// The values may either be Session object or a Steps function
export const sessions = cy.defineSessions({
  admin() {
    cy.get('#username').type('admin-username')
    cy.get('#password').type('admin-password')
    cy.get('#login').click()
  },
  regularUser: {
    steps() {
      cy.get('#username').type('basic-username')
      cy.get('#password').type('basic-password')
      cy.get('#login').click()
    }
  }
}
```

### Assuming a Session

Assuming a session will be done in either a `beforeEach` or within a block (`it`/`describe`), so that each test starts from a single session, or programmatically whenever a user wants.

There are two ways to assume a session. One takes advantage of per-test configuration and the other is a method on the `cy` object. The API design goal is for sessions to be real Type-able objects that can be used. We will still support string-lookup of sessions by name, but using real JavaScript objects is preferred.

### Programmatic API

By reference

```ts
import { admin } from './sessions'

// Switch between sessions programmatically using the Session's object
cy.useSession(admin)

// Remove previous state, rebuild and then use the session
cy.useSession(admin, { fresh: true })
```

By string
```ts
// Switch between sessions programmatically using Session.name
cy.useSession('admin')
```
Per-test configuration
By reference

```ts
import { admin } from './sessions'
describe('As an administrator', { session: admin }, () => {
  /* ... */
})
By string
describe('As an administrator', { session: 'admin' }, () => {
  /* ... */
})
```
### Retrying Corrupt Sessions

When assuming a session throws an error, it is considered corrupt. Sessions may be corrupt for a number of reasons: Bugs in the Steps logic, corrupt state from previous tests, invalid login tokens, or general flake.

If this happens, the session’s internal state will be invalidated, and it will be rebuilt from scratch. After this, the test run will proceed as normal.

### Composition with Sessions

Because sessions are simply a set of steps and a starting state, it is possible to compose with them by reusing `cy.useSession`

To create a new user with many cart items, you’d do

```ts
const seedDb = () => cy.task('create:user')

// prefer by-function steps because adding onto
// state will possibly pollute any backends
const loginSteps = () => { /* login steps */ }
export const newUser = cy.defineSession({
  steps() {
    //  seedDb()
    /* signup */
    loginSteps
  },
  before() { seedDb() } // always exec
})

export const userWithItems = cy.defineSession({
  steps() {
    loginSteps()
    // add an item to the cart, etc
  } 
})
```

Or to create a user who opts out of tracking before signing up, you’d do: 
	
```ts
export const privacyConsciousUser = cy.defineSession({
  steps() {
    // opt out of setting cookies
    // This assumes the backend or cookies would persist this info
    // window state is NOT stored with the session.
    cy.window()
      .then((win) => win.optOut = true)

    cy.useSession(newUser)
  }
})
```

The combined state at the end of the steps function is stored as that Session’s state




",enhancement
680136170,Add configuration option to disable/enable multiple commands logging,"This issue relates to the #3087

### Current behavior:

I have many commands that are not desired to be logged: setting states, clearing fields, etc. Mostly it relates to the negative cases when I do smth repeatable. For example,  iterate through the array with invalid characters and type them into the input field: 

```js
cy.get('@fullname').then(input => {
  credentials.invalid.fullname.IncorrectSymbolsArray.forEach((incorrectSymbol) => {
    cy.wrap(input, { log: false }).clear({ log: false }).type(`${credentials.valid.fullname.default}${incorrectSymbol}`)
  });
}).clear({ log: false })
```
_(some assertions will be added)_

In this case, if logging is not turned off, the left side log looks very ""crowded"".  I need information only about characters that are typed.

So, about 70% of commands have `{log: false}` option in my tests. It takes time to add this option and code looks not so pretty.
<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

### Desired behavior:

I have a proposition:

1. Provide a global logging setting in the configuration file. By default, it should be true.
2. Provide `{log: }` option for `context()` and `it().`
3. Priority order: command() > it() > context() > global configuration

So, then users have the ability to enable/disable logging in different scopes.

<!-- A clear description of what you want to happen -->

### Versions
 4.12.1
<!-- Cypress, operating system, browser -->
",enhancement
675062079,Take into account the search pattern when running all specs in the interactive mode (RegEx),"### Current behavior:

Currently the search pattern does not allow the use of Regular Expressions.

### Desired behavior:

Since I have spec files created for individual brand tests in separate files within separate folders it would be very useful to be able to filter using a regular expression (using the folder separator and maybe include a dropdown to specify .spec.ts, .spec.js, etc.) so I can include the folder(s) and/or sub folder(s) that the spec files exist in.

### Test code to reproduce

Simply include a regular expression in the search pattern (include a back slack or forward slash or asterisks).

### Versions

4.12.1
",enhancement
666911791,Detect and capture env vars from AWS CodeBuild including ciBuildId,"The documentation lists CodeBuild under ""CI environment variables"" in this list here:

https://github.com/cypress-io/cypress-documentation/blame/develop/source/guides/guides/parallelization.md#L246

Which was recently changed in the last month. However, when running cypress with the `--parallel` flag in this environment cypress (`4.11`) puts out this error:

```
962 | You passed the --group or --parallel flag but we could not automatically determine or generate a ciBuildId.
963 |  
964 | The --group flag you passed was: admin
965 | The --parallel flag you passed was: true
966 |  
967 | In order to use either of these features a ciBuildId must be determined.
968 |  
969 | The ciBuildId is automatically detected if you are running Cypress in any of the these CI providers:
970 |  
971 | - appveyor
972 | - azure
973 | - bamboo
974 | - bitbucket
975 | - buildkite
976 | - circle
977 | - codeshipBasic
978 | - codeshipPro
979 | - concourse
980 | - drone
981 | - githubActions
982 | - gitlab
983 | - goCD
984 | - googleCloud
985 | - jenkins
986 | - semaphore
987 | - shippable
988 | - teamfoundation
989 | - travis
990 | - netlify
991 |  
992 | Because the ciBuildId could not be auto-detected you must pass the --ci-build-id flag manually.
```

And in the cypress code it does not list `CodeBuild`:

https://github.com/cypress-io/cypress/blob/4054e72c3bc1ecfb5308156b5c782077d96358dc/packages/server/lib/util/ci_provider.js#L82-L105

I am confused why this documentation has been changed like this when it does not appear to be a supported CI provider?

",enhancement
664393970,fx/fixture shortcut does not call overwritten cy.fixture command,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->
For optimal usability it would be great if fx:/fixture: shortcuts would use overwritten fixture command.

### Current behavior:

```ts
Cypress.Commands.overwrite('fixture', (originalFn, path) => {
	console.log('load fixture '+path)
	return originalFn(path)
})
// logs 'load fixture fixture1'
cy.fixture('fixture1').then(fixture=>{
	cy.route('POST','api/users/authenticate',fixture).as('authRequest')
})
// logs nothing
cy.route('POST','api/users/authenticate','fixture:fixture2').as('authRequest')

```
<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

### Desired behavior:

This should log 'load fixture fixture2':

```ts
cy.route('POST','api/users/authenticate','fixture:fixture2').as('authRequest')
```
I'm not familiar with the Cypress source code yet so I'm not sure how complex this would be to fix.
However for intuitive use of command overwriting it would make sense if the shortcut calls cy.fixture to support overwriting.

### Versions

Cypress 4.10
",enhancement
663981260,Feature Request: Run recently-failed tests at the beginning in cicd,"Feature Request

### Current behavior:

In cicd, tests are run in a random order, with new tests run first instead of at random. 

### Desired behavior:

Run recently-failing tests first, after new tests. 

Why? Sometimes we have test failures that occur in cicd, but not locally, due to race conditions. It would be nice to run these as quickly as possible to see if changes succeed in fixing those race conditions. 

### Test code to reproduce

This ticket does not require reproduction. It is not a bug. 

### Versions

4.11.0
",enhancement
662619049,Do not pin CLI dependencies,"### Current behavior:
Currently, Cypress pins all dependencies. Previously we had preferred locking dependencies since we ran into issues before without locking, but since migrating to `yarn` for our own dev work, I've been told these concerns are more minimal.

```json
""lodash"": ""4.17.19""
```

**This introduces some issues:**

1. If there is a security vulnerability from a dep of Cypress found (highlighted through `npm audit`), our users are unable to run `npm audit fix` to bump the dependency themselves. This requires the user to use a convoluted workaround or for Cypress to release a new version - pushing a hotfix or waiting potentially 2 weeks for the scheduled release. 

    Many of our users have rules around their builds/dev process not allowing them to move forward if `npm audit` fails, so this presents an issue for them. ```**See previous issues:**``````* lodash security vulnerability: https://github.com/cypress-io/cypress/issues/7921* minimist security vulnerability: https://github.com/cypress-io/cypress/issues/6793* another lodash security vulnerability: https://github.com/cypress-io/cypress/issues/4743```

1. Our pinning strategy and how we run yarn + npm when building the binary is contributing to an increase in size of the binary. Sometimes there are dupped dependencies included. 

```

**See previous issues:**

```

```

* Fix lodash dup dep: https://github.com/cypress-io/cypress/pull/7954
* Built zip size keeps increasing: https://github.com/cypress-io/cypress/issues/5977 

    ### Desired behavior:
    Have looser restrictions on dependencies of Cypress, while using the correct dependencies to also build the binary.
    
    ```json
    ""lodash"": ""^4.17.19""* Renovate should be able to handle the enforcement of our range strategy mostly: https://docs.renovatebot.com/configuration-options/#rangestrategy* Look into how `npm` is run to build the binary.### Versions4.10.0",enhancement
656003057,Deno support,"We are in the process of switching to Deno from Node over the next 3 months.

We would like to bring Cypress also over to Deno. Is this something you could support?

Denoify could help in the effort.",enhancement
655278392,"Add ""overwrite"" Option to cy.screenshot()",`cy.screenshot()` should add an option `overwrite` to overwrite existing screenshots.,enhancement
654558153,Expose and document Chrome DevTools Protocol,"### Current behavior:

Currently there is no documented way to access the Chrome DevTools Protocol. 

This actually *is* possible today, although it's undocumented using the method below. 

```js
Cypress.automation(""remote:debugger:protocol"", {

})
```

### Desired behavior:

People have requested that they'd like direct access to the Chrome DevTools Protocol. Would want this documented so people could use it. Some examples of usage are below:

- Passing locale: https://github.com/cypress-io/cypress/issues/7890#issuecomment-655174901
- SessionId request: https://github.com/cypress-io/cypress/issues/7256
- Emulating offline mode: https://github.com/cypress-io/cypress/issues/235#issuecomment-608367340

This feature needs to support:

- Issuing commands
- Receiving events

Additionally, there's no cross-browser support to this, so that's a challenge.

### Versions

4.10.0
",enhancement
654416558,Allow custom metadata to enable integration with test management system?,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
No way to add custom metadata to test cases/files that allows users to further process the test results.
An example would be tagging test case with ticket number in a test management tool so later user can sync test result under the test ticket.
<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

### Desired behavior:
Some sort of tagging system that can be carried to test execution result reporting file(s)
<!-- A clear description of what you want to happen -->

### Test code to reproduce

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

### Versions

<!-- Cypress, operating system, browser -->
",enhancement
653991730,Angular Component Harness (Test Harness) support in Cypress,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
Cypress based e2e test cases  are not supporting angular [Component Harness](https://material.angular.io/cdk/test-harnesses/overview) (Test Harness).

### Desired behavior:

Cypress e2e tests shall be able to utilize angular component(test) harness. **_CypressElement_** and **_CypressHarnessEnvironment_** shall be available similar to [ProtractorElement](https://github.com/angular/components/blob/master/src/cdk/testing/protractor/protractor-element.ts) and [ProtractorHarnessEnvironment](https://github.com/angular/components/blob/master/src/cdk/testing/protractor/protractor-harness-environment.ts).

### Test code to reproduce
After **_CypressElement_** and **_CypressHarnessEnvironment_** is available, the user shall be able to use harness test cases in cypress e2e like:

```javascript
 it('should get button label from button harness', async () => {
    harnessLoader = CypressHarnessEnvironment.loader();
    const ButtonHarness = harnessLoader.getHarness(ButtonTestHarness);
    (await ButtonHarness).ButtonLabel().then(async (value) => {
      expect(value).toEqual('label');
    });
  });
```
### Why we need this feature
Currently, our e2e test cases are using Cypress. In order to use test harness APIs provided by UI library in our e2e, we need support from cypress.



Please let me know if there is any plan to support angular test harness.

#### Note: This is a feature request",enhancement
651491741,Accept locale as configuration,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

First of all: thank you for your work on Cypress 🙏. It's awesome and such a pleasure to use!

---

### Current behavior:

I have no unified, platform-independent way of controlling the browser locale. Setting it is specific to the browser and platform and thus error prone.

<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

### Desired behavior:

My goal is to get a predictable output of `new Intl.DateTimeFormat().resolvedOptions()`. I'm on macOS and I haven't found a way to set the browser locale in Chrome. It always resolves to `locale: ""en-GB""` but it should resolve to `en-US`. I tried setting the `LANGUAGE`, `LANG`, `LC_ALL` environment variables but it seems like they are ignored or overwritten. I also tried the `--lang` argument but that doesn't work as well (I read that it's only supported on Windows).

I also tried setting

- `launchOptions.preferences.default[""settings.language.preferred_languages""]`
- `launchOptions.preferences.default[""intl.initial_locale""]`
- `launchOptions.preferences.localState[""variations_safe_seed_locale""]`

during `'before:browser:launch'` but with no luck.

To be honest, I didn't even get Chrome to start from the command line with the correct locale. I tried it with this command:

`LANGUAGE=en-US LANG=en-US LC_ALL=en-US ./""Google Chrome"" --user-data-dir=""~/temp"" --lang=""en""`

So this is probably also kind of a Chrome issue.

I saw that Cypress is using a dedicated user profile located in `~/Library/Application Support/Cypress/cy/production/browsers/chrome-stable/interactive/Default`. Maybe it needs to be set somewhere there...

In this issue I'm asking for two things:

- In case you know a way how to set the Chrome locale or even in case you know that this is still an unsolved issue, could you please document this in this issue? I think this could be a common problem since a lot of web developers are on macOS.

- It would be nice if Cypress offered an easy, cross-platform configuration for setting the browser locale. There is a [similar request for the timezone](https://github.com/cypress-io/cypress/issues/1043) and I think this is quite common: you want to control the locale *and* the timezone your tests are executed with. (Btw: setting the `TZ` env variable works fine).

<!-- A clear description of what you want to happen -->

### Test code to reproduce

- https://github.com/jhnns/cypress-test-tiny/tree/locale-issue

### Versions

<!-- Cypress, operating system, browser -->
- cypress@4.9.0
- macOS@10.15.5
- Chrome 83.0.4103.116 (Official Build) (64-bit)
",enhancement
647778543,Improve focus UI and keyboard navigation in reporter,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
Currently, the `focus` state when navigating and toggling the sidebar is fairly ugly and could be improved to be more similar to the `hover` state.

This is what it looks like now:
![ezgif-6-03b3bf64ebbb](https://user-images.githubusercontent.com/7033952/86072243-268a4500-ba4f-11ea-9f72-87d8c62aab68.gif)

Keyboard controls:
| Key | Action |
| --- | --- |
| tab | move down |
| shift + tab | move up |
| enter | open / close |
| space | open / close |

### Similar behavior in other software:
**Webstorm**

![ezgif-6-dcce8aaf609d](https://user-images.githubusercontent.com/7033952/86072251-2ab66280-ba4f-11ea-9dd8-c025450a6ecd.gif)

A click on the arrow will toggle open/closed, and a double click on the name or to the right of the name will open/close and shift focus.

Keyboard controls:
| Key | Action |
| --- | --- |
| down | move down |
| up | move up |
| left | close |
| right | open (move down if already open) |
| enter | open / close |

**VS Code**

![ezgif-6-ea7d8b4fb9e8](https://user-images.githubusercontent.com/7033952/86072256-2e49e980-ba4f-11ea-8e27-53096396cf81.gif)

A single click on the name (or anywhere on the line item) will open/close.

Keyboard controls:
| Key | Action |
| --- | --- |
| down | move down |
| up | move up |
| left | close |
| right | open (move down if already open) |
| space | open / close |
| enter | rename file |

**Atom**

![ezgif-6-4097b9c85f20](https://user-images.githubusercontent.com/7033952/86072262-3144da00-ba4f-11ea-834f-72d553f51391.gif)

A single click on the name (or anywhere on the line item) will open/close.

Keyboard controls:
| Key | Action |
| --- | --- |
| down | move down |
| up | move up |
| left | close |
| right | open (move down if already open) |
| enter | open / close |

**_My Two Cents_**

We should remove the `focus` state when clicking and only leave it for keyboard navigation like we do with the [print to console button](https://github.com/cypress-io/cypress/blob/715d07c1a9308ad215fe35da2775100a31dbf982/packages/reporter/src/errors/test-error.tsx#L81-L88). In addition, the focus state for keyboard navigation should be the same as the hover state, and not include an outline around the name. The keyboard controls are fairly standard for the browser and don't require a change, but I figured I would include them to provide a broader picture (perhaps we could also add additional keyboard shortcuts).

",enhancement
645886628,Add code frame for error messages in stdout,"### Current behavior:

This output in CI is not as helpful as it could be

![image](https://user-images.githubusercontent.com/1500684/85801424-15180480-b700-11ea-8ef9-949e578a288b.png)


### Desired behavior:

I love the codeframe added to the UI in https://github.com/cypress-io/cypress/pull/3930. I'd like a codeframe for the headless mode output as well.

### Test code to reproduce

Any test that fails

### Versions

cypress 4.9.0",enhancement
645573946,How can we determine the browser headed and Cypress interactive mode from plugin code?,"From the support / spec code we can determine if 
1. Cypress is executed using `cypress open` or `cypress run` mode
2. If the browser is headed or headless

https://glebbahmutov.com/blog/cypress-tips-and-tricks/#interactive-and-headed-mode

We need a similar way for the plugin's code to determine these two modes. Maybe in the `config` object?",enhancement
644968627,Test Runner UI Tweaks [TR-43],"**Acceptance Criteria**
- Change “TEST” to “TEST BODY”
- When hovering a test, the dotted left border color changes to `#828282`
- When hovering a test, only the accordion/test header triggers the hover state
- Only clicking the accordion/test header triggers expand/collapse of accordion
- When hovering line items in a test, the text color is `#6A6B6C`

Design of hover:
<img width=""633"" alt=""Screen Shot 2020-06-24 at 6 07 11 PM"" src=""https://user-images.githubusercontent.com/7033952/85632597-9b234500-b645-11ea-8927-c9ae75457b0a.png"">",enhancement
644833427,Can we disable baseUrl from the command line,"Cypress v4.8.0

Imagine we have `cypress.json` with `baseUrl` (and lots of other settings)

```json
{
  ""baseUrl"": ""http://localhost:5005""
}
```

We want to run component tests, they don't require `baseUrl`, but attempting to run them hits the base URL check

```
Cypress could not verify that this server is running:

  > http://localhost:5005

We are verifying this server because it has been configured as your `baseUrl`.

Cypress automatically waits until your server is accessible before running tests.

We will try connecting to it 3 more times...
We will try connecting to it 2 more times...
We will try connecting to it 1 more time...

Cypress failed to verify that your server is running.

Please start this server and then run Cypress again.
```

I can try blanking `baseUrl` using CLI but

```
$ yarn cypress:run --spec 'src/**/*_spec.jsx' --config baseUrl=
yarn run v1.22.4
$ cross-env TZ=America/New_York node ../../scripts/cypress run --project . --spec 'src/**/*_spec.jsx' --config baseUrl=
We found an invalid configuration value:

Expected `baseUrl` to be a fully qualified URL (starting with `http://` or `https://`). Instead the value was: `""""`
```

I tried disabling it using `false` like some other settings allow, but no success

```
$ yarn cypress:run --spec 'src/**/*_spec.jsx' --config baseUrl=false
yarn run v1.22.4
$ cross-env TZ=America/New_York node ../../scripts/cypress run --project . --spec 'src/**/*_spec.jsx' --config baseUrl=false
We found an invalid configuration value:

Expected `baseUrl` to be a fully qualified URL (starting with `http://` or `https://`). Instead the value was: `false`
```

## Proposal

Allow ignoring `baseUrl` by using `--config baseUrl=false` to override `cypress.json` value",enhancement
644310458,Open hooks in IDE from reporter [TR-42],"User Story: When hovering a test in the Test Runner, I want to see and be able to click a button that opens the test in my code editor, so that I can easily make edits to my tests.

**Acceptance Criteria**
- When hovered, each test line item reveals an Open in IDE button
  - Background of button is: `rgba(186, 186, 186, 0.2)`
  - When button is hovered, the entire line item also retains hover state
  - The hovered button has a background color of `#D8DADB`
  - Clicking the button opens the users code editor at that hook and places their cursor at the line of the command.

_Design_ (Note: ""See Preview"" is not included in this PR)

<img width=""636"" alt=""Screen Shot 2020-06-24 at 12 30 58 AM"" src=""https://user-images.githubusercontent.com/7033952/85500824-379c0780-b5b2-11ea-9c7d-dbd4758c99f6.png"">

On Hover:

<img width=""639"" alt=""Screen Shot 2020-06-24 at 12 31 04 AM"" src=""https://user-images.githubusercontent.com/7033952/85500838-3cf95200-b5b2-11ea-909d-496e3f788b72.png"">
",enhancement
643894793,Implement response middleware pattern for net-stubbing,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
Request handlers can be chained:

```ts
req.reply(async (req) => {
	const foo = await something()
	req.headers['x-foo'] = foo
})

req.reply((req) => {
	// more req handling...
})
```

There is not yet a similar system for response handler chaining.

### Desired behavior:
1. Decide if response handler chaining can make sense, and what the rules would be for chaining.
1. Implement an API similar to the req.reply chaining API for res.send.

",enhancement
643394975,Split Hooks [TR-5],"User Story: When viewing executed tests in the Test Runner, I want to see hooks split out to be their own definitions, so that I can more easily identify the hooks running around my tests.

**Acceptance Criteria**
- Split each command in any hook into its own definition in the Test Runner.
- Append the command count each hook definition
- Ex: a beforeEach running three commands, the user would see:
  - beforeEach (1)
  - beforeEach (2)
  - beforeEach (3)

**Design:**
<img width=""693"" alt=""Screen Shot 2020-06-22 at 6 54 05 PM"" src=""https://user-images.githubusercontent.com/7033952/85342982-cda03700-b4b9-11ea-97a6-18b6a9ddf6f8.png"">",enhancement
643107069,Cypress should allow fullscreen for AUT,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

I have a custom video player that I need to test the various elements of the player controls. Because the containing iframe for the site/app in the test runner does not have the `allowfullscreen='true'` attr. fullscreen features are semi or totally disabled. This is true for all browsers. I'm showing below with Youtube just to show it's not an isolated issue in my environment.

### Desired behavior:

From what I can tell, simply adding the `allowfullscreen='true'` to the containing iframe (has class `aut-iframe`) will allow players (and other sites/apps that need to utilize fullscreen) to use and test features that utilize the fullscreen API.

<!-- A clear description of what you want to happen -->

### Test code to reproduce

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->
The tests below show the problem/solution in the firefox browser ran locally in the test runner (workaround doesn't work in ci environment for me). The behavior is similar in other browsers, but it was harder to hack fix in a concise way inside a test for demonstration purposes. In Chrome, for example, `fullscreenEnabled` is set to true, making the fullscreen button clickable, but the fullscreen action is still denied. I can mimic the same solution in chrome by manually adding the `allowfullscreen` attr. and then reloading the iframe via js in the console.

The first test fails because the `fullscreenEnabled` property is false. The second test will pass because I am programmatically adding the `allowfullscreen` attr., reloading the iframe, then running the tests.

```javascript
describe('FAILS: firefox fullscreen is disabled', () => {
  it('should be able to use fullscreen', () => {
    cy.visit('https://www.youtube.com/embed/YE7VzlLtp-4');
    cy.document().its('fullscreenEnabled').should('be.true');
    // play video
    cy.get('.ytp-large-play-button').click();
    // click fullscreen button
    cy.get('.ytp-fullscreen-button').click();
    // check if the video actually went fullscreen
    cy.document().its('fullscreenElement').should('not.equal', null);
    // just to be nice, exit fullscreen and pause video
    cy.get('.ytp-fullscreen-button').click();
    cy.get('.ytp-play-button').click();
  });
});

describe('SUCCEEDS: firefox fullscreen is enabled via custom js', () => {
  it('should be able to use fullscreen', () => {
    cy.visit('https://www.youtube.com/embed/YE7VzlLtp-4');
    cy.window().then(window => {
      // get site iframe for site, set the allowfullscreen to true
      window.parent.document
        .getElementsByClassName('aut-iframe')[0]
        .setAttribute('allowFullScreen', 'true');
      // reload iframe
      window.location.reload();
      // make sure fullscreen is now enabled
      cy.document().its('fullscreenEnabled').should('be.true');
      // play video
      cy.get('.ytp-large-play-button').click();
      // click fullscreen button
      cy.get('.ytp-fullscreen-button').click();
      // check if the video actually went fullscreen
      cy.document().its('fullscreenElement').should('not.equal', null);
      // just to be nice, exit fullscreen and pause video
      cy.get('.ytp-fullscreen-button').click();
      cy.get('.ytp-play-button').click();
    });
  });
});
```
<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

### Versions
Cypress 4.8.0, Firefox 76/77 Beta.
Happens in both Mac OS 10.15.5 and Cypress Docker Image via Bitbucket Pipelines: cypress/browsers:node12.18.0-chrome83-ff77 
<!-- Cypress, operating system, browser -->
",enhancement
642917071,Proposal: get all the test results after all specs are finished and save them into a json/html file. ,"### Current behaviour:

I can get the results by spec and save it into a file and then use some tools to merge, but I can't have a simple JSON/HTML/txt file to display easily on the command line. 

I've tried with a custom report, mocha report... but every time and every event is only for specs, but not for all-suite of tests. 

### Desired behaviour:

I would love to have an easy way to get the complete run results and saved it into a simple .txt file. 

### Test code to reproduce

1. Configure any file to get the results (pass, failed, skipped...) . 
2. All the tests finished to execute (all specs available) and the results from ALL specs are saved in a file (JSON, HTML TXT...). 

### Versions

Any, not relevant. 
",enhancement
641983209,"Expose CLI parsing logic that converts ""cypress run"" arguments to options object","It would be nice to expose a small utility from Cypress NPM module to parse ""cypress run"" CLI arguments into options object. Could be used to wrap Cypress and get for example JSON of results (#7532) while running everything the same way as ""normal run"" does

We already have the code in `cli/lib/cli.js`, just need to expose it from the NPM module

```js
// user code
const cypress = require('cypress')
const runOptions = cypress.cli.parseRunArguments(process.argv.slice(2))
cypress.run(runOptions).then(...)
```

Then it could eliminate need to prefix `cypress run` commands like Percy or Happo plugins do right now

```
npx percy-cypress -- cypress run ...
```

and would allow those plugins to receive the Dashboard URL to link their run to Cypress Dashboard run, like done in https://github.com/cypress-io/github-action#outputs

",enhancement
641607900,Ability to dynamically create tests while inside of a test - cannot create tests while tests are running,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

I am loading these based on some data, but to get it I need to run `cy.task` to grab that data. For now let's assume it's a MySQL query via a plugin. I cannot use `cy.task` outside of a test, so I am trying to add tests from within a test.

Another use case is that I am running a test, but I see a button. I have another set of tests that only run based on the existence of that button. I still want them in another separate context, so a separate dropdown.

Also, I cannot use `it` inside of a `cy.task` callback e.g. inside of `myFunction` like with `cy.task('readCSV', 'test.csv').then(myFunction);` 

### Current behavior:

Parent task results waits forever. Perhaps related (https://github.com/webdriverio/webdriverio/issues/4963)

### Desired behavior:

<!-- A clear description of what you want to happen -->
I would like to see ""Another Test"" in a separate row as per the code below. **FYI**: Doing this will work in puppeteer correctly.

### Test code to reproduce

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

```js
context('Set up',  () => {
  it('add tests',  () => {

    context('Another test', () => {

      it('this title', () => {
        expect(true).to.equal(true)
      })
    })
    
  });
})
```

### Versions

<!-- Cypress, operating system, browser -->
Debian 10, Cypress 4.8.0",enhancement
640015412,Misc minor UI improvements,"Miscellaneous minor UI tweaks and fixes regarding recent UI updates:

- Top border on spec file header
- Tooltip around open in IDE
- Better display of ""Print to Console"" when clicked
  - Add active state when button is ""pressed""
  - Display tooltip to show confirmation of print (like when a command is pinned)
- Center ""assert"" within red/green block (issue shown below)

<img width=""106"" alt=""Screen Shot 2020-06-16 at 3 51 10 PM"" src=""https://user-images.githubusercontent.com/7033952/84834677-f6c75000-afff-11ea-8547-4237beb9d21b.png"">
",enhancement
639989587,Use cy.wait to deterministically wait on response with specific HTTP status code,"I'm implementing 'long polling' in my application which means I send an HTTP request, get a `HTTP 202` with token. Then I keep calling the same endpoint with token until I eventually get an `HTTP 200`.

The problem I'm seeing with cypress is I have to anticipate exactly how many HTTP responses I'll get and put in that many `cy.wait` calls. Is there a more elegant way of calling `cy.wait` so that it skips the `HTTP 202` responses and just handles the `HTTP 200` so I can do my assertions?

F.e.,
api request sent -->
<--- HTTP 202 with token
api request sent(with token)-->
<--- HTTP 202
...
api request sent(with token) -->
<--- HTTP 200

I'd like to just have 1 `cy.wait` call for that HTTP 200 response.",enhancement
639309110,Open spec file from desktop gui [TR-3],"User Story: When viewing my specs in the desktop GUI, I want to be able to open a spec in my IDE, so that I can easily transition from Cypress to my codebase. 

**Acceptance Criteria**
- Hovering a spec file line item shows hover state
- Hover state reveals hidden `Open in IDE` button
- Button appears all the way to the right on the line item
- Hovering `Open in IDE` button has it’s own hover state
  - Background of button is: `rgba(186, 186, 186, 0.2)`
  - When button is hovered, the entire spec line item also retains hover state

Normal state:

<img width=""1594"" alt=""Screen Shot 2020-06-16 at 1 13 07 PM"" src=""https://user-images.githubusercontent.com/7033952/84806176-480d1a80-afd3-11ea-83f3-bde082875b67.png"">

Hover over spec file name:

<img width=""1594"" alt=""Screen Shot 2020-06-16 at 1 13 17 PM"" src=""https://user-images.githubusercontent.com/7033952/84806193-4e9b9200-afd3-11ea-9eab-2904da83ae04.png"">

Hover over ""Open in IDE"":

<img width=""1598"" alt=""Screen Shot 2020-06-16 at 1 13 29 PM"" src=""https://user-images.githubusercontent.com/7033952/84806237-5bb88100-afd3-11ea-9dac-f320c1226d25.png"">
",enhancement
638425222,Spec Loading State [TR-41],"User Story: When viewing the Test Runner as it’s loading a spec file, I want to see a loading animation, so that I know that the file is loading and that something is happening.


**Acceptance Criteria**
- User will see 5 progressively pulsating circles
- Below circles user will see Your tests are loading…
  - font family: Muli
  - font size: 20px
- The first circle has a background color of #56b790
- Second circle: #4a88cc
- Third circle: #b96162
- Fourth circle: #e3b065
- Fifth circle: #a9abad
- Animation plays over 2 seconds
  - Animation repeats until spec file loads


![ezgif-6-aec2bec79132](https://user-images.githubusercontent.com/7033952/84603449-8e8c3900-ae5c-11ea-8ec4-81bbc3a51bce.gif)
",enhancement
638084330,Run multiple same test at same times,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
I need to run some test multiple times in same time, is it possible?
Now i only can run 1 test at time, and if i want to run same test in same time i use paralelize to run it but need to make many same test files.
<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

### Desired behavior:
Make 1 test then run multiple times at once
<!-- A clear description of what you want to happen -->

### Test code to reproduce

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

### Versions

<!-- Cypress, operating system, browser -->
",enhancement
638061481,Allow hiding assertion logs for `.should()` and `.and()` except on failure,"### Current behavior:

There is no way to hide logs when making assertions, for example, with `should`.

### Desired behavior:

There is a way to hide passing assertions while still reporting failing assertions. Ideally these successful assertions could also be turned back on when running under a different log level.

This came up because I wanted a ""safer"" version of the `get` command, which would by default assert that there is only 1 element found (unless an explicit `length` option was passed) and that the element is visible (unless an explicit `noVisibleCheck` option was passed), since I've seen tests fail or falsely succeed because of overbroad selectors or when an element was present in the DOM but not visible. Cypress tests run fast enough that doing this shouldn't add significantly to the test run time.

However, when I do this, I end up with a ton of extra logs for each `get`, which clutters the test output. I'd like a way to disable these logs by default, unless the assertions fail.

### Test code to reproduce

https://github.com/ncknuna/cypress-test-tiny/blob/master/cypress/support/commands.js#L45

### Versions

Cypress 4.8.0
OSX 10.15.5
Chrome 83.0.4103.61
",enhancement
636889773,Cypress does not yet provide an option to disable websecurity for Firefox,"### Problem:
I am unable to run Cypress on Firefox due to its adherence to [same origin policy](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy). This issue can be fixed on chrome by setting the `chromeWebSecurity` to `false` in configuration.
 
Cypress should provide such a solution for the firefox browser.
The error message received on ``cy.visit()``:
```Permission denied to access property ""addEventListener"" on cross-origin object```


### Versions

Cypress version : 4.8.0
O.S: Ubuntu 18.04
Browser : Firefox 77
",enhancement
636525262,Explore allowing `cy` command usage in `cy.intercept` callbacks,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
`cy` commands are not explicitly treated differently when called from inside `cy.route2` callbacks.

### Desired behavior:
Cypress generally stops users from writing non-deterministic tests, and using cy commands inside of request/response callbacks would cause non-determinism.

`cy` commands should fail when called from inside `cy.route2` callbacks with a clear error message explaining why.

Perhaps cy.now should remain, so users can have a backdoor to access Cypress commands directly

",enhancement
636375668,Add support for waiting on the Nth request/response in cy.intercept(),"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
`cy.route` has (undocumented) support for waiting on the Nth request/response:

```js
cy.wait('@foo.1') // first response
cy.wait('@foo.request.1') // first request
cy.wait('@foo.response.5') // fifth response
```

`cy.route2` does not have this.

### Desired behavior:
Implement this in `cy.route2`, so that the following tests can pass:

https://github.com/cypress-io/cypress/blob/1b472e03e56de2de42d8d302009b5e3a1ee35732/packages/driver/test/cypress/integration/commands/net_stubbing_spec.ts#L991-L1030

Depends on #687

",enhancement
636371581,Show req/res diffs in consoleProps when using cy.intercept,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
There is not an easy way to tell what types of transformations were applied to a request or response in `cy.route2` after the fact.

### Desired behavior:
Improve logging to show the original request/response objects, as well as their diffs to the request/response objects that were actually used.

This may rely on the under-the-hood work to keep track of taintedness in #7657 

Depends on #687

",enhancement
636367544,"Add throttleKbps, delayMs with presets to StaticResponse objects","<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
Users have to invoke `.delay()` or `.throttle()` to delay/throttle the response, and they have to use plain numbers (ms and kbps, respectively) to set the throttle:

https://github.com/cypress-io/cypress/blob/2443eb4276fca048260b045b57123cc17a519b2e/packages/driver/test/cypress/integration/commands/net_stubbing_spec.ts#L766-L774

### Desired behavior:
Users should be able to statically define throttleKbps or delayMs, and should be able to use string presets. So the above code could be written as this:

```js
cy.route2('/timeout', {
	statusCode: 200,
	body: payload,
	delayMs,
	throttle: '3g', 
})
```

For the list of throttle presets, we can probably use the same list that Chromium/WebKit use: https://source.chromium.org/chromium/chromium/src/+/master:chrome/test/chromedriver/chrome/network_list.cc;l=12;drc=23bc3b1c92fd920d4d359ba46d73054ff0f47d2c?originalUrl=https:%2F%2Fcs.chromium.org%2F

Depends on #687

",enhancement
636357321,Add Express-compatible APIs to `cy.intercept` interceptors,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
Intercepting requests/responses right now is pretty ugly, lots of manual object manipulation and not many helper functions to let users modify the requests/responses.

### Desired behavior:
Using the Express APIs for inspiration, implement many of the same concepts for Cypress's request/response interception. For example, a user should be able to use `res.set` to case-insensitively override a header:

```js
cy.intercept('*', (req) => {
	req.reply(res => {
		res.set('content-type', 'foo').send()
	})
})
```

Depends on #687

",enhancement
636351884,Add API for skipping proxy middleware via `cy.intercept`,"Users may want to disable certain middleware in the `proxy` layer that interferes with their tests.

For example, to disable the behavior where Cypress attaches auth headers to an outgoing request:

`req.skipMiddleware('MaybeSetBasicAuthHeaders')`

And then the proxy would skip this for that request only:

https://github.com/cypress-io/cypress/blob/2443eb4276fca048260b045b57123cc17a519b2e/packages/proxy/lib/http/request-middleware.ts#L106-L117

Depends on #687

",enhancement
636340183,Implement plugin events for network stubbing/spying,"It makes sense to let plugins access the same network stubbing events that the driver can access, so that users can write more complex network stubbing tasks in Node.js.

A basic implementation of this would just be to let the plugin register to receive `net` events from the `socket`:

https://github.com/cypress-io/cypress/blob/2443eb4276fca048260b045b57123cc17a519b2e/packages/net-stubbing/lib/server/driver-events.ts#L133-L148

Depends on #687

",enhancement
635719202,Command Timeout Indicator [TTR-36],"Adds a command timeout progress bar underneath each running command.

- As a command is pending, a progress indicator appears at the bottom of the command line item
- The progress indicator has a background color of `#7EB0DB`
- The progress indicator should be 2px tall
- The horizontal length of the progress indicator will shortened from left to right as the command pends
  - The progress indicator should progress smoothly

<img width=""625"" alt=""Screen Shot 2020-06-09 at 3 34 34 PM"" src=""https://user-images.githubusercontent.com/7033952/84193938-3a531480-aa6a-11ea-8889-3f64b0cdc110.png"">
",enhancement
630020173,Date objects are not overwritten by cy.clock in unit test,"### Current behavior:

When using `cy.clock(now)` in a unit test (without calling `cy.visit`), the Date object is not overwritten and it is not possible to stub current date

### Desired behavior:

`cy.clock` should work in unit tests. 

### Test code to reproduce

https://github.com/Fredx87/cypress-clock-unit

### Versions
Cypress 4.7.0
",enhancement
628047347,Should show stack trace to step in the script on custom command error,"I'm creating set of really useful Cypress commands. I wan't to handle invalid arguments validations and more stuff within the custom command. Default Cypress `get()` command handles it as follows,

```javascript
get (selector, options = {}) {
  const userOptions = options
  const ctx = this

  if ((userOptions === null) || _.isArray(userOptions) || !_.isPlainObject(userOptions)) {
	return $errUtils.throwErrByPath('get.invalid_options', {
	  args: { options: userOptions },
	})
  }
```

Log will show following information.

![image](https://user-images.githubusercontent.com/18459807/83362473-2c88f980-a3af-11ea-8b64-2513319e0145.png)

Important thing here is, the failure from `get()` will show stack trace to the current step in the **test script** as well as in the code peek window.

### Current behavior:
With current capabilities, I could throw an error from the command

```js
Cypress.Commands.add('vDo', (...args) => {
    throw new Error('testing error');
});
```
but when an error is thrown from a custom command, log will shows the stack trace to the custom command implementation, not to the current step in the script just like `get()`.

![image](https://user-images.githubusercontent.com/18459807/83362871-5ee82600-a3b2-11ea-9e13-cbf07cf64aa4.png)

### Desired behavior:
My suggestion for handling errors would be following, since I can do it in the same format as other commands,

```js
Cypress.Commands.add('vDo', (sel, userOptions) => {
    return $errUtils.throwErrByPath('vDo.invalid_options', {
        args: {
            options: userOptions
        },
    })
});
```
In the log, on an error, stack trace & code peek should show the step in test script.


### Test code to reproduce
#### support/index.js
```js
Cypress.Commands.add('vDo', (...args) => {
    throw new Error('testing error');
});
```

#### integration/actions.spec.js
```js
/// <reference types=""cypress"" />

context('Actions', () => {
	it('should only get visible element', () => {
		cy.visit('https://www.google.com')
		cy.vDo()
	});
})
```
",enhancement
627302226,Have long file paths to screenshots and video that return be 'copy-able' as a single link,"# Current behavior:

As is, paths to screenshots and videos generated when a test fails are displayed in such a way that I cannot use the hyperlink capabilities of my terminal emulator. Similarly, a straightforward copy/paste is not possible.

![image](https://user-images.githubusercontent.com/259840/83269104-e2452400-a1c6-11ea-8478-35e477376293.png)

### Desired behavior:

Displaying the file paths in such a way that clicking on them does not break, and so that copying them is straightforward.

### Test code to reproduce

Any failed test that produces screenshots or videos will do, I think?

### Versions

Cypress version: 4.2.0
OS/Browser: not relevant, as this is about the terminal UI",enhancement
627300683,Allow using multiple built-in reporters,"Cypress v4.7.0

When running with default `spec` reporter I see good human output

```
$ npx cypress run
  Running:  spec.js                                                                         (1 of 1)


  page
    ✓ works (484ms)


  1 passing (3s)


  (Results)
```

But for checking the tests that ran I need `json` reporter

```
$ npx cypress run --reporter json
```

```
  Running:  spec.js                                                                         (1 of 1)
{
  ""stats"": {
    ""suites"": 1,
    ""tests"": 1,
    ""passes"": 1,
    ""pending"": 0,
    ""failures"": 0,
    ""start"": ""2020-05-29T14:02:03.671Z"",
    ""end"": ""2020-05-29T14:02:05.415Z"",
    ""duration"": 1744
  },
  ""tests"": [
    {
      ""title"": ""works"",
      ""fullTitle"": ""page works"",
      ""duration"": 434,
      ""currentRetry"": 0,
      ""err"": {}
    }
  ],
  ""pending"": [],
  ""failures"": [],
  ""passes"": [
    {
      ""title"": ""works"",
      ""fullTitle"": ""page works"",
      ""duration"": 434,
      ""currentRetry"": 0,
      ""err"": {}
    }
  ]
}
  (Results)
```

## Json report problem

Let's say we want to validate the tests that executed. We could try using json reporter ... but we cannot get JUST the JSON file

The user could redirect the STDOUT 

```
npx cypress run --reporter json > report.json
```

then there is NO output from the run and the report.json has a mixture of the human output and JSON parts.

### proposal

First, let's split the `json` output and output it to STDERR. Then the user at least could have nice and clean json file

```
npx cypress run --reporter json 2> report.json
```

Note: if there is an error, we write errors to STDERR, but in that case the report is invalid anyway, so I am ok with that.

## Ideally

But I really want both: human-readable spec reporter and json report for checking the tests that executed.

I think a good approach would be to allow specifying multiple reporters using `--reporter name1,name2` and saving additional reports into `cypress/reports` folder

## Why

When running component tests we use settings in cypress.json

```
experimentalComponentTesting: true,
componentFolder: ""src""
```

If we change the config key name or how they work - the tests still happily pass (because there are integration specs), yet the component tests that we really wanted to execute never ran, and there is no easy way of verifying the list of files and tests that were executed.

One could install a multi reporter module, but that is unnecessary complexity in my opinion.",enhancement
626000197,Add spec header with link to open file in editor,"When running tests in the Test Runner, I want each spec header to be sticky and clickable and opens the spec in my code editor, so that I can easily get to my spec and make changes.

- Spec header is sticky
- Spec header will have a background color of #f2f2f2 and will have a drop shadow
- Spec headers will show the file path
- File path will be semi-bold font weight
- File path is centered vertically in the div
- File path has a hover state where the path is underlined
- Clicking the file path opens the user’s IDE at that file
- Matches design

Design:
<img width=""892"" alt=""Screen Shot 2020-05-27 at 4 14 46 PM"" src=""https://user-images.githubusercontent.com/7033952/83067748-34eed680-a035-11ea-8da8-e006ff8f4b79.png"">
",enhancement
621911675,Plugin stdout not captured as part of stdout during run record,"currently we capture run stdout for recording by intercepting `process.stdout.write`, however that will only capture the stdout from the parent process, missing the plugins

We should capture stdout from the plugins as well

We likely should spawn plugins with `{ stdio: 'pipe' }` instead of `inherit` and manually forward the stdout to the parent",enhancement
620881059,"Feature request: Test ""Rehydration"", a strategy to execute tests faster","I'm not sure if we're already doing this. But to explain the feature I was looking for; there can be multiple scenarios where starting steps are same but some steps in the end changes. Can there be a possibility to save the page state for such scenarios without running all the common steps again?

No I'm not talking about commands.",enhancement
618947444,Hide XHR requests from the command log,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

All XHR requests are printed to the command log, which can be distracting. There is no option to filter them. In https://github.com/cypress-io/cypress/issues/1184 it was mentioned this is possible by whitelisting requests with `Cypress.Server.defaults`, but that breaks stubbing.

### Desired behavior:

Having an option, to only log stubbed XHR requests to the command log.

Maybe the best fix would be not a config option, but a toggle on the test runner, that can hide these logs. 

### Test code to reproduce

Test any app that does network requests.

### Versions

Any OS and version.
",enhancement
618371357,Is there a way to proxy mocked routes,"I know you can mock routes with  `cy.route('GET', 'settings', 'fixture:settings/index.json');`

We are running a OpenAPI Mock Server ([Prism](https://stoplight.io/open-source/prism/)) which returns deterministic examples. We would like to use these responses as our fixtures if possible so we don't need to maintain a separate set of fixtures.

It would be great if we could do something like `cy.route('GET', 'settings', 'proxy:http://localhost:4041/settings')` in our tests which proxies the requests (including body & headers).

Is there anything like this in Cypress? Or an API that i might be able to use to implement something like this",enhancement
617113215,"trigger ""search"" event is during type with {enter}","### Current behavior:

The `{enter}` key functionality is not triggered.

### Desired behavior:

After `enter` key simulated is pressed, it should display info in the page

### Test code to reproduce

This is the code I have for testing: 

```js
it('should render 20 articles if I write `México` in the search field', () => {
  const resultText = `Se encontraron 20 resultados de ""México"". `;
        
  cy.get('#search').should('exist');
  cy.get('#search').clear().type('RandomText{enter}');
});
```

**app.js**:

```js
export const apiKey = """";
const defaultSource = 'buzzfeed';
const sourceSelector = document.querySelector('#sourceSelector');
const inputSearch = document.querySelector('input[type=""search""]');
const newsArticles = document.querySelector('main');
const statusBar = document.querySelector('.status');
const imgNotFound = ""https://stockpictures.io/wp-content/uploads/2020/01/image-not-found-big.png"";

window.addEventListener('load', e => {

  sourceSelector.addEventListener('change', evt => updateNews(evt.target.value));
  updateNewsSources().then(() => {
    sourceSelector.value = defaultSource;
    updateNews();
  });

  inputSearch.addEventListener('search', e => {
    queryNews(e.target.value)
  })

  networkStatus()

  window.addEventListener('online', networkStatus);
  window.addEventListener('offline', networkStatus);
});

export async function getJSON(url) {
  const response = await fetch(url);
  const json = await response.json();
  
  return json;
}

export async function updateNewsSources() {
  const json = await getJSON(`https://newsapi.org/v2/sources?apiKey=${apiKey}`);

  sourceSelector.innerHTML =
    json.sources
      .map(source => `<option value=""${source.id}"">${source.name}</option>`)
      .join('\n');
}

export async function updateNews(source = defaultSource) {
  newsArticles.innerHTML = '';
  const json = await getJSON(`https://newsapi.org/v2/top-headlines?sources=${source}&sortBy=top&apiKey=${apiKey}`);
  
  newsArticles.innerHTML = json.articles.map(createArticle).join('\n');
}

export async function queryNews(query) {
  newsArticles.innerHTML = '';
  const json = await getJSON(`https://newsapi.org/v2/everything?q=${query}&apiKey=${apiKey}`);
  
  newsArticles.innerHTML = json.articles.map(createArticle).join('\n');
  document.getElementById('results').innerHTML = `Se encontraron <strong>${Object.keys(json.articles).length}</strong> resultados de <strong>""${query}""</strong>. `;
  inputSearch.value = """"
}

export function createArticle(article) {
  return `
      <div class=""article"" title=""${article.title}"">
        <a href=""${article.url}"">
          <div class=""article-img"">
            <img src=""${article.urlToImage ? article.urlToImage : imgNotFound}"" />
          </div>
          <div class=""article-body"">
            <h2 class=""article-title"">${article.title}</h2>
            <p>${article.description ? article.description : ""Lorem Ipsum""}</p>
          </div>
        </a>
      </div>
      `;
}

export function networkStatus(sb) {
  sb = sb || statusBar;

  if (navigator.onLine) {
    sb.innerHTML = """"
    sb.style.display = ""none""
    
    console.log('online');
  } else {
    sb.style.display = ""block""
    sb.innerHTML = ""Estas Offline""
    
    console.log('offline')
  }
}
```

**index.html**:

```html
<!DOCTYPE html>
<html lang=""en"">

<head>
  <meta charset=""UTF-8"" />
  <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"" />
  <title>News</title>
  <link rel=""stylesheet"" href=""style.css"" />
  <link rel=""manifest"" href=""manifest.json"" />

  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src=""https://www.gstatic.com/firebasejs/7.13.2/firebase-app.js""></script>
  <script src=""https://www.gstatic.com/firebasejs/7.12.0/firebase-messaging.js""></script>

</head>

<body>
  <div id=""statusBar"" class=""status""></div>
  <header>  
    <h1>News</h1>
    <div class=""search-bar"">
      <input type=""search"" placeholder=""Buscar..."" name=""Buscar"" id=""search"">
    </div>
    <div class=""select"">
      <select id=""sourceSelector""></select>
    </div>    
  </header>
  <p id=""results""></p>
  <main></main>
  <script src=""app.js"" type=""module""></script>
</body>

</html>

```

style.css:

```css
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono&display=swap');
body {
  font-family: 'Roboto Mono', monospace;
  font-weight: 300;
  padding: 1em 3em;
}

h1 {
  text-transform: uppercase;
  font-weight: 300;
}

.status {
  background: #ef4e4e;
  color: white;
  font-weight: bolder;
  padding: 7px;
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  font-size: 1em;
  position: relative;
}

#results {
  margin-top: 0;
}

main {
  display: grid;
  grid-gap: 30px;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  grid-auto-rows: max-content;
  grid-auto-flow: row dense;
}

.select {
  position: relative;
  display: flex;
  align-items: center;
}

select {
  font-family: 'Roboto Mono', monospace;
  border: .2em solid black;
  border-radius: 0;
  -webkit-appearance: none;
  -moz-appearance: none;
  -ms-appearance: none;
  padding: 1em;
}

.select:after {
  content: ""\25BC"";
  display: block;
  position: absolute;
  right: 20px;
  cursor: pointer;
  pointer-events: none;
}

.search-bar {
  flex-grow: .9;
}

.search-bar input {
  width: 100%;
  font-family: 'Roboto Mono', monospace;
  border: .2em solid black;
  font-size: 15px;
  padding: 8px;
}

.search-bar input:focus {
  outline-color: transparent;
  outline-style: none;
}

/* select::after {
  content: ""\25BC"";
  display: block;
  position: absolute;
  top: 0;
  right: 0;
  padding: 0 1em;
  background: #34495e;
  cursor: pointer;
  pointer-events: none;
  -webkit-transition: .25s all ease;
  -o-transition: .25s all ease;
  transition: .25s all ease;
  height: 40px;
  width: 40px;
} */

.article {
  word-wrap: break-word;
  background-color: #fff;
  background-clip: border-box;
  border: 1px solid rgba(0, 0, 0, .125);
  border-radius: .25rem;
  box-shadow: 4px 6px 7px 1px rgba(0, 0, 0, 0.75);
}

.article-body {
  padding: 1.25rem;
}

.article-title {
  margin-bottom: .75rem;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.article a, .article a:visited {
  text-decoration: none;
  color: inherit;
}

.article img {
  width: 100%;
  height: 13em;
}
```

I left here a video evidence to see the error: https://www.loom.com/share/dbccb6394a934222a3854b5973c1609c

### Versions

**Cypress**: 4.5.0
**Browser**: Google Chrome, Version 81.0.4044.138 (Official Build) (64-bit)
**OS**: Windows 10 Enterprise, 64 bits",enhancement
616472628,Re-query elements that are found 'detached' from the DOM,"### Current behavior:

Currently when Cypress queries an element that was passed from a parent element (say in `.get()`, `.click()` or `.find()`), if the element at some point becomes detached from the DOM, we throw an error:

```
CypressError: cy.click() failed because this element is detached from the DOM.

<element>

Cypress requires elements be attached in the DOM to interact with them.

The previous command that ran was:

  cy.get()

This DOM element likely became detached somewhere between the previous and current command.

Common situations why this happens:
  - Your JS framework re-rendered asynchronously
  - Your app code reacted to an event firing and removed the element

You typically need to re-query for the element or add 'guards' which delay Cypress from running new commands.

https://on.cypress.io/element-has-detached-from-dom
```

<img width=""641"" alt=""Screen Shot 2020-11-02 at 10 27 54 AM"" src=""https://user-images.githubusercontent.com/1271364/97828884-c7875600-1cf6-11eb-84a4-216968474439.png"">


### Desired behavior:

Really users just want to re-query the DOM for the previously found element and click on the new element. Because it's more often than not that the framework underneath has created a completely new DOM element and inserted it into the DOM. 

The proposal is to re-query the previously found element and continue the command with any newfound elements. Perhaps this could be an option passed to the command to allow this or not. 

### Reproducible Example

Provided in https://github.com/cypress-io/cypress/issues/9032

`index.html`

```html
<form>
    <select onchange=""document.forms[0].submit()"">
        <option value=""1"">First</option>
    </select>
    <input />
</form>
```

`spec.js`

```js
it('this will fail but should not', () => {
    cy.visit('index.html')
    cy.get(""select"").select(""First"")
    // adding any wait time will make it pass
    // cy.wait(0)
    cy.get(""input"").type(""Hallo"")
})
```

### Related issues

- https://github.com/cypress-io/cypress/issues/6215
- https://github.com/cypress-io/cypress/issues/5743
- https://github.com/cypress-io/cypress/issues/4946
- https://github.com/cypress-io/cypress/issues/4414
- https://github.com/cypress-io/cypress/issues/3670
- https://github.com/cypress-io/cypress/issues/9032",enhancement
616096223,"Remove regex-based JS/HTML rewriting, switch to AST-based rewriting","AST-based JS/HTML rewriting is available as an experimental feature with https://github.com/cypress-io/cypress/pull/5273

Here are the remaining tasks before it can fully replace the existing regex-based rewriting:

- [ ] Validation with users - is it solving the issues we set out to fix?
- [ ] (2) Rewrite all traffic (currently, only AUT's current origin is intercepted)
	- may require inlining `resolvers.ts`
- [ ] (3) Do https://github.com/cypress-io/cypress/issues/7268 or have it be fixed by inlining `resolvers.ts`
	- or else rewriting will break if a user visits an http:// url that redirects to https://
- [ ] (4) Inject HTML via `parse5` instead of regex.
- [ ] (4) Resolve issue where proxy will no longer work for normal web browsing outside of Cypress frame. Possible solution: inject a stub `window.Cypress.resolveWindowReference` into every html page here: https://github.com/cypress-io/cypress/blob/2ed56949cb14b4630ca11ec8c4cda715aa9bfa26/packages/server/lib/util/inject.js#L1-L28
- [ ] (4) Performance measurements:
    - [ ] difference between rewriting with sourcemap and without
	- [ ] comparison to regex-based rewriting
- [ ] (4) Performance improvements: 
	- [ ] improve speed: add streaming parsing/rewriting of JS (parse5 handles rewriting HTML as a stream)
	- [ ] mem usage: explore caching js in deferred-sourcemap-cache on filesystem
	- [ ] understand how sourcemaps are cached in browser and how we can reduce unnecessary regeneration/not store old sourcemaps in RAM
- [ ] (4) Add comments around injected code to help users understand - potentially include original code in a comment
- [ ] (1) Need a real fix for Electron worker_threads https://github.com/electron/electron/issues/23366
- [ ] (4) Fix all code TODOs from original PR: https://github.com/cypress-io/cypress/pull/5273",enhancement
613965812,CDP - Support for sessionId,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

# Feature-Request

### Current behavior:

`Cypress.automation('remote:debugger:protocol', {})` supports two parameters:
- `command: string`
- `params: Object`

<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

### Desired behavior:

An additional, optional parameter:
- `sessionId: string`

This way targets that are exposed via `Target.attachToTarget` can be reached. 

See https://github.com/aslushnikov/getting-started-with-cdp/blob/master/README.md#targets--sessions for details. 

<!-- A clear description of what you want to happen -->

### Test code to reproduce

N/A

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

### Versions

N/A

<!-- Cypress, operating system, browser -->
",enhancement
610927831,Error Improvements: Part 3,"[Error Improvements (Part 2)](https://github.com/cypress-io/cypress/pull/3930) is soon to be released and provides a foundation for many more improvements that can made on top of it. The following is a list of further work that can be done. It is in no particular order and any given item's inclusion is not a guarantee it will be done. The items need some discussion and prioritization. Once that occurs, items can be broken out into their own issues, so smaller PRs can be made addressing them.

- BUG: Errors that are currently not covered by tests and may not extra work to support source map/code frames:
  - Errors in hooks
  - Returning a promise from a test and rejecting it (cy.js `fail` isn't called)
  - jQuery sizzle errors (invalid selector)
- FEATURE: Add the code frame to the error message/stack, so it appears in stdout and other reporters https://github.com/cypress-io/cypress/issues/7819
- FEATURE: Show diffs in reporter (#3129 & #4084)
- FEATURE: Code frames and stack translation relies on inline source maps. If we detect there is no source map, show a message about their benefits and points to directions on how to enable them.
- FEATURE: Utilize the stack capturing and source mapping for purposes other than errors
  - Each test in the reporter can have a link that can open the user's IDE to that test's definition
- FEATURE: Should we show the stack trace by default in reporter?
  - It's actually useful and not overly verbose with internal lines
  - Maybe show 3/4 lines, with a 'Show more' button
- FEATURE: Some error messages have multiple error messages. Currently they just display:
  - 'Learn more' links next to each other in the reporter
  - The URLs one after another in stdout
  - We should differentiate them somehow
    - Give them different labels
    - Each may be associated with different parts of the message, so they should be integrated into the message better
    - Maybe the message should have placeholders for them that get replaced differently depending on interactive/non-interactive modes
- PERF: Profile how much time Bluebird spends when we enable longStackTraces (cypress.js) and maybe turn it always off or always on
- FEATURE: Splice out cypress internals when there's a user error (particularly Scenario 2, when error is in a command callback)
  - Alternatively, display them different in the reporter (e.g. less opacity, collapsed with option to open)

- BUG: Chai assertion error messages use quotes instead of backticks
  - ""expected 'actual' to equal 'expected'"" should be ""expected `actual` to equal `expected`""
- FEATURE: Send new error properties to the dashboard
  - Currently we only send the message and stack
  - Send the code frame, parsed stack, and any other useful properties
  - Include information about the command, type of assertion error, etc 
  - Enable opening in IDE from the dashboard
  - Jeff is working on a proposal for what the dashboard would find useful
- FEATURE: Capture and display info like current URL with an error (See [this comment](https://github.com/cypress-io/cypress/issues/3762#issuecomment-499962295))
- FEATURE: Explore opening stack lines in DevTools
  - Either do it instead of opening in IDE (maybe only in certain circumstances) or as an extra option
- FEATURE: Improve how errors are logged (use `console.group`)
- FEATURE: For File Opener Preference modal:
  - Add a learn more link (same as settings for it has in Desktop GUI)
  - 'Settings tab' should be clickable link to go to ‘Settings’ in the Desktop GUI
- FEATURE: Utilize source maps in user's app code
  - This is a technical challenge because we can't access the user's code as easily as the spec code
  - Would need to pull it out of the user's code or have the user opt in and provide a way for us to access it
  - Once we can, it enables:
    - Showing code frames for errors in app code
    - If visit synchronously fails in app code: 
      - Code frame that points to cy.visit in spec code, as it is now
      - A 2nd code frame that points to the app code
      - This might apply to other commands as well, where the error ocurred in the user's app, but we can still associate it with a command (click, etc)
- BUG: When printing error to console, the stack lines show fully qualified URLs instead of source mapped URLs
- BUG: When importing/requiring a file outside the project root, the path is not correct (`../foo` flattens into `webpack:///foo`)
- ~Make individual lines in the code frame clickable (then open in IDE)~

### In progress/done

- [ ] Improve Mocha `done` errors (called twice, timed out, etc) - [Issue](#7514)
- [x] Improve errors thrown in `cy.on('fail')` handlers - [Issue](#7512) | [PR](#7513)
- [x] `cy.task` errors need the original error appended like other Node.js errors  - [Issue](#7263) | [PR](#7264)

### Related Issues

- Module API doesn’t fail the promise with Cypress error message #3216
- Show warning message in command log #4917
- Add warning to command log for 'uncaught exception' #4933
- Add codeframe for error messages in headless mode https://github.com/cypress-io/cypress/issues/7819",enhancement
608886071,Expand `Cypress.isBrowser()` to allow for bool/array checks,"### Current behavior:

You can run checks against `Cypress.isBrowser()` by passing the name of the browser or by passing an object to match against. 

```js
Cypress.isBrowser('firefox')
Cypress.isBrowser({ family: 'chromium', channel: 'stable' })
```

### Desired behavior:

Expand this behavior to allow for a bool check and to check an array of browsers:

```js
Cypress.isBrowser('!chrome')
Cypress.isBrowser(['electron', 'chrome'])
Cypress.isBrowser(['!electron', '!chrome'])
Cypress.isBrowser([
  { family: 'chromium', channel: 'canary' },
  { family: 'firefox', channel: 'dev' }
])
```

### Versions

4.5.0
",enhancement
608881696,Pass options to specific tests/suites in order to overwrite configuration throughout test/suite,"## Current behavior: 

Currently you can change the configuration within tests mainly be setting `Cypress.config()`. This will change the configuration for the duration of the entirety of tests. Sometimes you just want configuration set for the current block of test/suite.

Furthermore, in order to filter certain tests/suites by the browser we're running in, we have to use `Cypress.isBrowser()` to do kinda of strange filters like below:

```js
const runOn = (browser, fn) => {
  if (Cypress.isBrowser(browser)) {
    fn()
  }
}

const ignoreOn = (browser, fn) => {
  if (!Cypress.isBrowser(browser)) {
    fn()
  }
}

// Run happy path tests if Cypress is run via Firefox
runOn('firefox', () => {
  describe('happy path suite', () => {
    it('...')
    it('...')
    it('...')
  })
})
```


### Desired behavior:

- users can add test configuration in object during test/suite declaration:
```js
it('can test with config', {
    defaultCommandTimeout: 200
  }, () => {
    // test body
  })
```

- run test only in certain browsers:
```js
it('only runs in ff', {
    browser: 'firefox'
  }, () => {
  })
```
- api for excluding browsers:
```js
it('does not run in ff', {
    browser: '!firefox'
  }, () => {})
```

- can apply same options for the whole suite:
```js
describe('suite with config', {
    defaultCommandTimeout: 40
  }, () => {
	// all tests declared here will inherit the config
  })
```

### Versions

4.5.0
",enhancement
605571748,Don't retry `its()` command when passed an alias object from `cy.wait()`,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

Hi, daily cypress user here again. I noticed this behavior.

### Current behavior:

I started stubbing my server requests to make stuff faster. The following way:

```js
function stubRequest(){
    cy.server();
    cy.route({
        method: 'PUT',
        url: '/api/users/Fvgq5e8jzl8.json',
        response: 'fixture:editUser.response.json'
    }).as('saveUser');
}

function inspectRequest(){
    cy.wait('@saveUser').its('request.body').should('deep.equal', editUserRequest);
}
```

Basically my REACT app edits a user and then I click save and send the result back to the server.

However, cypress interjects and inspects the outgoing request:
`.its('request.body').should('deep.equal', editUserRequest);`

Well I noticed that cypress is `waiting`:

![image](https://user-images.githubusercontent.com/47790868/80108674-8a255d00-854a-11ea-8322-3b3be4245877.png)


### Desired behavior:

<!-- A clear description of what you want to happen -->

Why Is cypress waiting?

The desired request is known. The fired request is known.
They won't change. No need to wait.
It would make my tests faster if cypress would remove wait times by default in this context.
I can do it manually.

### Test code to reproduce

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

Look for code above.

### Versions
cypress 4.3.0
<!-- Cypress, operating system, browser -->
",enhancement
603574714,Ability to prevent/stop loading 'Page load',"Well I try to stop to load the xhr and continue my test without page load time out error
but  not working and not even  stop the xhr loading.  Please guide if im using in correct way or it is actual bug.

```js
cy.window((win) => {
  win.stop()
})
```

Try with black list as well in cypress.json file but did not work

```js
""blacklistHosts"": [
  ""https://www.deepl.com/PHP/backend/docTrans.php?request_type=jsonrpc&il=en""
]
```

this is xhr I want to stop loading
""https://www.deepl.com/PHP/backend/docTrans.php?request_type=jsonrpc&il=en""

Reason why I need this because these is 1 xhr that will load after 5 seconds and this is never ending process in my application under test.

cy version 4.4.0
OS windows 10",enhancement
603504209,How to stub OData queries?,"### Current behavior:

I would like to stub OData queries with `cy.route()`

In some case, the query is send with **$batch** option in which all the requests are embedded inside the request payload. 

If I understood well, the stubbing process start when we set an URL + a response to the `cy.route()`.

### Desired behavior:

What I would expect, is, in the `onRequest` callback function, having something to filter which request in the payload we want to stub.

For instance, in a **/$batch** request you can have 2 payload requests :
```

> --batch_7df2-992d-537d
> Content-Type: application/http
> Content-Transfer-Encoding: binary
> 
> GET SoftwareComponents(Generate='0002',Id='0004')/to_packages?$skip=0&$top=10&$orderby=IsFrentEnd%20asc&$select=DevPackage%2cFcDevPackage%2cIsFrentEnd%2cFcIsFrentEnd%2cGenerate%2cScId&$inlinecount=allpages HTTP/1.1
> sap-cancel-on-close: true
> sap-contextid-accept: header
> Accept: application/json
> Accept-Language: fr-FR
> DataServiceVersion: 2.0
> MaxDataServiceVersion: 2.0
> x-csrf-token: uDm4KNv7nmdWIaO5GfIGNw==
> 
> 
> --batch_7df2-992d-537d
> Content-Type: application/http
> Content-Transfer-Encoding: binary
> 
> GET SoftwareComponents(Generate='0002',Id='0004')/to_roles?$skip=0&$top=10&$select=Role%2cScId%2cGenerate&$inlinecount=allpages HTTP/1.1
> sap-cancel-on-close: true
> sap-contextid-accept: header
> Accept: application/json
> Accept-Language: fr-FR
> DataServiceVersion: 2.0
> MaxDataServiceVersion: 2.0
> x-csrf-token: uDm4KNv7nmdWIaO5GfIGNw==
> 
> 
> --batch_7df2-992d-537d--

```
How to stub the second GET query but not the second?

### Versions
Version 4.4.0
",enhancement
603373990,Device pixel ratio/density simulation,"I'm following the advice here :
https://docs.cypress.io/api/commands/viewport.html#devicePixelRatio

### Current behavior:

Actually we can't simulate pixelRatio/pixelDensity with Cypress.
It can be very useful for testing correct behavior around responsive images.

### Desired behavior:

Have the possibility to switch the DevicePixelRatio in cypress.

Viewport dimension changes and testing the `currentSrc` is already very useful. 
Having DevicePixelRatio in cypress would enable finer tests.

### Test code to reproduce

Not applicable as it's not implemented.

It could be another option to `cy.viewport()`

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

",enhancement
601814592,Feature Request configurable hooks for around request-middlewarw,"### Current behavior:

Developers needing specific authentication mechanism need to spin off their own proxy server, ie [cypress-ntlm-auth](https://github.com/bjowes/cypress-ntlm-auth/tree/master/src) which raises the complexity of custom authentication solution. 

### Desired behavior:

Cypress lets me configure intercept for http header and exposes the full request object to me. Some authentication mechanism like SigV4 require hashing of secrets w/ headers / body. This can be used moving forward by multiple custom authorization providers.

### Test code to reproduce
```js
Cypress.on(""before-request"", function(req, callback) {
  req.proxyToServerRequestOptions.headers['newHeader'] = getNewHeader(req.proxyToServerRequestOptions) 


  // note that this operation can result in service call / asynchronous processing to get a secret so the request should be sent when that callback is executed.
  callback();
});

```
### Versions

Version 4.4.0",enhancement
599525596,Proposal: SauceLabs Support,"### Objective:

Add support for running Cypress tests on external cloud tests provider such as Saucelabs. 

Saucelabs is a tool we use a lot to be able to launch tests on different browsers and Operative Systems. It gives you the freedom to run tests (even in parallel) on different browsers and operatives systems and you can choose the combination you needed, even the screen resolution you want to test on. 

It will be absolutely GREAT to be able to have support from you guys to be able to launch my cypress test there. 

Thanks!
",enhancement
598346515,Feature Request: WebAuthn/FIDO2 testing via virtual authenticators,"### Current behavior:

Cypress does not support any way to test WebAuthn / FIDO2 flows without mocking the authenticator, which does not allow to test all cryptographic interactions sufficiently. If a valid request is forwarded to the browser, it will be delegated out of the browser and can not be interacted with.

### Desired behavior:

Just like [Selenium implemented it end of last year](https://github.com/SeleniumHQ/selenium/pull/7760), Cypress should offer a way to use the [W3C automation API](https://w3c.github.io/webauthn/#sctn-automation) to programatically interact with the browser to manage virtual authenticators that can confirm actions without leaving the browser context.
",enhancement
598047513,Feature request: .stop() command,"Something similar to .pause() but instead of pausing the run, just make the test stop altogether. Might be useful if you need to run only part of test. Now you do it by commenting out the rest of the test.

Example:

```javascript
it('Should test a thing', () => {

  // gets executed
  cy
    .get('item')

  // similarly to .pause() is ignored in CLI 
  cy
    .stop()

  // test stops before this command, right now I need to comment this out If I want to run my test, but stop before this command
  cy
    .get('item2')

})
```

.pause() is good and all, but I cannot stop the test after it is paused, just continue or go to next step. .debug() turns on debugger, which is not the thing I necessarily need.

Alternatively, adding an option to stop run on .pause() might be sufficient 😄",enhancement
597938924,use mocha 7.0.1 in packages/server,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
we currently use mocha 2.4.5 in packages/server, which got out of sync with packages/driver in the 4.0 mocha upgrade

<!-- A description including screenshots, stack traces, DEBUG logs, etc -->

### Desired behavior:
packages/driver and packages/server should be on the same mocha version `7.0.1`
<!-- A clear description of what you want to happen -->
",enhancement
595202530,Expose event for when Cypress is about to exit,"We have a process that starts up when Cypress does, which we start from the Cypress plugins index.js, using NodeJS's `child_process`. The process is Wiremock, to be exact. We know we can use Cypress' fixtures, but for now this is not an option.

We would like an event to be implemented that we can bind to so we can kill the `child_process` when Cypress is about to exit.

On Windows the `child_process` is killed automatically, but on Linux it needs to be manually stopped, because it keeps running even after the parent process is killed.
",enhancement
592959031,Is Cypress plugin a filepath or is it a module to be resolved,"Cypress v4.3.0
Demo in https://github.com/bahmutov/try-cra-with-unit-test

Imagine I want to load Cypress plugin from 3rd party module, not from `cypress/plugins/index.js`. In that demo project I have a dependency `""cypress-react-unit-test"": ""2.8.0-use-bundler-from-cra.2""` and it includes the plugins file that should be good for an application created using `create-react-app` before ejecting. So in `cypress.json` I can set this and it works

```json
{
  ""pluginsFile"": ""node_modules/cypress-react-unit-test/plugins/cra-v3/index.js""
}
```

Now - the following works too, so to me this looks like we resolve the module 

```json
{
  ""pluginsFile"": ""node_modules/cypress-react-unit-test/plugins/cra-v3""
}
```

Hmm, let's remove `node_modules`

```json
{
  ""pluginsFile"": ""cypress-react-unit-test/plugins/cra-v3""
}
```

Nope, an error (with `[object object]` too)

<img width=""1307"" alt=""Screen Shot 2020-04-02 at 6 35 29 PM"" src=""https://user-images.githubusercontent.com/2212006/78306186-c26be980-7510-11ea-98c7-610fc7c49d34.png"">

I think it would be marvelous to try the `pluginsFile` first as a path, and if not found try to resolve as a module.",enhancement
591139758,Make adding `sameSite` value to objects yielded by `cy.getCookie/setCookie/getCookies` the default,Remove the `experimentalGetCookiesSameSite` flag and make this behavior the default for all Cypress users.,enhancement
585571049,Total time should take into account setup and teardown,"### Current behavior:

![image](https://user-images.githubusercontent.com/197597/77235624-cc870300-6b74-11ea-8ea8-2ee3be959802.png)

### Desired behavior:

The total time should be ~30s rather than 12s

### Test code to reproduce

https://github.com/excalidraw/excalidraw/pull/691
`time npm run test:e2e`

### Versions

Cypress: 3.8.3",enhancement
583170691,cy.request unable to handle `Same-Site: None` cookie for cross origin requests,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Facts:
1. `cy.request` should persist cookies received in response headers. It does it just fine except this used case described below.
2. Google just published a new update to chrome browsers which breaks cookie persistance for cross origin requests
3. This is a new issue which just occurred after receiving a chrome update this weekend. This only affects my cypress environment. When testing manually on same version of chrome it's just fine.

### Behaviour before chrome update (expected behaviour):
1. I send a `cy.request` to login to our server before running tests:

```js
Cypress.Commands.add('loginAs', (userType)=>{
    cy.request({
        method: 'POST', 
        url: `${baseUrl}dhis-web-commons-security/login.action`,
        body: `j_username=cypress-${userType}&j_password=${testPassword}`,
        headers: {
            'authority': baseUrl,
            'origin': baseUrl,
            'referer': `${baseUrl}dhis-web-commons-security/login.action`,
            'content-type': 'application/x-www-form-urlencoded',
        }
    }).then((response)=>{ 
        console.log(response);
    });
});
```
2. This was just fine and it would set a cookie for chrome browser.
![image](https://user-images.githubusercontent.com/47790868/76881686-e4e2df00-684f-11ea-8cad-5016f16294a2.png)

3. Then I can run my tests against a local instance of my app at `http://localhost:3003` while the app requests cross-origin resources from `dev.xxxx.org`. The server `dev.xxxx.org` knows I am logged in because with each request my Chrome provides session id cookie.

### Behavior after chrome update (current behavior)

1. I do my login via `cy.request` as in the case above. But cypress fails to persist the cookie due to the following Chrome security complains:

```
A cookie associated with a cross-site resource at https://dev.xxxx.org/ was set without the 'SameSite' attribute. It has been blocked, as Chrome now only delivers cookies with cross-site requests if they are set with SameSite=None and Secure. You can review cookies in developer tools under Application>Storage>Cookies and see more details at https://www.chromestatus.com/feature/5088147346030592 and https://www.chromestatus.com/feature/5633521622188032.
```

Long story short: Chrome is complaining it can't store my session id cookie because it's missing `SameSite=None and Secure` attributes.

The problem is that the attributes are NOT missing. Look at raw output here:
![image](https://user-images.githubusercontent.com/47790868/76882070-7eaa8c00-6850-11ea-91c5-f97e8b33b00f.png)

### Conclusions

I believe that cypress swallows the `Same-Site` attribute while persisting cookies from `cy.request`

A hint is is also that `cy.setCookie` is completely missing `Same-Site` parameter:
![image](https://user-images.githubusercontent.com/47790868/76882192-ae599400-6850-11ea-9ff2-810e0bbfca46.png)

### Temporary solution

1. Downgrade Chrome 80.0.3987.132
2. Use Electron instead

### Versions
1. Chrome `80.0.3987.122` or `80.0.3987.132`. It was fine with earlier versions of Chrome including (80.*)
2. Cypress 4.2.0 and 4.1.0
3. OS: Ubuntu 19.10

<!-- Cypress, operating system, browser -->
",enhancement
577010578,Temporarily escape from a cy.within(),"### Current behavior:

`cy.within()` correctly scopes inner `cy.get()` and `cy.root()` calls.

### Desired behavior:

However, I sometimes need to temporarily escape from the `cy.within()` scope.

This is especially true for commands. I need a command that searches the whole `<body>` even when it is called from inside a `cy.within()`.",enhancement
577004904,"Add new plugin events 'before:spec', 'after:spec', 'before:run', 'after:run'","Add four new events that fire in the plugins file:

* `before:run`: Fires before the run starts, with details about the run.
* `before:spec`: Fires before a spec file is run, with details about the spec file.
* `after:spec`: Fires after a spec file and its tests run, with details about the spec file and its test results.
* `after:run`: Fires after the run finishes, with the results of the run.

In `interactive` mode, the behavior is slightly different, since there isn't a discrete 'run' and specs can be re-run at will:

* `before:run` fires when opening a project.
* `before:spec` fires when the browser opens.
* `after:spec` fires when the browser closes (and may not fire at all (if, for example, you force quit Cypress).
* `after:run` fires when you close the project (and may not fire at all (if, for example, you force quit Cypress).

The `after:*` events will only receive results in `run` mode, since there's no way to aggregate results from `interactive` mode.

> Note: this is take 2 on this previous issue: #2286. This will be able to be released in the next feature release instead of waiting for the next major version.

",enhancement
576240377,`requestTimeout` and `responseTimeout` should apply individually to each request in `cy.wait([])` with array of requests,"### Current behavior:

`cy.wait()` [can be passed an array of aliases](https://docs.cypress.io/api/commands/wait.html#Arguments). This is good. However, it is not clear what the impact on the [timeout](https://docs.cypress.io/api/commands/wait.html#Timeouts) is. `cy.wait()` has 2 timeouts, `requestTimeout` and `responseTimeout`.

I guess that if before `requestTimeout` all aliases have matched, then `cy.wait()` will be happy. But what if only a few of the aliases have matched while others have not matched yet?

From my experiment, passing several aliases to `cy.wait()` means:

> ""I want all requests to be sent before `requestTimeout`""
 
### Desired behavior:

The current behavior makes sense but I was expecting a completely different semantics:

> ""I don't want to wait more than `requestTimeout` between a response is received and the next request is sent"".

I think the documentation should be improved about that so I opened [an issue on the cypress-documentation project](https://github.com/cypress-io/cypress-documentation/issues/2573).

Still, @jennifer-shehane believes that the semantics of `cy.wait()` could benefit from being changed to match what we both expect.

More information about my context: https://github.com/cypress-io/cypress/issues/6563.

### Versions

- Cypress: 4.1.0
- OS: Fedora 31
- Browser: Chromium",enhancement
575559292,Cannot specify the default running browser in cypress.json configuration file,"### Current behavior:

The only way to specify the browser to use is via CLI options `cypress --browser chrome --headless` for example. There is no field in the [configuration](https://docs.cypress.io/guides/references/configuration.html) that allows users to specify the browser and headless mode.

### Desired behavior:

To be able to specify the browser and headless mode in the JSON configuration file, for example
```json
{
  ""browser"": ""chrome"",
  ""headless"": true
}
```
Then running cypress directly via `cypress run` would use chrome headless.

### Versions
Cypress 4.1.0
Debian Buster
(from `cypress/included` docker image)",enhancement
573694957,cypress should live reload when changes made to `fixturesFolder`,"### Current behavior:

When changing `plugins` or `fixtures`, the tests opened by `cypress open` are not auto-reloaded as they are when changes are made to `cypress/integration` or `cypress/support` files.

### Desired behavior:

Unless there is some good reason for it, I would expect the pages would reload. While I can see that `plugins` might be more consequential in having unintended side-effects, so too can `support` files (which can use plugins by way of commands), I would at least think that changes to`fixtures` would trigger reloads, and I'd personally like to see changes to `plugins` be able to do so.

### Test code to reproduce

1. Run `cypress open` on some repository.
2. Open a test file
3. Modify a file in `/plugins`
4. See that the test file does not reload (nor does the command line show changes)

### Versions

<!-- Cypress, operating system, browser -->

Cypress: 4.1.0
OS: Mac 10.15.2
Browser: Firefox or Chrome",enhancement
572118283,Take into account the search pattern when running all specs in the interactive mode,"Our users are asking us sometimes to run some specs when using the interactive mode. I think the simplest way we could make them happy is to use the search pattern when the user clicks ""Run All Specs"" button.

![](https://user-images.githubusercontent.com/2212006/75453683-42b39380-5942-11ea-9e4a-42aa8f2f748e.png)

",enhancement
571884551,Namespace for custom commands,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

1. Add custom commands and use them.
2. Then:
    1. Be concerned that the name might conflict with a future cypress command name OR
    2. Become unsure whether your command (or that created by another) is built-in (and documented on the Cypress site) or if it is one of your own

### Desired behavior:

<!-- A clear description of what you want to happen -->

1. See from the command name, that a custom command is being used, e.g., `cy.custom.myCommand()`

### Test code to reproduce

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->

N/A

### Versions

<!-- Cypress, operating system, browser -->
Cypress 4.0.2, Mac 10.15.2, Firefox 74.0b7",enhancement
565812212,Feature Request: Custom error messages,"if this is not the right place for feature-request, I apologize.

I have an idea for more project-individual error messages:

```javascript
cy.get('my-element > li.product-widget')
  .pinCustomError('ops! not enough product widgets were rendered')
  .should('have.length', 12)
  .unpinCustomError()
```

When some error is thrown between a `.pinCustomErrro(msg)` and `.unpinCustomError()` the original error message gets replaced with the provided message. That would make the errors way more descriptive

another example:

```javascript
cy.pinCustomError('product widget did not render')
  .get('.product-widget')
```
As a developer I write a lot of tests. An error like `CypressError: Timed out retrying: Expected to find element: '.product-widget', but never found it.` may not really tell me why the test failed. especially if it is a way more complex test than above.

Custom error messages could really help me to identify the problem faster for tests i wrote months ago. This implementation should be flexible enough to hande several use-cases. Another nice side-effect would be, that i can document my tests this way",enhancement
563642599,Proposal: IE 11 Support,"> **Current Status** - _last updated February 11, 2020_
> 
> ✅ Under Consideration
> ❌ Not Prioritized
> ❌ Not Under Active Development
> ℹ️ _Cypress currently supports [Firefox](https://cypress.io/blog/2020/02/06/introducing-firefox-and-edge-support-in-cypress-4-0/) and Chrome-family browsers (including Edge and Electron)_.

**Objective**
---
Add support for running Cypress tests within the [IE 11](https://en.wikipedia.org/wiki/Internet_Explorer#Internet_Explorer_11) web browser.
> **IE 11 End of Life**
> According to Microsoft, development of new features for Internet Explorer has ceased. However, it will continue to be maintained as part of the support policy for the versions of Windows with which it is included.
> _Source: [Wikipedia](https://en.wikipedia.org/wiki/Internet_Explorer#End_of_life)_

> This is a **placeholder proposal issue**. Necessary details will be added **once this feature is prioritized**. 
",enhancement
563638573,Proposal: Safari (WebKit) Support,"> **Current Status** - _last updated February 23, 2021_
> 
> ✅ Prioritized and on the roadmap
> ✅ Doing exploratory work to assess requirements and timelines
> ❌ Not under active development
> ℹ️ _Cypress currently supports [Firefox](https://cypress.io/blog/2020/02/06/introducing-firefox-and-edge-support-in-cypress-4-0/) and Chrome-family browsers (including Edge and Electron)_.

**Objective**
---
Add support for running Cypress tests within WebKit, which is the engine used by the [Safari](https://www.apple.com/safari/) web browser.




",enhancement
563252039,"""Can't start server"" error is confusing","<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

Any project error in GUI mode will present an error titled ""Can't start server"" without a stacktrace which isn't helpful to the user.

### Desired behavior:

1. Error is retitled to something else more relevant
2. Known error sources are caught and wrapped (for example, errors during browser launch/plugin registration should be presented as such)
3. Stacktrace should be available via an expando
",enhancement
562843510,"Print folder sizes with ""cypress cache list"" command","To improve ""cypress cache list"" in v4, which right now just prints list of versions

```
$ npx cypress cache list
3.0.1, 3.0.2, 3.0.3, 3.1.0, 3.1.1, 3.1.2, 3.1.3, 3.1.4, 3.1.5, 3.2.0, 3.3.0, 3.3.1, 3.3.2, 3.4.0, 3.4.1, 3.5.0, 3.6.0, 3.6.1, 3.7.0, 3.8.0, 3.8.1, 3.8.2, 3.8.3, 3.8.4, 4.0.0, 4.0.1
```

It would be nice to print a table with version number, folder size, maybe last access time (today, 2 days ago, a month ago, etc)",enhancement
561284110,Plugins need to know the Cypress version running,"Cypress v4

We don't include the Cypress version in the config passed to the plugins, but it would be really nice, especially to handle breaking changes.

",enhancement
559150686,Make it possible to support no_proxy environment variable for download,"
### Current behavior:

When downloading Cypress, the no_proxy environment variable is not taken into account.

![image](https://user-images.githubusercontent.com/9371059/73665135-86471480-4698-11ea-94cc-011e58c21275.png)

### Desired behavior:

When downloading, I want Cypress to be able to use the no_proxy environment so that it doesn't go through the company proxy. Using CYPRESS_INSTALL_BINARY and downloading manually isn't really a solution as we don't want CI/CD build agents to download cypress every time. Installing cypress on every build agents doesn't seem like the best solution either.

### Versions
Cypress: 3.8.3

",enhancement
557845632,Create a toggle to close/open all folders in Tests list,"**Current Behavior:**
Currently there seems to be no way to have all your folders defaulted to close when you open up Cypress.

The results is a messy UI that isn't as clean when you try and organize your many Cypress tests into folders.

**Desired Behavior:**
Have a setting option to default your folders to close on Cypress open that way you can navigate a cleaner interface when you organize your multiple tests into their appropriate folders.

![Screen Shot 2020-01-30 at 4 46 20 PM](https://user-images.githubusercontent.com/6404079/73503230-8dacac00-4380-11ea-9a1c-f5da020361ef.png)
",enhancement
556757479,Option to keep the Command Log sections opened or closed (collapsed) by default,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

<!-- A description including screenshots, stack traces, DEBUG logs, etc -->
Long story short; I use Cypress at work and performance is scarce (probably since we are using VDIs), but the tests will run around four times faster when I collapse all subsections in the Command Log.

During headless runs it's not even possible to interact with the Command Log, so a test suite with ten files that usually takes around 30 minutes will instead take a few hours.

### Desired behavior:

<!-- A clear description of what you want to happen -->
I want a new option in cypress.json (something like `keepCommandLogSectionsClosed` but a bit shorter...) that, when set to true, keeps the Command Log subsections collapsed by default during test runs.

Behavior when disabled (default) | Behavior when activated
--- | ---
![cypress1](https://user-images.githubusercontent.com/17113053/73275815-fad90980-41e7-11ea-87fd-748a309591fb.png) | ![cypress2](https://user-images.githubusercontent.com/17113053/73275832-ff052700-41e7-11ea-88f1-b36d20bc01fc.png)

I might add that any errors that occurs will still be visible:

![cypress3](https://user-images.githubusercontent.com/17113053/73277443-76d45100-41ea-11ea-84bc-e7d6b1ebd5fb.png)

### Test code to reproduce

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->
N/A

### Versions

<!-- Cypress, operating system, browser -->
3.8.3",enhancement
556119955,Feature request: quickly isolating the failing tests through filter,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behaviour:
When running multiple (and long E2E tests), it's hard to quickly find which ones are failing in the list.

![Actual behaviour](https://user-images.githubusercontent.com/3874873/73068806-6cdde580-3eac-11ea-8d7f-602848f3db6e.gif)

### Desired behavior:
Having a quick way to jump on the failing tests without losing time scrolling. Filtering by test suite state could be an option.

",enhancement
555812454,Allow passing XVFB parameters via env variable,"Similar to #804 (same pull request should close both this and #804)

In the line below we explicitly initialize Xvfb screen. We should allow overwriting these values with user values from an environment variable, for example

```
XVFB_ARGS=-screen 0 1280x1024x24
```

https://github.com/cypress-io/cypress/blob/c29f38305aeb2ba41b34fdf40c39ec75e68a4f2c/cli/lib/exec/xvfb.js#L14

The `XVFB_ARGS` would be parsed from a single string into an array of strings using spaces as separators and passed into Xvfb object. Might be a good idea to print parsed values to STDOUT to let the user know that non-default values are used.",enhancement
555613712,Multiple tabs support,"Before dismissing the issue, hear me out please

> The sweet spot of Cypress is to be used as a tool to test your own application as you build it. It is built for developers and QA engineers, not manual testers or exploratory testing.

Reading the docs - 

>  we don’t believe there is any use case for testing the browser’s native behavior. You should ask yourself why you are testing that clicking an <a href=""/foo"" target=""_blank"" opens a new tab. You already know that is what the browser is designed to do and you already know that it is triggered by the target=""_blank"" attribute.

I beg to differ.

This is a classic case of integration test in specific kind of applications - payment applications, where a large number of payment providers (i.e Adyen) require a flow for 3DS1 to open a new window via POST, enter fields, and return to the rest of the flow. 

As I see it, cypress helps in checking integration tests of these kind, where control of the browser is handled by cypress via code. Switching tabs, opening and closing them, having several windows communicate via web socket or similar and testing how they work is essential for a complete suite of browser testing. 

> Only test the underlying thing that causes the behavior you care about testing.

which is exactly what supporting these kind of edge cases is all about. 


Please reconsider supporting this",enhancement
554353417,Ctrl+F to set focus on the search bar,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

<!-- A description including screenshots, stack traces, DEBUG logs, etc -->
Pressing Ctrl+F does nothing at the moment as this keybinding seems not be bound to anything.

### Desired behavior:

<!-- A clear description of what you want to happen -->
I want said keybinding to set focus on the search bar in the GUI (and select all existing text), since I'm using the search bar quite often to find files.

### Test code to reproduce

<!-- If we cannot fully run the tests as provided the issue WILL BE CLOSED -->
<!-- Issues without a reproducible example WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then link to your fork -->
N/A

### Versions

<!-- Cypress, operating system, browser -->
3.8.2 and older",enhancement
550542283,Feature Request: collapse before each / after each,"### Current behavior:

When running tests in the Cypress UI, the `BEFORE EACH` and `AFTER EACH` sections are always expanded. This causes cognitive overhead as I need to scroll to identify and view the `TEST` results.

### Desired behavior:

I would like there to be a config option to automatically collapse (repetitive) `BEFORE EACH` and `AFTER EACH` sections. This would allow me to focus on the `TEST` results, not the test setup and teardown.

### Test code to reproduce

N/A

### Versions

Cypress 3.8.2, Chrome 79.0.3945.117, Mac OS 10.14.6
",enhancement
550355181,Detect browser/renderer crashes ,"<!-- Is this a question? Questions WILL BE CLOSED. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

Cypress doesn't know if the browser tab crashes during a test.

### Desired behavior:

Cypress detects browser tab crashes/browser crashes and exits cleanly after printing some debug information.

Dependency of: #349 
",enhancement
538974073,Support switching off the default test run result output,"It is a proposal

### Current behavior:

First described in https://github.com/cypress-io/cypress/issues/5833

I set a reporter in the config.
And then I have mixed output from default spec reporter with the reporter I have set-up.
For some reason spec still outputs and my specified reporter adds dots or cats in between.

```
Running:  backend/settings/my.spec.js                   (4 of 5)


  ․․

  2 passing (11s)


  (Results)

  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐
  │ Tests:        2                                                                                │
  │ Passing:      2                                                                                │
  │ Failing:      0                                                                                │
  │ Pending:      0                                                                                │
  │ Skipped:      0                                                                                │
  │ Screenshots:  0                                                                                │
  │ Video:        true                                                                             │
  │ Duration:     11 seconds                                                                       │
  │ Spec Ran:     backend/settings/my.spec.js                    │
  └────────────────────────────────────────────────────────────────────────────────────────────────┘

```

**Why is it a problem?**

Cypress floods the CI output with not needed information. Other tools like Jest + Puppeteer, Behat, PHPUnit are providing just dots output for the test result and it is very useful for CI.
And it looks like that in CI output
```
...........................................
```
And I see the full output only in case of error.

### Desired behavior:

I have an option in the config to not only choose a custom or mocha reporter but also to switch off the default output.

```
reporterDefaultOutput: false
```

In this case, the only reporter specified in `reporter` config option outputs to console. I should see only dots in the case of `dot` reporter specified in the config and the default output is switched off.

### Steps to reproduce: (app code and test code)

Set
`""reporter"": ""dot""`
or
`""reporter"": ""nyan""`

in cypress.json. do `cypress run`, see the mixed output.

### Versions

Cypress 3.8.0
",enhancement
538971061,Support connection to remote browser,"It is a proposal.

### Current behavior:

Currently, all browsers for Cypress runner should be installed on the same host (or same container).
It makes it hard to have custom setups in complex projects with a lot of services connected via Docker.

### Desired behavior:

Support possibility to connect to remote Chrome browser via WS, running locally or in the container.

For example, when using e2e testing with Jest + Puppeteer setup, I can use a separate Chrome container and just set a remote chrome address in config.
```
connect: {
    browserURL: 'http://127.0.0.1:9222'
}
```

### Steps to reproduce: (app code and test code)

There is no such option yet.

### Versions

Cypress 3.8.0",enhancement
536596786,Authentication events for plugins,"### Current behavior:

Plugins cannot interact with the http traffic through the plugin API. The only way to build a authentication plugin today is by using an external proxy process.

### Desired behavior:

A plugin API for authentication. 
#### auth-request event
In essence there would need to be an ""auth-request"" event in the plugin API, which is triggered when Cypress receives a 401 response with a `www-authenticate` header. The API call should pass at least the following arguments:
* content of the `www-authenticate` header (or headers) 
* client endpoint (at least port)
* server endpoint (hostname, protocol, port, path)

The auth plugin should then return the content for an `authorization` header to be used in the next request to the server. Cypress should then resend the previous request with this new header set. If the auth cycle is complete (non 401 response), all is well. If not, another call to the auth plugin may be required. (Some protocols require just one rountrip while others require two roundtrips).
The auth plugin could also return null if it does not support the required authentication protocol. 

#### auth-free event
To allow the plugin to clean up authorization states, there should be an additional ""auth-free"" event, which should be called when the client socket is destroyed. 

#### Auth method registration
A possible addition could be that the plugin should register which authentication methods it supports during initialization. This would simplify a scenario where multiple auth plugins are used simultaneously to cover different methods.

#### Benefits
As the developer of the NTLM authentication plugin [cypress-ntlm-auth](https://github.com/bjowes/cypress-ntlm-auth) I see many benefits with the suggested auth plugin API.
* No external proxy would be required to deal with authentication
  - greatly reducing the complexity for developers to develop authentication plugins
  - better performance
* Cypress is aware that authentication is performed
* An auth plugin could be used also for proxy authentication

#### Help needed?
If this suggestion makes sense to you, I would be happy to assist in making it happen.

### Steps to reproduce: (app code and test code)

No reproduction, this is a feature request.

### Versions

All versions, All OS, All browsers
",enhancement
535639015,RFC: Improve component based tests approach,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
The current state of cypress ""unit tests"" (they are actually end-to-end tests if you are building components library/design systems/everything) is completely unusable.
For example library https://github.com/bahmutov/cypress-react-unit-test is not allowing to tests portals approach,  impossible to test CSS-in-js, and anything that needs access to the document object, approach. 

### Reason
The main problem: when we want to render the application from the tests (like we have `cy.mount`) we understand that our tests are running from the different iframe. And this is the main problem for the component-based tests approach. 

### Request for change:
I propose to add a new config field like `mountMode: true` and just load an application right to the `.aut-frame`. This will fix all the problems 
> P.S. Already have a working code example will make a PR right in a few mins
> P.P.S I believe that cypress tests for components can take over the world. Because this is much more reliable than jest, enzyme, testing-library or anything. Moreover, it is super interactive so it is possible to use it as a kind of replacement for storybook. 

",enhancement
535021781,Allow configuration of `capture` option for screenshots taken during failure,"### Current behavior:
When my test fails, the screenshot taken is always captured in the `runner` size as per the documentation: https://docs.cypress.io/api/cypress-api/screenshot-api.html#Arguments:
>  For screenshots automatically taken on test failure, capture is always coerced to runner.

 I was curious, why that's the case? I think it'd be beneficial to be able to override this configuration even for the screenshot on failure:
```js
Cypress.Screenshot.defaults({
  capture: 'fullPage'
})
```
Often times I find myself looking at a failure video where Cypress can't find an element and I'm only seeing a portion of the page which isn't really helpful.

### Desired behavior:
When I configure Cypress to capture screenshots like so:
```js
Cypress.Screenshot.defaults({
  capture: 'fullPage'
})
```

I expect Cypress to take screenshot of the Full Page on failure rather than always taking `runner` despite the configuration.

### Versions
Cypress `3.7.0`, MacOS: `10.14.6`
",enhancement
534865191,Support npm_config_no_proxy configuration,"### Current behavior:

I am on Windows Server 2016 and have in the windows proxy settings (the one chrome uses) a proxy and a proxy exception set. These settings were not used.

The settings were taken from NPM config, however NPMs noproxy setting is not used.
In Cypress settings: ""Cypress auto-detected the following proxy settings from environment variables:"", which is incorrect, they were taken from the NPM settings.
Also NPM proxy settings is not mentioned in the documentation (https://docs.cypress.io/guides/references/proxy-configuration.html).

Also noticed when looking for my options to solve the problem, when the environment variable NO_PROXY is set, ""127.0.0.1', '::1', 'localhost"" was concatenated.

I can not use npm run script, as on Windows multiple commands are not working.

Using vscode PowerShell terminal with disabled proxy: 
$env:HTTP_PROXY=''; $env:HTTPS_PROXY=''; ./node_modules/.bin/cypress open 

### Desired behavior:

Fix/document behaviour.

### Versions

<!-- Cypress, operating system, browser -->
Cypress 3.7",enhancement
533797396,Take screenshots using Chrome DevTools Protocol ,"### Current behavior:

Cypress screenshot algorithm is complicated and has introduced several challenges.

- Cypress doesn't take correct snapshots in 'fullPage' mode in Electron and Chrome browsers https://github.com/cypress-io/cypress/issues/5876
- Screenshot of webGL content does not render anything https://github.com/cypress-io/cypress/issues/5792
- Chance of race condition when using screenshot() https://github.com/cypress-io/cypress/issues/3276
- Screenshot ""scroll and stitch together"" functionality does not play nicely with React Single Page Apps https://github.com/cypress-io/cypress/issues/2681
- Full page screenshots are not rendering as expected https://github.com/cypress-io/cypress/issues/2348

### Desired behavior:

Now that #4628 is merged, Cypress has access to Chrome's Debugger Protocol which could be used to take screenshots. 

Page.captureScreenshot docs: https://chromedevtools.github.io/devtools-protocol/tot/Page/#method-captureScreenshot

### Challenges

- This would only be usable in Chrome browser and not extensible to other browsers, so we would have to maintain the other screenshot algorithm anyway unless there are comparable substitutions for other browsers.

### Versions

3.7.0
",enhancement
531613918,Upgrade Electron to 7.1.4,"PR: https://github.com/cypress-io/cypress/pull/5849

### Current behavior:

Electron version is 5.0.10

### Desired behavior:

Latest Electron is 7.1.4, use Electron 7.1.4
",enhancement
530591918,Support for multiple preprocessors,"I haven't found any information in the docs about support for multiple preprocessors.

I've used the webpack preprocessor in some projects, and the cucumber proprocessor i others. For my new project, I'd like to use them both.

I tried adding two `on('file:preprocessor') like this:

```js
	on('file:preprocessor', cucumber())
	on('file:preprocessor', wp({
		webpackOptions: require('../../webpack.config'),
	}))
```
but then it doesn't preprocess the .feature files.

Any advice?",enhancement
529553393,Feature request: --cypress-env-file flag,"I have various different ""scenarios"" that are saved in cypress.env.json-like files.  It would be favorable if I could override the file to be used as the `cypress.env.json` file at the command line.

Something like:

`$ cypress open --cypress-env-file=cypress.env.my-test-scenario.json`
",enhancement
528848985,Pass additional arguments to child process when loading plugin file,"### Current behavior:

When writing a custom plugin and trying to debug it (e.g., from VSCode), we cannot do this, because the plugin is loaded with `fork` without initial Node.js arguments.

### Desired behavior:

The following Node.js arguments are passed to the child process:

- `--inspect-brk`
- `--inspect-port`
- `--inspect`
- `--require`
",enhancement
527586434,"""Timed out Retrying"" should indicate timeout value","I just started using Cypress in the last 30 min and already love it.

I love the work put into the custom error messages and would like to contribute.

I just wrote my first test asserting that 

```js
cy.get('body').contains('VERSION=latest2', {timeout: 10000})
```

which failed with

> CypressError: Timed out retrying: Expected to find content: 'VERSION=latest2' within the element: <body> but never did.

In the future, I think I would have an easier time troubleshooting this if the error mentioned the timeout that was specified:

> CypressError: Timed out retrying: Expected to find content: 'VERSION=latest2' within the element: <body> **within 10 seconds** but **didn't during this time**.

Thanks for your time.",enhancement
525976814,`cy.its()` should support `number` as an argument,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

```
CypressError: cy.its() only accepts a string as the first argument.
```

### Desired behavior:

```
CypressError: cy.its() only accepts a string or a number as the first argument.
```

### Steps to reproduce: (app code and test code)

```js
cy.wrap([]).its(0)
```",enhancement
525900273,Cypress does not bypass a domain properly ,"Hi!
I work in an organization that uses PAC. From the cypress specifications I have to use:

_If your organization uses a PAC file, contact a network administrator to ask what HTTP proxy you should be using to access the general Internet, then use that proxy with Cypress._

However, I can't use a proxy for my project, because ""internal"" calls should be called just without a proxy. The portal works only in the intranet and without proxy. 

This is the response from the support team (from my organization):

_Please clarify with cypress team, if no PAC can be used, then tool must be adjusted so that no proxy is used because ""internal"" calls should be called just without a proxy._

So I used NO_PROXY, like in the Cypress documentation says and the domain from my project is bypassed (at least it says in Cypress Settings)

`""test:no_proxy1"": ""set NO_PROXY=int....at.inside && npm run test:open"",`

![image](https://user-images.githubusercontent.com/28535063/69254585-c5e08300-0bb6-11ea-8993-afb6c13b688a.png)

However, if I try to run a test case I get this error:
![image](https://user-images.githubusercontent.com/28535063/69255052-7189d300-0bb7-11ea-8e42-53863f3aa30b.png)

From this, I understand that Cypress doesn't actually bypass the domain that is set. 



",enhancement
524256809,Allow clicking to set the caret position in ContentEditable components.,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

Clicking anywhere on a `contenteditable` box (such as `input`) always places the caret at the end of the word.

### Desired behavior:

We should be able to choose where the caret is placed when clicking, such as at the start, or 3 characters in, for instance.

### Steps to reproduce: (app code and test code)

<!-- Issues without reproducible steps WILL BE CLOSED -->

Same as this issue: https://github.com/cypress-io/cypress/issues/2857

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

### Versions

<!-- Cypress, operating system, browser -->
Cypress: 3.3.1
OS: MacOS 10.15 Catalina
React: 16.10.2
Browser: Chrome Version 78.0.3904.97 (Official Build) (64-bit)",enhancement
522438338,`cy.type` accept keyboard shortcut syntax to release modifiers,"currently, in order to simulate the user pressing ""`ctrl+b`hello world"", you would need two `cy.type` commands if you want to simulate releasing the `ctrl` key after the `b`:
```js
cy.get('...').type('{ctrl}b').type('hello world')
```

We should introduce a new syntax `{<mod>+<key>}` to specify you want to press-and-release the ctrl key after one (or more) key:

```js
cy.get('...').type('{ctrl+b}hello world')
```
",enhancement
521733090,"Cypress config files should support ""extends"" option","### Desired behavior:

TypeScript config files (`tsconfig.json`) allow the user to ""extend"" an existing file, e.g.:

`tsconfig.json`:
```json
{
  ""someOption"": ""value"",
  ""someOption2"": ""value2""
}
```


`tsconfig.test.json`:
```json
{
  ""extends"": ""./tsconfig.json"",
  ""someOption"": ""value3""
}
```

The end result is that the TypeScript compiler sees `tsconfig.test.json` as this:

```json
{
  ""someOption"": ""value3"",
  ""someOption2"": ""value2""
}
```

This allows the config files to remain DRY and avoid duplicating data, but still have multiple files for different scenarios.

Now that cypress has the `--config-file` option, I think `cypress.json` should support this too.",enhancement
521629633,Request: expose BrowserWindow instance,"### Desired behavior:

Would be great if the Electron's BrowserWindow would be exposed to us in the plugins file. Is there some technical limitation preventing it?

```js
module.exports = ( on, config ) => {
  on('before:browser:launch', (browser, args, /* --> */ browserWindow) => {
    if ( browser.name === 'electron' ) {
      // browserWindow supplied here
    }
  });
});
```

### Why?

- Ability to customize behavior, such as changing how the browser should behave when downloading files (to auto-accept download prompt), etc.",enhancement
521280860,Feature: Run until test fails (debug flakey/intermittent errors),"Add a way to keep re-running the test-suite until you run into a failure. When debugging flakey, intermittent failures, it would be nice to just keep retrying the tests until something fails. I don't want to keep pressing re-run manually.

This could be accomplished with `cypress run` and some outside scripting on top of it but I want to do this inside the `cypress open` test runner. Using `cypress run` is also tough to get useful info out of when a failure happens but this is being tracked by https://github.com/cypress-io/cypress/issues/448

There is a **Run all tests** button in the UI but it only re-runs the test suite once. I want to keep retrying the test suite until some test fails.

![](https://i.imgur.com/sQ33x28.png)

---

Related issues but mainly around retrying failed tests,

 - https://github.com/cypress-io/cypress/issues/518
 - https://github.com/cypress-io/cypress/issues/1599
 - https://github.com/cypress-io/cypress/issues/4886",enhancement
519270081,cy.getCookie() do not support path option,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

My cookies are stored using a path= ""/fr-FR"". I cant read those cookies using `cy.getCookie` since I can't specify the path in the options.

`cy.setCookie` supports path in his options.

### Desired behavior:

I want to be able to specify `path` in the `cy.getCookie` options like `cy.getCookie(""auth"", {path: ""/fr-FR""})` in order to read the cookie store un a specific path

### Versions

Cypress version : 3.4.1
OS : MACOS MOJAVE v 10.14.6
",enhancement
519214310,Do not truncate cy.log() in Command Log,"This is a feature request.

### Current behavior:

Long messages in `cy.log()` gets truncated to a single line. On screenshots the panel of cyress is always very narrow, so the log is almost never readable.

![screenshot_165](https://user-images.githubusercontent.com/227391/68385575-61570a00-015a-11ea-93c4-78ce020e50b4.png)

### Desired behavior:

It would be great to *not* truncate or at least support a flag to disable the truncation in `cy.log()`. Especially URLs and other import informations should be displayed.

![screenshot_166](https://user-images.githubusercontent.com/227391/68385589-6916ae80-015a-11ea-849c-c208f6ccfef3.png)

### Steps to reproduce: (app code and test code)

```js
  it(""example"", () => {
    cy.log(""Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et"");
    cy.log(""https://docs.cypress.io/api/commands/log.html#Syntax"");
  });
```

### Versions

3.4.1 to 3.6.0
chrome78

### Details

The following CSS rule is responsible for all message-types (`cypress_runner.css:4016`):

```css
.reporter .command-message {
  white-space: nowrap;
   ...
}
```

Maybe add a style just for the log (or all entries like URLs in cy.request()?):

```css
.reporter .command-name-log .command-message {
  white-space: initial;
  word-break: break-word;
}
```


",enhancement
515888990,Support disabling cookies in request headers,"Hi Team Cypress,

There are cases where one would want to test flows in cookie disabled browser/webviews.

https://docs.cypress.io/guides/references/configuration.html#Browser

If there is a user agent that can mimic a cookie disabled browser, then that would be great but unfortunately I could not find one (Any idea?)

Or if Cypress can help support this via config and disable request header cookies.


Thank you.",enhancement
515640162,Accept option to `click` to send mouseout events after click,"currently, we wait until the next `click` or `type` command in order to send `mouseout`/`mouseleave` to the previously clicked element.

Since we wait to fire the mouse leave events, event-listener tooltips will stick around until the next mouse command, which users might want to disable

We should accept a new option `{ unHoverAfterClick: true }` to fire mouse leave events after the click

### related
#5500 ",enhancement
513795682,Allow visiting `about:blank` during test / before each / after each,"### Current behavior:

`cy.visit('about:blank')` navigates to `http://url/base/about:blank`

### Desired behavior:

`cy.visit('about:blank')` navigates to `about:blank`

### Versions

3.4.1

### Background

In our application we register some listener on storage events. During before each cypress cleans the storage. This results into failing in our application, because our application is still running from the previous test case.
It should be possible to leave our application for example in after each by visiting `about:blank`.

I think the easiest way would be adding another option parameter to the visit command to skip adding base url to the target url:
https://github.com/cypress-io/cypress/blob/49f5b3e80c56e382b3cbd37c6deedda7389c32b7/packages/driver/src/cy/commands/navigation.coffee#L555-L563

Our current workaround is patching the register event listener method on `window:load`.",enhancement
513604883,support mobile touch events,"in mobile mode:
- support touchstart / touchend 
- correctly fire pointerleave / pointerout immediately before click as seen in the order below: 
![19-10-28_17:46::17](https://user-images.githubusercontent.com/14625260/67724694-35978f80-f9b6-11e9-9869-ca20b2e6d61b.png)
",enhancement
511766802,Support Microsoft Edge,"### Current behavior:

Microsoft Edge is not supported.

### Desired behavior:

Microsoft Edge is supported. Although this issue is specifically about Anaheim (v74+), support for Spartan (v20-v44) would also be welcome. Given that Anaheim is pretty much the same as Chrome, this shouldn't be a major change, but it would allow Windows users to not have to install Chrome just for Cypress.

### Steps to reproduce: (app code and test code)

N/A

### Versions

Microsoft Edge 74+",enhancement
509813200,GUI - Tests navigation sidebar alignment (bottom/top/left/right),"Please allow to choose tests sidebar navigation to be at the bottom or top.. I would like to use that window on my vertical monitor.. so I have like 3 split screens:
- top - actual site
- middle - tests navigation
- bottom - dev tools
thx",enhancement
509741265,ViewPort is not setting the view of the page according to parameters ,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

<!-- images, stack traces, etc -->I am setting the viewport to ""Iphone-6""
 and it is not giving back right behaviour in response. 
### Desired behavior:

<!-- A clear concise description of what you want to happen --> It should change the view of the website according to parameters passed in it. 

### Steps to reproduce: (app code and test code)

<!-- Issues without reproducible steps WILL BE CLOSED -->
```js
it(""should take the screeshot of google in Iphone-6"", () => {
        cy.viewport(""iphone-6"")
        cy.visit(""https://www.google.com"")
        cy.screenshot()

    })
```
<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

### Versions
Cypress: 3.4.1
Operating System: Macbook
Browser: Electron/ Chrome
![This will test Dashboard route -- should take the screeshot of google in Iphone-6](https://user-images.githubusercontent.com/50403616/67179106-b242d080-f3ee-11e9-92eb-516b2cd1857e.png)

<!-- Cypress, operating system, browser -->
",enhancement
508064393,Fail a test when errors occur in the Vue JS pipeline ,"I would like to fail a test if any errors occur within the Vue JS pipeline like within event handlers etc. Vue has it's own built in error handling so errors are handled, thus a Cypress test will never see them.

I have found a way to call into Cypress from the `Vue.config.errorHandler` in my app:

```js
        Vue.config.errorHandler = (err, vm, info) => {
            const er = ""Error in "" + info + "": \"""" + (err.toString()) + ""\"""";
            const cy = (window as any).Cypress;
            if (cy && cy.onVueError) {
                cy.onVueError(er);
            }
        };
```

In the Cypress commands.js file I have:
```js
Cypress.onVueError = function(err) {
    assert.isNotOk(err, err.message);
}
```

Now the trick is how can I fail the currently running test from `Cypress.onVueError` without trying to access the DOM to force a failure? 

Why is there no `cy.fail(""reason"")` method in Cypress for special cases like this? I could not find anything like this in the docs.

It seems like Cypress should handle this on it's own or at least have a plugin or something.


",enhancement
508053674,Proposal: add option to pass in an array of fixtures to cy.fixture,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
Currently, in order to load multiple fixtures you have to do something like [this](https://github.com/cypress-io/cypress-example-recipes/blob/master/examples/fundamentals__fixtures/cypress/integration/multiple-fixtures-spec.js) or [this](https://github.com/cypress-io/cypress/issues/2932)

<!-- images, stack traces, etc -->

### Desired behavior:
It would be really nice from a user perspective if we could load multiple fixtures like so:
```js
cy.fixture(['file1', 'file2']).then(files => {
    cy.log(files); // [ firstFile, secondFile ]
}
```
Why this would be nice is that it makes the code a lot neater as well you don't have to navigate through callback hell especially if you're trying to load more than two or three fixtures at once. Personally, This would be nice to have for something like file uploads where you potentially want to upload more than one file at a time.
<!-- A clear concise description of what you want to happen -->

### Steps to reproduce: (app code and test code)
See links.
### Versions
Chrome: latest
Cypress: 3.4.1
<!-- Cypress, operating system, browser -->
",enhancement
500101607,Ability to define multiple 'on' events in pluginsFile without overwriting previously defined,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
The last declaration of the on before hook is being executed using `cypress open`

### Desired behavior:
In this example, i'm expecting both before browser launch's to execute.

<!-- A clear concise description of what you want to happen -->

### Steps to reproduce: (app code and test code)

Add following code to `plugins/index.js`
```js
module.exports = (on, config) => {
  on('before:browser:launch', (browser = {}, args) => {
    console.log('WONT GET CALLED', args);
    return args;
  });

  on('before:browser:launch', (browser = {}, args) => {
    console.log('WILL GET CALLED', args);
    return args;
  });
};
```

<!-- Issues without reproducible steps WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

### Versions
v3.4.1, MacOS Mojave, Chrome / Electron
<!-- Cypress, operating system, browser -->
",enhancement
499039004,"Proposal: allow configuration file to be 'js', not 'json'","# Goal

Simplify Cypress configuration

# Why

Why is this important? Why is it a priority?

* Currently, allowing configuration from multiple different places (`cypress.json`, `cypress.env.json`, `pluginsFile`) is confusing and difficult to document well
* Users need to specify different configuration based on environment (https://github.com/cypress-io/cypress/issues/909), which doesn't work with `cypress.json`
* It's not possible to use comments in `cypress.json`

Related:
* Unable to use deeply nested configuration (https://github.com/cypress-io/cypress/issues/1736)

# Implementation

* Get rid of `cypress.json` and `cypress.env.json`
* Move the `pluginsFile` to `<projectRoot>/cypress.js`
* All configuration is from what's returned from `cypress.js`

# Questions

- Can/should we support TypeScript/CoffeeScript/etc (`cypress.ts`, `cypress.coffee`)?
- How do we handle writing the `projectId` when a user sets up their project to record
- Should we change the API of `cypress.js` to be different from the current API of the `pluginsFile`. Since it's the only way to configure Cypress, it might be good to make the use-case of only using it for configuration easier. Instead of:

```js
module.exports = () => {
  return {
    baseUrl: 'http://localhost:1234'
  }
}
```

We could allow them to export an object if they don't need to register events:

```js
module.exports = {
  baseUrl: 'http://localhost:1234'
}
```

# Research

## How other projects deal with TypeScript/CoffeeScript for config files

* Webpack supports it: https://webpack.js.org/configuration/configuration-languages/#typescript
* Jest does not support it (must be `.js` or `.json`)
* Looks like webpack is using this: https://github.com/gulpjs/interpret (Not a huge fan of that much documentation just to support configuration in typescript... but I do understand that users will want this.)

# Notes

- I would go with always requiring a function the same way we do with plugins to avoid needing to do error handling and documentation in two different ways

---

via @brian-mann 

Another change is that we will need to resolve default configuration and overrides **prior** to calling the config function so you can utilize those values.

Before it was...

- cypress.json
- env var overrides
- cli arguments

now it will be...

- env var overrides
- cli arguments
- cypress.js

which means we need to pass the defaults along with the overrides to the function so it can continue to change them.

```js
// something like this
module.exports = (defaults, overrides) => {}
module.exports = (defaultsIncludingOverrides) => {}

// or the jest approach
const { defaultConfigurationOptions } = require('cypress')

module.exports = (overrides) => {}
```

I think we also need to decide what to do with `env` and whether or not this should be set as a property of the default configuration or not.

We either need to keep it separate or merge it with the config.

```js
module.exports = (env, config) => {}
module.exports = (envWithConfig) => {}
```

Right now its confusing because you work with it separately in the driver with `Cypress.env(...)` but it ends up being a property on `config`, but is set through a separate CLI flag: `--env`.

It should be either a separate thing or a part of config.

EDIT: we may not want to change the order of resolving the env + config else this would force the user to **always** merge the overrides in, else they'd be ignored. That would also force the user to have a valid `cypress.js` which we want to make optional.

Disregard what I said above about setting overrides. We could go with the `defaultConfigurationOptions` since that is separate (or perhaps yield that in) but keep resolution to happen downstream.

---

via @brian-mann 

To make matters even more confusing... `CYPRESS_` env vars are special in that they...

1. can override configuration if they match a configuration option
2. are automatically set onto `config.env`

This was done a long time ago because without the ability to execute anything in `node` it was difficult to set environment variables in the traditional way and know that the user wanted them in the driver. It would be a vulnerability to just automatically attach everything on `process.*` onto `Cypress.env()`.

Anyway with the ability to write configuration, setting env vars becomes much easier because you can just do the ones you care about.

```js
module.exports = (something) => {
  return {
    env: {
      ...process.env,
      someValue: process.env.whatever
    }
  }
}
```

If we want to allow overriding configuration we could continue to accept env vars but namespace them like `CYPRESS_CONFIG_BASE_URL=...`

Setting a `CYPRESS_FOO` would no longer mean anything, but we could also still support a `CYPRESS_ENV_FOO=bar` which would set `{ foo: bar }`

I'm still conflicted on whether or not to make `env` a property on `config` or vice versa or keep them separate.

We could namespace them like this...

```js
module.exports = () => {
  return {
    config: {...},
    env: {...}
  }
}
```

Which would make more sense per how you work with them in the `driver`.

But then we'd also need to namespace the events you register, which is weird...

This would potentially work better through for things like `projectId` which isn't actually part of the configuration of cypress and could live outside of `config`.

---

Notes from 2/6/2018:

```js
// get
Cypress.config('baseUrl')
// set
Cypress.config('baseUrl', 'http://localhost:8080')
Cypress.config({
  baseUrl: 'http://localhost:8080'
})

// cypress run --config baseUrl=http://staging.local
// CYPRESS_BASE_URL=http://staging.local cypress run

// CYPRESS_CONFIG_BASE_URL
// CYPRESS_ENV_MY_VAR

// exports.secrets ?
exports.env = () => {
  return {
    foo: 'FOO',
  }
}

// Cypress.secrets('foo') ?
Cypress.env('foo')
Cypress.envVar('foo')

// ORDER:
// CYPRESS_ENV_* VARIABLES
// cypress.js env

const envs = {
  staging: {},
  development: {},
  production: {},
  default: {},
}

// --environment staging|development|production
Cypress.environment // ?
exports.config = (defaultConfig, environment) => {
  // how to differentiate from env above?
  // call it currentEnvironment?

  return {
    ...(envs[environment] || envs.default),

    // data
    // meta
    // user
    // etc
    // other
    custom: {
      testCases: [],

      percy: {
        id: '1234',
      }
    },
  }

  Cypress.config(""custom.percy.id"")
  
  // return {
  //   defaults: {

  //   },
  //   development: {
  //     baseUrl: 'http://localhost:8080',
  //   },
  //   production: {
  //     baseUrl: 'http://localhost:8080',
  //   },
  //   staging: {
  //     baseUrl: 'http://localhost:8080',
  //   },
  // }
}

// ORDER:
// default config
// cypress.js config
// CYPRESS_CONFIG_* VARIABLES
// CLI


// exports.hooks ?
// exports.plugins ?
// exports.events ?
exports.backgroundEvents = (on, config, env) => {
  // config and env|secrets are final resolved values
}

exports.projectId = '1234'
```

* remove the background file (call it config file?)
* support a new —env argument or NODE_ENV=?
* pass in the environment if one is specific in the exported function
    * tag the environment in the dashboard as a filter of the build or groups?
    * where to store the env on Cypress?
    * Cypress.env?
* remove —env-file, throw if those options are passed
* add support for arbitrary config.plugins property
* add a “migration” error helper
    * list out the problems found, with link to instructions + upgrade notes for each one
    * it looks like you’re trying to upgrade to a newer verison of cypress
    * we’ve listed out the breaking changes you must fix with an explanation of what changes were made and a link to them
* Cypress.config(‘meta’) // arbitrary storage
* remove Cypress.env() // just use Cypress.config(‘envVars.whatever’)
    * or Cypress.envVars(…)
",enhancement
496902505,Can't set cy.viewport larger than 3000 pixels,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

Cypress cannot take a 4K screenshot because the viewport dimensions are capped at 3000px (width or height).

<!-- images, stack traces, etc -->

### Desired behavior:

Cypress should be able to create a 4K viewport and take screenshots of it since 4K screen are common nowadays.

<!-- A clear concise description of what you want to happen -->

### Steps to reproduce: 

<!-- Issues without reproducible steps WILL BE CLOSED -->

Try setting the viewport to 4K. Get an error message related to the viewport size being too large.

I tried to manually remove the bound check from Cypress code but the screenshot did not have 4K resolution even though no other error appeared.

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

### Versions

<!-- Cypress, operating system, browser -->
Latest Cypress version (installed last week)
Window 10
Chrome (up to date)",enhancement
489906173,Proposal: Add `cy.catch` command to prevent failed Cypress commands from failing the test,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

There is no way to catch failed commands in a Cypress test. Any failed command fails the entire test. If you want to catch a failed command for a legitimate reason, ugly workarounds must be used: percy/percy-cypress#140

And options to use duck-typing to return errors must be added on a per-command basis: https://github.com/cypress-io/cypress/issues/3161#issuecomment-523039295

### Desired behavior:

Add `cy.catch` command which can be chained to any Cypress command, and will be short-circuited to if an error is thrown in the chain preceding it.

Similar to Promise.catch:

```js
cy.catch((err) => { ... })
cy.catch({ code: 'ECONNRESET' }, (err) => { ... })
```
",enhancement
488181971,Support to use RegExp in cy.clearCookie(),,enhancement
487730171,Yield sameSite attribute in getCookies,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

The list of attributes yielded by `cy.getCookie` does not include the [sameSite](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies/SameSiteStatus) attribute.

https://docs.cypress.io/api/commands/getcookie.html#Yields

### Desired behavior:

Yield `sameSite` in `getCookies`.

### Steps to reproduce: (app code and test code)
```js
cy.getCookie('TOKEN').then((cookie) => {
  expect(cookie.sameSite).to.equal('Lax'); // Cannot do this now
});
```
### Versions

<!-- Cypress, operating system, browser -->
Cypress `3.4.1`. I don't think system/browser matters.",enhancement
487153190,[module API] notifications for test started / test completed,"It seems that the module API returns results when all of the spec files it is running have finished. However, there's currently no way to be notified when an individual test within a file starts or completes. Is it possible to add this?
",enhancement
484515554,cy.visit() and URL encoding,"### Current behavior:

Cypress does not support URL encoding at all.  Ok I know this is the responsible of the HTTP 'client', but it would be nice if the cy.visit() function would support URL encoding in a similar way as any other JS REST client does.

Just for clarification: I am talking about URL parameters. Not HTTP headers. And also not POST body.

### Desired behavior:

cy.visit() should have a parameter params of type object. The passed values in this object will be URL encoded and then all attributes are sent as parameters in the request URL.

### Steps to reproduce: (app code and test code)

This code should work:

```js
    cy.visit('/search, { params: { searchQuery: ""some example string with spaces"" }}
    // => GET /search?searchQuery=some%20example%20string%20with%20spaces
   
    cy.visit({
      method: 'GET',
      url: '/fetch
      params: {
        foo: 'bar'
      }
    }
    // =>GET /fetch?foo=bar
```

### Versions

all cypress versions.    Yes ok, this is a feature request. 
",enhancement
484381409,Add configuration option for disabling screenshots in cypress.json,"To disable video, all I need to do is to add the following to my `cypress.json` file:

```json
{
  ""video"": false
}
```

To disable screenshots on the other hand, I have to put this ugly code somewhere:

```js
Cypress.Screenshot.defaults({
  screenshotOnRunFailure: false,
});
```

Can you please just add a simpler config for this so I can keep the global cypress test configuration in one place? E.g.

```json
{
  ""video"": false,
  ""screenshotOnRunFailure"": false,
}
```

**Cypress version:** 3.4.1

",enhancement
479150237,Support ansi color parsing in command log API,"Currently, we only support rendering markdown using `Cypress.log` (and cy.log by extension).

It would be nice to support ansi coloring which could allow for much richer logging for messages and plugins, **while still allowing compatibility between command log, browser console, and node console**

This would allow users to use something like `chalk` to create colored custom logs via `Cypress.log` or `cy.log` that will render everywhere.

It would solve #2134 which is asking for color support.

### Example use cases:

- diffing results (related to #3130): show a rich inline diff when asserting on strings, or objects
![image](https://user-images.githubusercontent.com/14625260/62805490-25aa9680-babe-11e9-8092-dd60f475bd73.png)



### Related
cy.log color support #2134
Cypress.log.groupEnd support https://github.com/cypress-io/cypress/issues/3229
  ",enhancement
479124593,Add support for testing Electron.js applications,"Currently Cypress can open the browser and load websites for testing. Electron.js applications ARE in essence the browser, so it would be cool to let Cypress test them.

Original issue: https://github.com/cypress-io/cypress/issues/2072

- [x] create basic Electron.js example to be used as a proof of concept
  * see https://github.com/cypress-io/cypress-example-electron
- [x] figure out how to change the browser launch from Cypress in order to ""attach"" to an Electron application
  * external process, similar to Chrome, passing remote interface url to be able to control the browser process
- [ ] see if we can implement testing an Electron.js application with minimal core changes, and most of the code as external plugin (faster iteration)
- [ ] figure out the changes / API that a typical Electron.js application would need to be testable from Cypress",enhancement
477204915,Issue Command Log 'warning' event during uncaught:exception,"### Current behavior:

Currently, when there is an uncaught:exception thrown from within the application under test, we fail the test and display the uncaught exception as the failure message.

### Desired behavior:

Many users have complained about this behavior - failing the test on uncaught exceptions. Changing this would be a breaking change (so may need to wait for Cypress 4.0)

But, we would like to at least log a ""warning event"" in the Command Log, similar to URL / XHR 'events' that log in the Command Log yet are not associated with a specific 'command'. 

I'd also like this warning to be collapsed by default, with the ability to expand for more information. 

Related issues: https://github.com/cypress-io/cypress/issues/4917 https://github.com/cypress-io/cypress/issues/3762

### Versions

Cypress 3.4.1
",enhancement
476333556,Show warning messages in command log,"It would be useful to allow commands to print a warning instead of an error in the command log.

This would allow commands to alert the user something they have done may lead to unexpected behavior, such as pressing the `{home}` key while we cannot preform the default action of scrolling. Or calling a `cy.wait` after a `cy.visit`. 

We could have:
- If there's a soft error during a command, allow a config value to turn it into a warning.
- If there's a warning during a command, add an icon to the command and allow it to be clicked and expanded
- Ability to add a new command log message / event for warnings/errors not linked directly to a command",enhancement
475855257,"In Desktop GUI, scroll only the specs and leave the search/filter in place","I think this will improve the experience, so you can get to the filter even if you've scrolled down a long list of specs.

Before:

![desktop-gui-scrolling-before](https://user-images.githubusercontent.com/1157043/62322301-c079f400-b472-11e9-9c1c-dec4f017462d.gif)

After:

![desktop-gui-scrolling-after](https://user-images.githubusercontent.com/1157043/62322176-73961d80-b472-11e9-9d84-fd62baa261c6.gif)

",enhancement
475097161,Allow to rerun only failed tests directly from the Test Runner UI,"### Current behavior:

In the test runner, there is no option to only rerun failed tests. After investigating and fixing a failed test, I'd like the watcher to only rerun failed tests.

### Desired behavior:

Add a rerun ""Rerun failed tests only"" checkbox to the tests runner UI.

",enhancement
474527188,[feature request] Allow setting `--record` switch with env var,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

Right now you can specify Project ID and key with env vars (`CYPRESS_PROJECT_ID`, `CYPRESS_RECORD_KEY`). But you do need to use CLI `--record` switch to actually make use of them. If you use `--record` flag without those env vars you get error:

```
You passed the --record flag but this project has not been setup to record.

This project is missing the 'projectId' inside of 'cypress.json'.

We cannot uniquely identify this project without this id.

You need to setup this project to record. This will generate a unique 'projectId'.

Alternatively if you omit the --record flag this project will run without recording.

https://on.cypress.io/recording-project-runs
```

This makes it challenging (or messy) to use scripts that would work when those env vars are set and when they are not. In our setup we want to record runs to dashboard only when run in CI and not when running them locally (to not pollute dashboard with any test runs that devs will run locally when testing their changes.

As solution/workaround we use scripts like `""cy:run"": ""(is-ci && cypress run --browser chrome --record) || cypress run --browser chrome""` to apply `--record` switch only in CI. ( https://github.com/gatsbyjs/gatsby/pull/16190 )

### Desired behavior:

I'd like to be able to use env var like `CYPRESS_RECORD=true` to control all recording related options with env vars.

### Steps to reproduce: (app code and test code)

- create single script to run cypress test suites (with `--record` switch)
- specify `CYPRESS_PROJECT_ID`, `CYPRESS_RECORD_KEY` in your CI setup
- try running script locally without above env vars set

### Versions

`cypress`: `3.3.2`
",enhancement
474022266,"[Feature Request] In the GUI, show the number line of code being run rather than the step number","### Current behavior:

When viewing running tests via the GUI or recordings online, there is a number associated with each step. This isn't really helpful for any of my personal use-cases and I'm unsure if it's really that helpful for anyone else.

![image](https://user-images.githubusercontent.com/10504626/62048217-f3ea2380-b1d1-11e9-9070-67b9a4f3307a.png)

### Desired behavior:

What WOULD be incredibly helpful is if the number shown in the GUI for each step was in reference to the specific line of code being run. This would help to easily debug which specific line of the test is failing.

![image](https://user-images.githubusercontent.com/10504626/62048268-0f552e80-b1d2-11e9-80e8-d0468b844255.png)

### Versions

Cypress 3.4.0
OSX 10.14.6
Chrome 75
Electron 61
",enhancement
470263462,socket hang up and keep-alive connections,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

<!-- images, stack traces, etc -->
Requests that result in a redirect fail with ""socket hang up"" error.

### Desired behavior:

<!-- A clear concise description of what you want to happen -->
They succeed.

### Steps to reproduce: (app code and test code)

<!-- Issues without reproducible steps WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

```
$ python -m venv env
$ . env/bin/activate
$ pip install Django==2.0.2
$ django-admin startproject p1
$ cd p1
$ ./manage.py runserver
```

`cypress/integration/1.spec.js`:

```
describe('redirect requests', () => {
    it('succeeds', () => {
        cy.visit('http://localhost:8000/admin/');
    });
});
```

### Versions

<!-- Cypress, operating system, browser -->
Cypress 3.4.0, Django 2.0.2

### More info

This is supposedly caused by a [bug][1] in Django development web server, which was fixed in [`2.1.4`][2]. Before this fix Django unconditionally closed the connection after the first request.

The thing is at `3.3.0` Cypress switched to [`keep-alive` connections][3], so now it tries to do a second request (to the URL it was given to in the first one) over the same connection. But at about the same time Django closes the connection, which results in the error in the title.

![][4]

I'm going to confirm in the near future if switching to the latest Django handles the issue.

Then, there's an open issue in Python's [`requests`][5] library (which is not used here, but still), that claims that a client that doesn't establish a new connection in this case is not well-behaved. And there are [open][6] [issues][7] in `request` package which Cypress uses. So the bug seems to be on the client side as well. Or rather on the client side. I'm not sure.

[1]: https://code.djangoproject.com/ticket/29849
[2]: https://docs.djangoproject.com/en/2.2/releases/2.1.4/
[3]: https://github.com/cypress-io/cypress/issues/3857
[4]: https://i.imgur.com/sR85k1X.png
[5]: https://github.com/kennethreitz/requests/issues/4664
[6]: https://github.com/request/request/issues/3131
[7]: https://github.com/request/request/issues/2815",enhancement
465274267,Add support for HTTP Digest authentication,"### Current behavior:

Cypress does not support HTTP Digest authentication in cy.visit:

https://stackoverflow.com/questions/56804599/manually-enter-auth-credentials-in-dialog

### Desired behavior:

Cypress supports digest authentication in cy.visit:

```js
cy.visit({
  url: 'http://example.com',
  auth: {
    user: '...',
    pass: '...',
    type: 'digest'
  }
})
```

### Versions

Cypress 3.3.2

### Related issues

* #850 - add in-browser support for NTLM authentication
* #1255 - add in-browser support for Kerberos authentication
",enhancement
462349455,Create ability to mock server requests,"### Current behavior:
As described [here](https://github.com/cypress-io/cypress/issues/588), Cypress doesn't have the ability to get involved with the server process as it stands - it's just about the client. In a bid to ensure that my test environment is as identical as possible to my prod environment, I find the suggestion of rendering on the client just for the sake of tests to be less than ideal.

### Desired behavior:
It'd be awesome if we were provided instructions on how to make our server make requests through the same network proxy layer that Cypress works or if Cypress could provide some kind of plugin to handle that.

### Versions
All",enhancement
462313455,Feature request: Button to disable Hot-Reload temporarly,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:

In dev mode, when I edit my code and unfocus the IDE the file gets auto saved and the cypress test runs again automatically. That is overall a great feature.
But a frequent usecase is to copy stuff from the current result into the IDE and while doing that, the page reloads and one has to wait until it finishs, scroll to the desired position again, copy the line, insert it into the IDE... and for the next all this happens again.

<!-- images, stack traces, etc -->

### Desired behavior:

So it would be very nice to have another button on top (e.g. next to the ""Disable Auto-Scrolling"") to be able to temorarly disable this hot-reload auto-re-run test behaviour.

<!-- A clear concise description of what you want to happen -->

### Steps to reproduce: (app code and test code)

Open cypress in dev mode, run a test, edit the test and save the test file.

<!-- Issues without reproducible steps WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

### Versions
3.3.1
<!-- Cypress, operating system, browser -->
",enhancement
462142430,Check desktop-gui's saved coordinate/size when opening to ensure Cypress is not opened outside of current screen dimensions,"<!-- Is this a question? Don't open an issue. Ask in our chat https://on.cypress.io/chat  -->

### Current behavior:
my desktop configuration recently changed.
ran npm run cypress open
the cypress icon appeared in the taskbar, but the window was nowhere to be seen.
hit Alt+Space, M and moved the window back onto the desktop view.
<!-- images, stack traces, etc -->

### Desired behavior:
when opening the cypress window, check that it is within the currently defined desktop coordinates.
<!-- A clear concise description of what you want to happen -->

### Steps to reproduce: (app code and test code)

<!-- Issues without reproducible steps WILL BE CLOSED -->

<!-- You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

### Versions
cypress 3.3.1
Windows 10 1809.  
<!-- Cypress, operating system, browser -->
",enhancement
462131340,Feature Request: Make retryOnStatusCodeFailure and retryOnNetworkFailure globally configurable,"### Current behavior:

The two params `retryOnStatusCodeFailure` and `retryOnNetworkFailure` are options passed in via `cy.request` and `cy.visit` - however, it would be great if these two settings are configurable globally as well as overridable per call.

### Desired behavior:

1. Users are able to to configure `retryOnStatusCodeFailure` and `retryOnNetworkFailure` in the Cypress config file.

2. Users are able to override the default settings in the Cypress config file via `cy.request` and `cy.visit`

### Steps to reproduce: (app code and test code)

`cy.visit(some_url, {retryOnStatusCodeFailure:some_value, retryOnNetworkFailure: some_value}`
`cy.visit(some_other_url, {retryOnStatusCodeFailure:some_value, retryOnNetworkFailure: some_value}`

This would be better if we could configure a default instead of having to pass it in each time.

### Versions

Cypress 3.3.1
",enhancement
460578520,Add failed screenshot to test information for custom reporter,"### Current behavior:

When writing a custom reporter you have access to some information from the test, but no indication of the screenshot taken automatically on failure.

```js
runner.on('test end', function(test) {
  console.log(test);
});
```

### Desired behavior:

the test object to have the screenshot path

```js
runner.on('test end', function(test) {
  console.log(test.screenshot);
  // or
  console.log(test.failedScreenshot);
});
```

### Steps to reproduce: (app code and test code)

simple runner `reporters/test.js`
```js
module.exports = function(runner, config) {
  runner.on('test end', function(test) {
    console.log('test done');
  });
}
```

use in `cypress.json`
```json
{
  ""reporter"": ""reporters/test.js""
}
```

### Versions
Cypress 3.3.1  
OS: Linux (Ubuntu)
Browser: Any

### Workaround
You can access the files with `fs` and `path` no problem in the `end` hook. This is less than ideal as you have to try and map file names to your failures

```js
runner.on('end', function() {
  //getFilePaths is a helper to list all files in a directory
  console.log('end:', getFilePaths('cypress/screenshots'));
});
```
",enhancement
459448998,Having a dedicated command to show up local environment information 'cypress info',"## Feature Request

Most CLI tools these days are shipped with a dedicated `info` command which shows up local environment information. Also, the present issue template includes a section which expects to have information regarding the local environment.

With this all the user has to do is just copy and paste the information as shown by `cypress info` within the respective section.
",enhancement
457896412,Truncate special env vars and debug logs,Display them as `XXX...XXX`,enhancement
456977900,Cypress cache path and list exit without any information,"I have installed Cypress inside a Docker container

```
docker run -it cypressinternal/xvfb /bin/bash
CI=1 npm i cypress

> cypress@3.3.1 postinstall /home/person/node_modules/cypress
> node index.js --exec install

[14:32:23]  Downloading Cypress     [started]
[14:32:43]  Downloading Cypress     [completed]
[14:32:43]  Unzipping Cypress       [started]
[14:33:53]  Unzipping Cypress       [completed]
[14:33:53]  Finishing Installation  [started]
[14:33:53]  Finishing Installation  [completed]

npm WARN enoent ENOENT: no such file or directory, open '/home/person/package.json'
npm WARN person No description
npm WARN person No repository field.
npm WARN person No README data
npm WARN person No license field.
```

Verify command fails (as expected in this container)

```
person@0bab1ba8abcc:~$ $(npm bin)/cypress verify
 ✖  Verifying Cypress can run /home/person/.cache/Cypress/3.3.1/Cypress
   → Cypress Version: 3.3.1
Cypress failed to start.

This is usually caused by a missing library or dependency.

The error below should indicate which dependency is missing.

https://on.cypress.io/required-dependencies

If you are using Docker, we provide containers with all required dependencies installed.

----------

/home/person/.cache/Cypress/3.3.1/Cypress/Cypress: error while loading shared libraries: libgtk-3.so.0: cannot open shared object file: No such file or directory

----------

Platform: linux (Debian - 8.9)
Cypress Version: 3.3.1
```

Notice that the binary exists ""/home/person/.cache/Cypress/3.3.1/Cypress/Cypress""

But when I try to use `cypress cache` commands, there is no output. and exit code is 0

```
person@0bab1ba8abcc:~$ $(npm bin)/cypress cache path
person@0bab1ba8abcc:~$ $(npm bin)/cypress cache list
```

Weird that `cypress cache` commands would silently terminate. More debug output does not show anything

```
person@0bab1ba8abcc:~$ DEBUG=cypress* $(npm bin)/cypress cache path
  cypress:cli cli starts with arguments [""/usr/local/bin/node"",""/home/person/node_modules/.bin/cypress"",""cache"",""path""] +0ms
  cypress:cli NODE_OPTIONS is not set +0ms
  cypress:cli program parsing arguments +4ms
person@0bab1ba8abcc:~$ echo $?
0
```",enhancement
456951982,Provide binary for ARM 7 architecture (Linux),"We need to run e2e tests on a device with ARM 7 architecture. Could you provide binaries for this architecture, please?
I would like to move all the e2e tests in a customer project to cypress, since they are a lot faster than Selenium. Only the missing binary is holding be back.",enhancement
455117036,Add more advanced screenshot clipping options,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:

When creating a screenshot you can pass an options object with a clip option which accepts an x, y, width and height setting defining the absolute position that you want the screenshot to be clipped to.

### Desired behavior:

I’d like to see the clipping options be extended to support relative or calculated coordinates. For example, the following could define a screenshot the viewport dimensions but inset by 50px.

```js
cy.screenshot({ capture: “viewport”, clip: { inset: 50 } });
```

Or when screenshotting an element, allow offsetting it’s coordinates to capture 20px of its surrounding area.

```js
cy.get(“#myId”).screenshot({ clip: { offset: 20 });
```

My use case for this is mostly to use cypress for automating documentation screenshots, but I’m sure it could have uses within the testing arena.
",enhancement
454820121,Allow using external Node when running tasks / plugins,"## Proposal

Currently, the plugins file is executed using the Node.js version included with Cypress Test Runner (like 8.2.1), which is often not the version needed to run the application. The most common problem is the inability to load native extensions when requiring NPM modules from the plugins file. The installed app for example uses Node 10 to compile extensions, while Cypress tries to load them using Node 8

So instead of using built-in Node version in `packages/server/lib/plugins/index.coffee`

```
pluginsProcess = cp.fork(path.join(__dirname, ""child"", ""index.js""),
   [""--file"", config.pluginsFile], { stdio: ""inherit"" })
```

we could find external Node and launch it as a child process

## reported issues

- cannot connect to Oracle DB #2914
- cannot load `node-sass` #3875 and #4202

",enhancement
452574058,No progress feedback while preprocessor is running,"### Is this a Feature or Bug?
Feature

### Current behavior:
When preprocessor is running, cypress window boots and shows a blank output while preprocessor is running. If you have a slow compilation process e.g. typescript, it can be confusing waiting for ~20 seconds while nothing appears to happen

### Desired behavior:
Indication of the progress of the plugin, or even just a notice that the preprocessor is running, standby...

### How to reproduce:
Use the preprocessor plugin, make it wait for an extended period of time



---
Moved here from https://github.com/cypress-io/cypress-webpack-preprocessor/issues/46 as requested by @chrisbreiding

- Operating System: MacOS, Ubuntu
- Cypress Version: 3.1.5
- Browser Version: Chrome 72",enhancement
452534129,Warn when ProxyMode/ExtensionWhiteList registry setting is detected,"Cypress fails in strange ways if a ProxyMode policy is set on the user's computer, because it can break Cypress's proxy when running tests in Chrome.

We should:

* warn the user on the command line when Cypress is launched if we detect this setting
* maybe also warn the user if they try to launch Chrome with this setting enabled - could have chrome greyed out, or add a small :warning: sign or something with a tooltip explaining this problem - also don't set Chrome as the default browser

Relevant issues: #1253 and #4263

----

Should also detect ExtensionWhiteList/other problematic extension settings. 

Relevant issues: #1239, #2494",enhancement
452330859,FeatureRequest: cy.waitTimes to wait X number of times for several requests,"Here is a small feature request to add the ability to wait for some requests to complete.

**Use case:** I have some generic requests to complete when opening a new view, like fetching some data-Types from my backend. Therefore i created a very generic cy.route and added cy.wait n-times. This happens some times in my tests, so is added a custom cypress command, which does the magic for me:
```js
/**
 * Helper method to wait for some requests to occur.
 *
 * @func cy.waitTimes
 * @param alias - {string|number} the alias or seconds to wait for
 * @param count - {number} number of times to wait for
 */
Cypress.Commands.add('waitTimes', (alias, count) => {
    // decrease count till 0, which is falsy
    for (; count; count--) {
        cy.wait(alias);
    }
});
```
**Usage:** 
```js
// ...
cy.server();
cy.route('GET', /.*\/data\/.*/).as('dataRequest');
cy.waitTimes('@dataRequest', 4);
```

Maybe you like the idea as I do. For me it was more useful to add waitTimes as command, but feel free to add 'count' to options of cy.wait, if this more the official cypress way. 
",enhancement
451787981,Collect CI environment variable from Concourse CI,"### Current behavior:

We don't collect anything from a Concourse CI run - do not even know if they are running within Concourse CI

### Desired behavior:

Need to identify Concourse and pull any useful environment variables for use here: 

https://github.com/cypress-io/cypress/blob/issue-3909/packages/server/lib/util/ci_provider.js

Add environment variables to collect from https://concourse-ci.org/implementing-resource-types.html#resource-metadata

- `$BUILD_ID`
- `$BUILD_NAME`
- `$BUILD_JOB_NAME`
- `$BUILD_PIPELINE_NAME`
- `$BUILD_TEAM_NAME`
- `$ATC_EXTERNAL_URL`

>If the build is a one-off, `$BUILD_NAME`, `$BUILD_JOB_NAME`, and `$BUILD_PIPELINE_NAME` will not be set.

I see quite a few other env variables floating around starting with `CONCOURSE_`, which can probably be used to identify it as a run within Concource CI.

### Versions

Cypress 3.3.1
",enhancement
451776124,allow live-reload out of paused debugger,"#### what
When chrome is paused on a debugger breakpoint, the filewatching/livereload currently does not refesh changes until you resume execution:

_when chrome is like this, live-reloading doesn't work until you click resume_
![image](https://user-images.githubusercontent.com/14625260/58848301-058cd000-8654-11e9-84a1-a23030781bc0.png)


It would be nice to expose the option to allow file changes to re-run tests even when the browser is paused on a debugger breakpoint

#### how
we could do this by 
- using the `native debugging protocols` to temporarily disable breakpoints and resume from execution until we are able to re-run cypress tests
**or**
- simply doing a hard refresh of the page using the native protocols or extensions API
",enhancement
451536370,Proposal: insert fixes for basic errors right from the Test Runner,"## Background

I have shown Cypress Test Runner at a company where my friend works, and then had to wait in their office for an hour until the end of the work day. While sitting at one of the desks, I have noticed a person next to me writing a Cypress test - trying it out on their website. He is a front end developer, who loved the demo and immediately wanted to replace a few existing tests. 

Their site polyfills `fetch` which caused Cypress test to crash due to `XMLHttpRequest` property missing (when we try to wrap it for XHR stubbing). I saw his reaction - he clicked on the link in the error message https://on.cypress.io/uncaught-exception-from-application which took him to this doc

<img width=""792"" alt=""Screen Shot 2019-06-03 at 10 55 10 AM"" src=""https://user-images.githubusercontent.com/2212006/58811598-160a5f80-85ee-11e9-9f1f-9e5efb272b00.png"">

He did NOT follow the link. I was next to him so I jumped into the situation, clicking on the link and explaining to him what happens. The first event on the page shows the workaround

<img width=""557"" alt=""Screen Shot 2019-06-03 at 10 56 02 AM"" src=""https://user-images.githubusercontent.com/2212006/58811653-376b4b80-85ee-11e9-987d-828e9534ed38.png"">

Without me there observing it, he would be blocked. After we added the workaround, he wrote several tests, absolutely happy as a clam

## Proposal

We know the spec, we know the place with `cy.visit`, we show the specific error message. We could add a button to the error message with something like ""Add workaround"". When the user clicks it, we can add our handler to the spec file.

```js
Cypress.on('uncaught:exception', (err, runnable) => {
  // returning false here prevents Cypress from
  // failing the test due to uncaught exceptions from the production code
  return false
})
```

We could even target the handler by only handling that specific error

The purpose is not to create a universal solution, but to avoid people being blocked 100% when they try writing their first ""hello Cypress"" test. We could probably insert typical solution for
- uncaught exception from the website under test
- chrome security: false
- ignore missing content type or non-200 response from the server

## Related

I think this work can only happen after the in progress error improvements land (issue #3762, pull request #3930)


",enhancement
449269382,Add a way to clear selection with `cy.select()`,"This Stack Overflow question points out that `cy.select()` can't clear a selection, and apparently, neither can commands like `cy.clear()`: https://stackoverflow.com/questions/56340978/how-do-i-clear-a-select-input-using-cypress

Things that should work, but don't:

* `cy.select([])` should cause no elements to be selected
* `cy.clear()` with a `<select>` subject should cause no elements to be selected

Also, maybe `cy.select()` or `cy.select(undefined)` should also clear the selection.",enhancement
447864450,Screenshot directory names should not contain spec file extensions such as `.js`,"### Current behavior:

Screenshots are written to directories that directly match the spec file name (including the extension) which creates confusing directory names that look like files:
```
cypress/screenshots
├── home_spec.js
│   └── home.png
└── login.spec.js
    └── login.png
```

### Desired behavior:

Directory names should not have the `.js` file extension in their name. And for extra credit, an ending `.spec` or `_spec` should also be removed like so:

```
cypress/screenshots
├── home
│   └── home.png
└── login
    └── login.png
```

### Steps to reproduce: (app code and test code)

_n/a_

### Versions

Cypress `3.0.2`
",enhancement
447486472,Allow to ignore special character sequences for cy.type,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:

`cy.type` considers everything in `{}` as modifier sequence. In our app we have embedded code runner. For testing we put there code from fixtures with `cy.type`. And `cy.type` throws `CypressError: Special character sequence: '{...}' is not recognized` when code includes some braced expression.
<!-- images, stack traces, etc -->

### Desired behavior:

Add option to `cy.type` to not treat `{}` as modifier sequence.

<!-- A clear description of what you want to happen -->

### Versions

<!-- Cypress, operating system, browser -->
Cypress: 3.2.0
",enhancement
445528853,Retry the initial baseUrl verification phase during the beginning of a cypress run,"### Current behavior:

When Cypress detects a `baseUrl` set in `cypress.json` it will initially verify this before running the tests.

The problem is that it will **instantly** fail and exit if this server is not accessible.

### Desired behavior:

Retry connecting to `baseUrl` multiple times, so that servers that are booting or experience a tiny hiccup do not cause run failures.

### Versions

`3.2.0`
",enhancement
439051087,Add ability to use .should (without callback) without retry,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:

`.should` is always retrying the previous command which can be undesired in some scenarios. For example when calling an api to check that an action on the app did change the data, we usually do something like:
```js
// ...
.request(...)
.its('body')
.should('deep.equal', expectedResult)
```

in this example, if the assertion fails then Cypress will retry the `its` until it times out. Which is useless since `.its('body')` will always return the same value.
### Desired behavior:

I'm not sure what's the best way to optimize this use case. My current workaround is to replace `.should` with:
```js
.then(body => expect(body).to.deep.equal(expectedResult))
```
Ideally, Cypress would be smart enough to avoid retries in this situation. If that is not possible, then maybe adding a `.assert` with same api as `.should` but without retry?
<!-- A clear description of what you want to happen -->

### Versions

cypress@3.2.0
",enhancement
437461712,"Launch Cypress with Chrome ""Incognito"" using --incognito flag","<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:

Launch Cypress with Chrome ""Incognito"" results in: ""Whoops can't run your tests""

![Incognito](https://raw.githubusercontent.com/beauholland/cypress-incognito/master/incognito.png?raw=true ""Incognito"")
### Desired behavior:

Able to launch Cypress with Chrome ""Incognito""

### Steps to reproduce: (app code and test code)

Clone repo to test: (https://github.com/beauholland/cypress-incognito)

### Versions

Cypress 3.2.0
Node 10.14.1
Chrome 73.0.3683.103
Windows 10 V1803 build 17134.706
",enhancement
437388771,Reject the underlying promise in the Module API when Cypress fails to run the tests,"Currently if Cypress errors out and does not run the test (which can happen due to misconfiguration, wrong arguments, failing to record, etc) it does not preserve the error - nor does it make it accessible via the module API.

Currently when using the module API and an error occurs, we have fallback code in the CLI here: https://github.com/cypress-io/cypress/blob/master/cli%2Flib%2Fcypress.js#L31 which resolves with a pretty useless object.

Instead, we should actually `reject` the underlying promise and rehydrate the error instance that caused Cypress to abandon running the tests.

Here's an issue for reference: https://github.com/cypress-io/cypress/issues/4021",enhancement
437045630,"Support creating custom assertion operator like 'should('have.text.trimmed', ...)'","Cypress have many assertion operators like 'eq', 'contain', 'have.text', but which is not enough for me.

E.g. I want to check a DOM element have some text but want to skip around whitespaces, I have to write:

```js
cy.get('.cell')
  .then($cell => $cell.text().trim())
  .should('eq', 'Hello')
```

Since none of `have.text`, `eq`, `contain` really work in this case.

I want to define a custom operator like `have.text.trimmed`, to simplify the code to:

```js
cy.get('.cell')
  .should('have.text.trimmed', 'Hello')
```

I can't find any document about it, does Cypress have a way to do it? Or add this feature?

PS: I also create a question before this issue: https://stackoverflow.com/questions/55842707/how-to-define-a-custom-assertion-operator-in-cypress/55842986",enhancement
434009510,Multiple versions of the same browser do not display,If multiple versions of the same browser are detected by having multiple results returned from `mdfind` only one version of the browser will be available via the Cypress GUI. All available versions should be pickable.,enhancement
431926734,Config routes with no response fail to be recognised as a route,"### Current behavior:

If we try to create the following route:

```javascript
cy.route({
  method: 'GET',
  url: '**/some-route',
  status: 400,
}).as('someRoute');
```

This is failed to be picked up by Cypress as a valid route:

```javascript
cy.wait('@someRoute'); // The route is not recognised, so this assertion will fail
```

The current workaround for this is to provide an empty response object, which is technically not correct behaviour, as this particular route does not return any response (not even an empty JSON payload):

```javascript
cy.route({
  method: 'GET',
  url: '**/some-route',
  status: 400,
 response: {}
}).as('someRoute');
```

### Desired behavior:

Routes without responses should be able to be configured / considered as valid routes by Cypress:

```javascript
cy.route({
  method: 'GET',
  url: '**/some-route',
  status: 400,
}).as('someRoute');
```

### Steps to reproduce: (app code and test code)

Same as per the [current behaviour](#current-behavior)

### Versions

Cypress: Latest, 3.2.0
Operating System: macOS High Sierra 10.13.6
Browser: Chrome and/or Electron 59",enhancement
429334545,"should('have.text', ...) should ignore leading and trailing whitespace","<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

If your HTML happens to have whitespace in the tag, e.g., `<div> foo  </div>`, that text will not impact how the user sees the page, unless it is a `<pre>` element. I don't think that the `'have.text'` assertion should fail just because it found `' foo '` when it was expecting `'foo'`.

If you're not willing to change this (since it is technically a breaking change), maybe there should be a `have.text.trimmed`?

### Current behavior:

`should('have.text', ...)` fails if the HTML contains whitespace, even if that whitespace doesn't impact the rendered content.

### Desired behavior:

`should('have.text', ...)` should ignore leading and trailing whitespace for elements that won't render it. Elements like `pre` (and elements with certain `white-space` css values) should still consider leading and trailing whitespace.

### Versions

3.2.0
",enhancement
426698275,cy.type('{insert}') is not supported,"### Current behavior:

```
CypressError: Special character sequence: '{insert}' is not recognized. Available sequences are: {selectall}, {del}, {backspace}, {esc}, {{}, {enter}, {leftarrow}, {rightarrow}, {uparrow}, {downarrow}, {home}, {end}, {alt}, {option}, {ctrl}, {control}, {meta}, {command}, {cmd}, {shift}
```

### Desired behavior:

`{insert}` should be a supported key. Not sure why it isn't. For that matter, `{pageup}` and `{pagedown}` should also be supported.

### Versions

3.2.0
",enhancement
426029415,Don't create a new socket to do HTTPS interception through SNI server,"Currently, `https-proxy` works by setting up a local HTTPS server and then using a local CA to issue self-signed certificates for any domains that need to be intercepted.

When new SSL requests come in to `https-proxy`, the HTTPS handshake and subsequent communication is performed over a TCP socket created from the `https-proxy` to it's own HTTPS server:

https://github.com/cypress-io/cypress/blob/e2e454262bf461f31e947da9f9fdc0a8fa23baf8/packages/https-proxy/lib/server.coffee#L94-L169

Creating a new socket like this internally just to serve an external request doesn't seem necessary. If possible, we should eliminate this superfluous socket creation.

Already tried converting the TCP socket to an IPC socket, but there was not a noticeable performance improvement.",enhancement
425080920,Block specific URL,"### Current behavior:

Users can only blacklist entire hosts.

### Desired behavior:

Users should be able to blacklist a specific URI. 

As we can't stub <script> requests, a suggested approach is to blacklist the host the script comes from, and then add your stubbed/mocked functionality to the contentWindow in an onBeforeLoad hook.

However, this doesn't work for the case where you only want to block one script, but allow all other requests from that domain. An idea is to be able to blacklist specific URIs.

",enhancement
423361597,cy.visit does not include headers on redirect,"We were waiting for the release to use headers with `cy.visit`. We are happy it is implemented, however it still does not work correctly for our use case.

### Current behavior:

When using `cy.visit()` with headers it does not include them on redirects. 

### Desired behavior:

Having the given headers on all requests that started from `cy.visit()`. Possibly with a toggle for users that only want it on the first visit.

### Steps to reproduce: (app code and test code)

```js
cy.visit({
  url: http://tinyurl.com/1c2,
    headers: {
      HEADER1: ""value1"",
      HEADER2: ""value2""
  }
})
```
When you check the network in the cypress browser it does not include them in the request headers from a redirect.
### Versions

Tested on Windows 10
Cypress: 3.2.0
Browser: Chrome 72
",enhancement
423278718,Conditional testing of DOM elements,"Hello!

Hope you are having a beautiful day!

Please do not make framework usability for developers more complex, because you have some vision, that is theoretically backed, but in practice makes life really hard.

Scenario:
1. A list of input fields is generated
2. Last input field OTP field is conditionally rendering depending of fraud calculation result (So in one test it might be there, in next not)

Why it is so hard to have:
```js
cy.get('input[field1]'.type('lala');
if (cy.hasElement('input[otp]')) {
  cy.get('input[otp]'.type('lala');
}
```

This document contents is understandable, but I totally disagree - better to have support from you, than investigate how to hack around, so I do not need to rewrite back-end services for tests.
https://docs.cypress.io/guides/core-concepts/conditional-testing.html#The-problem

**As a developer, I care only that my tests are quick to write and easy to read and debug. With Cypress this is not always the case, because a lot of things are counter-intuitive and require hackish solutions.**

5 Biggest problem for our team in few months of usage:
* A-B scenario testing with if-s is hard.
* Iframe contents testing is badly documented.
* Why Cypress tries to fill input if it is not visible? Find me a visible input instead and fill it. (Example scenario: modal is overlaying something.)
* 3rd party scripts failure causes all CI deployment flow stop and it takes days to find the root issue.
* For multiple domains testing within 1 test, we need to run local reverse proxy.

I understand, that you could say: ""this is feature and ..."", but we have real people, who are trying their best, and different team members stumble up on same issues. So maybe you could help us and future clients? :)

We totally love Cypress and we hope these issues will be fixed in future releases.


Best regards!

---

EDIT:  I have created and share my ""hacks"", how we needed to overcome Cypress limitations. Hopefully saves a week or two for the Cypress clients. 


# A/B testing fix

### hasElement.js

```js
export default function(e, cb) {
  cy.wait(1000);
  cy.get('body').then(body => {
    if (body.find(e).length > 0) {
      cb();
    }
  });
}

```

### ./commands.js

```js
  import hasElement from './hasElement';
  Cypress.Commands.add('hasElement', hasElement);
```

### Usage example

```js
    cy.hasElement('input[name=otpCode]', () => {
      const otp = authenticator.generate(otpKey).toString();
      modal.get('input[name=otpCode]').type(otp);
    });
```


# I frame testing fix

### ./inFrame.js

```js
export default function(frameId, cb) {
  cy.wait(5000);
  cy.get(frameId).then($iframe => {
    cy.wait(5000);
    const $body = $iframe.contents().find('body');
    cb({
      contains: e => cy.wrap($body).contains(e),
      get: e => cy.wrap($body).get(e),
    });
  });
}
```

### ./commands.js

```js
import inFrame from './inFrame';
Cypress.Commands.add('inFrame', inFrame);
```

### Usage example

```js
cy.inFrame('#gameIframe', frame => {
  frame.contains('Some link or text').click();
  frame.contains('Send').click();
});
```

# Multiple domain testing

For that you need to run local reverse proxy and run tests against it, example of our reverse proxy.

For that it would work on every developer computer, with subdomain and not changing /etc/hosts file, we created global DNS.

```
admin.localhost.io == 127.0.0.1
app.localhost.io == 127.0.0.1
```

```js
var proxy = require('http-proxy-middleware');
var app = require('express')();

app.use(
  '/',
  proxy({
    target: 'http://localhost:5000/',
    ws: true,
    changeOrigin: true,
    router: {
      'admin.localhost.io:5001':
        'http://admin.real.external.address.com/',
    },
  }),
);

const port = 5001;
app.listen(port, () => console.log(`Reverse proxy app listening on port ${port}!`));
```",enhancement
422094081,Selecting environment via the deskop appliction,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:
In the UI of Cypress, there is no way of selecting the environment option if we want to run the test case in a different environment. Need to run a special command kind of thing to do it. 
<!-- images, stack traces, etc -->

### Desired behavior:
There should be an option to select the environment for user convenience if user don't want to run any command by rather using the desktop appliction just for checking running test cases. Specially if some one ot that famliar with commnad line things. 
<!-- A clear description of what you want to happen -->

### Versions
3.20
<!-- Cypress, operating system, browser -->
",enhancement
421354621,Restrict listening to only the loopback adapter,Cypress runs locally and it being responsible for launching the browser means it's not necessary mount it's internal servers to anything other than loopback.,enhancement
712949833,Feature-Request: support babel.config.js,"### Current behavior:

@cypress/webpack-preprocessor supports Babel out of the box with a [default configuration](https://github.com/cypress-io/cypress-webpack-preprocessor/blob/c240d71f2b89d18a05aa8b6f0e67cb91d2722d05/index.js#L19-L21):

```js
{
  presets: [require.resolve('@babel/preset-env')],
}
```

### Desired behavior:

babel@^7.0.0 uses the `babel.config.js` file to configure its presets and plugins. Other libraries like [babel-jest](https://www.npmjs.com/package/babel-jest) pick up this configuration automatically. It would be nice if this package would do the same before falling back to its default configuration.

### How to reproduce:

Create an application with a `babel.config.js` that differs from this package's defaults. This package's defaults will be used.

### Additional Info (images, stack traces, etc)

- Operating System: OSX 10.14.3 Mojave
- Cypress Version: 3.1.5
- Browser Version: n/a/

",enhancement
418872377,Change the way that Windows browser version checks are done,"Currently, the launcher checks Windows browser versions by running a command like this in the shell:

```
C:\> wmic datafile where name=""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"" get Version /value

Version=72.0.3626.11
```

However, WMIC was [deprecated in Windows Server 2012](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831568(v=ws.11)#wmi-providers):

> The WMI command-line tool (Wmic) is deprecated. Use PowerShell cmdlets instead.

The WMIC database can also get corrupted, which causes issues for users since this will prevent them from launching browsers (see #3645)

We should probably replace our usage of WMIC with querying [CIM](https://docs.microsoft.com/en-us/windows/desktop/WmiSdk/common-information-model), the successor. We could also use a native package like [win-version-info](https://www.npmjs.com/package/win-version-info) to check the versions ourselves.",enhancement
418756138,API to set chromium preferences,"### Current behavior:

We can't specify chromium preferences when running Cypress tests. 
This becomes an issue when tests require certain browser configuration which is different to the defaults. 

An example is to disable the popup dialog for file downloads (requires `download.prompt_for_download = true`). 

See more preferences in the link in this comment: https://github.com/cypress-io/cypress/issues/433#issuecomment-470867819

### Desired behavior:

A Cypress API to enable setting chromium preferences as key value pairs.
This could be a new API or an extension to one of the existing APIs such as the browser-launch-api or the configuration-api.

### Versions

Valid for both Chrome and Electron setups.
",enhancement
418320860,watchForFileChanges during `cypress run` and rerun tests,"### Current behavior:

The command `cypress run` is not watching for file changes. Even if I set it on the cypress.json. If I run only successful tests, I got the following output on terminal:

```
> cypress run

===================

  (Run Starting)

  ┌───────────────────────┐
  │ Cypress:    3.1.5                                                    │
  │ Browser:    Electron 59 (headless)                        │
  │ Specs:      1 found (Loader.test.js)                        │
  └───────────────────────┘


─────────
                                                                                                    
  Running: Loader.test.js...                                                               (1 of 1) 


  BIG DESKTOPS: Loader
    ✓ It should be a fullscreen loader with a purple background (963ms)


  1 passing (1s)


  (Results)

  ┌─────────────┐
  │ Tests:        1                        │
  │ Passing:      1                      │
  │ Failing:      0                        │
  │ Pending:      0                      │
  │ Skipped:      0                      │
  │ Screenshots:  0                   │
  │ Video:        true                    │
  │ Duration:     1 second          │
  │ Spec Ran:     Loader.test.js │
  └─────────────┘


  (Video)

  - Started processing:   Compressing to 32 CRF
  - Finished processing:  /home/odelucca/Servers/yurah/v2/frontends/admin/cypress/videos/Loader.test.js.mp4 (0 seconds)


======================

  (Run Finished)


      Spec                                                Tests  Passing  Failing  Pending  Skipped 
  ┌────────────────────────────────┐
  │ ✔ Loader.test.js                            00:01        1        1        -        -        - │
  └────────────────────────────────┘
    All specs passed!                           00:01        1        1        -        -        -  

➜  admin git:(develop) ✗ 
```

Then, it exits

If any of the tests fails, I got the following:

```
> cypress run


====================

  (Run Starting)

  ┌──────────────────────────────┐
  │ Cypress:    3.1.5                                                                              │
  │ Browser:    Electron 59 (headless)                                                  │
  │ Specs:      1 found (Loader.test.js)                                                  │
  └──────────────────────────────┘


──────────────────────────────────
                                                                                                    
  Running: Loader.test.js...                                                               (1 of 1) 


  BIG DESKTOPS: Loader
    1) It should be align the loader to center horizontally and vertically


  0 passing (1s)
  1 failing

  1) BIG DESKTOPS: Loader It should be align the loader to center horizontally and vertically:

      AssertionError: expected 845 to equal 450
      + expected - actual

      -845
      +450
      
      at callback (http://localhost:3000/__cypress/runner/cypress_runner.js:54247:20)
      at getRet (http://localhost:3000/__cypress/runner/cypress_runner.js:53986:16)
      at tryCatcher (http://localhost:3000/__cypress/runner/cypress_runner.js:127195:23)
      at Function.Promise.attempt.Promise.try (http://localhost:3000/__cypress/runner/cypress_runner.js:124569:29)
      at thenFn (http://localhost:3000/__cypress/runner/cypress_runner.js:54000:26)
      at yieldItem (http://localhost:3000/__cypress/runner/cypress_runner.js:54253:16)
      at tryCatcher (http://localhost:3000/__cypress/runner/cypress_runner.js:127195:23)
      at Object.gotValue (http://localhost:3000/__cypress/runner/cypress_runner.js:126383:18)
      at Object.gotAccum (http://localhost:3000/__cypress/runner/cypress_runner.js:126372:25)
      at Object.tryCatcher (http://localhost:3000/__cypress/runner/cypress_runner.js:127195:23)
      at Promise._settlePromiseFromHandler (http://localhost:3000/__cypress/runner/cypress_runner.js:125213:31)
      at Promise._settlePromise (http://localhost:3000/__cypress/runner/cypress_runner.js:125270:18)
      at Promise._settlePromiseCtx (http://localhost:3000/__cypress/runner/cypress_runner.js:125307:10)
      at Async._drainQueue (http://localhost:3000/__cypress/runner/cypress_runner.js:122124:12)
      at Async._drainQueues (http://localhost:3000/__cypress/runner/cypress_runner.js:122129:10)
      at Async.drainQueues (http://localhost:3000/__cypress/runner/cypress_runner.js:122003:14)




  (Results)

  ┌─────────────┐
  │ Tests:        1                         │
  │ Passing:      0                       │
  │ Failing:      1                         │
  │ Pending:      0                       │
  │ Skipped:      0                       │
  │ Screenshots:  1                    │
  │ Video:        true                     │
  │ Duration:     1 second           │
  │ Spec Ran:     Loader.test.js  │
  └─────────────┘


  (Screenshots)

  - /home/odelucca/Servers/yurah/v2/frontends/admin/cypress/screenshots/Loader.test.js/BIG DESKTOPS Loader -- It should be align the loader to center horizontally and vertically (failed).png (1280x720)


  (Video)

  - Started processing:   Compressing to 32 CRF
  - Finished processing:  /home/odelucca/Servers/yurah/v2/frontends/admin/cypress/videos/Loader.test.js.mp4 (0 seconds)


======================

  (Run Finished)


      Spec                                                Tests  Passing  Failing  Pending  Skipped 
  ┌────────────────────────────────┐
  │ ✖ Loader.test.js                            00:01        1        -        1        -        - │
  └────────────────────────────────┘
    1 of 1 failed (100%)                        00:01        1        -        1        -        -  

npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! admin@0.1.0 cy:run: `cypress run`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the admin@0.1.0 cy:run script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /home/odelucca/.npm/_logs/2019-03-07T13_50_22_294Z-debug.log
➜  admin git:(develop) ✗ 
```

### Desired behavior:

It should be waiting for file changes and re run all tests if there is any change

### Steps to reproduce: (app code and test code)

Just run `cypress run`

### Versions

Cypress version: 3.1.5
",enhancement
417012969,Feature Request: User should be able to change config in cypress GUI interface,"### Current behavior:

Configuration can only be passed either by code or cli 

### Desired behavior:

Configuration can be modified through GUI interface

A use case would be:

We have a test suite that checks if all the strings on our web app are translated. 

The test code is the same for any given languages, all we change is the config parameter to select what languages we want to run with. 

Currently, I have to change the config file and restart GUI. It would be great if I can just change config on the GUI and run the test. 


### Versions

3.1.5
",enhancement
416901105,Feature request: let me use aliased values directly as parameters to 'should',"### Desired behavior:

I'd like to reference aliases in `should` parameters.

For example, testing a progress bar, I'd love it if I could write:

```js
  it('updates the progress bar', function() {
      cy.get('progress')
        .then($el => parseFloat($el.attr('value')))
        .as('progress0')
        .should('be.greaterThan', 0);
      cy.wait(2000);
      cy.get('progress')
        .then($el => parseFloat($el.attr('value')))
        .should('be.greaterThan', '@progress0');
  });
```

Instead, I have to implement it like this:

```js
  it('updates the progress bar', function() {
      cy.get('progress')
        .then($el => parseFloat($el.attr('value')))
        .as('progress0')
        .should('be.greaterThan', 0);
      cy.wait(2000).then(function() {
        cy.get('progress')
          .then($el => parseFloat($el.attr('value')))
          .should('be.greaterThan', this.progress0);
      });
  });
```

IMO, the first one is cleaner and doesn't rely on an unnecessary nested `then` function (or on the `this.` syntax which I don't like here).

If course, this would technically be a breaking change, since some users might actually have `'@'` characters at the beginning of the strings they're checking for.
In this case, maybe there'd be some way to escape them (`'@@'` ?)

If this is untenable, I'd settle for something like `cy.ref('@progress0')`.

### Versions

cypress 3.1.5
",enhancement
416240162,Add chapters keys in the video sequence for each test start/end.,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:
In the current video record output there is a plain sequence of the running tests in which we have to manually find for each test start/result.
<!-- images, stack traces, etc -->

### Desired behavior:
I would like to find for each test start in the video timeline sequence, through chapters keys.
<!-- A clear description of what you want to happen -->

### Versions
Latest Cypress on Windows 10.
<!-- Cypress, operating system, browser -->
",enhancement
416044650,Allow docking Command Log in different location - like below AUT window instead of on left,"### Current behavior:
The test web interface has the test list on the left and the web app on the right.

### Desired behavior:
It would be nice if there is an option to display the web app on top and the test list below it. This would work really well with a monitor that's turned 90 degrees. That way you have the web app, test list below it and dev tools on the bottom all on 1 monitor and you can keep a fullscreen editor on your main screen.
",enhancement
415326798,Link to docs from Command Log in Test Runner,"### Current behavior:

The Command Log, when listing each command does not link to the documentation for the command.

**No link to `cy.get()` doc anywhere in Command Log**
<img width=""436"" alt=""screen shot 2019-02-27 at 4 01 43 pm"" src=""https://user-images.githubusercontent.com/1271364/53522868-55825680-3aa9-11e9-97af-ea63ba770cac.png"">

**No link to `cy.get()` doc even in the console.log when clicking on get**
<img width=""591"" alt=""screen shot 2019-02-27 at 4 03 51 pm"" src=""https://user-images.githubusercontent.com/1271364/53522867-54e9c000-3aa9-11e9-92f2-75908794838c.png"">


### Desired behavior:

Have access to the command's documentation when reviewing the Command Log. This assumes that the person running the test may not have been the person who wrote the test - and wants to investigate what this command actually does. via @bahmutov 	suggestion from conference notes.

**Links to commands**

I know it's ugly, but it's the idea.

<img width=""439"" alt=""screen shot 2019-02-27 at 4 02 22 pm"" src=""https://user-images.githubusercontent.com/1271364/53522919-6d59da80-3aa9-11e9-8dc9-e7e255bb7adc.png"">

Also put a link in the devtools console.


### Versions

Cypress 3.1.5
",enhancement
415260563,Run selected subset of files from Cypress interface (multiple tests),"### Current behavior:

As far as I know cypress only allows you to run in 3 types of ways.
- UI
  - Run all specs located in the tests/integration folder
  - Run an individual test by clicking it
- CI / Command line
  - Run all specs
  - Run a folder of test using `--spec` option and specifying folder

### Desired behavior:

It would be nice if we could run tests in more flexible combinations.  Below is picture of what I'm imagining:

![cypresscheckboxes](https://user-images.githubusercontent.com/2856501/53512384-7c279980-3a77-11e9-91df-125e5466467a.png)

I assume this feature could be hidden by default so it doesn't overwhelm users, but maybe enabled with a setting such as ""Advanced Test Running"" or something to opt-in to.

Each test and folder would have a check box.  Modifying check of folder affects all children folders/tests.

There is button / warning to indicate when your selection deviates from normal and option to clear it in case people have checkbox selected but scroll down and might forget about it.  In worse case I think they would see it trying to run test that had accidentally remained checked, stop the tests, uncheck it and continue.

Related option would be that the ""Run All Specs"" option only runs the tests that are satisfying the search text filter.

### Versions

Cypress: Beta Version 3.0.3
Windows 10: 10.0.17763 Build 17763
Chrome: Version 72.0.3626.119 (Official Build) (64-bit)",enhancement
414858247,Multithreading or process based parallized test runs,"Cypress parallelization only works on OS level (add more machines to add parallization). But there is no reason cypress couldn't run multiple tests in parallel on one machine, just like Selenium supports with the `-w` flag.

Ideally `cypress --parallelization=n` should just work.
It could start one headless browser for each threads (or process) and run thread in parallel.

Cypress tests are inherently IO bound (they are interacting with an application. 
Therefore it should be easy to scale UP (one big beefy multicore machine) instead of scaling out (multiple machine)

I know this goes against the payment model of cypress (pay for parallization). But as an open source tool we should have this supported.",enhancement
414372632,Ability to bail running test if previous dependent test failed.,"### Current behavior:
Currently when you run a spec file with multiple test cases, they will all run and report their results of either PASS or FAIL.

After one test finished, the state of that test is left behind. It is quite possible for the next test to continue where the prior test left off. This is all good when the prior test passes, but it is not good when it failed since we don't need to waste time running the subsequent tests because we know they will fail. Which is why the Cypress documentation recommends writing bigger test cases that test more features.

### Desired behavior:

We need some mechanism to NOT run a test when a previous test it depends on fails, and to report it as not having been run.
 
I know the docs for Cypress discourages this practice, as have other test teams using other frameworks I have been on. I myself resisted it for a long time. However my manager insisted that I give it a try and when I did I discovered how elegant it actually was.

Prior to trying this I made bigger test cases that tested many features as it drilled down into the main feature being tested. But when I tried breaking those bigger tests into smaller test ""stages"" as I called them, putting each stage into the `it()` call, I could much more easily see in the test runner UI how the test progressed and at what stage the test failed. Since each stage is comprises of around 3-7 steps, it was much easier to pinpoint exactly where the failure was and in what iteration of the stage if it had been repeated.

Another benefit of this is that these tests became much more self-documenting.

### Versions
Cypress v3.0.3
Chrome Browser v72.0.3626.109

",enhancement
414177551,Proposal: Authenticate through user's installed browser,"### Current behavior:

Logging in with GitHub opens the Oauth authorize page in Cypress's packaged Electron, which causes issues:

- #1251 - Electron goes out of date and GitHub blocks logging in with it
- #1162 - Electron doesn't support hard tokens
- users can't see the URL of the page, could potentially be a security problem
- users can't use password vaults
- #4337 - networking bugs can cause auth not to work

### Desired behavior:

Logging in with GitHub through the desktop app opens a tab in the user's default system browser where they can authorize our app

Could be built by creating a HTTP server on localhost to accept auth redirects: https://stackoverflow.com/questions/37546656/handling-oauth2-redirect-from-electron-or-other-desktop-platforms

~~Or by creating a custom protocol handler and setting the GH redirect URL to that: https://glebbahmutov.com/blog/electron-app-with-custom-protocol/~~ Won't work, registering a custom protocol globally usually requires advanced permissions.",enhancement
414176742,Support Google Cloud Build details in Cypress Dashboard,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:

<!-- images, stack traces, etc -->
When using the Cypress Dashboard with Google Cloud Build, all of the Git information is coming back undefined/null.  From looking in the code, and asking on Gitter, it seems that is not currently supported.

### Desired behavior:

<!-- A clear description of what you want to happen -->
I would like the Cypress Dashboard to pull that information from Google Cloud Build and display it.  https://cloud.google.com/cloud-build/docs/configuring-builds/substitute-variable-values

### Versions

<!-- Cypress, operating system, browser -->
Cypress 3.1.5",enhancement
413383083,Support for graphql in e2e testing,"### Current behavior:
As far as I know there is no out of the box solution for stubbing graphQL requests.

With common api we can just do `route('GET', 'someurl', dataToReturn)`

Its really great and easy.

However, I can't find any clear, simple and documented solution to do something like this for graphQL. I understand that it may be a problem because it works differently.

But it could be great to have an ability to stub requests to graphQL.

Thank you

### Desired behavior:

Want to have an easy and clear handling of graphQL stubbing.
",enhancement
412544481,Offline timeline report,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:
Once the execution is complete, the user can view the timeline report for the current run, but there is no option for exporting the timeline report for future reference. Would be a good feature if timeline reports can be exported. That way the user does not have to create a cypress account in order to view the timeline report

<!-- images, stack traces, etc -->

### Desired behavior:
Option for exporting the report from the current run would be helpful (or) another option would be saving the files locally, so that it can be retrieved from a localhost port

<!-- A clear description of what you want to happen -->

### Versions
3.1.5

<!-- Cypress, operating system, browser -->
",enhancement
411549189,Support login via Google OAuth in Test Runner,"Cypress recently introduced the ability to login to the [Cypress Dashboard via Google](https://www.cypress.io/blog/2019/02/12/new-feature-log-in-to-the-cypress-dashboard-via-google/). While this is great for allowing a wider audience to access the Dashboard, the lack of feature parity with the Test Runner creates some awkwardness ... the requirement for a GitHub account in order to setup a project to record to the Dashboard.",enhancement
411152898,Inject an assertion after the request but before the response,"### Current behavior:

It is very common to have the UI display some kind of spinner or loading message while awaiting a response from an API call. Unfortunately, there is currently no way to ""pause"" a network request so that we can perform assertions before the response is received. The only option is to use a time delay which is flakey and an anti-pattern.

### Desired behavior:

To test this in a non-flaky way, it would be nice to be able to inject an assertion after the event that triggers the request but before the response is received. Something like:

```js
cy.route({
  onBeforeResponse: req => cy.get('[data-test-id=spinner]').should('be.visible') 
 ...
})
```

This would make the state much more deterministic as we would know that the request has been issued but that the response has not yet returned.

It's probably not possible to actually pause a request after it has been issued, but it should be possible to prevent the request from happening until some other event has taken place. For example, this could be implemented internally by wrapping the onBeforeResponse callback in a promise and delaying the request until onBeforeResponse is resolved. That way code like the following would be possible:

```js

cy.route({
  onBeforeResponse: req => cy.get('[data-test-id=spinner]').should('be.visible') 
 ...
}).as('apiCall')
cy.get('#button-that-triggers-apiCall').click()
cy.wait('@apiCall')
cy.get('[data-test-id=spinner]').should('not.be.visible') 
```

### Versions

Cypress: 3.1.5
macOS: Mojave 10.14.2
Chrome: Version 72.0.3626.109 (Official Build) (64-bit)

ref: #687 ",enhancement
410852101,Request: pointerLock support,"https://developer.mozilla.org/en-US/docs/Web/API/Pointer_Lock_API

### Current behavior:
Right now, it's not possible to use `trigger()` or any Cypress API for this, because the `pointerLock` API temporarily ""freezes"" the usual mouse event coordinate properties (`clientX`, `screenX`, etc). Instead, it adds 2 new properties: `movementX` and `movementY`.

<!-- images, stack traces, etc -->

### Desired behavior:
Would love to be able to simulate interactions that leverage `pointerLock`, e.g. alt-clicking to enter `pointerLock`, then dragging. 
",enhancement
410837174,Record video to my local while using cypress open,"### Current behavior:

Local recording of videos is limited to `cypress run`.

### Desired behavior:

I prefer to use `cypress open` rather than `cypress run`. I would like to locally record my videos while using `cypress open` as well. I do not want to write my recordings to the online dashboard.

### Steps to reproduce: (app code and test code)

Not Applicable

### Versions

Latest Cypress on Windows 10
",enhancement
408172733,Use fixture as request body shortcut,"It would be nice to be able to load and send a fixture file by name like

```js
it('finds issues mentioned', function () {
   cy.request('/api', 'fx:pr-opened')
})
```

Currently, have to load fixture and then send 

```js
it('finds issues mentioned', function () {
    cy.fixture('pr-opened')
      .then(data => cy.request('/api', data))
})
```",enhancement
408018807,Cypress Fails to Install with FreeBSD,"I would like to reopen this issue, which does not seem to have been addressed nor resolved. As Cypress is gaining popularity, the FreeBSD incompatibility is becoming more significant... What is the status, and is the developer team still adamant not to support FreeBSD (despite existing support for Mac)? Thank you for enlightening me.",enhancement
407800342,Add a way for custom commands to provide data for Dashboard,"External services, for example, visual diffing services, have 2 components. First is the custom command that takes the screenshot, sends the image to the external API, receives the result and continues.

For example, the test might have something like this

```js
it('looks the same', () => {
  cy.visit('/')
  cy.imageDiff('home page')
})
```

Second is the external diffing service dashboard that can show the image comparison. User has access to the 3rd party dashboard and would find the results for the above particular `cy.imageDiff()` call at some url like

```
https://app.image-diff-service.com/projects/abc123/e51d4263-1cf1-4d9c-8805-bd5fb311087f
```

If the test run is being recorded on the Cypress Dashboard, it would be nice to have this information and the right link to the external dashboard shown somehow.  For example, in addition to our own screenshots and video and terminal log, we could have a section with external links generated by the custom commands. Maybe somewhere here?

![screen shot 2019-02-07 at 11 53 44 am](https://user-images.githubusercontent.com/2212006/52427994-12971980-2acf-11e9-9394-ad755ea29502.png)

We can provide minimal information about each custom command

- external service name
- command parameters, like ""home page"" in the example
- success/failure status
- link to the external dashboard that should open at the relevant url

## Questions

- What information should we accept from the custom command?
- Should external services register with Cypress.io? How do we ensure that spam links to do start appearing in the Cypress Dashboard?
- Should we show the list of logical commands? And allow meta information on every command?
- Should we tie custom commands with this extra information to the timeline so we can add it to the video?",enhancement
407755117,cy.route() onRequest callbacks do not execute cy commands,"### Current behavior:

I'm stubbing a route and would like to execute some cy commands with in the `cy.route` `options.onRequest` callback function.

```js
it('Another look at route response callbacks', function() {
    auth.startSession(config.executionMode.e2e).then((token) => {           
        const baseUrl = useCI ? config.environment.CI.url : config.environment.LOCAL.url;
        const authUrl = `${baseUrl}/authenticate/cosi?signontoken=${token}`;

        cy.fixture('_landingPage.json').then((contents) => {
            const pdp1 = contents[3];

            const onRequest = () => {
                console.log(`console.log onRequest`); // logs as expected
                cy.log(`cy.log onRequest`); // *** appears to have no effect ***
            }

            cy.server();
            cy.route({
                'method': pdp1.method,
                'url': pdp1.url,
                'onRequest': onRequest,
                'response': pdp1.body
            }).as(pdp1.url);

            cy.log('hello world'); // logs as expected
            cy.visit(authUrl);
        });
    });
}
```

![image](https://user-images.githubusercontent.com/33003441/52421696-37cd5d00-2aba-11e9-8b31-01dfd24f21f2.png)


* The `cy.route` works fine and stubs the response.
* The `onRequest` callback is getting called as evidenced by the `console.log()` that works as expected.
* However the `cy.log()` (or other cy commands I put w/in the `onRequest` or `onResponse`) call backs silently do nothing.

### Desired behavior:

* either execute the cy commands or give an error explaining why they don't work

### Steps to reproduce: (app code and test code)

See code above. 

### Versions
* cypress: 3.1.4
* os: Windows 7
* chrome: 72
",enhancement
405405331,Proposal: Add support for delaying the mocha run,"Add support for delaying the mocha run. This is normally done with the [--delay flag](https://mochajs.org/#delayed-root-suite) or with `mocha.setup({ delay: true })`. 

Need to do the following:

* Add a way to turn this on, probably by adding a `delay` option for `cypress.json`.
* Expose a way to kick off the run. Mocha exposes a global `run` function, but we should probably create a `Cypress.run` method or something similar.

Addresses #3114 ",enhancement
405297849,Proposal: Add messaging capability between app code and Cypress,"This would allow the user to insert seems into their app code to aid with testing. 

For example, currently in the desktop-gui, we do [this in the code](https://github.com/cypress-io/cypress/blob/develop/packages/desktop-gui/src/main.jsx#L20):

```javascript
window.App = {
  ipc,

  start () {
    render(<App />, document.getElementById('app'))
  },
}
```

and [this in the test](https://github.com/cypress-io/cypress/blob/develop/packages/desktop-gui/cypress/integration/app_spec.coffee#L3):

```coffee
beforeEach ->
  cy.visitIndex().then (@win) ->
    { @start, @ipc } = @win.App

    cy.stub(@ipc, ""getOptions"").resolves({})

## later
it ""some test"", ->
  @start()
```

This is mainly so we can delay starting the app, which will automatically run some `ipc` calls before we can stub them. 

With the proposed API, this would look something like this in the code:

```javascript
const renderApp = () => {
  render(<App />, document.getElementById('app'))
}

if (window.cy) {
  window.cy.send('ready', { ipc }, renderApp)
} else {
  renderApp()
}
```

and this in the test:

```coffee
## option 1: with current API of cy.on:
beforeEach (done) ->
  cy.on ""app:message"", ""ready"", ({ ipc }, callback) =>
    cy.stub(ipc, ""getOptions"").resolves({})

    @start = callback
    done()

## option 2: with proposed listenFor/wait API:
beforeEach
  cy.listenFor(""app:message"", ""ready"").as(""ready"")
  cy.visitIndex() 
  cy.wait(""@ready"").then ({ ipc }, callback) =>
    cy.stub(ipc, ""getOptions"").resolves({})
    cy.stub(ipc, ""onMenuClicked"")
    cy.stub(ipc, ""guiError"")

    @start = callback


## later
it ""some test"", ->
  @start()
```

This eliminates the need for globals and allows these messages to be sent to Cypress in other places in the app as well.",enhancement
403926245,arrow keys to select specs in desktop-gui,"it would be nice to select specs with arrow keys in this view:

![image](https://user-images.githubusercontent.com/14625260/51854318-8596d800-22f8-11e9-8d69-b9490a4852fb.png)


if I'm typing in the search box, and hit `arrow down`, I would like it to highlight the first spec",enhancement
403567033,Api for plugins for ui customization. ,"I wanted to add plugin for coverage ui right within cypress ui. But there is no simple way to modify that ui. So I suggest to add some api for ui customization using plugin api. Thanks.
",enhancement
403372685,add Cypress.log.groupEnd() and Cypress.log.groupCollapsed(),"It would be nice `Cypress.log.groupEnd()` and `Cypress.log.groupCollapsed()` APIs similar to those of `console.groupCollapsed()` `console.groupEnd()` but **for the command log**

Cypress.log.groupEnd() and Cypress.log.groupCollapsed() similar to 

https://developer.mozilla.org/en-US/docs/Web/API/Console/groupCollapsed


This would help users make plugins like this proposal #1581 

- [ ] groupCollapsed, groupEnd
- [ ] custom styling of logs",enhancement
403215188,Feature request: test sections,"When I first started writing tests, I originally organized them like unit tests. This meant each test was small and contained, and only tested one simple thing.
I've learned that it's better to have larger tests that test an entire feature, since this speeds up test execution and reduces duplicated actions.
However, I still want to be able to ""group"" actions within a test, so I know what part of the test is running when I'm looking at the test log.
I've been using `cy.log` for this.  For example, here's a original test spec before I started grouping them together:

```
context('parameters', () => {
  it('allows the user to add a parameter');
  it('allows the user to delete a parameter');
  it('allows the user to rename a parameter');
});
```

And here's what I'm doing now:

```
it('allows the user to edit parameters', () => {
  cy.log('*** add parameter ***');
  cy.log('*** delete parameter ***');
  cy.log('*** rename parameter ***');
});
```

This works fine, but the `cy.log` statements get lost in the noise and are hard to pick out.

![screen shot 2019-01-25 at 10 50 18 am](https://user-images.githubusercontent.com/435418/51756467-0fdc0380-208f-11e9-843a-4dff33b186fd.png)

I'd love to have a `cy.section` command that works like `cy.log` but with some additional styling, e.g.:

![screen shot 2019-01-25 at 10 53 22 am](https://user-images.githubusercontent.com/435418/51756626-782ae500-208f-11e9-9c94-f3968dbbfff1.png)

Bonus points if I can expand/collapse the sections.",enhancement
402358032,Ability to console.log output from test files to stdout when running via `cypress run`,"### Current behavior:

If a test uses `console.log` to print output, it doesn't show up when running from the Cypress Module API (`cypress.run`).
I also tried `cy.log` and this didn't work either.

### Desired behavior:

Redirect `console.log` to print to the node console?

### Versions

3.1.4
",enhancement
402068602,Support for Early Hints (103 response code),"### Current behavior:

`cy.visit` crashes when accessing a page which uses Early Hints.

```js
// this line
cy.visit('https://my-app-staging.herokuapp.com/')
```

![image](https://user-images.githubusercontent.com/11358371/51582551-cf09b080-1f0f-11e9-9d31-7953706a441b.png)

Here is after adding the `failOnStatusCode: false` option.

![image](https://user-images.githubusercontent.com/11358371/51582710-97e7cf00-1f10-11e9-890d-a7f36ea86b40.png)

Here is a curl dump of the headers:

```bash
$ curl -i https://my-app-staging.herokuapp.com
HTTP/1.1 103 Early Hints
Server: Cowboy
Date: Wed, 23 Jan 2019 03:56:55 GMT
Connection: close
Link: <https://my-app-staging.herokuapp.com/assets/pages/teaser/application-75954bd9d7c1a87e0b297e6dd5d945d89555bb9af1be333d16a1aed75de349e9.css>; rel=preload; as=style
Via: 1.1 vegur

HTTP/1.1 103 Early Hints
Link: <https://my-app-staging.herokuapp.com/assets/pages/static/application-031d85232775d0f90de513495c11a5c867f975bcb49ab6b8afee3eaae5d1b065.js>; rel=preload; as=script

HTTP/1.1 200 OK
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff
X-Download-Options: noopen
X-Permitted-Cross-Domain-Policies: none
Referrer-Policy: strict-origin-when-cross-origin
Content-Type: text/html; charset=utf-8
ETag: W/""a0bd88dbe0de1e5905fafbe7d9319921""
Cache-Control: max-age=0, private, must-revalidate
Set-Cookie: _my-app_session=...; path=/; secure; HttpOnly
X-Request-Id: 29b23d23-de72-411a-88be-b71f53c2f8b7
X-Runtime: 0.011638
Strict-Transport-Security: max-age=31536000; includeSubDomains
Connection: close
Content-Length: 23509

<!DOCTYPE html>
... actual HTML below ...

```

### Desired behavior:

I want cypress to support Early Hints.

### Steps to reproduce: (app code and test code)

https://github.com/yanshiyason/cypress-early-hints-support-feature-request

### Versions

<!-- Cypress, operating system, browser -->

OS: macOS mojave 10.14.2
Chrome: 71
Cypress: Version 3.1.4 (3.1.4)
",enhancement
400435267,"cy.request(...) fails if server is not available, with no option to return or catch the connection error","### Current behavior

When you use `cy.request(...)` to connect to a server that isn't running, it throws a `CypressError` that is not possible to catch or otherwise handle gracefully:

```
CypressError: cy.request() failed trying to load:

http://localhost:5338/percy/healthcheck

We attempted to make an http request to this URL but the request failed without a response.

We received this error at the network level:

  > Error: connect ECONNREFUSED 127.0.0.1:5338
```

### Desired behavior

I would expect that something similar to `failOnStatusCode: false` exists to allow me to handle the ""connection refused"" case in the same way as I can handle a, say, 404 code.

An alternative could be a `catch` method to be chained off of `cy.request(...)`.

### Context

I'm adding new functionality to the Percy Cypress plugin, which is implemented as a custom Cypress command (https://github.com/percy/percy-cypress). I need to do a check to see if the local percy agent service is running, before proceeding with any more work. Our users typically want to be able to run their test suite with or without ""Percy mode"", so when the local percy service is not running, we'd like to issue a warning but otherwise allow tests to proceed normally.

Because I want to avoid CSP or other security issues in the browser, I want to use `cy.request(...)` or some other capability that allows me to do HTTP requests from outside of the browser context.

If I was doing this for my own test suite, I could use a new `cy.task(...)` to implement this healthcheck, but in the context of a Cypress plugin, that would require users to do additional setup in their `plugins/index.js`, in addition to what they already have to do in `support/commands.js`.

An alternate solution to this problem would be exposing an API in Cypress that allows me to programmatically add a `cy.task(...)` that I can then use in my custom command.

Another alternative would be a hook to catch this `CypressError` within a command, and the ability to inspect it and re-throw it if appropriate.",enhancement
399844388,Attachment path injected into the test object is not passed to the reporter,"### Current behavior:
New feature in **mocha-junit-reporter** allows for an attachment path to be included in the report output file. To achieve this the attachment path is injected into the test object:
```js
it ('should include attachment', function () {
  this.test.attachments = ['/absolut/path/to/file.png'];
});
```
(as described here: https://github.com/michaelleeallen/mocha-junit-reporter#attachments)

Currently Cypress does not pass the injected _attachment_ in the test object passed to the reporter:
```json
{
  ""title"": ""should include attachment"",
  ""pending"": false,
  ""type"": ""test"",
  ""body"": ""function () {\n  this.test.attachments = ['/absolut/path/to/file.png'];\n}"",
  ""duration"": 45,
  ""state"": ""passed"",
  ""parent"": ""#<Suite>"",
  ""id"": ""r2"",
  ""wallClockStartedAt"": ""2019-01-16T14:36:45.039Z"",
  ""timings"": {
    ""lifecycle"": 40,
    ""test"": {
      ""fnDuration"": 1,
      ""afterFnDuration"": 3
    }
  },
  ""speed"": ""medium""
}
```

### Desired behavior:

Cypress passes the injected _attachment_ in the test object passed to the reporter:
```json
{
  ""title"": ""should include attachment"",
  ""attachments"": '/absolut/path/to/file.png',
  ""pending"": false,
  ""type"": ""test"",
  ""body"": ""function () {\n  this.test.attachments = ['/absolut/path/to/file.png'];\n}"",
  ""duration"": 45,
  ""state"": ""passed"",
  ""parent"": ""#<Suite>"",
  ""id"": ""r2"",
  ""wallClockStartedAt"": ""2019-01-16T14:36:45.039Z"",
  ""timings"": {
    ""lifecycle"": 40,
    ""test"": {
      ""fnDuration"": 1,
      ""afterFnDuration"": 3
    }
  },
  ""speed"": ""medium""
}
```

### Steps to reproduce: (app code and test code)
Run test:
```js
it ('should include attachment', function () {
  this.test.attachments = ['/absolut/path/to/file.png'];
});
```
And view the object that is passed to the reporter.

### Versions
    cypress: 3.1.4

",enhancement
399527312,cy.fixture('foo.json') as text instead of object,"### Current behavior:

I have a fixture file that contains JSON data to be sent to the server to put the back-end in a specific state. It is sent as JSON text.
When using `cy.fixture()` or `cy.readFile()`, someone's parsing that JSON text and handing me an object.
Normally this is good, but in my case since I am just going to turn around and send the JSON text to the server, it seems like an unnecessary step to have to call `JSON.stringify`; why can't cypress just hand me the raw text?

### Desired behavior:

Add some option to `cy.fixture` that lets me force it to be text, even if the file extension is `.json`.

### Versions

3.1.4
",enhancement
397623661,Proposal: Launch single cypress test from vscode,"It would be awesome to be able to run a single cypress test in the cypress devtool directly from vscode. Currently something like that exists for debugging a jest test: 

![image](https://user-images.githubusercontent.com/2730609/50938055-5bee3d80-142b-11e9-8bcd-eb67d87f99f5.png)

As seen in the above photo, a user can hit ""debug"" and launch a debugging session for an individual jest test. I think it would be super awesome if I could press a ""run cypress"" button from the editor and have the devtool launch just that test. 

In order to get that feature to work I think a few things would need to be done: 

 - programmatic launching of a single test file using the `cypress open` command (not currently available according to https://docs.cypress.io/guides/guides/command-line.html#cypress-open). This would look like `cypress open mySpec.js`


 - programmatic running of just 1 test within a file (NOTE: **Not Essential** as this can already be done using it.only and is potentially a complicated issue, see https://github.com/cypress-io/cypress/issues/925)

 - actually making the cypress vscode plugin to put it all together!

I'd love to hear other people's thoughts on this. I just think it could make the already excellent cypress workflow even better!

Thanks!",enhancement
397618938,Provide a way for custom commands to retry on failed should(),"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:

```js
cy.get('#me').should('not.exist') // retries chain
cy.customGetById('me').should('not.exist') // does not retry
```

https://github.com/cypress-io/cypress/issues/1210#issuecomment-359075731


### Desired behavior:

```js
cy.customGetById('me').should('not.exist') // retries custom get if ""should"" fails
```
### Versions

Cypress 3.1.4

### Related

- https://github.com/cypress-io/cypress/issues/2670
- https://github.com/kentcdodds/cypress-testing-library/issues/30
- https://github.com/kentcdodds/cypress-testing-library/issues/23",enhancement
397060534,On-premise Dashboard,"## Problem

You organization would like to use [Cypress Dashboard](https://on.cypress.io/dashboard-service) but cannot send test results (names, timings, test bodies, screenshots, videos) to an external service.

## Proposal

Allow running Dashboard as a paid on prem solution. 

## Timeline

Far in the future. Requires bringing all our services into containers for deployment, rethinking charging and billing, support.

## Feedback

Is very welcome

## Related issues

- #3063
",enhancement
396768424,Add response alias support (res.alias),"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:

It's a bit error prone to wait for specific GraphQL queries, if they run simultaneously or their order of execution is unknown or the response times cause race conditions, as they all run on the same endpoint, for example `/graphql`.

My current workaraound is a recursive function: 

```js
export function waitForResponseFromGraphQLServer(query) {
  return cy
    .wait(""@graphqlResponse"")
    .then(r => Cypress._.get(r, 'response.body'))
    .then(xhr => Cypress.Blob.blobToBinaryString(xhr))
    .then(respString => JSON.parse(respString).data)
    .then(response => {
      if (response[query]) {
       // response did match the  query to be waited for?
        return cy.wrap(response[query]);
      }
     // response was for some other query -> recursive invokation
      return waitForResponseFromGraphQLServer(query);
    });
}
```

This works _often_, but suffers from some flakyness, which could also be caused by https://github.com/cypress-io/cypress/issues/2700. Also i'm not 100% sure how this recursion works with Cypress.

### Desired behavior:

A solution to define already on the route, _the content_ i'm waiting for, and keep waiting until i have found the specified content or the timeout is reached. This could be achieved with a validation callback option with the signature `xhrResponse => Promise<boolean> | boolean`. For example:

```js
cy.route({
  method: 'DELETE',
  url: '**/user/*',
  waitForContent: xhr => isResponseForGraphQLQuery(xhr, query)
//...
```
",enhancement
396151843,Feature Request: Support external api call to load fixed data in fixture,"### Current behavior:
Currently cypress fixture supports loading data from file only located in local drive.

```js
cy.fixture('logo.png').then((logo) => {
  // load data from logo.png
})
```

### Desired behavior:
Fixture should support loading data using external api call-
```js
cy.fixture('https://my-api.com/logo.png').then((logo) => {
  // load data from api
})
```",enhancement
395896770,Dashboard add comments,"### Current behavior:

There is no way of adding some comments to a failing test in the Cypress Dashboard

### Desired behavior:

I want to add some comments to a failing test. This so other testers know that I am looking at this failing test. This saves testers time in communication.

### Versions

3.1.4, Windows, Chrome
",enhancement
392716583,Get current test name within the currently running test.,"## feature

Sometimes users might need to know the name of the current test (current 'it' block and its parents). It would be nice to add the name to the object `Cypress.spec`. The name should have parts of each ""describe"" block from the parent to the test

```js
describe('foo', () => {
  describe('bar', () => {
    it('log spec info', function() {
      console.log(Cypress.spec)
      // {
      //   name: 'filter.spec.js',
      //   relative: 'cypress/integration/filter.spec.js',
      //   absolute: '/Users/janelane/Dev/web-app/cypress/integration/filter.spec.js',
      // . new property ""test"" with block and test names
      //   test: ['foo', 'bar', 'log spec info']
      // }
    })
  })
})
```",enhancement
392578350,Requery aliased DOM elements,"### Current behavior:

An alias onto a DOM selection is a snapshot. So `cy.get('@listElements').should('have.length', 2)` will yield the same result at any point in the test even if list elements are added or removed. 

This makes aliases difficult to use in some cases.

### Desired behavior:

An alias can be overwritten easily though. So you could write a command that overwrites a specific alias and use that instead of `get` (see `updatelistElements` command). But this breaks the readability and flow of the test a bit.

The `get` command does have all the information it would need to update the alias. The yield contains the `prevObject` property that can be traversed so that together with the `selector` property the alias can be updated.
This is illustrated in the `updateAlias` command that wraps a `cy.get` but updates the alias at the same time.

People could simply use the `updateAlias` command but it might also be nice to have this functionality in a different way.
Maybe a live alias could be created like so: `cy.get('li').as('listElements', {live: true})` that would always update the alias on a `get` command.
Or maybe the get could be use like this: `cy.get('@listElements', {update: true})`.

### A test script to illustrating the above

```javascript
Cypress.Commands.add('getListElements', () => cy.get('@list').find('li'))  
Cypress.Commands.add('updateListElements', () => cy.get('@list').find('li').as('listElements'))  
  
Cypress.Commands.add('updateAlias', domAlias => {  
    const aliasName = (domAlias.match(/^@(.*)$/)||[])[1]  
    return aliasName&&cy.get(domAlias).then($result => {  
        const tree = [$result]  
        while (tree[0].prevObject) tree.unshift(tree[0].prevObject)
        return tree.reduce(((cy,o)=>cy.find(o.selector)),cy.wrap(tree.shift().get(0).documentElement)).as(aliasName)
    })||cy.get(domAlias)  
})  
  
describe('TestAlias', () => {  
  
  beforeEach(() => cy  
    .get('body').then($body=>$body.get(0).innerHTML=`<ul><li></li><li></li></ul><button onClick=""document.querySelector('ul').appendChild(document.createElement('li'))"">add</button>`)  
    .get('ul').as('list')  
    .get('@list').find('li').as('listElements')  
    .get('button').as('addElement')  
  )  
  
  context('test', () => {  
    it('should not get correct amount of elements by alias', () => cy  
      .get('@listElements').should('have.length', 2)  
      .get('@addElement').click()  
      .get('@listElements').should('have.length', 2)  
    )  
    it('should get correct amount of elements by custom command', () => cy  
      .getListElements().should('have.length', 2)  
      .get('@addElement').click()  
      .getListElements().should('have.length', 3)  
    )  
    it('should get correct amount of elements by custom command that updates alias', () => cy  
      .get('@listElements').should('have.length', 2)  
      .get('@addElement').click()  
      .updateListElements().should('have.length', 3)  
      .get('@listElements').should('have.length', 3)  
    )  
    it('should get correct amount of elements by generic alias update command', () => cy  
      .get('@addElement').click()  
      .updateAlias('@listElements').should('have.length', 3)  
      .get('@listElements').should('have.length', 3)  
    )  
  })  
})
```

### Versions

Cypress 3.1.1",enhancement
392554825,Ability to capture video without test runner sidebar (command log),"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:
Currently the video recordings take the side bar, it is already possible to do screenshots without a sidebar since 3.0.0. I would propose allowing the same for video
<!-- images, stack traces, etc -->

### Desired behavior:
Have an option to capture the video without the sidebar to use the automated tests to create tutorials and guides easily that would be always up to date with the latest UI.

<!-- A clear description of what you want to happen -->

### Versions

<!-- Cypress, operating system, browser -->
",enhancement
392129877,Cypress.moment.locale() not setting locale in a test,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behaviour:

Currently, we can not set locale in Cypress with the context of file using `Cypress.moment.locale('fr')`

### Desired behaviour:

It should change the locale against `Cypress.moment` throughout the test

### Steps to reproduce: (app code and test code)

Create new spec file and paste the following code

```js
describe('test', () => {
  it('compare', () => {
    Cypress.moment.locale('fr');
    console.log('cypress', Cypress.moment().format('MMMM'));
  })
})
```

### Versions

os -> macos mojave 10.14
cypress -> ^3.1.0
",enhancement
390638119,Group tests to improve performance by reducing the amount of page loads,"### Current behavior:
When you want to improve runtime by reducing page loads you have to order your tests by their run order, even if that doesn't make sense from a logical standpoint.

I want to use Cypress to test a single page application that's different based on the parameters with which it's loaded. In this case, the parameters are `userId` and `authorization`. The application can get pretty complex so I order my test files by the part of the application they are testing. In some cases, properly testing the part of the application under test requires reloading the application with different parameters.

That also means that in my current implementation I'm reloading the page 50+ times, about 35 of which are the exact same page with the same `userId` and `authorization`. That's pretty wasteful.

### Desired behavior:
I want to be able to specify groups of tests across files that run with a single shared `before` script. That would allow me to set up the page in the `before` script and run my tests on that one instance of the application, greatly reducing the number of repeated steps required for running the suite.

Thinking I could control the Mocha instance of Cypress I [wrote a Mocha UI](https://www.npmjs.com/package/mocha-bundle-ui) to solve this problem. This package accurately describes the desired behaviour for me.

I've been asking about a way to accomplish this on Gitter but I didn't get a response, that probably means there is no way to do this yet.

### Versions
Cypress 3.1.3
Windows 7
Chrome 70
",enhancement
389150180,Change baseUrl during test (set to null) in order to visit local file instead of URL,"<!-- Is this a question? Don't open an issue. Ask in our chat https://gitter.im/cypress-io/cypress-->

### Current behavior:
We are currently implementing email confirmation test. 
We currently download the email file -> parse out the html content of it -> save it locally in fixture/. 

In order for `cypress.visit('path-to-local-file.html')` to load up the downloaded content, we need to change the `baseUrl` that was set in `cypress.json` to be empty. 

`Cypress.config('baseUrl', ' `');` doesn't switch `baseUrl` and keeps appending the path to local file to the original `baseUrl`, eg:  https://demo.test.com/fixtures/email-content.html

Also tried to follow https://docs.cypress.io/api/plugins/configuration-api.html#Usage but it also fails to switch out `baseUrl`. 

I couldn't find any workaround. 

One method I tried was NOT setting `baseUrl` in `cypress.json` and specify the main domain everywhere except for visiting local html file. But this also fails because we have a `before` hook that generates unique string for email and if you change the domain on `cy.visit()`, the `before` hook runs and the email file name won't match.

### Desired behavior:

`Cypress.config('baseUrl', ' ');` should switch baseUrl to none. 

### Steps to reproduce: (app code and test code)

Posting it as pseudo-code. Will fill in more details if needed.

**cypress.json**
```json
{
    ""baseUrl"": ""https://demo.testing.com"",
    ""userAgent"": ""testing""
}
```

**test spec file**
```js
 var emailFileName;

    before(function () {
        cy.log('ran');
        cy.task('generateGuid').then(function ($guid) {
            guid = $guid;
            emailFileName = 'tester' + guid + '@test.com';
            cy.log(emailText);
        });
    });

it('Register user', function () {

        cy.visit('/login'); //-> yields https://demo.testing.com/login
        // Fill up registration info then click 'Register' button

        cy.wait(5000);
        cy.get(sendConfirmEmailButton).click({ force: true });

        // wait for 30s to verify email body
        cy.wait(20000);
        cy.downloadEmailHtml(emailFileName, 'confirmAccount');
    });

it('Visit email user', function () {
        // Change baseurl
        Cypress.config('baseUrl', ' ');
        // TODO visit/load the confirm account html file
        cy.visit(`cypress/fixtures/confirmAccount_${emailFileName}@test.com.html`);
        cy.get('#templateBody')
            .contains('Click the button below to confirm your account');
    });
```

### Versions

Cypress: 3.1.3
OS: Mac- mojave
",enhancement
388361902,Allow for random spec ordering when running tests,"### Current behavior:

When running specs in cypress, the files run in alphabetical order, and tests within each spec run in order. See #2901.

### Desired behavior:

It'd be great to pass a flag into cypress (or for it to do some sort of optimization like Jest does) to randomize the order of test runs. This would allow tests that rely on other state to fail and could help increase confidence in how the app works.

### Versions

3.1.3, Alpine Linux, Electron
<!-- Cypress, operating system, browser -->
",enhancement
386978760,Add 'window:*' events,"Add a new event 'namespace' `window:*` where `*` is any event you can register on the `window`. So a user can do the following:

```javascript
cy.on('window:hashchange', (e) => {})
```

This would bind to the window's `hashchange` event and be unbound after the test finishes running. It would rebind if the page navigates. Any arbitrary window event can be bound and receives the event as normally binding with `window.addEventListener`.


```javascript
// instead of
cy.window().then((win) => {
  const handler = () => {
    // handling code
    win.removeEventListener('foobar', handler)
  }
  win.addEventListener('foobar', handler, false)
})

// the user can do this
cy.on('window:foobar', (e) => {
  // handling code
})
```",enhancement
386975173,Proposal: Add new event 'page:script',"This fires before a script is loaded on the page, whether it's an external script or an inline script. It will have a details object with the `type` ('external' or 'inline') and the `src` if it's external.

Need to handle the following scenarios:

- html with embedded `<script src=""..."">`
- html with embedded `<script>...</script>`
- dynamic JS with `document.createElement(...); document.body.appendChild(...)`

Need to come up with some good use-cases to inform the implementation and for documentation purposes.",enhancement
386974052,Proposal: Add new event 'page:formSubmit',"Fires when a form is submitted with details about the form. Serialize the form data like [jQuery.serialize()](https://api.jquery.com/serialize/).

Useful links:

* ['submit' event](https://developer.mozilla.org/en-US/docs/Web/Events/submit)
* [<form> element](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form)
* [form elements](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/elements)",enhancement
385530177,Allow one to store location as alias and visit it later,"### Desired behavior:

I would love if something like this would work:

```js
cy.location('pathname').should('match', /\/document\/(.*)/).as('document');

// ... much later ...

cy.visit('@document');
```",enhancement
384459511,Select / highlight text,"### Current behavior:

I'm having a hard time creating a text selection. Things I've tried: 

* `document.createRange()` and `window.getSelection()`
* Using `cy.trigger` to simulate a cursor drag over the paragraph.
* Using `dblclick` on the paragraph.

### Desired behavior:

Test highlighting text. 

![](http://g.recordit.co/e63MxidVQT.gif)

### Steps to reproduce:

I can provide sample code for the approaches I tried, but I'll hold off for now in case there's a completely different known way of doing this.

### Versions

Cypress 3.1.1, Chrome 70.0.3538.102",enhancement
383844041,Expose jQuery.expr and potentially other jQuery attributes & methods on Cypress.$,"While working on extending Cypress and hammer it to our needs (via custom commands, plugins, etc), I got stuck as I wanted to add a custom matcher to jQuery (via jQuery.expr - example here https://stackoverflow.com/a/18462522). Unfortunately, there's no way to do as only a handful of items are exposed (proxied) by cypress. This doesn't seem like a smart thing to do unless I'm missing something.

### Current behavior:

There's only a small subset of jQuery module exposed on the `Cypress.$`

### Desired behavior:

All jQuery properties & methods should be available for general use (`jQuery.expr` for instance). 

### Versions

Cypress 3.1.2, Ubuntu 18.04
",enhancement
383027034,Support mocking of iframe document response,"With ```cy.route``` it seems like document responses (GET-document requests) can not be mocked/replaced with fixture.

The use case is for having an foreign iframe embedded on our site and wanting to test our interaction with that iframe. But I can not reliably run the foreign iframe document in our tests.

It would be nice if (at least for relative paths, aka own domain) these responses could me mocked in cypress. If that's already possible with  ```cy.route```, please let me know.
",enhancement
382017032,File watch is not reliable when using 'safe write' in IDE.,"### Current behavior:

When file changes are ""safely"" saved by copying to a temp file, deleting the original, and then renaming the temp file, Cypress watch does not reliably detect the file change.

I noticed this issue because the *default* behavior in my IDE, WebStorm, is to use ""safe write"". This option is checked by default: Appearance & Behavior -> System Settings -> Use ""safe write"" (save changes to a temporary file first)
WebStorm setting description: ""If this check box is selected, a changed file will be first saved to a temporary file; if the save operation is completed successfully, the original file is deleted, and the temporary file is renamed.""

### Desired behavior:

Cypress should detect that files have been replaced and inspect for changes -- the way most other editors are able to do, like Notepad++.

### Steps to reproduce:

1. Start up cypress and watch for any spec file in Windows.
2. Delete the spec file and replace it with a copy with some changes.
3. Observe that Cypress does not reliably detect the change. (sometimes it does, which is weird)
4. Observe that clicking ""Run all tests"" again in the browser does not re-read the file.

### Versions

Cypress version: 3.1.1
Operating system: Windows 10
Browser: Chrome 70
IDE: WebStorm 2018.2.6

### Temporary Workaround

Disable ""safe write"" in IDE so that it does NOT save files using temp files and a delete/rename operation.
",enhancement
380950211,Introduce non case sensitive matching for cy.contains(),"### Current behavior:
`cy.contains('Capital Sentence')` does not match

`<span class=""capitalize""> capital sentence </span>`

where:
```css
.capitalize {
   text-transform: capitalize;
}
```

Is this expected? 

### Desired behavior:

I assumed it would match because that's what the user sees. However the underlying text in the DOM is indeed `capital sentence`.

### Steps to reproduce:

<!-- Issues without reproducible steps might get closed. *Tip* You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

### Versions

Cypress: 3.0.1
Chrome, Mac OS Mojave

",enhancement
379167159,Enable access to clipboard in test,"<!-- 
Is this a question? Do not open an issue. Please ask in our chat https://gitter.im/cypress-io/cypress

Want something newly documented? Please open an issue in the respective repo: 
- docs: https://github.com/cypress-io/cypress-documentation 
- example recipes: https://github.com/cypress-io/cypress-example-recipes
-->

### Current behavior:
There is no way to access the clipboard in a test, as far as I can tell.

<!-- images, stack traces, etc -->

### Desired behavior:
There should be an easy way to test what the clipboard holds. Useful for websites where text is placed in the clipboard using JS to transfere it somewhere.

<!-- A clear and concise description of what you want to happen -->

### Versions
all versions
<!-- Cypress, operating system, browser -->
",enhancement
378952378,Support for EventSource,"I would like to see the `EventSource` support because we use it extensively in our app.

### Current behavior:
`cy.route` doesn't identify `EventSource` requests and there is no way to watch them reliably now.

### Desired behavior:
Either `cy.route` should support it or we should have another API for EventSource.
",enhancement
377879416,"Improve selector playground suggestions, when element has a parent with data-test or id","If the target element has a parent/grandparent with a ""good"" selector like data-test/data-cy or id, but the target element has a class or something which happens to be unique on the page, I think the ""good"" selector should still be included in the suggestion.

#### Example HTML:
```html
<div data-test=""user"">
  <div class=""description"">...</div>
</div>
```
### Current behavior:
Suggested selector is `.description`
### Desired behavior:
Suggested selector should be `[data-test=user] > .description` or `[data-test=user] .description`",enhancement
377071621,Allowing setting Chrome bandwidth and latency setting,"### Current behavior:

Currently, during CI, the client-side connects to local server-side and this makes all API calls very fast. But in production, users are not so close to the server and I would prefer if I could test a more realistic scenario where there is a bandwidth and latency limits.

### Desired behavior:

In Chrome, in web development tool, you can configure the speed and latency override for all HTTP requests. I think it would be great if one could control this from tests in Cypress (or for all tests, or just for some). So that I could also test if on a very slow links behavior is as expected (for example, to test that loading UI element appears and so on).

### Versions

Cypress: 3.1.1
OS: Linux Ubuntu 18.04",enhancement
376439751,Pass flag '--use-fake...' flags to fake webcam in tests,"### Current behavior:
My client code is using the webcam. 
On ci there is no webcam. 
For Chrome and Chromium i can  fake the webcam using the code below in my `plugins/index.js`

```js
module.exports = (on, config) => {
  on('before:browser:launch', (browser = {}, args) => {
    args.push('--use-fake-device-for-media-stream')
    args.push('--use-fake-ui-for-media-stream')

    return args
  })
}

```

This makes my tests pass. 

On electron my test fails and i cannot seem to pass these options. 

On a system without webcam with chrome and the options set as explained above, the test succeeds.

On a system without webcam with electron the test fails. 

### Desired behavior:
Electron should use the fake-device and fake-ui by default to make tests pass, that require a webcam.

### Versions
cypress: 3.1.0
ubuntu 18.04.1 lts
chrome 70

### Reproducible Example

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset=""utf-8"">
  <meta content=""stuff, to, help, search, engines, not""
    name=""keywords"">
  <meta content=""What this page is about.""
    name=""description"">
  <meta content=""Display Webcam Stream""
    name=""title"">
  <title>Display Webcam Stream</title>

  <style>
    #container {
      margin: 0px auto;
      width: 500px;
      height: 375px;
      border: 10px #333 solid;
    }

    #videoElement {
      width: 500px;
      height: 375px;
      background-color: #666;
    }
  </style>
</head>

<body>
<div id=""container"">
  <video autoplay=""true""
    id=""videoElement"">

  </video>
  <div id=""statusElement"">Status</div>
</div>
<script>
  var video = document.querySelector('#videoElement');
  var statusElement = document.querySelector('#statusElement');

  if (navigator.mediaDevices.getUserMedia) {
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(function(stream) {
        video.srcObject = stream;
        statusElement.innerHTML = '<span>Webcam Success!</span>';
        console.info('Webcam Success!');
      })
      .catch(function(err) {
        statusElement.innerHTML = '<span>Webcam Error!</span>';
        console.error('Webcam Error!');
      });
  }
</script>
</body>
</html>
```

```js
describe('test-webcam', () => {
  it('should work', () => {
    cy.visit('test-webcam.html');
    cy.get('#statusElement').contains('Webcam Success!');
  });
});
```
",enhancement
376142518,Send a PKI from the client to the server,"Need a way to send a PKI from the client to the server when it is requested by the server on login (two way SSL).

On connecting to our application, the server requests a PKI / personal certificate from the client.  This PKI is unique to the user; it is installed in the browser so that they can authenticate to websites with it.

The browser prompts the user to “Select a certificate to authenticate yourself”, where the user can select OK to send it.

This prompt/dialog isn’t appearing in Test Runner.  Instead, our custom error message indicating that the user did not send a PKI is displayed.

I attempted to use a group policy to force all instances of Chrome to auto select a certificate, but the PKI still isn’t sent from the client to the server. The group policy does work for all other instances of Chrome that aren’t created by Cypress.",enhancement
375042462,Proposal: Make base path for cy.readFile / cy.writeFile configurable,"Address #2672 by adding a configuration option for the base path of `cy.readFile` and `cy.writeFile`. Currently, it's hard-coded as the project's root. With a configuration option, it makes it easier to have different base paths for different environments.
",enhancement
374970567,Automatically accept geolocation permission / mock geolocation for tests,"### Current behavior:
I have a map and a button in my app. When user clicks the button it identifies it’s current position and map pin moves to the current location of the user. This does not happen when running cypress tests.

### Desired behavior:

When running cypress test I want to be able to get the location of user and the map to show that position changes. 

### Steps to reproduce:

I created a simple POC – https://github.com/akozmanyan1/geolocation-bug 
Just download and run it - '$ npm run serve'.
You also will need to open cypress - '$ ./node_modules/.bin/cypress open'

### Versions

Cypress - Running Electron 59
OS: Windows 10
browser: Google Chrome - Version 69.0.3497.100
",enhancement
374781194,Cypress.Commands.add needs option to force retry on that command,"I've created a custom Cypress command that contains no calls to any other cypress cy.commands. Essentially it does this (simplified example):

`    var elements = Cypress.$(selector)
    expect(elements[0].innerHTML).to.equal(expectedValue)
`
But this does not retry as I expected it to. ALSO your document [https://docs.cypress.io/api/cypress-api/custom-commands.html#Retryability](https://docs.cypress.io/api/cypress-api/custom-commands.html#Retryability) says ""WIP"" so it is not clear what Cypress does or does not support.",enhancement
374288384,before and after hooks should be more intuitively displayed in test runner,"### Current behavior:

The following test structure ...
```js
describe('describe 1', () => {
    before('before all 1', () => {
        cy.log('before all 1');
    });

    beforeEach('before each 1', () => {
        cy.log('before each 1');
    });

    it('it A', () => {
        cy.log('it A')
    });

    it('it B', () => {
        cy.log('it B')
    });

    afterEach('after each 1', () => {
        cy.log('after each 1');
    });

    after('after all 1', () => {
        cy.log('after all 1');
    });
});

```

... results in the following view in the cypress test runner gui

![image](https://user-images.githubusercontent.com/7323845/47555316-c5ba7900-d90b-11e8-8101-a7c7486996cd.png)

The `before` hook is rendered into the first `it` hook. The `after` hook into the last `it` hook.  

### Desired behavior:
The `before` and `after` hooks should not be part of the `it` hook, they should placed inbetween describe and it.
The description of the hooks are missing in the cypress test runner gui.

### Versions
Cypress 3.1.0
Windows 10
Electron 59",enhancement
370215346,Introduce CYPRESS_DOWNLOAD_BASE_URL to specify a base download url,"In a corporate environment it may be necessary to download cypress through a proxy host because `https://download.cypress.io` isn't directly accessible. While it is possible to host specific, previously downloaded binaries and passing `CYPRESS_INSTALL_BINARY` to the installation, this loses the flexibility to provide current versions for different operating systems without maintenance.

This PR introduces a `CYPRESS_DOWNLOAD_BASE_URL` env variable which allows to override the base url which is currently hardcoded to `https://download.cypress.io/`. For example, when installing the package with `CYPRESS_DOWNLOAD_BASE_URL=https://example.org/cypress` it will attempt to download from `https://example.org/cypress/desktop/0.20.2?platform=OS&arch=ARCH`.

A proxy like [Nexus](https://github.com/sonatype/nexus-public) or some kind of web server configured as reverse proxy can be used to forward (and cache) requests to `https://download.cypress.io` and provide cypress to all clients inside the network.",enhancement
369273669,Cypress module API should return dashboard URL of recorded run,"### Current behavior:

I'm running Cypress programmatically with the module API. I want to send a Slack message with the dashboard URL for failed runs. Currently, the dashboard URL of the recorded run is printed to stdout but not included in the return value of `cypress.run`.

### Desired behavior:

`cypress.run` return value should include a key called `dashboardUrl` with the a value like `https://dashboard.cypress.io/#/projects/asdf/runs/123`.

### Versions

Cypress 3.0.2
",enhancement
367908054,cy.clearLocalStorage should clear all localStorage of all domains,"<!-- 
Is this a question? Do not open an issue. Please ask in our chat https://gitter.im/cypress-io/cypress

Want something newly documented? Please open an issue in the respective repo: 
- docs: https://github.com/cypress-io/cypress-documentation 
- example recipes: https://github.com/cypress-io/cypress-example-recipes
-->

### Summary of this thread so far
`cy.clearLocalStorage` doesn't behave the way I assumed it would. It doesn't clear _all_ local storage. The docs have since been updated to reflect this.

---

### Current behavior:

I was trying to write a simple test for some to do list website when I noticed that certain state wasn't being cleared correctly between tests. So I added some sanity checks like `cy.clearCookies()` and `cy.clearLocalStorage()` - which in theory should be redundant - and then I observed this: https://youtu.be/x6Yeh6WM5fM

Oddly enough, it looks like local state is magically reappearing for reasons I don't understand. Any idea what's going on? Here's the code snippet I executed:

```javascript
describe('Hello world', () => {
    before(function () {
        cy.viewport(1200, 660)
        cy.clearCookies()
        cy.clearLocalStorage()
        cy.wait(20000)
        cy.visit('https://www.any.do/').contains('Login').click()
        cy.contains('ALREADY A MEMBER?', {
            'timeout': 10000
        }).click()
        cy.get('#emailSignin #email').type('spam@pieterdedecker.be')
        cy.get('#emailSignin #password').type('badpassword')
        cy.contains('SIGN IN').click()
    })

    it('Is a test', () => {
        cy.log('Look!')
    })
})
```

Even going into the developer tools, Application tab, clicking 'Clear storage' and then clearing everything doesn't reset it. The only workaround I have found is selecting the local storage data for https://web.any.do and clicking 'Clear All'.

### Desired behavior:

The old local storage data should not reappear when the test reaches the domain https://web.any.do.

### Steps to reproduce:

1. Run this script with valid credentials. I've changed my example account's password, but you can use anydo@mailinator.com with password 'anydone'. The script should work even without the `cy.wait`; that was just to give me time to inspect cookie/local storage beforehand.
2. The test will pass.
3. Rerun the test.
4. The test will fail because it suddenly remembers the login.

### Versions

Cypress v3.1.0, Electron 59",enhancement
366638833,Ability to add tag to run to display in 'Runs' list in Dashboard UI,"
### Current behavior:

Dashboard UI does not show environment

![screen shot 2018-10-04 at 9 15 42](https://user-images.githubusercontent.com/34907201/46456050-2f84ae80-c7b6-11e8-9d12-42fb585552af.png)

### Desired behavior:

Hi,
Is there an option to add environment to the dashboard UI?
So for example if we run sanity tests (or any e2e) for the same project on different environments we have no way to know where did the test ran.

for example screen shot above, test num 100 can run on production, text 101 can run on qa etc...
It would be great to see the env straight on dashboard without entering the test and figuring out where it ran.

### Versions

cypress: v3.1.0
os: CentOS 7.3.1611
browser: Electron 59.0.3071.115",enhancement
366011327,FR: Add UI to denote context function,"### Current behavior:

![image](https://user-images.githubusercontent.com/1542376/46366810-0ba45a00-c64a-11e8-908d-bacdc82ba77f.png)

The tests in the image above are wrapped in 

```js
context(""Profile"", function(){

});

context(""Favourites"", function(){

});

...etc
```

But none of that shows up in the UI anywhere.

### Desired behavior:

I'm using the ""Log"" because I want the UI to break me out some detail, but it would be great if somehow ""context"" was nested into the UI somewhere instead.

Ideally just more `it()` methods would work too, then I'd get the nice checkmarks by them, but every `it()` is a new page request and the site is protected so I need to load a custom route and log the user in to run the test... so it's very time consuming to visit a new page on every contextual test just for UI embellishments.",enhancement
364744701,Switch to using proxy pac files ,"Instead of configuring each individual browser's `proxy` settings we should switch to using a pac file, which is much more flexible and gives us the ability to consistently work the same way in all browser agents.

A pac file also makes it easy to bypass the proxy and forward directly to servers running on loopback for automation purposes.",enhancement
363593864,Disable parallelization when dashboard service is unavailable,"### Current behavior:

With the recent all day crash of the dashboard, those of us that have integrated with the dashboard were burned pretty badly.  Our cypress tests had been so reliable that we had them set up as a gate to ship code.  When the dashboard went down yesterday all our cypress runs failed with the error below, which meant we were unable to ship code until the job was reconfigured to run tests serially.

```
14:00:40 cypress-e2e_1  | We encountered an unexpected error talking to our servers.
14:00:40 cypress-e2e_1  | 
14:00:40 cypress-e2e_1  | Because you passed the --parallel flag, this run cannot proceed because it requires a valid response from our servers.
14:00:40 cypress-e2e_1  | 
14:00:40 cypress-e2e_1  | The --ciBuildId flag you passed was: 290
14:00:40 cypress-e2e_1  | 
14:00:40 cypress-e2e_1  | The server's response was:
14:00:40 cypress-e2e_1  | 
14:00:40 cypress-e2e_1  | StatusCodeError: 503 - ""<!DOCTYPE html>\n\t<html>\n\t  <head>\n\t\t<meta name=\""viewport\"" content=\""width=device-width, initial-scale=1\"">\n\t\t<meta charset=\""utf-8\"">\n\t\t<title>Application Error</title>\n\t\t<style media=\""screen\"">\n\t\t  html,body,iframe {\n\t\t\tmargin: 0;\n\t\t\tpadding: 0;\n\t\t  }\n\t\t  html,body {\n\t\t\theight: 100%;\n\t\t\toverflow: hidden;\n\t\t  }\n\t\t  iframe {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tborder: 0;\n\t\t  }\n\t\t</style>\n\t  </head>\n\t  <body>\n\t\t<iframe src=\""//www.herokucdn.com/error-pages/application-error.html\""></iframe>\n\t  </body>\n\t</html>""
```

### Desired behavior:

Cypress should ping the dashboard and if it is unavailable, run tests serially instead of just bombing (remove the `--parallel`, `--record`, `--key`, and `ci-build-id` flags.  Slow tests are better than broken tests.

### Steps to reproduce:

1) Kill dashboard
2) Run tests that communicate with dashboard

### Versions

Cypress 3.1.0",enhancement
363549274,Add ability to configure ‘upload’ and ‘storage’ of videos separately when test suite passes/fails.,"<!-- 
Is this a question? Do not open an issue. Please ask in our chat https://gitter.im/cypress-io/cypress

Want something newly documented? Please open an issue in the respective repo: 
- docs: https://github.com/cypress-io/cypress-documentation 
- example recipes: https://github.com/cypress-io/cypress-example-recipes
-->

### Current behavior:

Currently, it's only possible to switch the video feature on or off in a binary way.

<!-- images, stack traces, etc -->

### Desired behavior:

To be able to record and process videos only when a test fails. If there's no way to do this (due to the recording feature not knowing whether a test will fail or not when it begins to record) - the processing part could at least be tweaked so that only failed tests have their videos processed and saved, whereas passing tests are technically recorded, but never processed or saved to disk if the test passes.

<!-- A clear and concise description of what you want to happen -->

### Versions

Cypress 3.1.0
Chrome 69
Electron 59
",enhancement
362527569,Enable dashboard login with email and password,"### Current behavior:

I can login only with my GitHub account which is linked to my private email address.

![screen shot 2018-09-21 at 11 07 32](https://user-images.githubusercontent.com/31006608/45871827-aec5bb80-bd8e-11e8-85ad-4f6edf342078.png)

This leads to all of the organization members having their own GitHub account with their private email addresses linked to Cypress.

<img width=""808"" alt=""screen shot 2018-09-21 at 11 03 14"" src=""https://user-images.githubusercontent.com/31006608/45872170-a02bd400-bd8f-11e8-9793-c07f7f850a02.png"">

### Desired behavior:

We would like to be able to link the company email addresses to Cypress with user accounts independent from GitHub for several reasons:

- Private email accounts generally shouldn't be exposed to the company.
- Currently someone with access to a private email account of one of our employees could get access to the Cypress dashboard of our company, which is a security issue as we don't have any control over private email accounts.
- Employees who leave the company still have access to the Cypress dashboard until we revoke access manually.

### Versions

https://dashboard.cypress.io on 21.09.2018",enhancement
361706990,Mock websockets,"### Current behavior:
We can use `cy.server()` and `cy.route(...)` to mock HTTP calls.

### Desired behavior:
The exact same thing for Websockets.

For apps using websockets quite heavily this would come really handy.

Might be related to [https://github.com/cypress-io/cypress/issues/199](https://github.com/cypress-io/cypress/issues/199)

Would be great to have the ability to watch a bi-directional web socket to process messages from the back-end as they are received.

Use Case:

User preforms a action through the front-end which actions several back-end events.  It would be great if we could monitor that these different events did occur (there is an endless amount of different events and combinations of events).

What would be great if there was a simple message pool/queue or a way to ""monitor"" a bi-direcitonal websocket and capturing the messages received from the back-end.

We would then write tests to check if those events are being executed by looking at the socket/pool/queue and seeing if the events were received after X user actions.

",enhancement
358277821,"Allow cy.wait command to accept ""requestTimeout"" and ""responseTimeout"" option.","### Current behavior:

The `cy.wait` command does not respect the ""requestTimeout"" option. The following command will still timeout waiting for a request to begin after 5000ms:
```js
cy.wait('@completeUpload', {requestTimeout: 20000})
```

### Desired behavior:

The following command should wait up to `20000ms` for a request to start before timing out.
```js
cy.wait('@completeUpload', {requestTimeout: 20000})
```

### Steps to reproduce:

```js
cy.wait('@completeUpload', {requestTimeout: 20000})
```

### Versions

Cypress: 3.1.0
OS: macOS 10.13.6
Browser: Chrome 68

### Workaround

Setting timeout, as the documentation states, appears to set both `requestTimeout` and `responseTimeout`.

```js
cy.wait('@completeUpload', {timeout: 20000})
```",enhancement
358101731,Delay for Non-Stubbed Responses not supported,Cypress does not delay non-stubbed responses e.g. responses to API endpoints.,enhancement
357657295,When dealing with blank ciGroupId should ask API to determine it,"If running with `--record --parallel` or `--record --group` mode and without user-supplied group id, do not try to guess if we have all environment variables from the provider to know the group id.

Instead send all environment variables for the provider and let API respond with run or error. The error could be really specific to the provider!

Related to https://github.com/cypress-io/cypress/issues/2439 and PR https://github.com/cypress-io/cypress/pull/2422",enhancement
357308309,Allow sameSite in setCookie,"### Current behavior:

setCookie has the options  ""domain"", ""name"", ""value"", ""path"", ""secure"", ""httpOnly"", ""expiry""

### Desired behavior:

setCookie should also allow setting the ""sameSite"" option

### Versions

Cypress 3.1.0

sameSite is described in https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie
",enhancement
355852493,Support For Chrome Native Messaging,"Hi All,
I am new to Cypress and find it very useful for testing my javascripts.
I have created a chrome extension and I am using Chrome Native Messaging to communicate with my Chrome Extension with my Host.

I want to know whether Cypress uses Chrome Native Messaging to perform automation on Chrome Browser or not.

Link to get information about Chrome Native Messaging : https://developer.chrome.com/apps/nativeMessaging.

Also if possible please give the code-snippets for the same.

",enhancement
353137799,implement modifier effects for copy and paste,"### Is this a Feature or Bug?
Feature

### Current behavior:
`cy.get('input').type('{cmd}c')` types in character 'c' instead of simulating copy event.
`cy.get('input').type('{cmd}v')` types in character 'v' instead of simulating paste event.
### Desired behavior:
`cy.get('input').type('{cmd}c')`  simulates copy event.
`cy.get('input').type('{cmd}v')` simulates paste event.

### Versions
Cypress- 3.1.0, operating system- MacOS Sierra 10.12.6, browser- Chrome 68.0.3440.84
",enhancement
350287849,Memory analysis integration with Cypress,"### Is this a Feature or Bug?

This is a feature. Is there any way to utilize existing memory analysis tool with Cypress, which can help in detecting memory issues/leaks.
<!-- 
Is this a question? Do not open an issue. Please ask in our chat https://gitter.im/cypress-io/cypress

Want something newly documented? Please open an issue in the respective repo: 
- docs: https://github.com/cypress-io/cypress-documentation 
- example recipes: https://github.com/cypress-io/cypress-example-recipes
-->

### Current behavior:
Currently, there is no way to get the heap snapshot at a particular time instance, or say step in the input test. Hence, memory debugging is difficult.

<!-- images, stack traces, etc -->

### Desired behavior:
Developer should be able to insert hooks at various steps and request heap snapshots. This will help in memory debugging.

<!-- A clear and concise description of what you want to happen -->

### Steps to reproduce:

<!-- Issues without reproducible steps might get closed. *Tip* You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

### Versions

<!-- Cypress, operating system, browser -->
",enhancement
350031912,Ability to tell Cypress we're on retina screen and browser render accordingly.,"### Current behavior:

Given HTML like this:

```html
<figure>
    <picture>
        <source media=""(min-width: 1000px)""
         srcset=""https://placeimg.com/750/500/any, https://placeimg.com/1500/1000/any 2x"">
        <img alt="""" src=""http://example.com/some/fallback/image"">
    </picture>
</figure>
```

If we set Cypress viewport to a large size:

```js
cy.viewport(2880, 1800);
```

...and we then get the computed image of the srcset:

```js
cy.get(`figure img`).then($image => {
    expect($image[0].src).to.equal('https://placeimg.com/1500/1000/any');
});
```

I would expect the large viewport size to deliver the high-res image (https://placeimg.com/1500/1000/any), but I'm actually getting the low-res image (https://placeimg.com/750/500/any). Same happens if I set it to `macbook-15`.

### Desired behavior:

There should be a way to tell Cypress we're on a retina screen, and the browser should render accordingly.

### Steps to reproduce:

Write any HTML that offers a retina option, and try to test for the retina option being delivered. It currently doesn't seem possible in Cypress.

### Versions

Cypress: 3.0.1, OSX, Headless",enhancement
348106436,Proposal: Allow Users To Set Custom Title for Integration Test for GUI,"### Current behavior:

In the Cypress GUI, the listed integration tests for a given workspace are labeled by their file name and there is no option to customize these labels/titles.

![screen shot 2018-08-06 at 3 22 08 pm](https://user-images.githubusercontent.com/6406400/43743982-da7189f6-998c-11e8-856b-4403b0b1ea4f.png)

### Desired behavior:

Inside of an integration file, allow users to indicate a label/title to be used with the given test when listing the integration files in the GUI.
```
/* cy:title: 'GET /users/:id' */
```
Including (something along the lines of) the above comment in an integration file would set the ""title"" for this test in the GUI to: 
`""GET /users/:id""`

This creates enhanced usability and customization when running tests via the GUI.
",enhancement
347948978,Proposal: update cy.task so that subsequent calls merge events,"Currently, if there are 2 `task` events registered in the plugins file, the second one will overwrite all the task events registered by the first call. This would most likely happen if using a 'plugin' that accepts the `on` function and registers the `task` event:

```javascript
// plugins file
const somePlugin = require('some-plugin')

module.exports = (on) => {
  on('task', {
    'task:one' () {},
    'task:two' () {},
  })

  somePlugin(on)
}
```

and 'some-plugin' looks something like:

```javascript
module.exports = (on) => {
  on('task', {
    'plugin:task:one' () {},
    'plugin:task:two' () {},
  })
}
```

Even though they each registered different task events, the user's task events are overwritten by the plugin. Instead, all the events should be merged together and registered. 

We need to handle event conflicts in some way, in case there is an attempt to register the same task event twice. We'd probably just prefer the last one registered, but perhaps we should log a warning. In any case, we need to make sure the user has control over which event is preferred. ",enhancement
347945873,Proposal: Add more plugin events to mirror driver events,"Add the following plugin events that mirror [the driver events](https://docs.cypress.io/api/events/catalog-of-events.html#Cypress-Events) that occur in the browser.

* test:before:run
* test:after:run

Related: #2177",enhancement
347891104,Indicate when API retries happen...,"When API failures occur during recording, display a message indicating the retries and the delay periods.",enhancement
347730509,Show the estimated duration per spec when it begins to run and in the summary,When a run starts we now estimate the wallclock duration. We should display it when the spec begins and also in the summary results.,enhancement
347067520,load fixtures from a key management system,"### Current behavior:
I can load data from `.json` files (and other formats) from the `/fixture` folder

### Desired behavior:

I would love to have the possibility to load users from a `keepass` file. (or any other key management system) This would mean that I had to type in the master password everytime when I start a test suite, but it would help with a lot of issues. In my company test accounts, especially when they are live accounts, are a extremely sensitive topic and I cant just include their passwords in a git repository.

### Versions
-all versions

Any idea how I could accomplish this or is this a new feature?",enhancement
347001995,Get a file stream,"<!-- 
Is this a question? Do not open an issue. Please ask in our chat https://gitter.im/cypress-io/cypress

Want something newly documented? Please open an issue in the respective repo: 
- docs: https://github.com/cypress-io/cypress-documentation 
- example recipes: https://github.com/cypress-io/cypress-example-recipes
-->

### Current behavior:

Cypress offers 'readFile' which returns a string with file contents

### Desired behavior:
I'd like to be able to get hold of a stream for a file on the file system which I can then uses with `cy.request`. The purpose is to test API endpoints which expect a binary stream as the POST content.

For example, from nodeJS with e.g. superagent I can do something like
```JS
const stream = fs.createReadStream('path/to/my.json');
stream.pipe(req)
```

I have tried doing

```JS
const data = cy.readFile(path, 'binary')
const blob = new Blob([data])
cy.request({
  url: '<url>'
  method: 'POST',
  json: false,
  body: blob
  headers: { ... }
})
```
But it doesn't work in the same manner

### Versions

<!-- Cypress, operating system, browser -->
cypress 3.0.3, Chrome 67, Ubuntu 18.04
",enhancement
345834846,Blur active element if cy.type subject is 'body',"**Currently**, if `cy.type`'s subject is `body`, Cypress will not blur the active element, and instead just send key events to the body while ignoring typing any characters and skipping actionability checks

**Instead**, Cypress should blur the active element. This makes sense because the user can't type into the body if there is an active element that's typeable",enhancement
345831989,Focus instead of click before cy.type,"**Currently**, if the active element isn't the subject of `cy.type`, Cypress issues a `click` to the element.
**Instead**, Cypress should call the native `focus()` method

This is a breaking change, because Cypress would no longer be sending a click",enhancement
345827798,cy.type should follow activeElement,"During `cy.type()`, if a typeable element is focused other than the command's subject, Cypress should start typing into the newly focused element

This is a patch change, despite cypress behavior changing, because previously `cy.type` would continue to type into the subject, despite other elements gaining focus",enhancement
343773145,"cy.contains('foo', { yieldAll: true })","## FEATURE REQUEST

### Current behavior:

cy.contains() yields only the first matched element and there is no config option to allow yielding of all matched elements. Only viable workaround for this is to use the `cy.get(el:contains(foo))` pseudo selector which is potentially deprecated (I couldn't find it mentioned in the current css3 spec) and kind of unknown/hacky. I had to dig to find out it was actually a thing.
 
### Desired behavior:

Add a new `yieldAll` property to the acceptable options config object for cy.contains. It's default state would be `false` and would behave as it currently does only returning first matched element. If set to a value of `true`, it will yield all matched elements, setting them as the subject and behave the same as a cy.get with the :contains pseudo selector currently does.

### Example

```js
 cy
    .get('.link')
    .contains('Sign Up', { yieldAll: true })
    .each(($el) => {
        expect($el).to.have.attr('href', '/sign_up');
    });
```

Idea inspired by [this gitter discussion.](https://gitter.im/cypress-io/cypress?at=5b56273eee530e4aac919a62)",enhancement
342367199,Monorepo with multiple apps usage - allow passing of `projects` array to `cypress run`,"Say I have a monorepo with multiple apps which share libs. If i modify a shared lib and want to test if my apps pass the tests, what is the best approach?

```
- packages
	- app-1
		- cypress
	- app-2
		- cypress
	- shared-library-1
	- shared-library-2
```

- Can I have cypress search for multiple `integrationFolders` so that a single test run will test all my apps?
- Maybe I could use a `cypress` dir in the monorepo root, then have symlinks to the different `cypress/integration` folders in each app in the monorepo?",enhancement
341713871,Error when passing baseUrl with value null or undefined to cypress.run,"### Current behavior:

When you pass a config to cypress.run and it contains the `baseUrl` param with the value `null` (which is its default value: https://docs.cypress.io/guides/references/configuration.html#Global) or `undefined` it throws the error: 

Expected 'baseUrl' to be a fully qualified URL (starting with http:// or https://). Instead the value was: ""null""

### Desired behavior:

Should execute the tests just like if you didn't pass the `baseUrl` param.

### Steps to reproduce:

This is a code similar to the one I tried to run:

```js
const cypress = require('cypress')

cypress
      .run({
        headed: false,
        watchForFileChanges: false,
        config: {
          record: false,
          video: false,
          baseUrl: null, // <- the problem
        },
      })
```

### Versions

cypress: 3.0.2 
Operating system: macOS High Sierra (10.13.5)
",enhancement
341095507,Feature: System notification on failure of test(s),"<!-- 
Is this a question? Do not open an issue. Please ask in our chat https://gitter.im/cypress-io/cypress

Want something newly documented? Please open an issue in the respective repo: 
- docs: https://github.com/cypress-io/cypress-documentation 
- example recipes: https://github.com/cypress-io/cypress-example-recipes
-->

### Current behavior:

Test failure shows up in the Cypress app.

### Desired behavior:

In much the same way that you can do a Gulp notification using `gulp-notify` to show a system notification for, perhaps, an ESLint failure, it would be great to also be able to do this with Cypress when a test fails. The use case is running the Cypress app in the background running your tests against your local development environment while you develop. I have Cypress running and every time I save my JS files Cypress silently runs the tests. Unless I click over to the app and see I've broken something, I won't know that a test is failing.

This type of real-time feedback would be huge on every save to catch if you've just caused a regression to happen with your latest changes. I would love it if I didn't have to go back to the app to check if something is failing every time and be notified of this.

### Versions

All.
",enhancement
340888013,Need to describe type for cypress module API,"When using Cypress via its module API, the resolved value is quite large and complex. So we should include typescript definitions for it with the code. This will be especially useful for the output of the `cypress.run` method.

Example `cypress.run` resolved value

```json
{
  ""startedTestsAt"": ""2018-07-13T05:36:53.230Z"",
  ""endedTestsAt"": ""2018-07-13T05:37:14.954Z"",
  ""totalDuration"": 21724,
  ""totalSuites"": 0,
  ""totalTests"": 1,
  ""totalFailed"": 0,
  ""totalPassed"": 1,
  ""totalPending"": 0,
  ""totalSkipped"": 0,
  ""runs"": [
    {
      ""stats"": {
        ""suites"": 0,
        ""tests"": 1,
        ""passes"": 1,
        ""pending"": 0,
        ""skipped"": 0,
        ""failures"": 0,
        ""wallClockStartedAt"": ""2018-07-13T05:36:53.230Z"",
        ""wallClockEndedAt"": ""2018-07-13T05:37:14.954Z"",
        ""wallClockDuration"": 21724
      },
      ""reporter"": ""spec"",
      ""reporterStats"": {
        ""suites"": 0,
        ""tests"": 1,
        ""passes"": 1,
        ""pending"": 0,
        ""failures"": 0,
        ""start"": ""2018-07-13T05:36:53.238Z"",
        ""end"": ""2018-07-13T05:37:14.983Z"",
        ""duration"": 21745
      },
      ""hooks"": [],
      ""tests"": [
        {
          ""testId"": ""r2"",
          ""title"": [
            ""adds and removes completed todos""
          ],
          ""state"": ""passed"",
          ""body"": ""function () {\n  var _this = this;\n\n  cy.visit('http://todomvc.com/examples/react/', {\n    onBeforeLoad: function onBeforeLoad(win) {\n      loadTinyToast(win.document);\n    },\n    onLoad: function onLoad(win) {\n      win.tinyToast.show(_this.test.title).hide(3000);\n    }\n  });\n  cy.get('.new-todo').should('be.visible');\n  addTodo('this is first todo');\n  addTodo('second todo');\n\n  // cy.wait(1000)\n  cy.contains('ul.todo-list li', 'second todo').find('input.toggle').check();\n  cy.toast('Checked 1 todo');\n  scroll();\n\n  cy.contains('.todo-count', '1').should('be.visible');\n\n  cy.toast('Filters: Active / Completed / All');\n  pickFilter('Active');\n  pickFilter('Completed');\n  pickFilter('All');\n\n  cy.toast('Clicking \""Clear completed\"" button');\n  clearCompleted();\n\n  cy.toast('Completed items have been removed', 5000);\n\n  cy.then(function () {\n    var rect = findAppRectangle();\n    var size = serializeRectangle(rect);\n    console.log(size);\n    // return cy.task('size', size)\n    var s = JSON.stringify(size, null, 2) + '\\n';\n    cy.writeFile('size.json', s, 'utf8');\n  });\n\n  // capture several resolutions\n  // cy.screenshot('runner', {\n  //   capture: 'runner'\n  // })\n  // cy.screenshot('app', {\n  //   capture: 'viewport'\n  // })\n  // cy.screenshot('full', {\n  //   capture: 'fullPage'\n  // })\n}"",
          ""stack"": null,
          ""error"": null,
          ""timings"": {
            ""lifecycle"": 28,
            ""test"": {
              ""fnDuration"": 20067,
              ""afterFnDuration"": 1
            }
          },
          ""failedFromHookId"": null,
          ""wallClockStartedAt"": ""2018-07-13T05:36:54.852Z"",
          ""wallClockDuration"": 20098,
          ""videoTimestamp"": 3770
        }
      ],
      ""error"": null,
      ""video"": ""/Users/gleb/git/cut-movie/cypress/videos/spec.js.mp4"",
      ""screenshots"": [],
      ""spec"": {
        ""name"": ""spec.js"",
        ""relative"": ""cypress/integration/spec.js"",
        ""absolute"": ""/Users/gleb/git/cut-movie/cypress/integration/spec.js""
      },
      ""shouldUploadVideo"": true
    }
  ],
  ""browserPath"": """",
  ""browserName"": ""electron"",
  ""browserVersion"": ""59.0.3071.115"",
  ""osName"": ""darwin"",
  ""osVersion"": ""16.7.0"",
  ""cypressVersion"": ""3.0.2"",
  ""config"": {
    ""viewportWidth"": 1000,
    ""viewportHeight"": 1000,
    ""videoCompression"": false,
    ""projectRoot"": ""/Users/gleb/git/cut-movie"",
    ""projectName"": ""cut-movie"",
    ""morgan"": false,
    ""isTextTerminal"": true,
    ""socketId"": ""q34tb"",
    ""report"": true,
    ""browsers"": [
      {
        ""name"": ""chrome"",
        ""displayName"": ""Chrome"",
        ""version"": ""67.0.3396.99"",
        ""path"": ""/Applications/Google Chrome.app/Contents/MacOS/Google Chrome"",
        ""majorVersion"": ""67""
      },
      {
        ""name"": ""electron"",
        ""displayName"": ""Electron"",
        ""version"": ""59.0.3071.115"",
        ""path"": """",
        ""majorVersion"": ""59"",
        ""info"": ""Electron is the default browser that comes with Cypress. This is the browser that runs in headless mode. Selecting this browser is useful when debugging. The version number indicates the underlying Chromium version that Electron uses.""
      }
    ],
    ""port"": 56514,
    ""hosts"": null,
    ""baseUrl"": null,
    ""userAgent"": null,
    ""reporter"": ""spec"",
    ""reporterOptions"": null,
    ""blacklistHosts"": null,
    ""clientRoute"": ""/__/"",
    ""xhrRoute"": ""/xhrs/"",
    ""socketIoRoute"": ""/__socket.io"",
    ""socketIoCookie"": ""__socket.io"",
    ""reporterRoute"": ""/__cypress/reporter"",
    ""ignoreTestFiles"": ""*.hot-update.js"",
    ""testFiles"": ""**/*.*"",
    ""defaultCommandTimeout"": 4000,
    ""requestTimeout"": 5000,
    ""responseTimeout"": 30000,
    ""pageLoadTimeout"": 60000,
    ""execTimeout"": 60000,
    ""taskTimeout"": 60000,
    ""video"": true,
    ""videoUploadOnPasses"": true,
    ""modifyObstructiveCode"": true,
    ""chromeWebSecurity"": true,
    ""waitForAnimations"": true,
    ""animationDistanceThreshold"": 5,
    ""numTestsKeptInMemory"": 0,
    ""watchForFileChanges"": false,
    ""trashAssetsBeforeRuns"": true,
    ""autoOpen"": false,
    ""fileServerFolder"": ""/Users/gleb/git/cut-movie"",
    ""videosFolder"": ""/Users/gleb/git/cut-movie/cypress/videos"",
    ""supportFile"": ""/Users/gleb/git/cut-movie/cypress/support/index.js"",
    ""fixturesFolder"": ""/Users/gleb/git/cut-movie/cypress/fixtures"",
    ""integrationFolder"": ""/Users/gleb/git/cut-movie/cypress/integration"",
    ""screenshotsFolder"": ""/Users/gleb/git/cut-movie/cypress/screenshots"",
    ""namespace"": ""__cypress"",
    ""pluginsFile"": ""/Users/gleb/git/cut-movie/cypress/plugins/index.js"",
    ""javascripts"": [],
    ""env"": {},
    ""cypressEnv"": ""production"",
    ""resolved"": {
      ""animationDistanceThreshold"": {
        ""value"": 5,
        ""from"": ""default""
      },
      ""fileServerFolder"": {
        ""value"": """",
        ""from"": ""default""
      },
      ""baseUrl"": {
        ""value"": null,
        ""from"": ""default""
      },
      ""fixturesFolder"": {
        ""value"": ""cypress/fixtures"",
        ""from"": ""default""
      },
      ""chromeWebSecurity"": {
        ""value"": true,
        ""from"": ""default""
      },
      ""modifyObstructiveCode"": {
        ""value"": true,
        ""from"": ""default""
      },
      ""integrationFolder"": {
        ""value"": ""cypress/integration"",
        ""from"": ""default""
      },
      ""env"": {},
      ""pluginsFile"": {
        ""value"": ""cypress/plugins"",
        ""from"": ""default""
      },
      ""hosts"": {
        ""value"": null,
        ""from"": ""default""
      },
      ""screenshotsFolder"": {
        ""value"": ""cypress/screenshots"",
        ""from"": ""default""
      },
      ""numTestsKeptInMemory"": {
        ""value"": 0,
        ""from"": ""config""
      },
      ""supportFile"": {
        ""value"": ""cypress/support"",
        ""from"": ""default""
      },
      ""port"": {
        ""value"": null,
        ""from"": ""default""
      },
      ""reporter"": {
        ""value"": ""spec"",
        ""from"": ""default""
      },
      ""videosFolder"": {
        ""value"": ""cypress/videos"",
        ""from"": ""default""
      },
      ""reporterOptions"": {
        ""value"": null,
        ""from"": ""default""
      },
      ""testFiles"": {
        ""value"": ""**/*.*"",
        ""from"": ""default""
      },
      ""defaultCommandTimeout"": {
        ""value"": 4000,
        ""from"": ""default""
      },
      ""trashAssetsBeforeRuns"": {
        ""value"": true,
        ""from"": ""default""
      },
      ""execTimeout"": {
        ""value"": 60000,
        ""from"": ""default""
      },
      ""blacklistHosts"": {
        ""value"": null,
        ""from"": ""default""
      },
      ""pageLoadTimeout"": {
        ""value"": 60000,
        ""from"": ""default""
      },
      ""userAgent"": {
        ""value"": null,
        ""from"": ""default""
      },
      ""requestTimeout"": {
        ""value"": 5000,
        ""from"": ""default""
      },
      ""viewportWidth"": {
        ""value"": 1000,
        ""from"": ""default""
      },
      ""responseTimeout"": {
        ""value"": 30000,
        ""from"": ""default""
      },
      ""viewportHeight"": {
        ""value"": 1000,
        ""from"": ""config""
      },
      ""taskTimeout"": {
        ""value"": 60000,
        ""from"": ""default""
      },
      ""video"": {
        ""value"": true,
        ""from"": ""default""
      },
      ""videoCompression"": {
        ""value"": false,
        ""from"": ""config""
      },
      ""videoUploadOnPasses"": {
        ""value"": true,
        ""from"": ""default""
      },
      ""watchForFileChanges"": {
        ""value"": false,
        ""from"": ""config""
      },
      ""waitForAnimations"": {
        ""value"": true,
        ""from"": ""default""
      }
    },
    ""parentTestsFolder"": ""/Users/gleb/git/cut-movie/cypress"",
    ""parentTestsFolderDisplay"": ""cut-movie/cypress"",
    ""supportFolder"": ""/Users/gleb/git/cut-movie/cypress/support"",
    ""integrationExampleName"": ""examples"",
    ""integrationExamplePath"": ""/Users/gleb/git/cut-movie/cypress/integration/examples"",
    ""scaffoldedFiles"": [
      {
        ""name"": ""cypress"",
        ""children"": [
          {
            ""name"": ""integration"",
            ""children"": [
              {
                ""name"": ""examples"",
                ""children"": [
                  {
                    ""name"": ""actions.spec.js""
                  },
                  {
                    ""name"": ""aliasing.spec.js""
                  },
                  {
                    ""name"": ""assertions.spec.js""
                  },
                  {
                    ""name"": ""connectors.spec.js""
                  },
                  {
                    ""name"": ""cookies.spec.js""
                  },
                  {
                    ""name"": ""cypress_api.spec.js""
                  },
                  {
                    ""name"": ""files.spec.js""
                  },
                  {
                    ""name"": ""local_storage.spec.js""
                  },
                  {
                    ""name"": ""location.spec.js""
                  },
                  {
                    ""name"": ""misc.spec.js""
                  },
                  {
                    ""name"": ""navigation.spec.js""
                  },
                  {
                    ""name"": ""network_requests.spec.js""
                  },
                  {
                    ""name"": ""querying.spec.js""
                  },
                  {
                    ""name"": ""spies_stubs_clocks.spec.js""
                  },
                  {
                    ""name"": ""traversal.spec.js""
                  },
                  {
                    ""name"": ""utilities.spec.js""
                  },
                  {
                    ""name"": ""viewport.spec.js""
                  },
                  {
                    ""name"": ""waiting.spec.js""
                  },
                  {
                    ""name"": ""window.spec.js""
                  }
                ]
              }
            ]
          },
          {
            ""name"": ""fixtures"",
            ""children"": [
              {
                ""name"": ""example.json""
              }
            ]
          },
          {
            ""name"": ""support"",
            ""children"": [
              {
                ""name"": ""commands.js""
              },
              {
                ""name"": ""index.js""
              }
            ]
          },
          {
            ""name"": ""plugins"",
            ""children"": [
              {
                ""name"": ""index.js""
              }
            ]
          }
        ]
      }
    ],
    ""state"": {},
    ""isNewProject"": false,
    ""proxyUrl"": ""http://localhost:56514"",
    ""browserUrl"": ""http://localhost:56514/__/"",
    ""reporterUrl"": ""http://localhost:56514/__cypress/reporter"",
    ""xhrUrl"": ""__cypress/xhrs/""
  }
}
```",enhancement
340691445,Feature: natural language query functions for links and form elements,"I'd like to see Cypress add natural language query functions for links and standard form elements.

One of the nicest things about the [capybara](https://github.com/teamcapybara/capybara) API is that it has a few tricks that make selecting links and form elements (the element types an integration test will interact with most frequently) queryable with the same natural language text that users will see. 

Here are a few examples from Capybara:

* `click_link('Link Text')`, `click_button('Button Text')`, `click_on('a link or a button')`
* `fill_in('First Name', with: 'John')`
* `check('A Checkbox')`, `uncheck('A Checkbox')`

And so on. None of these matchers are particularly challenging to implement, but they can dramatically improve the UX of a browser automation API, especially to people in non-typical developer roles. Additionally, selecting on text can improve the durability of a test suite against subsequent implementation changes, since you're coupling to text users can see and not markup.

This style has been found to have a few benefits over the years:

* The intent of the test is more apparent, especially in cases where the markup is obtuse or unclear (and where making the markup cleaner is outside the control of the tester)
* The test is less likely to break due to implementation changes that are unimportant to the user. If the label of a form element changes, however, that's almost always meaningful to _somebody_, since it's visible to the users. This has the effect of decreasing the occurrence of false negatives (tests that fail but for which nothing is broken)
* It encourages better a11y, in particular for form elements, which sadly still often fail to have proper `for` & `id` attribute matching. If the test can select a form element correctly based on given label text, so can a screen reader",enhancement
340568702,Allow formatting cy.log() text,"### Current behavior:
`cy.log()` prints grey text to the left column:
<img width=""362"" alt=""screen shot 2018-07-12 at 10 48 26"" src=""https://user-images.githubusercontent.com/1737376/42626027-25c9aa1c-85c1-11e8-9f39-ded9569c5695.png"">

### Desired behavior:
`cy.log()` takes an option for formatting, e.g. color, bold:
```javascript
cy.log('Given I am logged in', { color: 'blue' })
```
<img width=""365"" alt=""screen shot 2018-07-12 at 10 49 49"" src=""https://user-images.githubusercontent.com/1737376/42626192-956e1254-85c1-11e8-8205-ec4380cb451f.png"">


### Steps to reproduce:
N/A

### Versions
3.x",enhancement
340481192,If you shrink the reporter sidebar (Command Log) by dragging the width to be too small you cannot get it back,"### Current behavior:
![screen shot 2018-07-11 at 8 57 25 pm](https://user-images.githubusercontent.com/8467234/42611839-0eda0bfe-854d-11e8-8de6-80317aab00d1.png)

### Desired behavior:
If you manually drag and shrink the sidebar there should be a way to get it back.

### Steps to reproduce:
Shrink the sidebar on the ui with the arrow drag (just like you shrink any GUI). You'll see that there is no obvious way to get this back to normal. Even when I uninstall and reinstall the package its persisting and relying on some cached data somewhere.

### Versions

cypress: ^3.0.2
Chrome: 67
Mac OS
",enhancement
339026690,Add more debug logs around why Electron hangs trying to open,"Electron is still hanging per: https://github.com/cypress-io/cypress/issues/1912#issuecomment-402892019

We've investigated this - and we're still unsure where this could be happening. We need to add more debugging logs around this area to help track it down.",enhancement
338471479,Provided Chrome browser does not support DRM (widevine),"### Current behavior:
When we try to play a DRM protected video in the chrome browser provided by cypress, our video player throws a error (`drm/widevine is not supported`). The same video in ordinary chrome plays well. 

### Desired behavior:
The video plays well in the browser

### Steps to reproduce:
```js
cy.visit('https://demo.castlabs.com/')
```

Big buck Bunny > MPEG-DASH > DRM (video should start playing)
We have tried to set `chromeWebSecurity: false`, but it did not help. A friend of mine is saying that this is most likely caused by the fact that the site is running in a iframe in the cypress chrome browser, so it might have something to do with security in iframes etc.

### Versions

Cypress 3.0.1
Chrome 67
",enhancement
337253443,Add environment variable CYPRESS_FORCE_INSTALL to do the same thing as cypress install --force,"Useful in CI so that you can force installs of cypress when you have a `CYPRESS_BINARY_VERSION` set but that specific version number is already cached.

In those cases I want to force it to be installed no matter what. Currently I have to change the CI scripts and add `cypress install --force`.

Having `CYPRESS_FORCE_INSTALL=1` would act as if the `--force` flag is always set during `npm install` and `cypress install`.",enhancement
337191102,Option to disable Cypress the verbose results to stdout,"### Current behavior:

Cypress logs a results table for each test files **and** another one at the end of the test run.

![travis screenshot](https://i.imgur.com/ajtYjgb.png)

### Desired behavior:

The output from the selected runner is often enough. An option to either completely disable cypress reports or to disable file reports and run reports selectively would be very appreciated.

### Versions

Cypress 3.0.3
OS: Ubuntu 18.04
",enhancement
336835182,Cypress should have a warning when in a Read Only FS not error,"### Current behavior:
Cypress will throw when run in a read only FS.
In my case im running it under Bazel which only allows reading from it's processes unless specific files are stated to be written.

>The error was:
Error: EROFS: read-only file system, mkdir '/home/fabian/.config/Cypress/cy/production/projects'

### Desired behavior:
This error should be caught and handled as a warning that features like project seed, screenshots, video recording will be disabled when being unsed in a Read Only File system.

### Versions
```
Cypress:  3.0.1 
Browser:  Electron 59 (headless) 
Node: 8.11.2
OS: linux x64
```

related: https://github.com/cypress-io/cypress/issues/1281",enhancement
336178143,Conversion to onPointerDown,"### Current behavior:
We are converting our app to React 16.4 which introduced Pointer Events API. However, items that we convert from onClick/onMouseDown-> onPointerDown break our Cypress tests. Everything works normally on our dev environment, and we have a PointerEvents polyfill as well (cypress' Chrome version supports the API natively).

Duplicating our `onPointerDown={someAction}` to `onPointerDown={someAction} onMouseDown={someAction}` fixes the tests but adds duplication. 

### Desired behavior:
Cypress should be able to handle onPointerDown events without code duplication

### Versions
Cypress 3.0.1",enhancement
335957543,Proposal: add 'after:screenshot' plugin event,"Add an event for the `pluginsFile` that is called after a screenshot is taken and written to disk. It will be called with an object with the following properties:

```
{
  size 
  takenAt
  dimensions
  multipart
  pixelRatio
  name
  specName
  testFailure
  path
  scaled
  blackout
  duration
}
```

An object can be synchronously returned or resolved in a promise with the following properties:

```
{
  size 
  dimensions
  path
}
```

Those properties will be merged into the original object and will be passed to the `onAfterScreenshot` browser callback. Any extra properties returned/resolved will be ignored.",enhancement
335725328,Add support for {home} and {end} special character sequences,"### Current behavior:

`cy.type('{home}')` and `cy.type('{end}')` are not supported:

```
CypressError: Special character sequence: '{home}' is not recognized. Available sequences are: {selectall}, {del}, {backspace}, {esc}, {{}, {enter}, {leftarrow}, {uparrow}, {rightarrow}, {downarrow}, {alt}, {option}, {ctrl}, {control}, {meta}, {command}, {cmd}, {shift}
```

```
CypressError: Special character sequence: '{end}' is not recognized. Available sequences are: {selectall}, {del}, {backspace}, {esc}, {{}, {enter}, {leftarrow}, {uparrow}, {rightarrow}, {downarrow}, {alt}, {option}, {ctrl}, {control}, {meta}, {command}, {cmd}, {shift}
```

### Desired behavior:

Support the `{home}` and `{end}` special character sequences.

### Versions

Cypress 3.0.1
",enhancement
335536878,can cy.writeFile write any type of document?,"### Current behavior:

After a download attempt an excel file with `cy.request()` command, `response.body` can be saved by using `cy.writeFile` command with any filename and extension (like 'text.xlsx') but file cannot be open.   
### Desired behavior:

Any type of file should be saved with any extension and can be opened properly.

### Versions

Cypress: 3.0.1
Operating system: Mac
Browser : Electron 59

",enhancement
335416017,Proposal: Record open devTools in screenshots and video during `cypress run`,"With [these changes](https://github.com/cypress-io/cypress/issues/2013), it will no longer be possible to have opened the dev tools for electron in interactive mode and then have them automatically opened during a run. Also, it's never been possible to explicitly tells other browsers to open their dev tools.

Add a flag (`--dev-tools` or `--open-dev-tools`) that will open the browser dev tools on launch so a debugger in test or app code can hit and pause the run for debugging purposes.",enhancement
334922710,Creating cy.route(s) for an iframe,"Hi all, I want to setup a cy.route which listens for a request on a button press within an iframe but haven't had any luck. I think this might be down to the cy.server being setup on the parent window so its not catching the request as it's sent from the iframe - can anyone help? - I think this might be related to the ever present cypress iframe bugs but I think it should be possible to launch the server on the iframe and listen for the request there instead of the parent window.

Is this a known bug or can anyone help me out?",enhancement
334885415,Improvements/fixes for reading state.json,"In an attempt to mitigate [Cypress randomly hanging in CI](https://github.com/cypress-io/cypress/issues/1912), implement the following:

1. Add debug logs around reading/writing/locking/unlocking files, so if the issue occurs again, they'll hopefully provide more information
2. Stop the `state.json` file from being read during `run` mode. The last log before Cypress hanging is the `state.json` being read, so it's possible it is the cause. Since we solely persist state related to the GUI/browser in interactive mode, it's not necessary to read it at all during a run. This may solve the issue.
3. Add a timeout for unlocking a file. If the hanging is indeed caused by the `state.json`, it's likely it's actually unlocking the file that never resolves. It would be better to time out in this scenario, catch the timeout, and carry on without the file unlocked. There's already a timeout on getting a lock on the file, so subsequent read and writes will handle that accordingly.
4. Add a whitelist for keys that can be saved in `state.json`. Currently, it allows any arbitrary keys to be written to it, making it difficult to tell what state it actually can possibly contain. This will document the keys in the code.",enhancement
333975155,`Cypress.log` should log in the queue or at least support it as an option,"_This IMO falls somewhere in the grey area between bug and feature request. I picked ""bug"", because the current functionality seems clearly insufficient to properly achieve what's described [here](https://docs.cypress.io/api/cypress-api/custom-commands.html#Command-Logging). If you consider it a feature request, please mark it as you will._

I want to create some custom commands to help interact with the UI library I'm using, e.g. `chooseSelectOption(valueLabel)` or `resolveModal(actionLabel)`. As hinted [here](https://docs.cypress.io/api/cypress-api/custom-commands.html#Command-Logging), I'd like to log once (a single high-level message) for each command and mute the logging for the inner low-level commands, but see the inner assertions.

_Note that the following is just a demo example, not my real use-case._

### Current behavior:

If I write my command like this:

```javascript
function chooseSelectOption(valueLabel) {
  Cypress.log({ name: 'choose_option', message: valueLabel })
  cy.contains('.some-class', valueLabel, { log: false })
    .should('be.enabled')
    .click({ log: false })
}
```

it looks fine, when I call it once. But when I call it multiple times in a loop (say I have a multi-select thing going on):

```javascript
[ 'a', 'b', 'c' ].forEach(val => chooseSelectOption(val))
```

I get the following log:

```
CHOOSE_OPTION a
CHOOSE_OPTION b
CHOOSE_OPTION c
 - ASSERT expected <tag.some-class> to be enabled
 - ASSERT expected <tag.some-class> to be enabled
 - ASSERT expected <tag.some-class> to be enabled
```

### Desired behavior:

I'd expect to get a log like this:

```
CHOOSE_OPTION a
 - ASSERT expected <tag.some-class> to be enabled
CHOOSE_OPTION b
 - ASSERT expected <tag.some-class> to be enabled
CHOOSE_OPTION c
 - ASSERT expected <tag.some-class> to be enabled
```

I'm able to log into the queue using e.g. `wrap`:

```javascript
cy.wrap({ name: 'choose_option', message: valueLabel }, { log: false }).then(Cypress.log)
```

but that nests the messages:

```
 - CHOOSE_OPTION a
 - ASSERT expected <tag.some-class> to be enabled
 - CHOOSE_OPTION b
 - ASSERT expected <tag.some-class> to be enabled
 - CHOOSE_OPTION c
 - ASSERT expected <tag.some-class> to be enabled
```

making the log hard to read. I'd expect to be able to log from custom commands in the same fashion as the native Cypress commands.

_And while I'm at it, I'm fine with Cypress upper-casing the names of its commands in the log, but I have no idea why it's upper-casing mine (I'd say it's my business how I want them formatted and there are various reasons why not upper-casing them might be useful)._

### Versions

Cypress: 3.0.1
OS: MacOS 10.13.5
Browser: Chrome 67.0.3396.87 (64-bit)",enhancement
333720862,More reliably determine CI Provider,"### Current behavior:

Some CI Providers show up as ""unknown"" with a suspected large amount of Jenkins CI runs going reported as ""unknown""

### Desired behavior:

@RandallKent mentioned this package may be helpful in determining the CI provider. 
- https://www.npmjs.com/package/ci-info

Update the current code to use package instead of env keys. 

Link to current code: https://github.com/cypress-io/cypress/blob/issue-1942/packages/server/lib/util/ci_provider.coffee#L12

### Versions

Cypress 3.0.1
",enhancement
333092473,Add more DEBUG logs to ffmpeg to help understand root cause of why ffmpeg compression dies,Per this issue (and probably others): https://github.com/cypress-io/cypress/issues/1934,enhancement
333085478,contain.text and include.text should do substring matches but instead do full-string matches,"### Current behavior:

```js
    // cy.get('div#preview').should('have.text', 'Hello');     // this is a full match, but we want a partial match, to ignore newlines etc.
    // cy.get('div#preview').should('contain.text', 'Hello');  // bug: this does the same as have.text
    // cy.get('div#preview').should('include.text', 'Hello');  // bug: this also does the same as have.text
    cy.get('div#preview').then((el)=> {
      assert.include(el.text(), 'Hello');  // this works but it isn't pretty
    });
```

the log for all three of the above says:
```
ASSERT: expected <div#preview> to have text Hello, but the text was Hello\n
```
which makes me think that there might be some aliasing going on since I'd think the error messages for ""include"" and ""contain"" would say ""include"" and ""contain"", not ""have

### Desired behavior:

* `have.text` should test whether the element's full text is equal to the given string
* `contain.text` and `include.text` should test whether the element's text *contains* the given string but is not necessarily *equal* to it

This follows the Chai docs here: http://www.chaijs.com/api/bdd/#method_include
""When the target is a string, .include asserts that the given string val is a substring of the target.""

### Steps to reproduce:

<!-- Issues without reproducible steps might get closed. *Tip* You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

* Clone this repo (branch name `solution`): https://github.com/BurlingtonCodeAcademy/markdown_preview/tree/solution
* Run `npm install`
* Run `npx cypress open`
* Uncomment lines in `cypress/integration/simple_spec.js` and check the cypress log


### Versions

* Cypress 3.0.1
* MacOS High Sierra
* Google Chrome / Chromium as installed by `npm`


",enhancement
333026001,Support browser specific protocols (chrome extensions),"Support `cy.visit()` with protocols other than `http`/`https` such as:
- `chrome://`
- `chrome-extension://`
- `resource://`

Most notably, `chrome-extension://` will allow users to test the UI of a chrome extension.",enhancement
332378048,Add an option to output a single report,"### Current behavior:

As described extensively in #1824, specs run in isolation and generate multiple reports.
This is not a big issue for junit reports as they can be combined but for mochawesome html reports as you get N not combinable html files.
In addition to this, the documentation is not updated and thus new users have a hard time to figure out why N specs are executed but only one report with the latest spec is generated.

### Desired behavior:

Cypress should have an option to call the generator only once after all specs are executed. Reporters would work as expected again.

### Versions

Cypress: 3.0.1
",enhancement
331699732,"Send KeyboardEvent , not Event for `cy.type()`","in `cy.type()` we need to send instances of `KeyboardEvent`, instead of `Event`",enhancement
331386025,Cypress programmatically generate template structure,"### Current behaviour:
Currently, cypress only generates the initial folder structure and files on running cypress open for the first time. 

<img width=""548"" alt=""screen shot 2018-06-12 at 9 12 00 am"" src=""https://user-images.githubusercontent.com/98919/41261888-2c99fce6-6e21-11e8-94d9-42f5e42a9c61.png"">

### Desired behaviour:
Be able to generate the initial folder structure programmatically with something like:
```
cypress init -P test
```

### Motivation
This will allow other projects and libraries to wrap the initial setup process with additional setup steps and files as required.

### Versions
Future Cypress versions",enhancement
331151639,"Support for --spec with ""cypress open""","### Current behavior:
`--spec` flag only seems to work with the `cypress run` command.
<!-- images, stack traces, etc -->

### Desired behavior:
Would be nice to also have this in `cypress open` command. In case we have several subfolders under `integrations` folder to distinguish types of tests, and we want to work only on one specific suite. At the moment we can't use the ""Run all tests"" since it will run everything.

### Versions
Cypress 3.0.1",enhancement
331045334,Failure screenshots should append `(failed)` to the screenshot name,"```js
// cypress/integration/app/users/list.spec.js

describe('table', () => {
  it('paginates users', () => {
    throw new Error('fail whale')
  })
})

// outputs screenshot to:
// cypress/screenshots/app/users/list.spec.js/table -- paginates users (failed).png

```",enhancement
330926667,Add Cypress.browser to the driver,"We should yield you the spec because it may be useful in the driver.

```bash
cypress run --browser chrome
```

```js
const browser = Cypress.browser

// return
{
  name: 'chrome',
  displayName: 'Chrome',
  version: '67.123.456.90',
  majorVersion: '67',
  path: '/path/to/browser'
}
```",enhancement
330925819,Add Cypress.spec to the driver,"We should yield you the spec because it may be useful in the driver.

```bash
cypress run --spec cypress/integration/foo.spec.js
```

```js
const spec = Cypress.spec

// return
{
  name: 'foo.spec.js',
  relative: 'cypress/integration/foo.spec.js',
  absolute: '/Users/bmann/Dev/my-app/cypress/integration/foo.spec.js'
}
```",enhancement
330248426,Add support for cy.reload() onBeforeLoad and onLoad callbacks,"### Current behavior:

Currently there are no options to add `onBeforeLoad()` and `onLoad()` callbacks for `cy.reload()` like there is for `cy.visit()`.

### Desired behavior:

I'd like to have these callbacks on `cy.reload()` too.

In my case, I want to make sure my app still loads and functions on a reload. I have some code that needs to be stubbed in `cy.visit` in the `onBeforeLoad()` callback. I need to make these stubs when the app gets reloaded too.

### Versions

Cypress 3.0.1
",enhancement
330248375,"In cypress GUI are not visible skipped and pending tests, in dashboard yes","### Current behavior:

In cypress GUI are not visible skipped and pending tests, in dashboard yes

![ashampoo_snap_ctvrtek 7 cervna 2018_14h18m55s_001_](https://user-images.githubusercontent.com/22873782/41099247-31c70cfc-6a5e-11e8-87df-d799f9ba428b.png)
![ashampoo_snap_ctvrtek 7 cervna 2018_14h19m29s_002_](https://user-images.githubusercontent.com/22873782/41099248-31e7db4e-6a5e-11e8-9596-d47e84cf0e63.png)

### Versions

Cypress: 3.0.1., Win 10
",enhancement
329602028,"In CI, direct users to cache ~/.cache directory","In CI, if cypress run fails without finding executable, direct to CI docs, advising to
-  cache `~/.cache` and flush cache in CI
or
- cache `~/.cache` and use `npm ci`",enhancement
329138063,Support `cypress run --no-exit`,"Option to keep browser open after test run, useful for
- quickly finding errors that happened in CI, without having to use debugger",enhancement
329094029,Add support for using Jasmine/Jest matchers instead of Chai,"Hello.

First of all, I want to congratulate you all. This tool is indeed awesome.

I'd like to know if it's possible, or if it isn't, to make a suggestion to add support for using `Jasmine` instead of `Chai`.

In my humble opinion, it works better and it's more complete than Chai. Most of the frontend projects that I have seen use it (behind Jest, mainly), including (not exclusively, but the majority) React and Angular ecosystems.

Thanks!
",enhancement
328932456,Filter or grep specific tests to run (like mocha grep pattern),"### Current behavior:

Run specific files but cannot choose specific single/multi tests.

### Desired behavior:
Choose expected tests to run, like mocha grep pattern.
Though we put a group of tests in a spec file, but sometimes we just want to run parts of them, so we need filter them out.

",enhancement
328651659,Add cli commands for managing binary cache,"- [x] `cypress cache clear`: clears ~/.cache/Cypress/*
- [x] `cypress cache folder`: logs `~/.cache/Cypress`
- [x] `cypress cache list`: lists currently installed cypress binary versions (delimited by space - ex: `3.0.1 3.0.2`)",enhancement
328214438,"In CI, cypress install should clear old cached versions","**Proposal:** Prevents large buildup of `~/.cache` with obsolete versions. Should only happen in CI because locally users could have multiple versions installed on the system in other projects.

**complications:**
- different cypress versions across branches, can't clear out other versions...",enhancement
328194630,Ability to delete run from Dashboard,"### Current behavior:

Users may want to delete runs due to sensitive data or just to clean up their Dashboard.

### Desired behavior:

Button at top of run that say ""Delete run data"" with confirmation dialog. 

![36328792-832f04c0-1331-11e8-9bc0-1b9d04693770](https://user-images.githubusercontent.com/1271364/40792571-46cc004e-64c8-11e8-8f3e-2a42523481d2.png)

- API Issue: https://github.com/cypress-io/cypress-api/issues/376
- Dashboard Issue: https://github.com/cypress-io/cypress-dashboard/issues/501",enhancement
327724494,Proposal: Nest screenshot path based on spec path by default,"Instead of saving screenshots all directly in the screenshots directory, nest them based on where the spec file is relative to the integration directory. So if running 

`cypress/integration/app/login/user_spec.js`

a screenshot will be saved as 

`cypress/screenshots/app/login/user_spec.js -- login -- users -- can log in.png`.",enhancement
327684710,Feature Request: Extend route definition,"### Feature Request

I want to be able to define several routes over the same endpoint.
I want to be able to define several routes based on request headers.
I want to be able to define several routes based on body content.

### Proposed Usage:

Maybe some fluency will work here:
```js
cy.route(""POST"", ""/endpoint"").where().its(""body"").contains(""<A/>"").as(""A"")
cy.route(""POST"", ""/endpoint"").where().its(""body"").contains(""<B/>"").as(""B"")
````

And a general use escape hatch like `cy.server({ whitelist: ... })` per route will also work nicely.
```js
cy.route(""POST"", ""/endpoint"", (xhr) => isInRouteA(xhr)).as(""A"")
cy.route(""POST"", ""/endpoint"", (xhr) => isInRouteB(xhr)).as(""B"")
```

I personally think the escape hatch solution works better. Simply due to the huge variety in how applications use async requests.
",enhancement
327491138,Decrease size of cypress binary zip,"Binary size from 2.1.0 -> 3.0.0 is up `72Mbs` (`372Mbs`-> `443Mbs`) on linux
71Mbs is due to `packages/server/node_modules`

to lower size:
- update `jpeg-js` to not include 4.5 mbs of tests
- update `@cypress/cypress-icons` to not include `src`
- hoist shared packages to top level node_modules

all added node modules make up ~ 60Mbs
other 10Mbs is probably due to updated modules

new modules: 
```
59M    total
35M    typescript
4.5M    jpeg-js
2.4M    cli-table2
1.8M    jimp
1.6M    postcss
1.3M    requirejs
1.3M    escodegen
1008K    pixelmatch
916K    nise
752K    tinycolor2
652K    gonzales-pe
644K    text-encoding
516K    requirejs-config-file
468K    exif-parser
356K    detective-typescript
344K    dependency-tree
300K    detective-postcss
280K    bignumber.js
248K    typescript-eslint-parser
236K    es6-promise
228K    filing-cabinet
220K    precinct
220K    module-lookup-amd
212K    pngjs
208K    stylus-lookup
200K    enhanced-resolve
196K    is-function
176K    xmlbuilder
156K    postcss-values-parser
156K    app-module-path
152K    follow-redirects
148K    min-document
136K    detective-less
132K    detective-scss
132K    detective-sass
120K    load-bmfont
108K    term-size
104K    widest-line
100K    sass-lookup
72K    xml2js
72K    sax
72K    optionator
68K    global
64K    prelude-ls
60K    dom-walk
56K    levn
52K    estraverse
52K    deep-is
48K    find
48K    errno
44K    type-check
40K    xhr
40K    @sinonjs
40K    parse-headers
40K    lodash.get
40K    for-each
40K    bmp-js
36K    resolve-dependency-path
36K    prr
36K    memory-fs
36K    is-url
36K    is-arrayish
36K    file-type
36K    buffer-equal
36K    ast-module-types
32K    uniq
32K    trim
32K    tapable
32K    math-random
32K    is-relative-path
32K    file-exists
32K    detective-es6
32K    buffer-fill
28K    to-buffer
28K    stream-to
28K    parse-bmfont-xml
28K    module-definition
28K    indexes-of
28K    graceful-readlink
28K    get-own-enumerable-property-symbols
28K    detective-stylus
28K    detective-amd
28K    color-string
24K    log-symbols
24K    lodash.unescape
24K    fs-constants
24K    flatten
24K    buffer-alloc-unsafe
24K    buffer-alloc
20K    xml-parse-from-string
20K    url-regex
20K    string-width
20K    stringify-object
20K    stream-to-buffer
20K    simple-swizzle
20K    parse-bmfont-binary
20K    node-source-walk
20K    is-obj
20K    is-fullwidth-code-point
20K    is-fork-pr
20K    ip-regex
20K    get-amd-module-type
20K    fast-levenshtein
20K    detective-cjs
20K    code-point-at
20K    buffer-from
16K    traverse-chain
16K    read-chunk
16K    parse-bmfont-ascii
16K    just-extend
16K    is-regexp
```
",enhancement
326867504,"Pass 'Details"" via CLI to run instead of getting from commit","This would be a great feature, as we use Cypress in a team, and it would enable others to see what the latest test I added was. I try to do this by committing using a name that will point them to what the most recent test was, but sometimes I commit other stuff and then that string shows up under DETAILS for that  run.",enhancement
326309063,wait for the network idle ,"<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->

### Current behavior: <!-- (images, stack traces, etc) -->
Currently, only way to wait for certain time is that using wait function. However, it is not reliable because internet speed and other variable is always different.
 

### Desired behavior:
I would like to have wait for the network idle function. 

### Versions  <!-- (Cypress, operating system, browser) -->

^2.1.0
",enhancement
326255893,Canvas elements should restore drawn state on time travel with before and after snapshots,"<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->

### Current behavior: <!-- (images, stack traces, etc) -->
When I run the ""actions"" tests in the provided examples, the clicks on the canvas show while the test is running, but do not show when going back through them in the command log. In fact, you can't even manually click the canvas and create a dot in the runner.

### Desired behavior:
Time travel and the command log should show before and after versions of what happens when you click on a canvas.

### Steps to reproduce:

<!-- Issues without reproducible steps might get closed. *Tip* You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

Install Cypress. Run the examples. Use the command log to time travel to the Actions section and attempt to view the canvas before and after each click.

### Versions  <!-- (Cypress, operating system, browser) -->
Cypress - 2.1.0
Windows 10 - 1703 Build
Chrome - 66
",enhancement
326229065,Support video capture in browsers other than headless electron ,"## Features
Video recording for both local and CI:

- [x] chrome headed in https://github.com/cypress-io/cypress/pull/4628 - released in 3.5.0
- [x] electron headed in #6632
- [x] chrome headless in #5676 - released in 3.8.0 
- [x] firefox headed in #1359 - released in 4.0.0
- [x] firefox headless in #6336  - released in 4.0.0

## Tasks
- chrome headed:
  - use devTools protocol [`screenCast api`](https://chromedevtools.github.io/devtools-protocol/tot/Page/#method-startScreencast)
- electron headed:
  - use devTools protocol [`screenCast api`](https://chromedevtools.github.io/devtools-protocol/tot/Page/#method-startScreencast)
- chrome headless
  - use devTools protocol [`screenCast api`](https://chromedevtools.github.io/devtools-protocol/tot/Page/#method-startScreencast)
- firefox headed:
  - use `getUserMedia` API + user prefs to auto-accept prompt to capture current tab
- firefox headless:
  - use `getUserMedia` API + user prefs to auto-accept prompt to capture current tab


#### Related
Video record also mentioned in #745 
",enhancement
325146263,Breaking config changes,"We are no longer distinguishing between `headless` per this issue: https://github.com/cypress-io/cypress/issues/1140

To synchronize the nomenclature changes we've done the following:

- `screenshotOnHeadlessFailures` has been removed in favor of the new Screenshot options exclusively in the driver
- `trashAssetsBeforeHeadlessRuns` -> `trashAssetsBeforeRuns`
- `videoRecording` -> `video`

We will throw an explicit error if using the old verbiage.",enhancement
324733396,Support a NO_COLOR argument to force disabling all colors,"Because we are now aggressively forcing color output in CI, we need to support a `NO_COLOR=1` argument when spawning Cypress.",enhancement
324715645,Improve color detection support for CI,"Travis + Appveyor are not displaying colors although they are capable of doing it.

In Travis, if you've configured any secret environment variables, they are piping the child processes and therefore `process.stdout.isTTY == false`. This causes colors to be turned off.

In Appveyor, it seems to always be `false` with or without secret environment variables.

Both environments are capable of displaying color, and we should be more aggressive about forcing colors when we're running in CI.",enhancement
324613496,Support for VSTS & VSTS Test Attachments,"<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->

### Current behavior: <!-- (images, stack traces, etc) -->
I've installed Cypress into a project built on VSTS. To get cypress to run on the Linux Hosted agents I had to perform the following additional steps:

```
apt-get -qq -y update
apt-get -qq -y install xvfb libgtk2.0-0 libnotify-dev libgconf-2-4 libnss3 libxss1 libasound2
```

To get reporting to work (to get status information in the VSTS release dashboard) I configured the `junit` reporter:

```
cypress run --reporter junit
```

This works up to a certain point. Cypress runs, a junit report is generated, but all of the recorded videos are ignored after the run is completed.

VSTS supports uploading test attachments when they are referenced in the test report. I tried configuring the `xunit-file` reporter, but no attachment is added. I tried configuring the `mocha-trx-reporter` (native visual studio format), but it crashes when running with cypress.

```
TypeError: test.isPending is not a function
    at C:\temp\node_modules\mocha-trx-reporter\lib\trx.js:63:22
    at Array.forEach (<anonymous>:null:null)
    at Runner.<anonymous> (C:\temp\node_modules\mocha-trx-reporter\lib\trx.js:62:34)
    at emitOne (events.js:120:20)
    at Runner.emit (events.js:210:7)
    at Reporter.emit (C:\temp\node_modules\cypress\dist\Cypress\resources\app\packages\server\lib\reporter.js:191:55)
    at Object.server.startWebsockets.onMocha (C:\temp\node_modules\cypress\dist\Cypress\resources\app\packages\server\lib\project.js:288:22)
    at Socket.<anonymous> (C:\temp\node_modules\cypress\dist\Cypress\resources\app\packages\server\lib\socket.js:237:36)
    at emitOne (events.js:115:13)
    at Socket.emit (events.js:210:7)
    at C:\temp\node_modules\cypress\dist\Cypress\resources\app\packages\socket\node_modules\socket.io\lib\socket.js:503:12
    at _combinedTickCallback (internal/process/next_tick.js:131:7)
    at process._tickCallback (internal/process/next_tick.js:180:9)
``` 

### Desired behavior:

Cypress logs the recorded video as test attachment in the generated test results so that Visual Studio Team Services can associate them to the test results and show them in the portal.

### Steps to reproduce:

*  Run cypress in a Visual Studio Team Services build.
* Run the ""Upload test results"" step and publish the results file

![image](https://user-images.githubusercontent.com/4173387/40266763-2837344e-5b51-11e8-90d0-feffc494398b.png)

* Check the VSTS portal for the presence of test attachments.

### Versions  <!-- (Cypress, operating system, browser) -->

* Windows 10 April 2018 or Ubuntu (https://github.com/Microsoft/vsts-agent-docker/blob/master/ubuntu/16.04/standard/Dockerfile)
* Cypress: 2.1.0
* VSTS Agent version: 2.133.3",enhancement
323563404,cy.route doesn't match http calls to .js resources,"### Current behavior: <!-- (images, stack traces, etc) -->
![image](https://user-images.githubusercontent.com/5776997/40112071-20dee5aa-5905-11e8-9e38-9163b841b5d1.png)
(Notice how # is - because cypress doesn't think the route is matched)

Interestingly the response handler is still called and the log appears in the console.

### Desired behavior:
I'd like the route to match and be able to replace the contents of the resource I'm trying to hijack.

### Steps to reproduce:

<!-- Issues without reproducible steps might get closed. *Tip* You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->

```js
describe('Route matching fails', function () {
    it('fail matching routes', function () {
        cy.server()
        cy.route({
            method: 'GET',
            url: 'https://consent.snmmd.nl/js/cookiebar-latest.js',
            response: (req) => {
                console.log('[REQUEST] JavaScript');
            }
        })
        cy.visit('http://www.nu.nl')
    })
})
```

### Versions  <!-- (Cypress, operating system, browser) -->
Cypress 2.1.0
macOS 10.12.6
Node 10.0.0
",enhancement
322056356,Proposal: Desktop GUI filter improvements,"The Desktop GUI spec filter could use a few minor improvements:

### Hide folders that don't match

Currently, folders are shown even if they don't include any matching files. It would be better to hide any folders that don't match.

![screen shot 2018-05-10 at 3 35 27 pm](https://user-images.githubusercontent.com/1157043/39890109-c98bd818-5467-11e8-9b24-dfbfac03c9a3.png)

### Save the filter per project

It would be nice if the filter was persisted, so if you close a project, then re-open it, the previous filter will still be there and active. This would be best per-project. It could be stored in local storage.

### Make the filter fuzzy

It would nice if the filter was fuzzy instead of needing the filer to match exactly, the way file searches work in most text editors these days.",enhancement
321195767,Support for data URI in cy.request(),"<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->

### Current behavior: <!-- (images, stack traces, etc) -->

`cy.request` fails when loading a data URI (URLs prefixed with the `data:` scheme) because it tries to load it from the base URL.

Error message logged

```
Error:     CypressError: cy.request() failed on:

http://localhost:3000/data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLz4=

The response we received from your web server was:

  > 404: Not Found

This was considered a failure because the status code was not '2xx' or '3xx'.

If you do not want status codes to cause failures pass the option: 'failOnStatusCode: false'

-----------------------------------------------------------

The request we sent was:

Method: GET
URL: http://localhost:3000/data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zd...
Headers: {
  ""user-agent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/65.0.3325.181 Chrome/65.0.3325.181 Safari/537.36"",
  ""accept"": ""*/*"",
  ""accept-encoding"": ""gzip, deflate""
}

-----------------------------------------------------------

The response we got was:

Status: 404 - Not Found
Headers: {
  ""x-powered-by"": ""Express"",
  ""content-security-policy"": ""default-src 'self'"",
  ""x-content-type-options"": ""nosniff"",
  ""content-type"": ""text/html; charset=utf-8"",
  ""content-length"": ""221"",
  ""date"": ""Tue, 08 May 2018 13:35:19 GMT"",
  ""connection"": ""close""
}
Body: <!DOCTYPE html>
<html lang=""en"">
<head>
<meta charset=""utf-8"">
<title>Error</title>
</head>
<body...
```

### Desired behavior:

Test passes.


### Steps to reproduce:

```js
const checkSVGReception = response => {
  const parser = new DOMParser();
  const xmlDoc = parser.parseFromString(response.body, ""text/xml"");

  cy.wrap(xmlDoc.rootElement.nodeName).should(""eq"", ""svg"");
};
cy.get(""img[src^='data:']"")
  .invoke(""attr"", ""src"")
  .then(url => cy.request({ url }))
  .then(checkSVGReception);
```

### Versions  <!-- (Cypress, operating system, browser) -->

**Cypress**: 2.1.0
**Node**: v8.11.1
**Browser**: Chromium - Version 65.0.3325.181 (Official Build) Built on Ubuntu , running on Ubuntu 17.10 (64-bit)",enhancement
319740266,Add ability to use Cypress.config to set  'modifyObstructiveCode'.,"### Current behavior: <!-- (images, stack traces, etc) -->
 
When using

`Cypress.config('modifyObstructiveCode', false);`
 
in an `it`, the test runs as if this value was not set

### Desired behavior:

When using

`Cypress.config('modifyObstructiveCode', false);`
 
in an `it`, the test should run as if this value was set in cypress.json

### Steps to reproduce:

Create a test that behaves differently depending on this configuration being set. When set from .json file, different behavior is observed. When set using Cypress.config, different behavior is not observed.

```js

it('does stuff within an iframe and window.parent', () => {
   // the follow had no affect, but setting in json will
   Cypress.config('modifyObstructiveCode', false);`
});
```

### Versions  <!-- (Cypress, operating system, browser) -->

Cypress 2.1.0
MacOS
Chrome 66

",enhancement
319635152,When the binary fails to download add a message about proxy,"In CLI if the binary download fails, in the error message tell about proxy environment variables.",enhancement
318418871,Posting formData using cypress doesn't work,"<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->

### Current behavior: <!-- (images, stack traces, etc) -->
Uploading file via `POST` request of `formData` doesn't work.

### Desired behavior:
Being able to post `formData` using cypress `POST` request.

### Steps to reproduce:

<!-- Issues without reproducible steps might get closed. *Tip* You can fork https://github.com/cypress-io/cypress-test-tiny repo, set up a failing test, then tell us the repo/branch to try. -->
The following code doesn't work.

```js
  const formData = new FormData();
  formData.set('file', new File(['data'], 'upload.txt'), 'upload.txt');
  cy.request({
    method: 'POST',
    url: '/upload/end/point',
    body: formData,
    headers: {
      'content-type': 'multipart/form-data',
    },
  });
```

### Versions  <!-- (Cypress, operating system, browser) -->
cypress@2.1.0
ubuntu 16.04 LTS
Chrome 66.0.3359
",enhancement
317332859,Desktop-gui should show billing notifications relevant to project,"Upon the release of Cypress' new billing portal, there are several notifications that should be shown in the Desktop-gui relevant to the project running tests, such as:

- [ ] A banner indicating the project is within a 'grace period' of billing - with an encouragement to set up billing during that time - link to Dashboard.
- [ ] When not in grace period, a banner warning projects in organizations when the projects go over the allowed test recordings - link to Dashboard.
- [x] Removal of 'beta' flag

**These warnings can only be shown when:**
1. The user is logged in
2. The project has been set up to record (associated with an org)",enhancement
316602308,Warn when localhost is not mapped to 127.0.0.1 and launch Cypress directly on that ip address,"When users `/etc/hosts` file is nuked or has had the `localhost -> 127.0.0.1` ip address mapping removed then Cypress will fail to spawn the browser correctly.

We can detect this and provide a warning to the user, and additionally could just launch the browser on `127.0.0.1` as opposed to `localhost`.

Related to: https://github.com/cypress-io/cypress/issues/1455 and https://github.com/cypress-io/cypress/issues/680",enhancement
315617796,Ability to disable javascript for the url under test,"I would like to be able to use Cypress to test an application when Javascript is disabled. 

### Current behavior: <!-- (images, stack traces, etc) -->
Cypress makes itself appear to run from the same domain as the application under test and Chrome allows Javascript to be disable by domain only, so Javascript cannot be disabled without affecting Cypress itself. 

### Desired behavior:
The ability to disable javascript for the url under test, possibly with:
- A Cypress option to disable JS for the url under test (not sure this is possible)
- A Cypress option to NOT run from the same domain as the url under test (this would come with limitations)
",enhancement
314703044,Feature: Stop Cypress when there are too many failed tests,"<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->

### Current behavior: <!-- (images, stack traces, etc) -->
Sometimes a feature I work on breaks a lot of tests in the CI build. I have to wait until all tests are finished until I can figure out what happened, which can take very long due to long timeouts.

### Desired behavior:
Being able to set a variable in cypress.json to stop the Cypress test execution and fast-forward to uploading the data to the Cypress dashboard when a specific number of test failures is exceeded.

For example in cypress.json:

```json
{
  ""maxFailedTests"": 10
}
```",enhancement
314387560,Retry API interactions with a backoff strategy,"Whenever we interact with the API in order to run specs we need to have a retry + backoff strategy in the case the API is temporarily available such as DNS/network partition problems.

Currently we wait 10 secs and then immediately give up. We should retry a few times and backoff incrementally if there are `5xx` errors or node connection related errors like ECONNREFUSED.",enhancement
314387354,Create new intro / outro banner summarizes all of the specs run ,"Example output with discussion here: https://gist.github.com/brian-mann/7b34b1eaa76b829d9de46914fba32b76

The idea is that since we're chunking the specs and running them independently there is going to be a lot more isolated ""runs"" which gives us an opportunity to highlight how many specs are left to run, and provide a summary at the bottom of what happened.",enhancement
314381900,"Change the way ""Run All Specs"" are run in Interactive Mode (from the GUI)","This comes from this epic... https://github.com/cypress-io/cypress/issues/681

All other stories were complete except this section...

## Interactive Mode

- Continue enabling users to ""Run all Tests""
- Enable clicking folders to automatically run a subset of specs
- Instead of killing the renderer process between specs the browser will simply be ""navigated"" to the next spec URL.
- This will isolate each spec, and be much faster and less abrupt than killing the renderer like we will for the CLI. However this makes sense considering Cypress already has the code for swapping the URL and rehydrating the state of the reporter. We already do this when swapping domains in a cy.visit.
- Isolating specs will help with memory exhaustion, but its still possible to blow out on a very long and intense spec file.
- To solve this we'll begin purging snapshots by reducing the default minimum of 50, down to 5.
- Purged snapshots will only affect passing tests and we will not purge data for failing tests. This will enable users to review the commands and output for failed tests - as they likely don't care about the data for passing tests anyway.
- We'll need to add a good user experience / messaging around why snapshots were purged
- When running multiple specs we'll add the spec file as part of the command log which will give you a shortcut for focusing in on a spec file.

@jennifer-shehane we'll need you to comp some UI changes related to communicating to the users about running too many tests in Interactive Mode.

This should include a banner saying: ""It looks like you're trying to run all tests in Interactive Mode. To prevent crashes slowdowns we are turning off interactive snapshots and debugging features.""",enhancement
314373132,Exit with status 1 when no specs were found with or without a --spec pattern,"Cypress should automatically exit and fail if no spec files were found to run tests for.

This can happen if something goes terribly wrong or for instance configuration is really messed up or you've passed a glob to the new 3.0 `--spec` option and it didn't find any files.",enhancement
314230291,"Test sections, checkpoint reporting, or subTests","<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->

### Current behavior: <!-- (images, stack traces, etc) -->

To get a nice list of use cases to be listed, in test results, I currently have to run a test for each use case.

Example:
Order Bike
--> Pre Login
-> Initial Bike configuration is set
--> Navigate to Catalog
--> Find Bike
--> Click
--> Assert Page

-> Bike Type unicycle hides chain option
--> Navigate to Catalog
--> Find Bike
--> Click unicycle
--> Validate sections

-> Bike Type motorcycle shows engine section
--> Navigate to Catalog
--> Find Bike
--> Click motorcycle
--> Validate sections
etc.
etc.
### Desired behavior:

Be able to report on important checkpoints within the run that signify a validated use case. Where if the use case is not reached is reported as incomplete. I would also like to be able to see these checkpoints reported as tests with the time set to the current parent's time.

Order Bike
--> Pre Login
--> Navigate to Catalog
--> Find Bike
--> Click
--> Assert Page **Initial Bike configuration is set**
--> Click unicycle
--> Validate sections **Bike Type unicycle hides chain option**
--> Click motorcycle
--> Validate sections **Bike Type motorcycle shows engine section**




",enhancement
314220915,Proposal: Collapse consecutive repeated events in reporter,"When there's network polling or similar, the reporter gets filled with countless duplicate events. It would be nice to collapse the events into a single item that can be expanded.

So instead of all the xhr stub events seen here:

![screen shot 2018-04-13 at 3 11 01 pm](https://user-images.githubusercontent.com/1157043/38753670-2563b07a-3f2d-11e8-8660-ef313ccce0d9.png)

There would only be one, with an arrow to the left indicating it can be expanded and a number in a circle on the right showing how many events there are total.

This would only collapse consecutive events.",enhancement
312390969,Support ability to visit non `text/html` content-type pages (aka - visit downloaded file page),"### Current behavior:

I am trying to test a download action from a `.ts` file using the attribute  `window.location.href`. It doesn't matter what value I assign for the URL string, the test instruction fails claiming a **timeout** waiting for the request when the file actually has been downloaded in few seconds. For some unknown reason Cypress never can reach the URL.    

Note: I am using a **Genesis UI** theme as my development code base. 

These are the paths that I have tried aiming to get an Ok result from the Cypress test:
1. `window.location.href = '/api/download/file_id';`
2. `window.location.href = '/#/api/download/file_id';`
3. `window.location.href = 'http://localhost:5000/api/download/file_id';`
4. `window.location.href = 'http://localhost:5000/#/api/download/file_id';`

All of them fail. But if I try the first option as a normal user from the browser directly, the download works perfectly.

Note: During the Cypress test, I can see how the file is actually downloaded. The download action occurs.

### Desired behavior:

All that I am expecting is to be able to test my download action from the Cypress test. 

If I trigger the download button using something like: 
```js
cy.get('[data-cy=download-file]').click();
```
I expect to get a positive response from the test if the file was actually downloaded.

### How to reproduce:

Note: It would be great if you can try this steps using a **Genesis UI** theme as the base application.

1. Create a form template with a button pointing to the `.ts` method on the (click) parameter:
   `(click)=""downloadFile()""`
Note: Include a `data-cy` parameter as part of the button in the form:
   `data-cy=""download-file""`
2. Inside the `.ts` method use the instruction, ensuring to use a valid path: 
   `window.location.href = '/path/to/file/for/download';`
3. Write a Cypress test when you try to trigger the download button from the form. Something like:
   `cy.get('[data-cy=download-file]').click();`
4. You should get a timeout message similar to the one included as attached image.

#### Test code:

```js
cy.get('[data-cy=download-file]').click(); 
```

### Additional Info (images, stack traces, etc)

![timeout](https://user-images.githubusercontent.com/2789669/38479472-01990e5c-3b85-11e8-9b78-661fb3f1fd8e.png)

- Operating System: Mac OSX 10.13.2
- Cypress Version: 2.1.0
- Browser Version: Google Chrome 65.0.3325.181


",enhancement
312115911,Proposal: .pipe command that is essentially a retryable .then,"Proposal: Command that is essentially a retryable .then

Example:
```ts
const getTable = id => cy.get(`[data-testid=${id}`)
const getColumnNames = $el => Array.from($el.find('[role=columnheader]')).map(el => el.innerText)

getTable('identifier')
  .then(getColumnNames) // The `should` doesn't cause this to re-evaluate
  .should('deep.equal', ['Column One', 'Column Two'])
```

The `getTable` will get an element given a test id and `getColumnNames` will get the text contents of a table's column headers. If the table's column headers aren't statically known (maybe column order is a user preference), the assertion immediately fails.

I don't think we want `.then` to retry. I think it is good that `.then` has strong guarantees that it will only be run once. It just makes composition of functions not quite fit.

There could be another command that does re-run if there is an assertion:

```ts
getTable('identifier')
  .pipe(getColumnNames) // The `should` would cause re-evaluation
  .should('deep.equal', ['Column One', 'Column Two'])
```",enhancement
310714680,screenshotsFolder not working correctly ,"### Current behavior:
Using `screenshotsFolder` does not save fails to correct folder when using `cy.screenshot`

```js
Cypress.config(""screenshotsFolder"", ""cypress/screenshots/desktop"") 
expect(Cypress.config('screenshotsFolder')).to.eq(""cypress/screenshots/desktop"")
cy.screenshot('homepage_desktop')
```

Expected passes the test, but screenshots are saved to wrong folder `cypress/screenshots`.


### Desired behavior:
Using `screenshotsFolder` on a test should save fails correct folder

### How to reproduce:

```js
it('Homepage test', function () {
  cy.wrap(lang_array).each(function(lang, i, array) {
    cy.viewport(1680, 1050)
    Cypress.config(""screenshotsFolder"", ""/home/osboxes/<project>/<project-folder>/cypress/screenshots/desktop"")
    Cypress.config('screenshotsFolder')
    expect(Cypress.config('screenshotsFolder')).to.eq(picutres_url+""/desktop"")
    cy.visit('/?lang='+lang)
    cy.screenshot('homepage_desktop_'+lang)
    cy.viewport(720, 1280)
    Cypress.config(""screenshotsFolder"", ""/home/osboxes/<project>/<project-folder>/cypress/screenshots/medium"")
    expect(Cypress.config('screenshotsFolder')).to.eq(picutres_url +""/medium"")
    Cypress.config(""screenshotsFolder"", picutres_url+'/medium')
    cy.screenshot('homepage_medium_'+lang)
    cy.viewport(320, 480)
    Cypress.config(""screenshotsFolder"", ""/home/osboxes/<project>/<project-folder>/cypress/screenshots/mobile"")
    expect(Cypress.config('screenshotsFolder')).to.eq(picutres_url +""/mobile"")
    cy.viewport(320, 480)
    Cypress.config('userAgent', 'Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e Safari/8536.25')
    cy.screenshot('1 homepage_mobile_'+lang)
  })
})
```

- Operating System:
DISTRIB_RELEASE=16.04
DISTRIB_CODENAME=xenial
DISTRIB_DESCRIPTION=""Ubuntu 16.04.4 LTS""
- Cypress Version: 5.8.0
- Browser Version: FireFox 59.02

",enhancement
310560233,Add option to treat API communication errors as fatal errors,"## Proposal

Currently if there is a problem communicating with the Cypress dashboard API, we just continue (usually). We should add a CLI option to treat it as a fatal error to ensure the users know that recording is not happening

Example:
<img width=""944"" alt=""screen shot 2018-04-02 at 2 08 56 pm"" src=""https://user-images.githubusercontent.com/2212006/38208646-bd6c7d5e-367f-11e8-9f3e-f80569daf7eb.png"">
",enhancement
309840167,Support SSO authentication for the Dashboard,"### Is this a Feature or Bug?

Feature

<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->

### Current behavior:

Authentication is currently handled through Github login only.

### Desired behavior:

Support authentication through SSO.

Right now, our team is required to authenticate through LastPass's SSO service when using third-party tools to meet set security requirements. For this reason, we're unable to use the Cypress dashboard. I'm sure other organizations have similar requirements, so this would be a handy feature to have. Of course, the alternative would be self-hosting the dashboard. Until that's possible, simply having SSO support would go a long way, and would be much simpler to put together.

I looked into Auth0's documentations, and it seems implementing SSO may be straight-forward using their [Universal Login](https://auth0.com/docs/hosted-pages/login#single-sign-on-sso-) tools.
",enhancement
309780541,Add `before:action` event,"<!-- Is this a question? Do not open an issue. Please ask your question in our chat https://gitter.im/cypress-io/cypress -->
### Feature
Add a `before:action` event that fires immediately before an action is made.

### Purpose
Allow user to debug at the time immediately before Cypress takes an action.

",enhancement
309292998,Ability to record *.gifs,"### Is this a Feature or Bug?

Feature request!

### Current situation:

Currently we've got a possibility to record and save videos from test runs, which is really great! But many times QA's have to report a bug which is very hard to describe, e.g. animation behaving somehow wrong, weird UI jumps, etc.

### Desired feature:

I would love to see a possibility in a test run to be able to save a *.gif file for chosen steps, so that I can easily and fast explain wrong behavior of UI for my dear developers.

### Additional Info (images, stack traces, etc)

Very good work on cypress though. I am impressed!

Anyone sharing the same opinion?",enhancement
309151943,Stress / load testing,"### Desired behavior:
I'd like a `--stress-test` parameter which lets me re-run tests for a set number of hours, with a final report to indicate which tests are flaky and which are sturdy.

~~As an alternative, it'd be fine if your dashboard service would aggregate fails over time, allowing me to see which tests need more attention.~~ 

This feature is going to grow in importance to me personally as my test suite grows in size.

- Operating System: Linux Mint 18.3
- Cypress Version: Cypress 2.1.0
- Browser Version: Electron

*Edit by @jennifer-shehane: Moved Dashboard feedback to https://portal.productboard.com/cypress-io/1-cypress-dashboard*
",enhancement
309085794,Add keywords to npm package.json,"Should probably have keywords to enhance npm package search.

*Sad, no keywords*
<img width=""1154"" alt=""screen shot 2018-03-27 at 2 26 00 pm"" src=""https://user-images.githubusercontent.com/1271364/37987011-14567f5c-31cb-11e8-9029-a2a26831e699.png"">

*Suggested keywords*
```json
{
  ""keywords"": [
    ""browser""
    ""cypress"",
    ""automation"",
    ""mocks"",
    ""test"",
    ""testing"",
    ""runner"",
    ""spies"",
    ""stubs""
  ]
}
```

Need to add to root `package.json` and update `build` process to copy over `keywords` here: https://github.com/cypress-io/cypress/blob/develop/cli/scripts/build.js#L8
",enhancement
307742907,Retry instead of Fail/Pass on non-200 Status Codes,"### Is this a Feature or Bug?

Feature

### Current behavior:

[failOnStatusCode: false](https://docs.cypress.io/api/commands/visit.html#Arguments) will silently swallow errors and skip the test on a per `visit()` basis.

### Desired behavior:

While the current behavior is a valid use case, our use case is that non-200 status codes are sometimes expected (because of how the app is deployed for testing internally) and instead we would like the ability to _retry_ instead of swallow, skip and continue.

So maybe a `retryOnStatusCode: true` or something (or maybe instead of a Boolean it could take an Integer for number of retries).

cc, @ValerieThoma 
",enhancement
305253411,Update onboarding modal to reflect new scaffolding,"I was initially opening this issue for the updates being made to kitchen-sink in 3.0.0 here: https://github.com/cypress-io/cypress-example-kitchensink/pull/40 The onboarding modal should display a folder called `examples` instead of a file called `example_spec.js`

But, I realize that this was never updated after adding the plugins folder/file, so this modal also needs to be updated to reflect that. 

**Current onboarding dialog**
![screen shot 2018-03-14 at 1 14 22 pm](https://user-images.githubusercontent.com/1271364/37419060-066555f8-278a-11e8-910b-1ca320898b10.png)
",enhancement
304459089,Unable to configure orientation independently of width / height,"### Current behavior:

We can only configure the orientation with cy.viewport, as the 2nd ( with presets ) or 3rd ( with width / height ) param,

### Desired behavior:

We should be able to configure orientation without being required to to pass a new width / height value with cy.viewport

We should be able to configure orientation in the cypress.json file

### Additional Info (images, stack traces, etc)


Orientation isn't as simple as reversing the width and height of the target browser, as this would not trigger window.orientation changes or event changes. 

When testing webapps, it is important that the orientation change logic is consistent.

I need to be able to have the proper orientation configured in the cypress.json as well as being able to switch on the fly with cy.viewport. 

",enhancement
304371484,Ability to whitelist as well as blacklist hosts,"### Is this a Feature or Bug?

Feature.

### Desired behaviour

Whilst you can blacklist hosts, I think it would be good if you could also provide a whitelist, as that way you could guarantee that your tests (which may be running quite frequently, after all) weren't making external requests you didn't know about (e.g. no need to worry about some third-party rate limiting for some item your page includes).",enhancement
304205661,Server sent events don't work and seem to be buffered by the Cypress proxy.,"This is following up after tagging onto [this issue](https://github.com/cypress-io/cypress/issues/1111) with my versions, specs and further info:

- Operating System: macOS 10.13.3
- Cypress Version: 2.1.0
- Browser Version: Google Chrome 65

### Is this a Feature or Bug?
Bug

### Current behavior:
No server sent events are received by the application running in the Cypress browser. If I kill the server then all events are flushed and appear in the browser at once. It seems that the events are getting buffered in Cypress' proxy layer until the connection terminates. This is how nginx works (or more accurately - doesn't work) with buffering turned on.

### Desired behavior:
Server sent events are passed through to the application.

### How to reproduce:
Run the repro below.

#### Test code:
https://github.com/hally9k/cypress-sse


",enhancement
303437991,Endurance testing with Cypress,"### Current behavior:
A small note about performance testing being one of the things you don't do with Cypress.
https://docs.cypress.io/guides/references/trade-offs.html#Automation-restrictions

### Desired behavior:
So we've written a heap of Cypress tests for different end user workflows through our product and now we're looking for ways to simulate a user using the platform over the course of several hours (our goal is 8h+)

* Ability to maintain a single browser session across multiple tests.

* Chain existing tests together. At the conclusion of a test, specify the next test to run in the test sequence. This allows for different user workflows to be created dynamically at run-time. The tests should still execute as separate tests to facilitate separate reporting on the different user workflows instead of just capturing success / failure of the whole workflow.

* Memory snapshots and statistics capture from snapshots to help with memory leak detection.

* Different (configurable) compensation strategies:
   - On application error, terminate the current browser session and establish a new one.
   - On application error, log the error and continue within the current browser session.
   - On application error, stop the test (pretty much what happens now).

* Capture statistics to identify executions that took longer / shorter (standard deviation metrics).

* Errors are captured and aggregated together for statistical reporting (I.E. spec 1 failed 88 times out of 100)

* All of the above captured into the Dashboard service

* Stretch goal: Run multiple instances across different browsers concurrently to do stress testing. Failure rate and other metrics captured on per browser basis. (This one seems less likely to happen given the comments on the link above)

So there's a starting point for our feature wish list (I realize these aren't small things). This might get quickly closed as falling under the banner of performance testing but I hope it can spark some further discussion because there actually aren't that many tools out there that can consistently mimic an end user to the simplicity and extend of Cypress. I know a good chunk of this functionality can be delivered with the existing framework components (Plugins, Cypress Events, Uncaught exception handling) but my hope is that Cypress may consider, or are planning in the future to go into this space as a first-class solution offering long running testing within the Cypress framework and Dashboard service.",enhancement
303316223,Support snapshotting iframes,"Will be useful for cases like [running storybook tests with cypress](https://medium.com/@mtiller/testing-react-components-using-storybook-and-cypress-1689a27f55aa)

",enhancement
302419963,Can we download cypress not on postinstall but on first real use?,"Everytime I purge node_modules and use `npm i` or `yarn` it downloads Cypress.

Can we download cypress not on postinstall but on first real use?

Thanks a lot.",enhancement
302342117,Simulate swipe action,"### Desired behavior:
I use Cypress with Ionic 3 and I want to test my side-menu opening/closing, tabs change and pull to refresh with a swipe action. 
It is possible to simulate a swipe action with Cypress ? 
I tried to get inspired by the drag and drop example but it doesn't works.
Maybe I'm doing something wrong.

#### Test code:

```js
it('should close menu', () => {
  // This open my side menu by click on a button (OK)
  cy.get('button').click();

  // This should close menu by swipe (DO NOTHING)
  // I selected content of my menu.
  cy.get('content of my menu').trigger('mousedown', { which: 1 })
    .trigger('mousemove', { clientX: 120, clientY: 300 })
    .trigger('mouseup', {force: true})
});
```

- Operating System: Mac OS 10.13.3
- Cypress Version: 2.1.0
- Browser Version: Chrome 64.0.3282.186


",enhancement
302283162,Await-ing Cypress Chains,"### Current behavior:
`await`-ing cypress chains yields undefined

### Desired behavior:
`await`-ing cypress chains yields the value of the chain (since the chain is a promise-like, it should work with await out of the box)

### Additional Info (images, stack traces, etc)
I understand the recommended way to use cypress is closures, however, when dealing with multiple variables, we run into callback hell's lil' brother **closure hell**. 

The ability to use `await` on Cypress chains could be beneficial in many ways:

- avoiding nesting closures many levels deep, thus preventing unreadable code
- making it easy for programmers familiar with traditional async patterns to start using Cypress

Example code using closures

````js
describe('Filter textbox', () => {
    beforeEach(() => {
        cy.get(test(""suplovaniTable"")).as(""suplovaniTable"");
        cy.get(test(""filterTextbox"")).as(""filterTextbox"");
    });

    it('changes data on filter text change', () => {
        cy.get(""@suplovaniTable"").then((el) => {
            return el[0].innerHTML;
        }).then((innerHTML) => {
            return sha256(innerHTML);
        }).then((hash) => {
            cy.get(""[data-test=suplovaniTable] > tbody > :nth-child(1) > :nth-child(2)"")
                .then((tds) => {
                    const text = tds[0].innerText;
                    cy.get(""@filterTextbox"").type(text);
                    cy.get(""@suplovaniTable"")
                        .then(el => el[0].innerHTML)
                        .then((innerHTML) => {
                            expect(hash).to.not.equal(sha256(innerHTML));
                        });
                });
        });
    });
});
````

Example code using `await`
````js
describe('Filter textbox', () => {
    beforeEach(() => {
        cy.get(test(""suplovaniTable"")).as(""suplovaniTable"");
        cy.get(test(""filterTextbox"")).as(""filterTextbox"");
    });

    it('changes data on filter text change', async () => {
        const table = await cy.get(""@suplovaniTable"");
        const hash = sha256(table[0].innerHTML);

        const filterCell = await cy.get(""[data-test=suplovaniTable] > tbody > :nth-child(1) > :nth-child(2)"");
        await cy.get(""@filterTextbox"").type(filterCell[0].innerText);

        const newTable = await cy.get(""@suplovaniTable"");
        const newHash = sha256(newTable[0].innerHTML);
        expect(hash).to.not.equal(newHash);
    });
});
````

- Operating System: Windows 10 x64
- Cypress Version: Beta 2.1.0
- Browser Version: Chrome 64

",enhancement
301814872,Proposal: Watch entire dependency tree of plugins file,"Currently, we only watch the plugins file itself for changes and reload. To make iterating on plugins easier, we need to watch its entire dependency tree (maybe excluding node_modules) for changes.",enhancement
301785550,Proposal: new command for communicating between tests and a plugin event,"Create a new command, `cy.task()`, that will send a message that can be received by a plugin event, allowing the user to write arbitrary code to be executed in node and return the result.

The code in the plugin can return a value or return a promise that resolves a value. That will become the value yielded by the command.

It can also throw an error or reject the promise to fail the command.

Returning undefined from the 'task:requested' event in the plugins file will cause an error, to help prevent missing a task event and help debug instead of just failing for subtle reasons. A user will be able to return `null` if they explicitly don't want to return a value.

Example:

### Warning: this API has changed since this original issue. Please refer to the [task doc](http://on.cypress.io/task) for the latest API.

```javascript
// in spec.js
cy.task('createUser', { email: 'chris@cypress.io' }).then((user) => {
  // user is the object returned by the plugin
})
```

```javascript
// in plugins/index.js
module.exports = (on) => {
  on('task:requested', (event, arg) => {
    switch (event) {
      case 'createUser': {
        // arg === { email: 'chris@cypress..io' }
        // create user and return it
      }
     }
  })
}
```

",enhancement
301543400,Allow specifying cypress binary location from .npmrc,"### Current behavior:
https://docs.cypress.io/guides/getting-started/installing-cypress.html#Environment-Variables

### Desired behavior:
Rather than needing to introduce an environment variable outside of npm land, it would be nice to specify a `cypress_binary_version` npm config inside the .npmrc file.

This means our devs only need to type `npm install`, and don't need to think about specifying environment variables.

This is how PhantomJS does it.
https://github.com/Medium/phantomjs#deciding-where-to-get-phantomjs

### How to reproduce:
`npm install`

- Operating System: Linux
- Cypress Version: 1.4.2
- Browser Version: Chrome 60

",enhancement
300997400,Cypress & Serenity-js integration,"### Desired behavior:
As discussed yesterday with @bahmutov @RandallKent and Jan Molak of Serenity-js. I want to see if we are able to integrate cypress with serenity. This will be a place to discuss this and review it.

### why?
Serenity-js can be handy in multiple ways:
* Support the BDD process with the screenplay pattern. Serenity-js uses tasks that represents business language. The outcome can be a SerenityBDD report which can serve as living documentation (if the BDD process is correctly implemented)
* It can help the non-technical tester to contribute more in testing. By using components in the screenplay pattern in the form of a DSL, it is easier to contribute and read the tests.

### The challenges:
* Serenity-js uses the standard es6 promises. Cypress uses there own Chainable promises. I found a way to convert this (see the example) but it is not pretty. We need to figure out a nice way to do these transformations.
* Serenity now uses protractor and records the events and writes them in the process straight to the file system. Since the tests of cypress run in the browser, this is not possible. A solution would be to send the events to the process who can pick it up and then do the same it already did, writing it to a file. 

### Test code:
see [repo](https://github.com/Baasie/cypress-serenity-js)
*** Disclaimer, this is POC, be faced that your Clean Code senses will go off. But it works as a simple example :)

- Operating System: Ubuntu 17.10
- Cypress Version: 2.0.4
- Browser Version: 

",enhancement
300858872,"Do not capture video during 'file:preprocessor', etc, before tests start","<!-- **Tip** in order for us to reproduce the bug you can fork [cypress-io/cypress-test-tiny](https://github.com/cypress-io/cypress-test-tiny) repo and setup the failing test. Then just tells us the repo and branch to try! -->

- Operating System: Windows 10
- Cypress Version: 2.0.4
- Browser Version: Chrome 64

### Is this a Feature or Bug?
Feature

### Current behavior:
When using the typescript plugin, the uploaded video includes the typescript compilation time frame which is just a static image of the uninitialised test runner for the first 30 seconds of the video. I have to go hunting through the video for the point where the tests begin to execute.

### Desired behavior:
Do not capture the period of execution during the file:preprocessor (possibly others) into the resulting video.

Additionally, offer bookmarks on the dashboard search video viewer so that I can more quickly identify when individual tests execute. Bookmarks for point of failure would be awesome as well!",enhancement
300651384,Cypress should empty indexDB before onload,"<!-- **Tip** in order for us to reproduce the bug you can fork [cypress-io/cypress-test-tiny](https://github.com/cypress-io/cypress-test-tiny) repo and setup the failing test. Then just tells us the repo and branch to try! -->

- Operating System: Mac OS X
- Cypress Version: 2.0.4
- Browser Version: Chrome 64

### Is this a Feature or Bug?
Bug

### Current behavior:
IndexDB databases are not being cleared before runs

### Desired behavior:
IndexDB databases should be empty when doing the first `.visit`

### How to reproduce:
From an application that uses indexDB, reload the application and indexDb data will still be there 

#### Test code:

```js

```


### Additional Info (images, stack traces, etc)

",enhancement
299865469,cypress folder being added even with custom folders set,"### Current behavior:

I have the following in my cypress.json:

```json
{
  ""fileServerFolder"": ""./test/_integration"",
  ""integrationFolder"": ""./test/_integration/integration"",
  ""pluginsFile"": ""./test/_integration/plugins"",
  ""screenshotsFolder"": ""./test/_integration/screenshots"",
  ""supportFile"": ""./test/_integration/support"",
  ""videosFolder"": ""./test/_integration/videos"",
}
```

but when I run `cypress open`, it scaffolds a cypress folder

### Desired behavior:

To not scaffold a cypress if custom folders are set

### How to reproduce:

run `cypress open` with the above conifg

- Operating System: osx
- Cypress Version: 2.0.3
- Browser Version: 64
",enhancement
299736753,Add `--config-file` CLI argument,"### Current behavior:

I cannot specify a configuration file path

### Desired behavior:

I want to specify a configuration file path

#### Test code:

```
cypress run --config-file ""/path/to/config""
```

### Additional Info (images, stack traces, etc)

I'm building a tool for PayPal called `paypal-scripts` (similar to `react-scripts`). One of the purposes is to cover 80% of the use cases by hiding all configuration from the user of the tool so they can focus on just writing the code. If they _do_ create a `cypress.json` file then we'll use that one, but for most people they should be able to just use the built-in configuration of `paypal-scripts` and they wont need to have and maintain a `cypress.json` file at all. There's honestly not a lot of configuration we'd need (mostly the `baseUrl` I think), but a lot of the value proposition of `paypal-scripts` is that people don't need to worry about configuring anything and it all just works out of the box.

I'm able to do this with `eslint`, `babel`, and many other tools, but I can't currently do it with `cypress` and I'd like to be able to do that if possible :) Thoughts?",enhancement
299589305,Propose: Providing the service for get cypress status's badge.,"I saw the related issue https://github.com/cypress-io/cypress-documentation/issues/71

But the badge is settled style, I want to get the status dynamically by `https://example.com/${projectId}.svg?...`",enhancement
298189222,Login through Azure AD account.,"### Current behavior:
I use Azure AD to authenticate my users. 

My logic:

When user opens the browser and get `401` status code from my api then application redirects to `https://login.microsoftonline.com/`.... page to input login and password and then microsoft redirects back with access token for my application.

Now when I open my page `cy.visit(""http://localhost:8080"")` I just get 401 status code from my application and it doesn't redirect me to input login and password.

I tried to open login page directly to check login and password typing: `cy.visit(""https://login.microsoftonline.com"");`

but cypress can't load this page and fails with timeout.

In dev tools I see that it tries to load page content all the time.

My cypress,json file:
```json
{
	""chromeWebSecurity"": false
}
```

Selenium works fine with this case.

### Desired behavior:

Cypress can redirect me to `https://login.microsoftonline.com` to input login and password and redirect back to `http://localhost:8080`.

https://login.microsoftonline.com should be open correctly.

### How to reproduce:

1. `cy.visit(""https://login.microsoftonline.com"");`
2. Try to get 401 status code from your application and redirect to `https://login.microsoftonline.com`


#### Test code:

```js
describe(""Integration tests"", function() {
	it(""login"", function() {
              cy.visit(""http://localhost:8080"");
              //cy.visit(""https://login.microsoftonline.com"");
	});
});
```


### Additional Info (images, stack traces, etc)

```
CypressError: Timed out after waiting '60000ms' for your remote page to load.
Your page did not fire its 'load' event within '60000ms'.
You can try increasing the 'pageLoadTimeout' value in 'cypress.json' to wait longer.
Browsers will not fire the 'load' event until all stylesheets and scripts are done downloading.
When this 'load' event occurs, Cypress will continue running commands.
```

- Operating System:
Windows 10 pro
- Cypress Version:
2.0.2
- Browser Version:
Chrome 63
",enhancement
297892969,Upgrade sinon to the latest version,"Upgrade sinon from `3.2.0` to `4.3.0` and ensure no breaking changes to what Cypress exposes. 

Might fix #1328.",enhancement
297233984,Support mocha test retries / retry test failures,"### Is this a Feature or Bug?
Feature

### Current behavior:
With this.retries set, when a test fails:

```
TypeError: Cannot set property 'err' of undefined
    at Reporter.mergeErr (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/reporter.js:95:18)
    at Reporter.parseArgs (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/reporter.js:199:20)
    at Reporter.emit (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/reporter.js:190:23)
    at Object.server.startWebsockets.onMocha (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/project.js:287:22)
    at Socket.<anonymous> (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/socket.js:237:36)
    at emitThree (events.js:116:13)
    at Socket.emit (events.js:194:7)
    at /home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/socket/node_modules/socket.io/lib/socket.js:503:12
    at _combinedTickCallback (internal/process/next_tick.js:67:7)
    at process._tickCallback (internal/process/next_tick.js:98:9)

TypeError: Cannot set property 'err' of undefined
    at Reporter.mergeErr (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/reporter.js:95:18)
    at Reporter.parseArgs (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/reporter.js:199:20)
    at Reporter.emit (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/reporter.js:190:23)
    at Object.server.startWebsockets.onMocha (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/project.js:287:22)
    at Socket.<anonymous> (/home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/socket.js:237:36)
    at emitThree (events.js:116:13)
    at Socket.emit (events.js:194:7)
    at /home/cameronc/switch/test/matcher/node_modules/cypress/dist/Cypress/resources/app/packages/socket/node_modules/socket.io/lib/socket.js:503:12
    at _combinedTickCallback (internal/process/next_tick.js:67:7)
    at process._tickCallback (internal/process/next_tick.js:98:9)
```
### Desired behavior:
this.retries is supported at the describe() and it() level",enhancement
296545639,"Support arbitrary list of methods, (Cf: Express)","### Is this a Feature or Bug?

Feature.

### Current behavior:

Currently, when using `cy.request`, you are limited to a handful of the most popular HTTP verbs.  However, there are far more verbs than the official ones, such as in [express API](http://expressjs.com/en/api.html#routing-methods).  Without supporting these, it makes it hard to test methods like `subscribe` and `unsubscribe`.

### Desired behavior:

Allow arbitrary HTTP methods to be used.  

### How to reproduce:

```js
cy.request({
        method: 'SUBSCRIBE',
        url: `users/1`,
        body: email
      }).then(() => {});
```

Result:  CypressError: cy.request() was called with an invalid method: 'SUBSCRIBE'.  Method can only be: GET, POST, PUT, DELETE, PATCH, HEAD, OPTIONS

Possibilities:  Allow an extra flag to be checked that will turn off method checking.",enhancement
296488163,Proposal: download Cypress to the common cached folder,"## Feature

Instead of downloading and unzipping Cypress into `./node_modules/cypress/dist/` download it into a global folder for better caching. This will allow

- better caching of dependencies on CI
- reusing same version of Cypress if already downloaded once for some project

To determine output location use https://github.com/LinusU/node-cachedir

```js
var cachedir = require('cachedir')
var path = cachedir('cypress')
// `path` now contains the path under which you should store cached files
```



- cypress run, open, verify
  - [ ] ~take arg `--binary-folder` (looks like: `/foo/bar/Cypress.app` (macOS) or `/foo/bar/Cypress` (linux, win), to override default path to cypress binary folder (default is  `(cypressCache)/<cli version>/Cypress.app`)~
  - [x] can override folder of binary with env var `CYPRESS_BINARY_FOLDER=/path/to/Cypress.app`
    - [x] warn user if set

- cypress install
  - [x] Checks `(cypressCache)/<cli version>` for already installed binary folder (`Cypress.app` on macOS, `Cypress` on linux/win), and if binary version matches `(installVersion)`, do nothing.
  - [x] `(installVersion)` defaults to cli version, is overridden by env var `CYPRESS_BINARY_VERSION` during install
    - can be either `semvar: 1.2.3`, `url: www.cypress.io/download/1.2.3`, or `zip: /path/to/cypress.zip`
  - [x] if `cypress install --force`, force reinstall to `(cypressCache)/<cli version>`
  - [x] `(cypressCache)` defaults to:
    - `~/Library/Caches/Cypress` (macOS)
    - `~/.cache/Cypress` (linux)
    - `/AppData/Local/Cypress/Cache` (win)
  -  [x] `(cypressCache)` can be overridden with env var `CYPRESS_CACHE_DIRECTORY`
  - [x] before install, ensure write access to `(cypressCache)`

- [x] custom error message for failed access to `(cypressCache)`
- [ ] docs
  - [x] Installing Cypress
  - [ ] ~command line usage~
  - [ ] update info about global install
- [x] manual testing all use cases
  
  - [x] cypress install
    - CYPRESS_BINARY_VERSION
      - [x] url 
        - [x] skip if has any cache
      - [x] semvar
      - [x] zip
        - [x] skip if has any cache
        - [x] show progress for unzipping 
      - [x] --force
    - [x] --force
  - [x] ~--binary-folder~
    - [x] ~cypress run~
    - [x] ~cypress open~
    - [x] ~cypress verify~
    - [x] ~invalid~
  - [x] CYPRESS_CACHE_DIRECTORY
    - valid
    - invalid, error message
  


- [x] add local code coverage with `nyc`
  - [ ] ~~send to `coveralls` in CI~~
## Stretch goal
- [ ] can we cache `ffmpeg` separately to avoid bundling the same version over and over?",enhancement
296487121,Allow running Cypress binary installed in arbitrary folder,"## Feature

Instead of always taking the binary from `node_modules/cypress/dist`, allow passing path to the binary folder dynamically.

- [x] using environment variable `CYPRESS_RUN_BINARY`
- ~using CLI argument `--binary-location`~

Part of caching binary epic",enhancement
296378310,Add ability to wait for script to load (like cy.script('js') + cy.wait()),"### Current behavior:
I am working on a React application where we create splitting points here and there in order to separate the code into different bundles. This means that sometimes it is necessary to wait for a script to load before continuing. The only way I found of doing that was by adding a `cy.wait(5000)` for those cases. Is there any other way of doing this? 

### Desired behavior:
Similar approach to `cy.route` so that you can specify which scripts to wait for. Something like:

```js
cy.script('js*').as('getBundle');

cy.wait('@getBundle').then(...)
```

- Operating System: macOS High Sierra
- Cypress Version: 1.4.2
- Browser Version: Chrome 64

",enhancement
295330273,Support xpath support for cy.get() and .find(),"### Current behavior:
.get('//div') doesn't work
.find('p/span') also doesn't work
### Desired behavior:
It gets the element using document.evaluate just like get and find currently uses document.querySelector.

or to avoid collisions we add getXpath and findXpath or something.

### Motivation
xpath is fairly standard in integration tests, and is much more powerful than css selectors are, and I'm working on a shared library of xpath selectors for use with selenium, puppeteer, and ideally, cypress.

I'm happy to help with writing this code if people agree it's a useful feature that would be likely to get merged.",enhancement
294661054,Proposal: Add a group to commands for nicer command logging,"I've been playing around with ways of defining reusable helpers (blog post coming) and have been using the Cypress log API and passing `{ log: false }` to allow control of the log output of these helpers/commands. This has been useful, but there are some times that I want to dive into that abstraction (most likely on failure) to see what step of the helper failed.

I think a concept of a `group` would be useful here. Instead of passing `{ log: false }` to every encapsulated command, having a group would help a lot more

### Current behavior:
```js
// This will work on https://github.com/cypress-io/cypress-example-todomvc
export const createTodo = (name) => {
  const log = Cypress.log({
    name: 'createTodo',
    message: name,
    consoleProps() {
      return {
        'Inserted Todo': name,
      }
    }
  })
  cy.get('.new-todo', { log: false }).type(`${name}{enter}`, { log: false })

  return cy
    .get('.todo-list li', { log: false })
    .contains('li', name.trim(), { log: false })
    .then(($el) => {
      log.set({ $el }).snapshot().end()
    })
}

// to use this helper:
createTodo('Learn the Cypress Log API')
  .then(console.log) // logs the created todo element from the TodoMVC Cypress example
```
Screenshot of the above:
<img width=""548"" alt=""screen shot 2018-02-06 at 12 30 46 am"" src=""https://user-images.githubusercontent.com/338257/35846734-1052101e-0ad5-11e8-80e7-a498151f74e5.png"">


### Proposed behavior:
```js
export const createTodo = (name) => {
  const group = Cypress.group({
    name: 'createTodo',
    message: name,
    consoleProps() {
      return {
        'Inserted Todo': name,
      }
    }
  })

  cy.get('.new-todo').type(`${name}{enter}`)

  return cy
    .get('.todo-list')
    .contains('li', name.trim())
    .then($el => { group.set({ $el }).snapshot().end() })
```

Matching the log API seems like a logical choice. In the UI it would show `createTodo` with the logging the same as the `Current behavior` example, but would have an arrow that would expand to the grouped commands. This would both simplify creating custom command output (don't have to pass `{ log: false }` to everything) as well as make it easier to understand that's going on under the hood of a custom command. The group would be collapsed by default and expanded if a nested command failed.
",enhancement
294170967,Cypress in Kerberos Environment,"Thanks for an amazing product in e2e javascript testing.

Will cypress work in Kerberos environment. I was trying to open a internal site in electron headed mode, but request failed with 401.  

What should I do to make cypress work in Kerberos environment.
",enhancement
293733212,Add feature to append instead of overwrite with cy.writeFile,"<!-- **Tip** in order for us to reproduce the bug you can fork [cypress-io/cypress-test-tiny](https://github.com/cypress-io/cypress-test-tiny) repo and setup the failing test. Then just tells us the repo and branch to try! -->

- Operating System:
- Cypress Version:
- Browser Version:

### Is this a Feature or Bug?
Feature Request

### Current behavior:
`cy.writeFile` will only overwrite. In order to append, you have to read a file (making sure it already exists...), add the contents of that file to what you want to append to it in memory, and then do another writeFile call. 

### Desired behavior:
add a `{""append"": true}` option to `cy.writeFile`.

Since I am dynamically generating tests, this would allow me to aggregate specific metrics from each test into a single JSON file without working around it. 
",enhancement
292033123,Run Cypress Headless Without Binary,"### Current behavior:
`npm install cypress` downloads the cypress app binary


### Desired behavior:
`npm install cypress` (or something like `npm install @cypress/headless`) does not install a binary, and only installs necessary dependencies for running tests headlessly on CI.

### Additional Info (images, stack traces, etc)
Our CI configuration is pretty strict about what can be externally downloaded. It would be great if cypress could be run without needing to whitelist the cypress domain.

- Operating System: Linux centos
- Cypress Version: 1.4.1
- Browser Version: Chrome 63


",enhancement
290099158,Server needs promise-based way to communicate with driver,"## Feature

When the client code (running in the spec iframe) stubs a network request it might have logic to execute. For example if the delay for the resource is not a constant but should be determined dynamically the test might do this

```js
it('delays', () => {
  cy.route({
   url: '/foo',
   delay: (req) => 500
  })
})
```

This ""traffic rule"" should be sent to the server's network proxy module that handles stubbing. We cannot send the callback function `delay: (req) => 500`, so it gets stripped when passing message from the client to the network proxy module. The module is running in the Node process. When it needs to handle the request it has a problem - how does it call `delay` callback?

We have three problems: 

- we cannot just strip `delay` callback and forget about it.
- network proxy module should send a message to the client saying ""call delay callback""
- the client should be able to _respond_ back to the server after calling the delay callback

## Proposal

When stripping callback functions from traffic rules, we are going to collect all callbacks into an object by unique id.

```js
// before sending rule
const r = {
  url: '/foo',
  delay: (req) => 500
}
// after
const toSend = {
  url: '/foo',
  delay: '__message:a1234'
}
const callbacks = {
  __message:a1234: (req) => 500
}
```

On the server side, when reconstructing traffic rule object we put method proxies

```js
// on the server we receive
const received = {
  url: '/foo',
  delay: '__message:a1234'
}
// and make into
const rule = {
  url: '/foo',
  delay: (...args) => callClientCallback('__message:a1234', ...args)
}
```

The function `callClientCallback` uses socket message to communicate to the client, but it also registers 1 time unique _receiver_ message name to receive reply and resolve its promise.

```js
function callClientCallback(name, ...args) {
  return new Promise((resolve, reject) => {
    const replyId = '__reply:' + _.random(1, 1e+6)
    socket.emit('client:async', name, ...args)
    socket.on(replyId, (data) => {
     socket.remove(replyId) // used once
    })
  })
}
```

The network layer thus can transparently get specific delay or other values from the test's callbacks.

I have implemented rudimentary solution in https://github.com/cypress-io/cypress/commits/collect-traffic-rules but the communication needs to be tighten up and made general. 

## Related info

- https://github.com/bahmutov/iframe-api is example of making an API across iframe boundary using `postMessage` to communicate",enhancement
289924437,Cypress should clear indexeddb state between test runs,"### Current behavior:
Cypress does not clean the indexeddb state between test runs

### Desired behavior:
Cypress should clean the indexeddb state between tests

### How to reproduce:
I've created a spec that reproduces this behaviour in a fork of cypress-test-tiny. Just clone, run the spec here and open the console:  https://github.com/andreiashu/cypress-test-tiny

- Operating System: any
- Cypress Version: 1.4.1
- Browser Version: any
",enhancement
288625757,Do not fail test run if recording without record key for pull requests from forked repos,"## improvement

We currently stop tests if the user wants to record the test run but has not passed record key. This becomes a problem when someone submits a pull request from a forked repository. Example in https://travis-ci.org/bahmutov/cypress-react-unit-test/builds/328887786

```
$ npm test -- --record
> cypress-react-unit-test@0.0.0-development test /home/travis/build/bahmutov/cypress-react-unit-test
> cypress run ""--record""
You passed the --record flag but did not provide us your Record Key.
You can pass us your Record Key like this:
  cypress run --record --key <record_key>
You can also set the key as an environment variable with the name CYPRESS_RECORD_KEY.
https://on.cypress.io/how-do-i-record-runs
npm ERR! Test failed.  See above for more details.
The command ""npm test -- --record"" exited with 1.
```

This is a very common case for public repos - and every pull request will have tests fail without even running.

## Proposal

Maybe a better solution would be for the test runner to
- detect `--record` flag without record key. 
- check if running in a fork pull request (look at environment variables like https://docs.travis-ci.com/user/environment-variables/#Default-Environment-Variables) then show a warning, skip recording *but run the tests*",enhancement
287735269,Allow reusing cy.server() in several tests and hooks,"### Is this a Feature or Bug?

Feature.

### Current behavior:

`cy.server()` is reset after each test case (`it`) is run. This makes impossible things like this:

```
describe
-> before :: something that needs to wait for a XHR request
-> it :: several tests waiting for requests
```

We could do:

```
describe
-> before :: set up cy.server()
-> before :: something that needs to wait for a XHR request
-> it :: several tests waiting for requests
```

But the second test will fail as current server will have been reset (it's reset [here](https://github.com/cypress-io/cypress/blob/2b2b6d99a9f1bf232d9c7396b25390913d5f2b18/packages/driver/src/cy/commands/xhr.coffee#L233)).

We could do:

```
describe
-> before :: set up cy.server() for before hooks
-> before :: something that needs to wait for a XHR request
-> beforeEach :: set up cy.server() for tests
-> it :: several tests waiting for requests
```

But then we have to set up the server twice.

### Desired behavior:

Cypress should expose a way to tell `cy.server()` that we don't want to reset the server before each test or one way to tell that we want to preserve aliased routes.",enhancement
287171555,Email / submit GH issue straight from the test runner,"# new feature

When working in opened test runner and hitting a test failure, it would be so useful to send an error email or open a github issue with _all_ relevant details (test, steps, XHRs, exception, screenshot) with a single button push. Probably would require dashboard service though.",enhancement
286589966,"Aggregate stats ourselves, do not rely on mocha reporters","Currently we rely on the mocha reporter's `stats` object to return us the stats related to a single run. We use this when displaying the final results of a run.

This is problematic because it may differ on custom reporters (which are not consistent with the base reporter) and we also disagree with the mocha semantics for things like counting the number of `tests`.

Tests to mocha are actual **test runnables** that must reach their `test end` event to being counted. This means that failures occurring in `hooks` they do not increment this number - which makes no sense.

In Cypress we consider the test body itself and **all associated hooks** to be one discrete ""test"". In our UI we show tests failing on their hooks (and provide you visual indicators). 

Since we've already gone through all the trouble of making the UI represent this - it's necessary for us to aggregate the stats ourselves during a `cypress run` so we can accurately provide you the same stats (including for our Dashboard).
  ",enhancement
286331701,Update Cypress to use Chai 4.0 instead of 3.5,"- Cypress Version: 1.4.1

### Is this a Feature or Bug?
Feature

### Current behavior:
There have been some new methods that were introduced to Chai between 3.5 & 4.0, but Cypress still uses 3.5. Current version of Chai 4.1.2 and have some more bug fixes and ES6 fixes.

### Desired behavior:
**Ability to use updates in Chai 4.0:**
- Add `ordered` assertion: `to.have.ordered.members`
- Throw when non-existent property is read. `expect(true).to.be.ture; // Oops, typo, now Chai will throw an Error`
- Have suggestions on typos. `expect(false).to.be.fals; // Error: Invalid Chai property: fals. Did you mean ""false""?`
- Use `by` with `increase`, `change` `decrease`. `expect(increaseByTwo).to.increase(obj, 'val').by(2)`
- Use `does` and `but` as new no-op assertion.
- Use `nested` property

### How to reproduce:
**Test Code**
```js
expect([1, 2]).to.have.ordered.members([1, 2])
```

**Resulting Error**
```
CypressError: Timed out retrying: Cannot read property 'members' of undefined
```
  
  ",enhancement
284803113,CSS Selector Playground - allow configuration?,"Hi!

This is a follow up to the launch of the CSS Selector Playground feature, and in reference to this comment: https://github.com/cypress-io/cypress/issues/917#issuecomment-352225763.

A use case I have is the following: 
We always set a unique `data-testid` on all of our elements used in E2E tests. It'd be really cool if the CSS Selector Playground was configurable so that it would prefer (or even enforce) selectors using the `data-testid`-convention. In addition to that, it'd be cool if it could also somehow highlight all elements with `data-testid`'s on the page right now.

Any thoughts/comments?",enhancement
284779953,"Add option to hide log to the ""cy.its"" command","Cypress v1.4.1 `cy.its` https://on.cypress.io/its command does not accept options argument, so there is no way to hide it from the command log for example.",enhancement
284387440,Add cypress:xvfb logging,"When `xvfb` is being used, we should allow its `stderr` output to be seen via `DEBUG=cypress:xvfb`",enhancement
284380173,Force colors in Windows when running from electron,"Per this issue in electron: https://github.com/electron/electron/issues/11488

When running electron in Windows, `isTTY` ends up being false. To preserve the native behavior of Windows, we're opting not to monkey patch this. However, we will force colors to be output correctly (if originally supported) thus making Windows look nice™.",enhancement
284380030,Coerce TTY to true when using pipe'd child processes,"Per this repo: https://github.com/cypress-io/cypress-test-tty

And these CI providers: https://circleci.com/gh/cypress-io/cypress-test-tty and https://travis-ci.org/cypress-io/cypress-test-tty

Because we pipe the output of `stdout` and `stderr` when spawning the electron process from the CLI - this causes `process.stdout.isTTY` and `tty.isatty(1)` to be `false`.

Although this is *technically* true, since we are the ones controlling the piped process, we really want it to be have as a correctly ""inherited"" child process - which would then cause the checks for `tty` to be `true`.

This is important as terminal packages like `chalk` or `mocha` depend on this to figure out whether they should output colors, and additionally how to write things like new lines, etc.

To fix this, we need to monkey patch the `isTTY` property and override `tty.isatty` to force these values to be true.",enhancement
284300765,Add Cypress option to clear browser cache before each test,"### Is this a Feature or Bug?
This is a Feature


### Current behavior:
I can't manage to force Cypress clear browser cache before each run

### Desired behavior:
I would like some option like:
```
./node_modules/.bin/cypress run --cache clean
```
so force browser to clean cache from previous run

",enhancement
283924926,Document TS for common methods better,"Cypress 1.4.0

I looked at the IntelliSense popups in the project https://github.com/cypress-io/cypress-example-todomvc and the results are not very useful. While they could be useful (there is some formatting that I had to adjust on `cy.type` example to get this to work) like for `cy.type`

<img width=""679"" alt=""cytype"" src=""https://user-images.githubusercontent.com/2212006/34263204-b322c288-e63c-11e7-971f-770349f70e34.png"">

Many other code popups were useless.

For example, `cy` itself needs to be documented

<img width=""509"" alt=""cyitself"" src=""https://user-images.githubusercontent.com/2212006/34263245-d1de58a4-e63c-11e7-800b-7efe521debf2.png"">

`cy.visit` is ok, but the example needs to be tweaked to be displayed properly. Here is what works

```
/**
 * Type into a DOM element.
 *
 * @see https://on.cypress.io/type
 * @example
 *
 *    // type ""Hello, World"" into the <input> element
 *    cy.get('input').type('Hello, World')
 */
type...
```
The example is indented without any other text

<img width=""687"" alt=""cyvisit"" src=""https://user-images.githubusercontent.com/2212006/34263289-ec29d6c0-e63c-11e7-9ce5-473ee89b2624.png"">

`cy.get` is scary

<img width=""697"" alt=""cyget"" src=""https://user-images.githubusercontent.com/2212006/34263360-36f0c92a-e63d-11e7-9350-a47b55d2e094.png"">

`cy.should('have.class'...)` and other assertions need documentation

<img width=""774"" alt=""cyshouldhaveclass"" src=""https://user-images.githubusercontent.com/2212006/34263389-5162a97c-e63d-11e7-89ce-8da02b9e3371.png"">
",enhancement
283685004,Add cypress.json schema to Schemastore,"- write json schema for file `cypress.json` and submit to https://github.com/SchemaStore/schemastore
- this will provide editors like VSCode, WebStorm, Atom (via https://atom.io/packages/autocomplete-json) with IntelliSense and validation when editing `cypress.json` file

Example: https://github.com/SchemaStore/schemastore/pull/287

<img width=""888"" alt=""screen shot 2017-12-20 at 12 01 03 pm"" src=""https://user-images.githubusercontent.com/2212006/34227085-f3c41376-e599-11e7-90ae-cbc4081a6399.png"">
 
<img width=""969"" alt=""intellisense-json"" src=""https://user-images.githubusercontent.com/2212006/34227106-073e7fcc-e59a-11e7-9959-45f434c9b233.png"">
",enhancement
283631485,Add schema file for cypress.json to scaffolded files,"VSCode and (probably) other editors allow specifying a separate schema file for JSON files. If such file is found, the editor will show intellisense help, provide default values, etc - really nice experience.

For example, the scaffolded `cypress.json` could have the following

```json
{
  ""$schema"": ""./cypress/cypress-schema.json""
}
```
And the new file `cypress/cypress-schema.json` could describe all configuration options we have https://docs.cypress.io/guides/references/configuration.html#Options

```json
{
  ""title"": ""JSON schema for https://cypress.io test runner cypress.json file. Details at https://on.cypress.io/configuration"",
  ""type"": ""object"",
  ""properties"": {
    ""baseUrl"" : {
      ""type"": ""string"",
      ""description"": ""Url used as prefix for cy.visit() or cy.request() command’s url. Example http://localhost:3030 or https://test.my-domain.com""
    },
    ""env"": {
      ""type"": ""object"",
      ""description"": ""Any values to be set as environment variables"",
      ""body"": {}
    },
    ""ignoreTestFiles"": {
      ""type"": ""string"",
      ""description"": ""A String or Array of glob patterns used to ignore test files that would otherwise be shown in your list of tests. Cypress uses minimatch with the options: {dot: true, matchBase: true}. We suggest using http://globtester.com to test what files would match.""
    },
    ""numTestsKeptInMemory"": {
      ""type"": ""number"",
      ""default"": 50,
      ""description"": ""The number of tests for which snapshots and command data are kept in memory. Reduce this number if you are experiencing high memory consumption in your browser during a test run.""
    }
 }
}
```
and many more. Here is how helpful it is in VSCode

<img width=""969"" alt=""intellisense-json"" src=""https://user-images.githubusercontent.com/2212006/34218868-6f3310ec-e57d-11e7-8e0d-de7fb7f7c9a8.png"">

when adding new option

<img width=""888"" alt=""screen shot 2017-12-20 at 12 01 03 pm"" src=""https://user-images.githubusercontent.com/2212006/34218927-9dfe661a-e57d-11e7-8d12-73112371af26.png"">

",enhancement
283331861,Search specs by name of file in Desktop-GUI,"### Is this a Feature or Bug?
Feature

### Current behavior:
Cannot filter list of specs or search specs by name

### Desired behavior:
To filter list of specs by name through searchbar.
",enhancement
283326980,Support Firefox browser ,"PR: https://github.com/cypress-io/cypress/pull/1359

- [x] Update `packages/launcher` to find Firefox, Firefox Dev Edition, and Firefox Nightly
- [x] Launch Firefox with profile + args (look at FirefoxDriver for reference)
- [x] Convert `packages/extension` to `packages/webextension` via [mozilla polyfill](https://github.com/mozilla/webextension-polyfill)
- [x] Add `server/lib/browsers/firefox.coffee` to implement opening the browser
- [x] Ensure all driver integration tests pass on firefox
- [x] Ensure all e2e tests pass on firefox
- [x] Ensure all CSS / visuals work as intended
- [x] Update our docker images to include firefox https://github.com/cypress-io/cypress-docker-images/issues/27
- [x] Make decisions on running e2e or integration tests on firefox in CI
- [x] Add browser-related property and methods to `Cypress`
- [x] Merge in `before:browser:launch` changes https://github.com/cypress-io/cypress/pull/6293",enhancement
283087247,Feature Request: fuzzing,"

Feature

Nothing that I saw in the documentation

Be able to call a line of code that enables random inputs whatever it is the test is testing




",enhancement
282249732,Add chai assertions in Typescript for autocomplete ,,enhancement
281173476,Setup feature flags / toggles,"## Development feature

Setup a way to implement features behind feature flags.

Probably add an object to `cypress.json` that would describe features (on/off) and value for ""on"" features.

```json
{
  ""experimentalFeatures"": {
    ""featureA"": false,
    ""featureB"": true,
    ""featureC"": ""fast""
  }
}
```
So `featureA` is turned off, `featureB` is on, and `featureC` is on with value ""fast""",enhancement
280730692,Update TS type definitions to match API more closely,"- Add mocha and chai (and sinon-chai and chai-jquery) types
- Add API methods that were missing (like `cy.clock')
- Fixed a few API methods that had pre 1.0 type definitions
- start type linting kitchenk sink spec file",enhancement
280335475,Accept timezone as configuration,"It remains to be seen if all browser respect this - but setting the `TZ` environment variable seems to make chrome change the timezone accordingly.

If this is the case we can accept this as a config value in `cypress.json` and automatically pass this in when spawning the browser.",enhancement
280301817,Add browsers command,"A new good feature to have: `cypress browsers` command that would show a list of detected browsers. Now similar information can be shown using

```
$ node node_modules/cypress/dist/Cypress.app/Contents/Resources/app/packages/launcher/index.js 
Launcher project exports
{ [Function: init]
  update: [Function: update],
  detect: [Function: detectBrowsers] }
⛔️ please use it as a module, not from CLI
detected 3 browsers
[ { name: 'chrome',
    displayName: 'Chrome',
    version: '62.0.3202.94',
    path: '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome',
    majorVersion: '62' },
  { name: 'chromium',
    displayName: 'Chromium',
    version: '60.0.3110.0',
    path: '/Applications/Chromium.app/Contents/MacOS/Chromium',
    majorVersion: '60' },
  { name: 'canary',
    displayName: 'Canary',
    version: '65.0.3287.0',
    path: '/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary',
    majorVersion: '65' } ]
```",enhancement
279972648,Figure out how to load site with Content-Security-Policy without stripping header,"## Feature proposal

Currently we strip ""content-security-policy"" when loading documents.

- allow rewriting this header in a plugin to only strip what is preventing Cypress from iframing the site

<img width=""783"" alt=""screen shot 2017-12-06 at 8 43 01 pm"" src=""https://user-images.githubusercontent.com/2212006/33694498-779962d4-dac6-11e7-9200-20a070b51852.png"">

By passing through CSP, and possibly tweaking it, we should be able to add security testing to Cypress. 
- is my CSP setup correctly?
- are my violations reported?
- can I load code / style / object from given domain or will it throw an error?

## Observation

- if we run content security policy with report-only mode, everything is working and no problems are reported when running the test itself (and any inline scripts are executed, but reported)

using [helmet](https://helmetjs.github.io/docs/csp/) to generate CSP, we can do nothing and just run in report mode.

```js
// basically do not allow inline scripts
app.use(
  helmet.contentSecurityPolicy({
    directives: {
      scriptSrc: [""'self'""],
      reportUri: '/report-violation'
    },
    reportOnly: true
  })
)
```

In the following page we catch two errors:

```html
<!DOCTYPE html>
<html lang=""en"">

<head>
  <title></title>
  <meta charset=""UTF-8"">
  <meta name=""viewport"" content=""width=device-width, initial-scale=1"">
</head>

<body>
  <p>a few scripts from files index.0.js etc</p>
  <script src=""index.0.js""></script>
  <script src=""index.1.js""></script>
  <script src=""index.2.js""></script>
  <p>an inline script with alert below</p>
  <script>alert('abc')</script>
</body>

</html>
```

1. the Cypress injection code `<head> <script type='text/javascript'> document.domain = 'localhost'; var Cypress = window.Cypress ...`
2. inline alert call

The server receives the following calls from the browser

```
Example app listening on port 3000!
CSP Violation:  { 'csp-report': 
   { 'document-uri': 'http://localhost:3000/',
     referrer: 'http://localhost:3000/__/',
     'violated-directive': 'script-src \'self\'',
     'effective-directive': 'script-src',
     'original-policy': 'script-src \'self\'; report-uri /report-violation',
     'blocked-uri': 'inline',
     'line-number': 4,
     'status-code': 200 } }
CSP Violation:  { 'csp-report': 
   { 'document-uri': 'http://localhost:3000/',
     referrer: 'http://localhost:3000/__/',
     'violated-directive': 'script-src \'self\'',
     'effective-directive': 'script-src',
     'original-policy': 'script-src \'self\'; report-uri /report-violation',
     'blocked-uri': 'inline',
     'line-number': 16,
     'status-code': 200 } }
```

Which leads me to conclude that we should inject our Cypress top level script from external url and not inline (where it might conflict)",enhancement
279087122,"Provide mechanism to skip binary download/install during ""npm install""","- Operating System: Win10 x64
- Cypress Version: 1.1.2
- Browser Version: Chrome 62

### Is this a Feature or Bug?
Feature

### Current behavior:
When running `npm install` with Cypress listed as a dependency, the binary is always downloaded, unzipped and installed.

### Desired behavior:
Provide a mechanism (most likely an environment variable such as `CYPRESS_SKIP_BINARY_INSTALL`) where the user can manually skip the binary install process.

### Impetus
We have a React project with Cypress tests that are run in our CI pipeline (currently Travis). We also have our project being built and deployed by a different service (currently Netlify). Cypress is not needed during the build/deploy process but is being installed anyway. This adds additional load and time to our build process.

### Test code:
In `/cli/test/lib/tasks/install_spec.js`:

```js
describe('skips install', function () {
  afterEach(function () {
    delete process.env.CYPRESS_SKIP_BINARY_INSTALL
  })

  it('when environment variable is set', function () {
    process.env.CYPRESS_SKIP_BINARY_INSTALL = true

    return install.start()
    .then(() => {
      expect(download.start).not.to.be.called

      snapshot(
        'skip installation',
        normalize(this.stdout.toString())
      )
    })
  })
})
```

### Additional Info (images, stack traces, etc)
Possible implementation at [cli/lib/tasks/install.js#L176](https://github.com/cypress-io/cypress/blob/master/cli/lib/tasks/install.js#L176):

```js
if (process.env.CYPRESS_SKIP_BINARY_INSTALL) {
  logger.log('Skipping binary install.')
  return Promise.resolve()
}
```
",enhancement
278250985,Make input value check user friendlier,"### Current Behavior 

When checking value of input box like this
```html
<input id=""foo"">
```
we have to use `have.value` which is hard to remember https://docs.cypress.io/guides/references/assertions.html#Value

```js
cy.get('#foo').type('something')
cy.get('#foo').should('have.value', 'something')
```

### Desired Behavior

It would be nice to also detect `input` or `textarea` and allow these assertions in this case

```js
cy.get('#foo').should('equal', 'something') // DOES NOT WORK NOW!
cy.get('#foo').should('contain', 'something') // DOES NOT WORK NOW!
```

Cypress 1.1.2
",enhancement
277828286,Proposal: Integrate Dashboard test results with outside services.,"**We'd like to have test results integrate with third party services like:**

- Zapier
- Slack (#578)
- ~GitHub (DONE)~
- Jira
- TestRail
- Gitlab
- Confluence
- Sentry
- Google Docs
- PagerDuty
- ??? *have a service you'd like? You can express interest and see progress for this feature on our Roadmap from our Dashboard's product board here: https://portal.productboard.com/cypress-io/1-cypress-dashboard (Look for the card with your desired integration or `Submit idea` if you don't see it)*


Our Dashboard Service knows when tests fail, it has details about a user's recorded CI run. When certain conditions are met, it can notify other integrated services and do things like:

- Send basic pass/fail stats
- Send Stdout (or link)
- Send Screenshots (or link)
- Send Video (or link)
- Analytics like...was this test failing before? the last time it passed?
- ??? *have data you'd like? comment below!*

The Dashboard should likely have a UI interface allowing the user to set what integrations they would like and what data they would like sent (on project? on organization?)

This proposal is a WIP currently, so we'd love to hear from the community on what you'd like to see.

**You can express interest and see progress for this feature on our Roadmap from our Dashboard's product board here: https://portal.productboard.com/cypress-io/1-cypress-dashboard (Look for the card with your desired integration or `Submit idea` if you don't see it)**",enhancement
277821310,"If running single spec, name output video file using spec name","## feature

If running a single spec with `--spec <filename>` instead of random video filename like `abc123.mp4` name the video file using the spec base name.

Should especially help when we isolate running each spec (parallel work)",enhancement
277582433,Partial route mock,"Is there a chance to partially mock a route? What I'm interested to achieve is something like this:
```js
cy.route({
    method: 'POST',
    url: 'api/myEndpoint',
    response: this.onResponse,
    onResponse: xhr => ({
        ...xhr,
        response: {
            ...xhr.response,
            body: {
                ...xhr.response.body,
                foo: 'bar'
            }
        }
    })
})
```
so that in regression mode, I'll still allow the real endpoint to flow, but instead of seeding my database per each test, I can alter the response to suit the need of my feature under test.

What I tried was
```js
cy.route({
    method: 'POST',
    url: 'api/myEndpoint',
    onResponse: xhr => xhr.response.body.foo = 'bar'
})
```
which alters the xhr response when I'm clicking on the route and view the Logger, but this doesn't get passed into the response to be consumed.

and
```js
cy.route({
    method: 'POST',
    url: 'api/myEndpoint',
    response: {},
    onResponse: function(xhr) { this.response = {
        ...xhr,
        response: {
            ...xhr.response,
            body: {
                ...xhr.response.body,
                foo: 'bar'
            }
        }
    }}
})
```
doesn't change the response at all.

I don't think any of the [function-approach examples](https://docs.cypress.io/api/commands/route.html#Function) are suitable for this kind of need.

Thank you!",enhancement
275995241,In-browser file download support,"## Current behavior:
In Electron, when an anchor is clicked that downloads a file from the server, a ""Save"" dialog is shown  thus preventing the rest of the test case from completing / succeeding. No dialog is shown in Chrome, at least currently, but this appears to be just because that's Chrome's default behaviour.

Furthermore, there is no way of specifying the desired location of file downloads.

### Desired behavior:

1. No ""Save"" dialog should be ever shown.
2. Not as crucial (i.e. with rather easy workaround in the CI), but we should be able to configure browser (both Chrome and Electron, and any browsers supported in the future) with the location where files should be downloaded. 

This should work both for files downloaded from the server (with `Content-Disposition` HTTP header), as well as for files downloaded using in-browser `Blob` + dynamically generated anchor approach.

### How to reproduce:

Given any site that contains an `<a href="""">...</a>` pointing to a file served with `Content-Disposition` header, use a test script similar to the one posted below:

#### Test code:

```js
describe('Lorem', function() {
  it('Ipsum', function() {
    cy.visit(""https://localhost"")
      .get(""a.download-link"").click()
      // This blocks in Electron because of the ""Save"" popup.
      .readFile(""/Users/kls/Downloads/file.txt"")
      .then(function() {
         // Do something with the file.
      });
  })
})
```

### Additional Info (images, stack traces, etc)

This functionality is needed in cases where it is not possible to verify validity of the download using [other methods suggested in the FAQ](https://docs.cypress.io/faq/questions/using-cypress-faq.html#Is-there-a-way-to-test-that-a-file-got-downloaded-I-want-to-test-that-a-button-click-triggers-a-download):

- When downloaded file is dynamically generated on the server based on a data that browser sends over to it, in case when this data is sensitive and cannot be sent over in the file URL. Imagine a file path such as `https://bank/transaction-history/34964483209802/pdf`, where `34964483209802` is a credit card number. This is unacceptable from the security / compliance perspective, because HTTP URL's are oftentimes logged in proxies or web servers. One solution is to send sensitive data over secure comms, i.e. WebSockets, just after user clicks the anchor. But this makes it impossible to just look at URL and issue `cy.request()`.
- When downloaded file is dynamically generated in the browser using a `Blob` + transient `<a>` with data URI technique, in which case no request is made to the server at all.",enhancement
275747573,max 1 site... support visiting multiple superdomains in one test," ```
""One thing you may notice though is that Cypress still enforces
visiting a single superdomain with cy.visit().
This is an artificial limitation (and one that can be removed).
You should open an issue and tell us what you’re trying to do!""
- https://docs.cypress.io/guides/guides/web-security.html#Disabling-Web-Security
```

```
I was trying to get a quick script to press an update button on 500 of our domains.
```

Maybe you could document a way for us to remove this limit without having to open an issue to have the core functioning of the app changed ? Maybe allow passing an argument when running the app.
",enhancement
275095960,"I am starting with Cypress but Not sure it supports Win64 or not?  I am using Win 10, 64bit with node v6.11.0 and npm 3.10.10","
`C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\utils.coffee:57
          throw new Error(""Platform: '"" + p + ""' is not supported."");
          ^

Error: Platform: 'win32' is not supported.
    at Object.getDefaultAppFolder (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\utils.coffee:37:15)
    at Object.getPathToExecutable (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\utils.coffee:18:16)
    at Object._fileExistsAtPath (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\utils.coffee:51:23)
    at Object.verifyCypress (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\utils.coffee:78:6)
    at C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\utils.coffee:167:8
    at Object.spawn (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\utils.coffee:191:7)
    at Open.open (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\commands\open.coffee:25:11)
    at new Open (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\commands\open.coffee:10:6)
    at Open (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\commands\open.coffee:8:14)
    at Command.<anonymous> (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\cli.coffee:98:7)
    at Command.listener (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\node_modules\commander\index.js:300:8)
    at emitTwo (events.js:106:13)
    at Command.emit (events.js:191:7)
    at Command.parseArgs (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\node_modules\commander\index.js:635:12)
    at Command.parse (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\node_modules\commander\index.js:457:21)
    at module.exports (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\lib\cli.coffee:135:11)
    at Object.<anonymous> (C:\Users\tvishnoi\AppData\Roaming\npm\node_modules\cypress-cli\bin\cypress:4:29)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.runMain (module.js:604:10)
    at run (bootstrap_node.js:389:7)
    at startup (bootstrap_node.js:149:9)
    at bootstrap_node.js:504:3`",enhancement
274742025,Be able to run a single test by interacting with it in the Browser,"### Current behavior:

When you want to run only one spec/context, you must supply `.only` in code

### Desired behavior:

Each test and context should have a deep link which would be interpreted by cypress as the ""only"". This way, code changes do not need to be made to demonstrate the running of many tests (as currently all tests cannot be run at once). This is how we have used similar test suites, like jasmine, to run a specific suite/spec in the browser without code modifications. ",enhancement
274184901,Proposal: CSS Selector helper,"Add a button to the runner/reporter that enters into a ""selector helper"" mode. In this mode, you can hover over parts of your app and the element underneath the cursor will be highlighted (like ""Select an element"" mode from the DevTools). 

Cypress will calculate the best selector to using for `get`ting that element. It will display the selector in a new UI panel overlaying the reporter and allowing refinements such as selecting by text via `cy.contains` or selecting via attribute. It will have a copy-to-clipboard button for easy copying.

Some prior art to research for the best way to implement:

* [CSS Selector for Chrome](https://github.com/jlawrence6809/CSS-Selector-Helper-for-Chrome)
* [Selector Gadget](https://github.com/cantino/selectorgadget)",enhancement
273808257,Fail tests that have unexpected API requests,"### Is this a Feature or Bug?
Feature

### Desired behavior:
I'd like a way to fail a test for any XHR calls that are not expected (ie. that no `cy.route()` has been set for). Current there's a `force404`, but that's not enough to be able to actually cause a test to fail

I had thought of using the `onResponse` option but it gets bypassed for the requests that `force404` handles.

```js
cy.server({
  force404: true,
  onResponse: xhr => {
    if (xhr.status === 404) {
      expect(true).to.equal(false);
    }
  }
});
```
",enhancement
273761434,Adding Authorization header to cy.visit(),"Hi,
I'd love to use Cypress for testing sites that use Bearer token authorization - every `.visit()` should automatically have a header added. I couldn't find a place where these additional headers could be added, except maybe in socket.coffee - would that be the right place?

Thanks for any pointers!",enhancement
272715876,Module API should accept reporterOptions like env and config,,enhancement
272691099,Retry proxied requests when network level errors occur,"Need to implement the same kind of retry logic as this lib:

https://github.com/FGRibreau/node-request-retry

['ECONNRESET', 'ENOTFOUND', 'ESOCKETTIMEDOUT', 'ETIMEDOUT', 'ECONNREFUSED', 'EHOSTUNREACH', 'EPIPE', 'EAI_AGAIN']

TODO: research `EPIPE` we may not be able to retry from that.",enhancement
272624532,Update Electron to v1.8.2 (Chromium 59/Node 8.2.1),,enhancement
272328233,Enabling opening Cypress installed locally in 'global' mode,"Use case is when you have multiple nested projects but a single shared `cypress`.

It's useful to spawn cypress open in global mode so you can pick either project.

```text
/my-project
  package.json
  /node_modules
    /cypress
  /nested-project1
    cypress.json
    /cypress
  /nested-project2
    cypress.json
    /cypress
```",enhancement
271099366,Enable users to change the scrolling strategy,"Users have expressed a desire to modify how Cypress internally scrolls elements.

Related to:

- https://github.com/cypress-io/cypress/issues/682
- https://github.com/cypress-io/cypress/issues/483
- https://github.com/cypress-io/cypress/issues/706
- https://github.com/cypress-io/cypress/issues/3623
- #2302
Currently we pin elements to the topmost coordinate after scrolling.

Users should be able to change this strategy to be one of:

- top
- bottom
- middle (don't scroll if already within screen)
- disable (turn off all automatic scrolling)

### future
~- [ ] By default, scroll element into center~
",enhancement
271042251,Add support for MTLS authentication,"### Is this a Feature or Bug?
Feature

### Current behavior:
No apparent way to support mutual (aka client) TLS authentication

### Desired behavior:
An apparent way to support mutual (aka client) TLS authentication

### How to reproduce:
Get a hold of a server that requires mtls (happy to provide if desired) and try to make requests to it. Here's the output when I try to hit mine:

```
CypressError: cy.visit() failed trying to load:

https://admin-pe-demo-09x-o-2.dev-b.symdev.us/ui/

The response we received from your web server was:

  > 400: Bad Request

This was considered a failure because the status code was not '2xx'.


      at Object.cypressErr (http://localhost:56974/__cypress/runner/cypress_runner.js:65861:11)
      at Object.throwErr (http://localhost:56974/__cypress/runner/cypress_runner.js:65826:18)
      at Object.throwErrByPath (http://localhost:56974/__cypress/runner/cypress_runner.js:65853:17)
      at http://localhost:56974/__cypress/runner/cypress_runner.js:57502:31
      at visitFailedByErr (http://localhost:56974/__cypress/runner/cypress_runner.js:57132:12)
      at http://localhost:56974/__cypress/runner/cypress_runner.js:57483:22
      at tryCatcher (http://localhost:56974/__cypress/runner/cypress_runner.js:6268:23)
      at Promise._settlePromiseFromHandler (http://localhost:56974/__cypress/runner/cypress_runner.js:4290:31)
      at Promise._settlePromise (http://localhost:56974/__cypress/runner/cypress_runner.js:4347:18)
      at Promise._settlePromise0 (http://localhost:56974/__cypress/runner/cypress_runner.js:4392:10)
      at Promise._settlePromises (http://localhost:56974/__cypress/runner/cypress_runner.js:4467:18)
      at Async._drainQueue (http://localhost:56974/__cypress/runner/cypress_runner.js:1200:16)
      at Async._drainQueues (http://localhost:56974/__cypress/runner/cypress_runner.js:1210:10)
      at Async.drainQueues (http://localhost:56974/__cypress/runner/cypress_runner.js:1084:14)
```

#### Test code:

```js
  it(""works with MTLS"", function() {
    cy.visit(""https://admin-pe-demo-09x-o-2.dev-b.symdev.us/ui/"");
    cy.title().should(""include"", ""Private Equity"");
  });
```

### Additional Info (images, stack traces, etc)

",enhancement
270016376,Send list of specs to the API when creating a build,"## feature

When test runner is sending data to the API (using `--record` option), it should send the list of spec filenames it found and expects to run.

Imagine a project with two spec files in the integration folder `a.js` and `b.js`. Then:

1.  default sends all specs

```
cypress run --record
```
sends 
```json
{
  ""specPattern"": ""all"",
  ""specs"": [""cypress/integration/a.js"", ""cypress/integration/b.js""]
}
```

2. `--spec <filename>`  sends single filename

```
cypress run --record --spec cypress/integration/b.js
```
```json
{
  ""specPattern"": ""cypress/integration/b.js"",
  ""specs"": [""cypress/integration/b.js""]
}
```

3. Wild card sends subset of tests matching the wildcard

```
cypress run --record --spec 'b*'
```
```json
{
  ""specPattern"": ""b*"",
  ""specs"": [""cypress/integration/b.js""]
}
```

For now, this is just for dashboard to know what to expect at the start of the test run.",enhancement
269784913,cy.drag() & cy.mouse proposal,"As mention in the #845 it would be interesting to have a broader API for drag'n drop and mouse movement.

### Desired behavior

It's very hard to reproduce drag'n drop using native browser events. It's much simpler to simulate how the mouse would behave. Here is a drag'n drop assertion done on nightwatch.js

```js
    let elementToMove = '//div[@class=""column""][2]'
    browser
      .url('http://grafikart.github.io/ReorderJS/index.html')
      .useXpath()
      .waitForElementVisible(elementToMove, 1000)
      .moveToElement(elementToMove, 10, 10)
      .mouseButtonDown(0)
      .moveToElement('//div[@class=""column""][1]', 10, 10)
      .mouseButtonUp(0)
```

The API behaves at a lower level where we can control how the mouse behave. It would be nice to have something to describe generic behaviours.

```js
cy.drag(selector: string, position: topLeft|center|topRight...., x: number, y: number)
cy.drag(selector: string, x: number, y: number)
// Maybe
cy.drag(fromSelector: string, toSelector: string) 

// Or a low level api to control the mouse
cy.mouse.moveTo(selector: string)
cy.mouse.press(button = 0)
cy.mouse.moveTo(selector: string)
cy.mouse.release()
```
",enhancement
269644903,NTLM Authentification,"Hi,

This is a question. I haven't been able to find an answer, so I'm trying here.

I wanted to test your product on our Sharepoint On-Promise, in our intranet. However I'm blocked on `cy.visit(""https://domain%5Clogin:password@www.intranet.com/site/"")` that returns a 401 error.

I tried both Chrome and Electron from the dropdown selection.

Any idea how I could have the authentication working? We use NTLM authentication for our Sharepoint.

Thanks",enhancement
269162053,Start Cypress server through the CLI in the monorepo,"## dev feature

When working inside this repo we can start the server (the Cypress app itself) without building the binary. This is great of course, no need to build Electron binary, which saves a LOT of time.

```
npm start
```
which calls `node scripts/start.js`
But this is different from the way it runs in user projects, where the execution goes through the CLI first (`cli/bin/cypress` script)

Thus small differences in parsing CLI arguments are hard to catch. For example, server had `--group` and `--group-id` support for a while, but CLI did not allow these options until #836 

## proposal

CLI should detect when it is inside the monorepo and there is no Cypress app in the `dist` subfolder. Then instead of spawning something like `dist/Cypress/Resources/Cypress.app` it should spawn `node scripts/start.js ...` from the CLI code, parsing the command line arguments the same way as a production app would do.",enhancement
269154475,Show CLI help when user passed unknown option,"## Feature

All versions of Cypress

When a user passes unknown CLI option we just die.

```
$(npm bin)/cypress open --foo

  error: unknown option `--foo'
```

First, the quotes are wrong around `--foo`, second we should display help message right away to show the right options for that command. Simple to do by replacing `commander` method

```js
commander.Command.prototype.unknownOption = function(flag) {
  if (this._allowUnknownOption) return;
  console.error();
  console.error(""  error: unknown option '%s'"", flag);
  console.error();
  this.outputHelp()
  process.exit(1);
};
```",enhancement
268946398,Add browser + version to stdout,"Users are confused we are launching Electron headlessly instead of Chrome.

We should print out the browser + version in stdout prior to the `(Tests Starting)` message, and then also include it in the `(Tests Finished)` message.",enhancement
268874221,Updates to 'set up project' dialog needed for future billing.,"There are a few things that need to be updated in the desktop-gui when billing is released in the Dashboard.

- Remove line ""Free while in beta, but will require a paid account in the future"" 
- If org selected is over their private projects limit (dependent on [cypress-api#249](https://github.com/cypress-io/cypress-api/issues/249)), display ""In order to make this project private, you need to [upgrade your account]()."" - link should go to `dashboard.cypress.io/organizations/:id/billing`. 
- Display banner within 'runs' tab when project's org is over it's recorded tests limit. This would require polling the GET org endpoint (which I don't think we are doing currently). ",enhancement
268838028,"Show absolute path of the project in the title bar when running Cypress in ""Global Mode""","### Is this a Feature or Bug?

Feature

### Current behavior:

Full/absolute path of the project is shown in the title bar when running in Local Mode but not in Global Mode.

### Desired behavior:

Show absolute path of the project in the title bar when running Cypress in ""Global Mode""

### Additional Info (images, stack traces, etc)

Local Mode:
![Local Mode](https://user-images.githubusercontent.com/51821/32066310-53a39a5a-ba4d-11e7-9449-533fc2fd2b28.png)

Global Mode:
![Global Mode](https://user-images.githubusercontent.com/51821/32066311-53aedcee-ba4d-11e7-9762-744e7a288708.png)",enhancement
268834721,Uncaught Exceptions should clearly indicate where they originated from,"Currently when an uncaught exception causes a test to fail we only print the error.

This is confusing because Cypress fails the test for any kind of reason

- maybe there was an error in the test code itself
- maybe a command failed
- maybe your application threw an uncaught exception

In the cases of uncaught exceptions originating from your application we should **CLEARLY** indicate that is from your application code.

Bonus points for also doing the same thing when test code is the culprit.",enhancement
268829374,Add Cypress utility methods for OS / Platform / Arch / Browser / Browser Version,"Something like this...

```js
// utility functions
Cypress.isPlatform()
Cypress.isBrowser()
Cypress.isArch()
Cypress.isBrowserVersion()

// constants
Cypress.arch
Cypress.platform
Cypress.browser
Cypress.browserVersion

Cypress.isWindows()
Cypress.isLinux()
Cypress.isMac()

if (Cypress.browser === ""chrome"") {

}

if (Cypress.isPlatform([""win32"", ""darwin""]) {

})

if (!Cypress.isBrowser(""firefox"") {

}
```

What about normalizing things like `chrome`, `chromium`, `canary` ?",enhancement
268547630,Add ability to point installed Cypress app at staging environment,"### feature

We have official ""production"" API but also we have cutting edge ""staging"" API. When using Cypress app installed as a dependency, the ""production"" is hardcoded in the `app/index.js` that Electron loads

```js
process.env.CYPRESS_ENV = 'production'
require('./packages/server')
```
We should only set this variable if it is not set already.
```js
if (!process.env.CYPRESS_ENV) {
  process.env.CYPRESS_ENV = 'production'
}
require('./packages/server')
```
This will allow us to test staging environment better and deploy API changes with confidence.

```
npm install
CYPRESS_ENV=staging $(npm bin)/cypress run
```

Note: check how `ts/register.js` decided when to load `ts-node` hook. Right now it assumes that in production we do not need TypeScript transpile. With above change we might need to transpile even in production and staging (when we develop locally and want to use remote API)",enhancement
268507401,Check downloaded binary file size,"When downloading binary, it might be corrupted / intercepted by a proxy. Sometimes even CDN has a hiccup like shown below from a test project run
```
Instead we will install version: https://cdn.cypress.io/beta/binary/1.0.3/win64/appveyor-develop-7b4c223233ca8eb6e147dc5e89b30a01061f6581-11678682/cypress.zip
Note: there is no guarantee these versions will work properly together.
Installing Cypress (version: https://cdn.cypress.io/beta/binary/1.0.3/win64/appveyor-develop-7b4c223233ca8eb6e147dc5e89b30a01061f6581-11678682/cypress.zip)
[?25l[18:21:09]  Downloading Cypress     [started]
[18:21:16]  Downloading Cypress     [completed]
[18:21:16]  Unzipping Cypress       [started]
[18:22:16]  Unzipping Cypress       [completed]
[18:22:16]  Finishing Installation  [started]
[18:22:16]  Finishing Installation  [completed]
[?25h
You can now open Cypress by running: node_modules\.bin\cypress open
https://on.cypress.io/installing-cypress
[?25h
> node-sass@4.5.3 postinstall C:\projects\cypress-test-example-repos\cypress-example-piechopper\node_modules\node-sass
> node scripts/build.js
Binary found at C:\projects\cypress-test-example-repos\cypress-example-piechopper\node_modules\node-sass\vendor\win32-ia32-57\binding.node
Testing binary
Binary is fine
npm ERR! path C:\projects\cypress-test-example-repos\cypress-example-piechopper\node_modules\fsevents\node_modules
npm ERR! code EPERM
npm ERR! errno -4048
npm ERR! syscall lstat
```

Need to validate downloaded zip file size. If it < 50 MB something went terribly wrong.",enhancement
268399737,Improve invoking native DOM methods,"### Current behavior:

Cypress makes invoking methods *on native DOM elements* less expressive than it could be.

My use case: I want to call an `<input>`'s `checkValidity` method. According to [the FAQ](https://docs.cypress.io/faq/questions/using-cypress-faq.html#How-do-I-get-the-native-DOM-reference-of-an-element-found-using-Cypress) I basically need to do this:

```javascript
cy.get('input')
  .should($input => {
    expect($input.get(0).checkValidity()).not.to.equal(false)
  })
```
This basically works, but Cypress' otherwise amazing expressivity takes a hard hit here since the logs naturally don't know anything about the invocation:

![image](https://user-images.githubusercontent.com/1922624/32000400-da787ef4-b996-11e7-9b79-45c087098bbc.png)

→ The assertion is shown, however the desired behaviour would be to also have the invocation listed in the log, as it does when running `.invoke()`.

### Desired behavior:
I'd like to advocate for a built-in way to invoke native DOM methods. Some quick thinking lead me to two possible solutions:

**The obvious one.** Provide an `.invokeNative()` method on the Cypress wrapper. However having two methods for basically the same thing may not be desirable.

**The embracing-jQuery one.** Extend the built-in jQuery copy with a `native` method that proxies native DOM calls. I've tried this myself, but you apparently have shielded the `Cypress.$.fn` away from curious developers. 🙃 

The implementation would basically be this:

```javascript
Cypress.$.fn.native = (method, ...args) => {
  return this.get(0)[method](...args)
}
```

which would allow to invoke native DOM functionality as easy as:

```javascript
cy.get('input')
  .invoke('native', 'checkValidity')
  .should('not.equal', false)
```

I'd love to hear your feedback on this.

- Operating System: macOS 10.12.6
- Cypress Version: Beta 1.0.2
- Browser Version: Chrome 61
",enhancement
268224103,Configurable framebuffer resolution and browser width,"### Current behavior:
Browser width is fixed.

### Desired behavior:
Browser width is configurable.

I'm running cypress in Docker and framebuffer resolution is fixed and browser size is fixed.

My ugly, temporary workaround

**Dockerfile**
```dockerfile
FROM cypress/base

ENV XRES 1920
ENV YRES 1200

RUN npm install --save-dev cypress
COPY ./node_modules/cypress/lib/exec/xvfb.js node_modules/cypress/lib/exec/xvfb.js
COPY ./node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/modes/headless.js node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/modes/headless.js
RUN $(npm bin)/cypress verify

CMD [""node_modules/.bin/cypress"", ""run"", ""--project"", ""/frontend""]
```

**node_modules/cypress/lib/exec/xvfb.js:13**
```javascript
var xvfb = process.env.XRES && process.env.YRES
  ? Promise.promisifyAll(new Xvfb({ silent: true, xvfb_args: ['-screen', '0', process.env.XRES + 'x' + process.env.YRES + 'x24'] }))
  : Promise.promisifyAll(new Xvfb({ silent: true }))
```

**node_modules/cypress/dist/Cypress/resources/app/packages/server/lib/modes/headless.js:118**
```javascript
width: process.env.XRES && +process.env.XRES - 6 || 1280, // 1914 is max for 1920
height: process.env.YRES && +process.env.YRES - 6 || 720, // 1194 is max for 1200
```


",enhancement
267807631,support multiple cy.route methods at once,"### Current behavior: 

currently, we need to specify routes separately:

```js
cy.route(""POST"", ""/folder"").as(""postFolder"");
cy.route(""PATCH"", ""/folder"").as(""patchFolder"");
...
```

### Desired behavior:

specify several methods at once for easier management

```js
cy.route([ ""POST"", ""PATCH"", ""DELETE"" ], ""/folder"").as(""folderModification"");

// so that later we can do

cy.get( selector ).click(); // POST
cy.wait(""@folderModification"");
cy.get( selector ).click(); // PATCH
cy.wait(""@folderModification"");
cy.get( selector ).click(); // DELETE
cy.wait(""@folderModification"");
```",enhancement
267706918,Provide ability to test @media print mode,"<!-- Want a bug fixed quickly? Please provide a repository to reproduce the issue. -->

### Is this a Feature or Bug?
Feature

### Current behavior:
Now it's not possible to test CSS rules that only work in `@media print` mode.

### Desired behavior:
Provide a way to have a page rendered in `@media print` mode, eg:

```js
cy.viewport('print');
```
Apparently there is a [chromium flag](https://peter.sh/experiments/chromium-command-line-switches/#enable-print-browser) for this.",enhancement
267505857,Ability to opt out of waiting for 'load' event before resolving cy.visit() - onload event takes too long to fire,"### Current behavior:
Cypress runs extremely slowly. Run time for 2 tiny tests is ~60-65 compared to similar Protractor test suite which takes ~20-25 seconds to complete the same tests. My timing for Cypress is based on the timer in the runner and my timing for Protractor is based on the timestamp in the console from when it starts and finishes.

### Desired behavior:
Significant improvement to run time.

### How to reproduce:
Using test code below.

#### Test code:

##### Cypress code:
(I would set timeout as 15000 just like my Protractor code, but it times out when I do that)
```js
describe('Attempt to log in', () => {
  beforeEach(() => {
    cy.visit('/')
  })

  it('without a username or password', () => {
    cy.get('button', {timeout: 30000})
      .contains('SIGN IN')
      .should('be.visible')
      .click()
    cy.get('#error')
      .should('have.text', 'Please enter your username')
  })

  it('without a password', () => {
    cy.get('#username', {timeout: 30000})
      .should('be.visible')
      .type('example_username1')
    cy.get('button')
      .contains('SIGN IN')
      .click()
    cy.get('#error')
      .should('have.text', 'Please enter your password')
  })
})
```

Comparable Protractor code:
```js
describe('Attempt to log in', () => {
    const EC = protractor.ExpectedConditions;

    beforeAll(() => {
        browser.get('/');
        browser.wait(EC.presenceOf($('#username')), 15000);
    });

    it('without a username or password', () => {
        element(by.buttonText('SIGN IN').click();
        expect($('#error').getText()).toBe('Please enter your username');
    });

    it('without a password', () => {
        $('#username').sendKeys('example_username1');
        element(by.buttonText('SIGN IN').click();
        expect($('#error').getText()).toBe('Please enter your password');
    });

    afterEach(() => {
        browser.executeScript('window.sessionStorage.clear();');
        browser.executeScript('window.localStorage.clear();');
        browser.refresh();
    });
});
```

Cypress is really great and powerful, but it's a shame that it takes so long to execute these tests.

- Operating System: Windows 7
- Cypress Version: Beta 1.0.2
- Browser Version: Version 61.0.3163.100 (Official Build) (64-bit)

",enhancement
267032392,Missing information about git branch in cypress dashboard runs for BuildKite,"### Current behavior:

Lack of information about the git branch in Cypress Dashboard runs

<img width=""873"" alt=""screen shot 2017-10-20 at 11 48 37 am"" src=""https://user-images.githubusercontent.com/829242/31800471-ddc59e1a-b58c-11e7-8f5c-3aaf514712c8.png"">

I couldn't find anything about that in the docs, issues and in configuration.

### Desired behavior:

See information from what git branch Cypress test runs comes from.

- Operating System: Linux Debian - 8.8
- Cypress Version: 1.0.2
- Browser Version: Electron 53.0.2785.143
- CI service: Buildkite

",enhancement
266728817,Proposal: add snapshot testing (this is not screenshot diffing),"Similar to Jest / Ava snapshot testing (see https://glebbahmutov.com/blog/snapshot-testing/ and https://glebbahmutov.com/blog/picking-snapshot-library/) it would be nice to save / compare values to snapshots.

For example this test can save the wrapped objects on the first run, then we would check in the generated `snapshots.js` file. Next time Cypress runs it would compare new values with saved snapshots and throw an error if they are different.

Here is a proof of concept

```js
describe('my tests', () => {
  it('works', () => {
    cy.log('first snapshot')
    cy.wrap({foo: 42}).snapshot()

    cy.log('second snapshot')
    cy.wrap({bar: 101}).snapshot()
  })
})
```
The test runner

![screen shot 2017-10-19 at 1 52 55 am](https://user-images.githubusercontent.com/2212006/31756219-d9a24b8e-b470-11e7-9260-dcdc64c43cc1.png)

When clicking on ""snapshot"" in the reporter, it shows the object in the dev tools

Similarly, if previous command yields a jQuery element, then it is converted into JSON and saved. For example, we could snapshot focused element before and after typing (TodoMVC example at todomvc.com/examples/react/)

```js
describe('focused input field', () => {
  it('is empty and then typed into', () => {
    cy.visit('http://todomvc.com/examples/react/')
    cy.focused()
      .snapshot('initial') // given human names as well
      .type('eat healthy breakfast')
      .snapshot('after typing')
  })
})
```
When clicking on the snapshot in this case, prints original element and JSON object

![screen shot 2017-10-19 at 1 53 07 am](https://user-images.githubusercontent.com/2212006/31756261-219ee852-b471-11e7-93d3-44a326d1db28.png)

The snapshots are all loaded at the start and saved together at the end. Here is snapshot file
```js
module.exports = {
  ""my tests"": {
    ""works"": {
      ""1"": {
        ""foo"": 42
      },
      ""2"": {
        ""bar"": 101
      }
    }
  },
  ""focused input field"": {
    ""is empty and then typed into"": {
      ""initial"": {
        ""tagName"": ""input"",
        ""attributes"": {
          ""class"": ""new-todo"",
          ""placeholder"": ""What needs to be done?"",
          ""value"": """"
        }
      },
      ""after typing"": {
        ""tagName"": ""input"",
        ""attributes"": {
          ""class"": ""new-todo"",
          ""placeholder"": ""What needs to be done?"",
          ""value"": ""eat healthy breakfast""
        }
      }
    }
  },
  ""__version"": ""1.0.2""
}
```

If a run time value during test does not match value loaded from snapshot, it throws an exception.
For example, changed code to `cy.wrap({foo: 45}).snapshot()` leads to

<img width=""449"" alt=""screen shot 2017-10-19 at 2 01 27 am"" src=""https://user-images.githubusercontent.com/2212006/31756325-76138f28-b471-11e7-9bec-2bfbaa2601a6.png"">


",enhancement
266435154,Collapse/expand specs in subfolders in UI,"<!-- Want a bug fixed quickly? Please provide a repository to reproduce the issue. -->

### Is this a Feature or Bug?
Feature

### Current behavior:
If you structured your tests in various subfolders, the Cypress UI reflects this with indented subheaders, but there's no way to collapse these blocks. In a large project, this can become cumbersome to work with.

### Desired behavior:
Make it possible to collapse (and expand) these subfolders one-by-one and/or all at once.",enhancement
266397912,Ability to select by index within `.select()` command,"#4239 

- Operating System: GNU/Linux Ubuntu 17.04
- Cypress Version:   ` ""_from"": ""cypress@^1.0.1"",  ""_id"": ""cypress@1.0.2"",`
- Browser Version: Google Chrome Version 61.0.3163.100 (Official Build) (64-bit)
# Current behavior:

![screenshot from 2017-10-18 10-02-19](https://user-images.githubusercontent.com/713283/31707092-8298a3a4-b3eb-11e7-9975-c3b5183c266f.png)


### Desired behavior:

I can select this option, via an index inside the argument option.

### How to reproduce:
```
<select id=""country"">
   <option label=""United States"" value=""object:44"" selected=""selected"">United States</option>
   <option label=""United Kingdom"" value=""object:45"">United Kingdom</option>
   <option label=""Switzerland"" value=""object:46"">Switzerland</option>
   <option label=""France"" value=""object:47"">France</option>
   <option label=""Germany"" value=""object:48"">Germany</option>
   <option label=""Canada"" value=""object:49"">Canada</option>
   <option disabled="""" label=""------------------"" value=""object:50"">------------------</option>
   <option label=""Estonia"" value=""object:117"">Estonia</option>
   <option label=""Ethiopia"" value=""object:118"">Ethiopia</option>
   <option label=""Falkland Islands (Malvinas)"" value=""object:119"">Falkland Islands (Malvinas)</option>
   <option label=""Faroe Islands"" value=""object:120"">Faroe Islands</option>
   <option label=""Fiji"" value=""object:121"">Fiji</option>
   <option label=""Finland"" value=""object:122"">Finland</option>
   <option label=""France"" value=""object:123"">France</option>
   <option label=""French Guiana"" value=""object:124"">French Guiana</option>
   <option label=""French Polynesia"" value=""object:125"">French Polynesia</option>
   <option label=""French Southern Territories"" value=""object:126"">French Southern Territories</option>
</select>
```

#### Test code:

```js
cy.get('#country').select('France');
```

### Additional Info (images, stack traces, etc)

I tried to create the patch myself (_it seems the error is here -> https://github.com/cypress-io/cypress/blob/0e0f75cfe90d24d9b0ed52b3c6a5a986baefcf8a/packages/driver/src/cy/commands/actions/select.coffee#L50_) but I cannot find the file inside node_modules :/

PS: Cypress is awesome :heart: ",enhancement
265106008,Make Cypress even faster: use MutationObserver for retry-ability,"Instead of (or in addition to?) using a setTimeout to retry the next assertion, a [MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver) on the page could trigger the next queued assertion. 

Relevant code (I think): [packages/driver/src/cy/retries.coffee](https://github.com/cypress-io/cypress/blob/develop/packages/driver/src/cy/retries.coffee)",enhancement
264980518,`cy.spread` doesn't work on selections,"

- Operating System: OSX Sierra
- Cypress Version: 1.0.1
- Browser Version: Chrome 61

### Is this a Feature or Bug?
Bug

### Current behavior:
`cy.spread` doesn't work when I pass a `cy.get` selection of multiple elements.

### How to reproduce:
Create a table to test:
```html
<table><thead><tr>
  <th>First</th>
  <th>Second</th>
  <th>Third</th>
</tr></thead></table>
```

Test:
```js
cy.get('table thead th').spread((first, second, third) => {
});
```

![image](https://user-images.githubusercontent.com/963136/31503725-b33365aa-af70-11e7-8b61-96252dda5e73.png)
",enhancement
264670160,Public Cypress onError method,"### Is this a Feature or Bug?

Feature

### Current behavior:

Cypress only detects errors that reach window.onerror

### Desired behavior:

Expose a public method on Cypress which allows you to throw errors into it.

Something like:
```
Cypress.onError(new Error(""This will cause the current test to fail""));
```",enhancement
264662606,Default headers for cy.request command,"### Current behavior:
There is no possibility to add default headers for the `cy.request` command. The only way to add such headers is to overwrite this command

### Desired behavior:
The possibility to set default headers (and maybe some other default options) for the `cy.request` command. 
For example, we use `SessionId` header for authenticated requests in our app. And I would like to implement custom login command for my tests, so it would set this header as default for all subsequent requests.


",enhancement
262415317,File watching does not execute actual code changes when site under test utilizes Service Workers.,"Related to #686.

It's possible the application under test ends up using Server Workers to inadvertently cache the files Cypress uses to serve spec files. This prevents changes to the spec files from ever being updated.

Prior to the beginning of **all** tests we should clear the Service Worker cache and then add a new cy command and add this to lifecycle rules `cy.clearServiceWorkerCache()`.

We could make this command print out all the cache keys it cleared.

## Workaround:

```js
before(function () {
  // run this once before all code
  return window.caches.keys().then(function(cacheNames) {
    return Promise.all(
      cacheNames.map(function(cacheName) {
        return window.caches.delete(cacheName);
      })
    );
  })
})
```",enhancement
262234443,Installing specific binary by using CYPRESS_BINARY_VERSION env variable,"We should be able to install specific version of the Cypress binary by specifying it in the `CYPRESS_BINARY_VERSION` environment variable

3 modes

## specify version

```
$ CYPRESS_BINARY_VERSION=0.20.0 npm i cypress@0.20.2
```
Should install NPM cypress version 0.20.2 but binary 0.20.0

## specify binary zip filename

```
$ CYPRESS_BINARY_VERSION=/some/path/cypress.zip npm i cypress
```
Should install latest cypress NPM package but grab the binary from existing file `/some/path/cypress.zip`

**note** in this case do NOT remove the existing file after unzipping

## specify url to the binary

```
$ CYPRESS_BINARY_VERSION=https://somewhere.com/foo/cypress.zip npm i cypress
```
Should install latest cypress NPM package but download the binary from the given url",enhancement
262194776,Serialize console.log/info/warn/error to stdout on CLI runs,"Currently there's no way to see browser messages in `stdout`. 

We can likely serialize the console.* method calls and send them to the node process.

Users would need a way to opt into this. Perhaps just another namespace DEBUG command like.

```bash
DEBUG=cypress:console:* cypress run
DEBUG=cypress:console:log cypress run
DEBUG=cypress:console:info cypress run
DEBUG=cypress:console:warn cypress run
DEBUG=cypress:console:error cypress run
```",enhancement
262193607,Setting DEBUG=cypress:* or DEBUG=cypress:driver should launch the Cypress GUI in this debug mode,"Currently users have to do two separate steps to see debugging output. 

1. They have to run this from the command line to get output in stdout
2. Then they also have to run a separate command in their browser console to see it there.

We should fuse this together and automatically launch the driver in debug mode if this flag was set.

https://docs.cypress.io/guides/guides/debugging.html#Using-the-DevTools",enhancement
261734944,Trim cy.exec output text,"<!-- Want a bug fixed quickly? Please provide a repository to reproduce the issue. -->

- Operating System: Mac / all
- Cypress Version: 0.20.1
- Browser Version: all

### Is this a Feature or Bug?

a **breaking feature**

### Current behavior:

`cy.exec('cmd')` returns an object with `stdout, stderr, code`. I always as a rule trim the `stdout` and `stderr` before comparing them to the expected values to avoid silly whitespace differences. Other tools like [execa](https://github.com/sindresorhus/execa) also trim `stdout` by default, removing extra new line. 

### Desired behavior:

Can we match `execa` behavior (and even switch to it for better cross platform support) and trim both `stdout` and `stderr` output by default?

",enhancement
261674444,Improve UI when el not actionable by distinctly displaying stale elements vs hidden elements,"The visibility algorithm correctly identifies detached elements as ""hidden"".

But when determining and providing the **reason** its hidden, we get an error message about the effective width and height being 0.

Since detached elements do not actually displace any content, this is technically correct, but miscommunicates the reason why.

We should provide a better error message in this circumstance and also add a new UI icon for detached elements (as opposed to just hidden).

Here's an example.

In this situation I've caused the element to be removed **after** the `cy.get()` but **during** the `.click()`

This test should correctly fail but the error message sends me down the wrong path.

![screen shot 2017-09-29 at 11 07 44 am](https://user-images.githubusercontent.com/1268976/31022430-c2995618-a506-11e7-8f9a-e47a3def9232.png)

Here's a suggestion where instead of displaying the **invisibility** icon, we add a new icon and tooltip to indicate that this element has become detached.

![screen shot 2017-09-29 at 11 11 19 am](https://user-images.githubusercontent.com/1268976/31022486-f0fbabb4-a506-11e7-81e9-7e1aec996a08.png)

",enhancement
260908171,Filter Runs tab on status,"We run a lot of tests and when we want to investigating a failing build, we have go to Older Runs to finnd the failing build.

I want to filter the Runs tab on failing/errored runs so that they will appear on top.",enhancement
260320363,Add plugin event for before launching browser,"Will allow updating flags sent to browser, with the following signature:

```js
register('on:before:browser:launch', (browserName, flags) => {
  return flags
})
```

The modified flags should be returned or resolved in a promise.",enhancement
260034227,Full Network Layer Stubbing / fetch support,"Pull Request (in progress): https://github.com/cypress-io/cypress/pull/4176

## What users want
* To be able to stub any kind of HTTP request including `window.fetch` 
  * note: temporary polyfill available https://github.com/cypress-io/cypress/issues/7710 [v4.9.0](https://on.cypress.io/changelog#4-9-0)
* To blacklist certain domains (google analytics, new relic, intercom)
* To have more control over dynamically routing / stubbing requests and responses
* To more easily stub graphQL calls

## What we do now
* We modify the host `XMLHttpRequest` object which limits us to only stubbing XHR's from the main application frame.

## What we need to do
* Throw away the entire existing system for stubbing
* Move stubbing into the internal Cypress network proxy layer (outside of the browser)
* Synchronize the state of the browser tests with the backend (so its aware what needs to be stubbed / routed)
* Remove `cy.server` and instead just use `cy.route`
* Expand the API's for more advanced configuration
* Accept `blacklistDomains` option for `cypress.json`
* As each request comes in, if we expose callback functions we'll need to constantly communicate with the driver for guidance on what to do - whether to proceed - halt, etc. This can get pretty complicated and might have significant performance issues. We'll need to experiment ~~and we may not be able to provide callback functions anymore.~~

## Things to consider
* `onRequest` and `onResponse` currently provide the raw level `xhr` object. This would no longer be possible. We'd have to serialize the request / response into basic objects. No method calling would be available.
* The `onError` callback could no longer exist
* Additionally we hook into the `onerror` events for XHR's and will automatically fail the test if this is called. This would no longer be possible.
* Blacklisting `https` cannot be dynamic. It would have to be set in `cypress.json` or environment variables. The reason is that for each blacklisted domain that goes over https, we would have to route that traffic to a self signed certificate. Browser freak out if traffic to https gets assigned one certificate, and then within the same session it gets another cert applied. What this means is that before spawning the browser we have to isolate that traffic and know ahead of time not to route it to the actual server. This enables us to send a single cert to the browser.
* We could enable non https hosts to be dynamically blacklisted, but these API's would be async and likely difficult for users to understand / use. We might be able to bake these into `cy.route` but I'm not sure there's much of a use case here of only dynamically blacklisting non https traffic.
* We will no longer be able to tell the difference between an `XHR` and any other kind of `http` request. We'd likely have to change the page events to say `REQ` and `REQ STUB` instead of `XHR` and `XHR STUB`.
* It would be very difficult to provide accurate `onResponse` callback functions. It's possible for the internal server to know when an HTTP request has been completed, but it's not possible to know whether the browser has actually finished processing it. This may or may not be a problem.
* How would we handle stubbing binary / streaming responses?
* How would we handle stubbing things like images? (This is likely pretty simple)

## Bonus Points
* It would likely be possible to stub Websocket traffic in the same manner
* The problem with this is that most Websocket libraries (ie socket.io) add their own ""encoding"" pattern on top of each websocket message frame. The ergonomics around stubbing this would be odd. The problem is this is library (and even version of library) specific. This may be a better use case for `cy.stub`, or perhaps a 3rd party extension

",enhancement
260033528,Create a Plugins / Extensions API,"## The idea behind this
As it stands - while users can create custom commands in the `driver`, we do not expose any real way to alter, modify or change Cypress's behavior **BEHIND** the driver (in the node server code).

Currently all we expose is a simple `cypress.json` to change the way Cypress works. This is heavily limiting.

What we need to do is expose a public interface so users can write `node` code to modify and alter the internals.

The use cases we're specifically trying to support are:

#### Custom Preprocessors
Swapping out the default `preprocessor` for custom ones. This is the thing that processes the spec files and ultimately serves them to the browser.

Customizing the preprocess would enable users to write `typescript`, `coffeescript 2.0`, `clojurescript`, use `webpack`, customize `babel` options, use newer `ES7` features, etc, etc. Big win.

#### Browser Configuration
Users would have access to the browser processes and launch configuration. This would enable them to change the flags used to launch browsers.

You could also use this to load in browser extensions.

#### Browser Finding
Changes / modifies the logic we use to find browsers on the system.

#### Custom Configuration
Having just a single `cypress.json` is limiting. Users have expressed a desire to have more programatic control over things like environment variables. 

#### Backend Messaging
While we currently expose `cy.exec` and `cy.request`, there is still a desire to message / talk directly to your backend.

Exposing this API would enable you to do things like call your application code directly to do things like setup / seed / create / update database records.

#### Screenshot Diffing
As we continue to expand the features of Cypress we would expand these API's to do things like letting you swap out the screenshot diffing algorithm.

## The Cypress Ecosystem
Going down this route will enable us to develop a Cypress Ecosystem consisting of official extensions (created by us) as well as user submitted extensions.

We'll also need to create an ""index"" of extensions that enable users to search, browse, and submit new extensions.

## Things to consider
- How will we / users handle versioning for plugins? We may need to set a `process.versions.cypress`
- How will we differentiate official plugins from regular ones? We could publish them under our `@cypress` npm namespace.
- How will we make modifying the **default** plugin that Cypress uses by default. Users may want to swap out entire implementations (like the preprocessor) or perhaps just modify the configuration for the default one.
- We should likely seed a commented out `cypress/plugins/index.js` with all of the API's that we support. 
- We should enable users to easily debug their `node` code by passing a flag to Cypress which spawns the internal chrome inspector.
- Users code will run in the builtin `node` environment that comes with Cypress.

## Examples of how we could do this

```js
// cypress/plugins/index.js

module.exports = ((register, config, utils, defaults) => {
  register('on:spec:file:preprocessor', (filePath, options) => {
    // do your own custom preprocessing on the spec
  })

  register('on:before:browser:launch', (browserName, flags) => {
    // do your own custom bits on launching the browser
    // such as loading in an extension or modifying the flags
    // used to launch the browser
  })

  register('on:find:all:browsers', (browsersFound) => {
    // add or modify the browsers we found
  })

  register('on:config', (config) => {
    // read in your own yaml files to change some
    // environment variables
    return fs.readFile(""./some/yaml"", ""utf8"")
    .then((str) => {
      const yaml = jsYaml.parse(str)

      config.env.yml = yaml

      return config
    })
  })

  register('on:driver:message', (msg, options) => {
    const db = require('./lib/db') // your db

    const request = require('request') // 3rd party request module

    // pass custom messages and do your own thing here loading
    // your own application files
    switch (msg) {
      case 'create:user':
        return db.seed(options)
      case 'reset:db':
        return db.reset()
      case 'make:request':
        return Promise.all(options.urls, request)
    }
  })
})
```",enhancement
259846726,Scrolling element in the viewport when clicking on step in reporter is too agressive,"Applies to all versions of Cypress

Imagine simple test with two steps:
- get parent element
- find child element

When we click on the second step in the reporter (on the left), it scrolls so aggressively, that it puts the top edge of the child element at the top of the viewport. Thus the parent element is now invisible. Think submit button and the form around it - I would like to still see the form when clicking on the submit button step.

Here is an example. First element is a demo div with some graphics and ""Next step"" button. At first I see the demo div and plan to click on the ""next step"" in the reporter

<img width=""1274"" alt=""screen shot 2017-09-22 at 10 53 47 am"" src=""https://user-images.githubusercontent.com/2212006/30750730-4660c1f2-9f85-11e7-8a9b-aed7b8e49925.png"">

The ""next step"" button element is *already visible*, but when I click on the reporter, it scrolls it way up, hiding the demo block it is inside of. And since the ""next step"" button changes the appearance of the demo block, I do not see right away how it changed it.

<img width=""1274"" alt=""screen shot 2017-09-22 at 10 53 57 am"" src=""https://user-images.githubusercontent.com/2212006/30751147-7fdb84f2-9f86-11e7-8d08-bf6f7d6879db.png"">

A better solution for scrolling would be
- if the element is already fully visible in the viewport when clicking do not scroll
- otherwise scroll
    - scrolling so that the element is in the middle of the viewport is best




",enhancement
259623204,"Proposal: enable spec globbing, enforce isolated renderer processes for each spec","## What users want
- To be able to run multiple specs files

## How we could do this
- Add glob support to `cypress run`
- `cypress run --spec cypress/integration/login/**/*`

Doesn't sound that hard, but there are many potential areas this will affect.

## What I'm proposing
- Enable multiple specs, but force each spec to run in its own isolated renderer process

## Why is this necessary?

### The default behavior is bad
As of today, we automatically ""merge"" and group multiple spec files by using a magical route called: `__all`.

This means that when you iterate on the spec itself: it's isolated because it's the only spec file served. But when you run them all together, they are no longer isolated. This can cause unforeseen issues to arise when running all the specs together which are difficult if not impossible to reproduce.

### Users don't use the Test Runner and the CLI as intended

We constantly see users running all their specs from the Test Runner. 

The Test Runner is not designed for this use case. It's designed to run a single or handful of specs at a time as you iterate and build your tests. The Test Runner is specialized for **debuggability** while the CLI is designed for running all of your tests. 

When the Test Runner runs, it's constantly creating snapshots, holding references in memory, etc. These quickly add up and your tests end up going slower and slower and oftentimes crash the entire renderer process. This is a design decision, not a bug. When running from the Test Runner it's specialized to enable users to interact with the tests' commands. Running from the Test Runner never ""ends"" or exits. 

This is much different than the CLI. Running from the CLI prevents you from interacting with anything. The CLI will run ""to completion"" and exit whereas the Test Runner never actually ends. Because of these differences, when running from the CLI, Cypress makes several internal performance optimizations to prevent memory exhaustion and to run as fast as possible.

### Watch mode is disabled automatically on 'All Tests'

Users expect ""Run All Tests"" to reload when you change a spec file. File watching is a CPU intensive task and because we've had users write hundreds of spec files, decided not to always do this. This goes back to the theory that you shouldn't be using this mode to run all your tests.

### Solving the Test Runner problem

One possible solution is to count the number of tests you're running in the Test Runner and automatically disable the built in debuggability features and to run the same way the CLI does. We'd need to show a warning message to the user indicating we're ""switching off"" these features and you won't be able to interact with any of the tests. 

This may be pretty annoying but at least it will communicate the intent of the Test Runner well. This option could be exposed via `cypress.json` such as `{ interactabilityThreshold: 5 }`. Users could then set this really high or disable it to get the old functionality back.

## The Downsides

### Running All the Tests

By enforcing specs to run in their own isolated process, we instantly have a huge problem for the Test Runner. 

For instance there is a:

- 'Run All Tests' button
- A seeded `example_spec` that contains **wayyyyy** too many tests and does not represent a normal use case.

This could be solved by removing the `Run All Tests` button but users would likely complain about this and it's unexpected. 

> Why can every other testing tool run all tests but Cypress can't?

The `example_spec` could be solved by splitting up the [kitchen sink tests](https://github.com/cypress-io/cypress-example-kitchensink) into a series of files:

- `querying_spec`
- `stubbing_spec`
- `network_spec`
- etc, etc, etc

Splitting up the `example_spec` into smaller files is an easy win: but then we're back to the problem above: ""How do I run all my tests?""

We could kick the can on this, and continue to let users run all of their tests from the Test Runner. Unfortunately, if we introduce a ""warning message"" this would continue to communicate confusing intent.

> Why is it warning me like I'm doing something wrong when all I've done is click the first button I've seen!

Another option is when running ""All Tests"" from the Test Runner we iterate and highlight each spec but then kill the process when switching to the new spec. This kind of defeats the purpose of the GUI as you would not be able to interact (and failures would instantly go away). Not a good option.

## The Upsides (why this would help all users)

Forcing each spec to run in its own isolated renderer would do a few very important things:

- It would prevent any global leakage from one spec to the next
- It would automatically restart the browser / renderer process in between each spec
- Memory would automatically be purged and we'd never have to worry about memory leaks
- The browser would likely crash much less often
- This positions users to better maintain and manage a growing suite of tests
- Introducing parallelization and load balancing becomes painlessly simple
- Users would overall see more consistent test results

### Parallelization

Forcing specs to run isolated is actually the same thing as performing parallelizations by spinning up multiple docker containers or instances and then dividing all of the spec files between them.

When this happens you still have all the same problems as what we listed above:

- You will need to stitch together multiple external reports
- You will receive multiple isolated videos
- You will receive multiple `stdout` text

Because users are already doing this (manually) it means they're overcoming these problems, or they aren't really problems to begin with - which is why I'm okay with making this the default behavior.

This problem is further mitigated by the way the Dashboard Service works. It can automatically associate groups of independent specs to the same run. This means all the data will be aggregated in the same place making it appear as if the run happened on a single machine.

### Load Balancing

Splitting up the specs enables us to easily load balance parallelization.

Instead of manually balancing by machine like this:

- Machine A gets Spec 1,2,3
- Machine B gets Spec 4,5
- Machine C gets Spec 6,7,8,9
- Machine D gets Spec 10,11

Each machine would run at the same time and simply ask ""for the next spec file"".

That means the work completes as fast as possible without needing to manually balance or tweak anything.

Load balancing is something our Dashboard Service is already doing on internal projects.

### Failure Isolation

Another benefit is that by splitting up the specs and taking multiple videos, you have a much easier time focusing on the real thing you care about - failures.

Instead of having a 30+min run, your videos would only be the duration of each spec file. Much better and easier to work with.

### More consistent results

Splitting out spec files will absolutely without a doubt yield better, more consistent results. Browsers aren't perfect and Cypress pushes them to their absolute limit. Garbage collection does not work in our favor - letting the browser decide when to GC oftentimes leads it to eating up huge chunks of ""primed"" memory and there is no way to force it to release.

We've been internally running in isolated specs (oftentimes thousands of specs across dozens of files) and it has removed nearly all flake. Previously this flake only cropped up when running all the specs at once and it was incredibly difficult to default and took a huge amount of effort.

### Better video names

Videos would no longer have a random name. Instead they could be named after the spec file: `cypress/videos/login_spec.js.mp4`

## New Challenges

The default `spec` reporter and the additional Cypress messages would run for as many N specs you have. Instead of receiving a single ""report"" Cypress would essentially iterate through each spec file and start the ""Tests Running"" message all the way through to ""Tests Finished"". Internally we'd keep state with the number of failures and still exit with the total aggregate. 

### External Reporters

This would unfortunately create a problem for external / 3rd party reporters. Instead of receiving a single report, it would generate a report for each spec file. While this sounds bad it's not that different than what already happens when you parallelize a run.",enhancement
259521779,Add timeout to verify command,"Currently, the `cypress verify` command can just hang because we do not put a timeout on a test run. It would be better to add a a timeout, and if the test really timed out, show the error output.",enhancement
259271746,Print reasons why Cypress considers an element 'visible' in errors.,"### Is this a Feature or Bug?
Feature

### Current behavior:
When I assert that an element `.should('not.be.visible')`, but Cypress finds that it is visible, it doesn't tell me why it considered the element visible.

**Error: why does Cypress think it's visible??**
![screen shot 2017-09-20 at 3 10 24 pm](https://user-images.githubusercontent.com/1271364/30662663-e069d9f8-9e15-11e7-9096-96bbf4b100c6.png)

### Desired behavior:
Cypress should explicitly print the reasons for why Cypress considers an element 'visible' when it fails `.should('not.be.visible')` assertion (just as it does for when it fails `.should('be.visible')`).

My specific use case had to do with an element on my page having a style of `{opacity: 0}`. So, to me, the element seems to not be visible and I expected a `.should('not.be.visible')` assertion to pass. 

After speaking with the Cypress team, the current behavior is **correct** however. Since the browser actually allows users to interact with elements that have `{opacity:0}` and Cypress uses this visibility algorithm to determine if elements are intractable, they do not intend to change this behavior.

The list of reasons for why Cypress considers something visible may have a specific message about opacity listed first?

### How to reproduce:
```js
cy.get('.el-with-opacity-zero').should('not.be.visible')
```

## Reasons why an element is considered visible
## Reasons why an element is considered not visible
* The element is partially covered by another element, so not _fully_ visible as in https://github.com/cypress-io/cypress/issues/3369
* The element has been detached from the DOM (is effective height/width of 0) https://github.com/cypress-io/cypress/issues/696#issue-261674444

",enhancement
259255211,Create webpack preprocessor,"Create a preprocessor that utilizes webpack, with watching feature and utilizing babel loader by default. This will make it easy for users already using webpack to customize it to their needs as well as serve as another example of how to write a preprocessor plugin.",enhancement
259254253,Add method for getting operating system,Add a utility method that returns the same thing or something similar to node's `os.platform()`.,enhancement
258857885,make cy.route onRequest and onResponse async,"### Current behavior:
`onRequest` and `onResponse` are synchronous so you cannot test inside them 

its really hard to test some situations, for example.

lets say that you have `call1` and `call2`. with the current scenario you would have to stub and then do the following:

```js
cy.wait('@call1').then(validate);
cy.wait('@call2').then(validate);
```

but if `call1` and `call2` happen close the same time, and `call2` request happens to resolve before `call1`, then the test above would fail since the `cy.wait('@call2');` would not be fulfilled. i guess then you could add a delay, but that would not be performant.

### Desired behavior:
run tests inside, so for example
```js
onResponse: (request) => cy.get('.someElement').should('contain', request.response.body);
```",enhancement
258478894,Cypress open does not accept --project flag,"<!-- Want a bug fixed quickly? Please provide a repository to reproduce the issue. -->

- Operating System: MacOs 0.12.6
- Cypress Version: 0.20.1
- Browser Version: electron 53

### Is this a Feature or Bug?
Bug, its in the documentation
the run command works corectly.

### Current behavior:
Opens cypress in root folder

### Desired behavior:
Opens cypress in specified folder

### How to reproduce:
run cypress open
move files created into /tests folder
cypress open --project ./tests

### Additional Info (images, stack traces, etc)

",enhancement
258256937,Accept --headed option when running headlessly in electron,"As it stands when running as `cypress run` and not specifying the browser, we'll run Electron headlessly.

There should be an option like `--headed` to cause Electron to run headed. This would match how you can run Electron headed while in GUI mode.",enhancement
258164074,GUI input for environment,"### Current behavior:

I have to spawn a process using Node and pass options as a command string.

### Desired behavior:

I want to be able to do `cypress.open()` with a config/env object, like I can with `cypress.run()`.

---

## Update

*I'm updating this issue to reflect my conversation with @brian-mann in the comments section.*

### Current behavior:

I have to restart the GUI every time I want to change the environment.

### Desired behavior:

I want an input for the environment within the GUI so I can modify environment variables without exiting and restarting.",enhancement
257471531,More comprehensive fix is needed for React 16 to fire change events,"Issue #536 hacked around the way React works to fire onChange events.

The problem is that this was specific to React and essentially was a quick workaround.

A more comprehensive approach is necessary.

React (and other frameworks) keep the value of an input in sync by overwriting the `value` sett on `HTMLInputElement`.

When Cypress sets this, it triggers the framework to ""think"" the value has changed and to process that change immediately.

The problem is that when using native events, the browser modifies the value under the hood without it touching the overridden `value` setter.

What we should do is detect when that property is not the default, and instead call underneath it to the original `value` setter so it does not trigger framework code and would work the same way as it does natively.",enhancement
257435545,When chainers are not found calculate Levenshtein distance for suggested: 'Did you mean',"```js
expect($el).to.have.clas('foo') // should error and suggest: Did you mean 'class' ?
```",enhancement
257136932,Pass config object to Cypress module API,"Cypress 0.20.0 should accept config object via module api

* https://on.cypress.io/module-api

Should be same as passing objects via command line switch cypress run --config pageLoadTimeout=100000,watchForFileChanges=false

```js
const cy = require('cypress')
cy.run({
  config: {
    pageLoadTimeout: 10000,
    watchForFileChanges: false
  }
})
```",enhancement
256735306,"Provide a ""Cypress"" way to access textContent (and/or innerText) - .text() command","### Desired behavior:
Add a `.text()` method similar to jQuery's text method to access textContent and/or innerText.

I guess for convenience, by default `cy.text()` should just return whatever `$(...).text()` returns.

It may also be good to provide a way to get the innerText of an HTMLElement as it returns a rendered text representation (removing sub-tags and whitespace that may be part of the node, but not visible once rendered). Perhaps a flag in the `.text()` method or via `.its('innerText')` or something.",enhancement
256425492,Show list of top failing tests in dashboard,"### Is this a Feature or Bug?
feature

### Current behavior:
Didn't find anything like that

### Desired behavior:
Add a list of failing tests ordered by number how often they are failing. 

### Additional Info (images, stack traces, etc)
The problem what we are trying to solve is that we have a lot of false-alerting tests and we would like to identify which tests are failing most often so we can prioritize which tests we need to fix.
Right now we just randomly report it to the author of the test if our CI fails too often with the same test. 
",enhancement
256074223,Improve error messages when a command requires a DOM but did not receive one,"The current message is pretty worthless. Doesn't say which command failed or what the subject was. When running headlessly you can't tell what happened.

![screen shot 2017-09-07 at 5 20 28 pm](https://user-images.githubusercontent.com/1268976/30185777-e553aa40-93f0-11e7-9f59-d618cb2ebaa6.png)
",enhancement
256071224,Improve error messaging when commands fail due to elements detaching from the DOM,"The current error does not provide enough context or go into enough detail.

![cy-method-failed-element-is-detached d7e8ae04](https://user-images.githubusercontent.com/1268976/30185397-38a6bffe-93ef-11e7-963c-bebb079059f5.png)
",enhancement
255749859,Rename Cypress.Log.command -> Cypress.log,"To make some of our interfaces more consistent we're renaming this.

```js
Cypress.Log.command(...) // => Cypress.log(...)
```",enhancement
255717765,Handle `alert` and `confirm` better,"As it stands Cypress's current behavior is to auto accept `alert` and `confirm`.

We should make the following changes:

## Alerts
- Alerts should at least log in the command log as a page event so you can visually see them 
- Alert command log events should capture the alerted value for debugging purposes
- We should expose an event which enables you to listen to alerts and receive their values

## Confirms
- Confirms should log in the command log as a page event so you can visually see them
- Confirms should auto accept by default, and save their values for debugging purposes
- However we should expose an event which enables you to listen for confirms and `return false`
- By returning false we will decline the confirmation as opposed to accept it.

You'll now see and have control over these events.",enhancement
255536678,Add `cypress init` command to seed / scaffold test files on current directory,"We no longer seed anything when running `cypress run` on a fresh project. 

Instead we now error: #618 

For that reason we should give users the ability to seed / scaffold out files from the command line instead of using the GUI.

Proposal add a `cypress init` command which does this.

Bonus points if we offer an `inquirer` view enabling the user to select what they want to. We could even explain what each one does.

",enhancement
254420460,Improve visibility algorithm,"Take into account the following scenarios:

* If an element is outside the bounds of an `overflow: hidden` ancestor (OA), but its offset parent is an ancestor of OA, the element is still visible
* If an element is position relative and outside the bounds of an `overflow: hidden` ancestor, the element is hidden
",enhancement
254119657,Update verbiage in Cypress application to display what commands 'yield' as opposed to 'return',"### Is this a Feature or Bug?
Feature

### Current behavior:
Cypress has been very careful to update the verbiage in it's documentation to specify what a command 'yields' (and very rarely 'returns'). [See the documentation on `cy.get()` for example.](https://on.cypress.io/get#Yields)

But, the Cypress app itself often uses the incorrect verbiage of 'returns' when the command actually 'yields'. For example, this is the current log to the console when clicking on a `cy.get()` command from the Command Log, notice the use of the word **Returned**:

<img width=""569"" alt=""screen shot 2017-08-30 at 4 03 37 pm"" src=""https://user-images.githubusercontent.com/1271364/29892535-e7b47904-8d9c-11e7-943f-e7991da9d8ac.png"">

### Desired behavior:
The app verbiage should accurately reflect the behavior of the command, whether it yields or returns.

",enhancement
254116617,Display element that is being covered in error msg when element is covered by another element.,"### Is this a Feature or Bug?
Feature

### Current behavior:
Whenever there is an error about an element not being interactable due to being covered by another element, this error displays: 

<img width=""508"" alt=""screen shot 2017-08-30 at 3 51 08 pm"" src=""https://user-images.githubusercontent.com/1271364/29892120-6482eefe-8d9b-11e7-9834-d26388d24b56.png"">


### Desired behavior:
It'd be nice to see the actual element that was attempted to be interacted with that is being covered (since the element being interacted with may *not* be the element you expect).

",enhancement
253113705,Reduce number of internal Cypress network requests,"## Current
Currently Cypress sends up to **18** network requests for internal traffic. This is obtrusive to users, mixes with their own traffic, and reduces performance.

All of these requests come from Cypress itself.

![screen shot 2017-08-26 at 2 17 54 pm](https://user-images.githubusercontent.com/1268976/29743991-858f64f4-8a69-11e7-83fe-ea7dadf47170.png)

## Proposal
- Consolidate as many requests as possible
- Namespace these so they are more clearly identified as internal cypress network requests.

",enhancement
252636442,Create and publish ESLint plugin for Cypress,"* Create and publish ESLint plugin with settings appropriate for Cypress
* Write documentation detailing how to use https://github.com/cypress-io/cypress-documentation/issues/107",enhancement
250748264,"if chaining .clear() with .type(), do not issue 'blur', 'click', etc to input in between","- Operating System: Mac
- Cypress Version: 0.19.4
- Browser Version: Chrome

### Is this a Feature or Bug?
Enhancement

### Current behavior:
If I write a test:

```js
cy.get('input').clear().type('Jane')
```

After the `.clear()`, Cypress blurs off the input, then attempts to click back onto the input at the beginning of the `type`. 

These events firing can cause some unexpected results when I'm essentially expecting the caret to clear the input and stay in the input to then type. 

### Desired behavior:

If `.clear()` is followed with `.type()`, keep the caret in the input and do not fire the events to blur the input after clear and click on the input at the start of type. 

",enhancement
249095160,Make the screenshot/video size configurable,Right now the resolution of the screenshots and the recorded video is fixed at 1280x720. This should be configurable,enhancement
249062320,Update/improve cy.type validation logic,"It appears fairly common that users need to type into an input that has an invalid *type* attribute (`type=""STRING""`, `type=""username""`), triggering the error `cy.type() can only be called on textarea or :text`. 

Here are two possible ways to improve the experience for this use case:

1. Allow validation to be bypassed with either `{ force: true}` or `{ validation: false }`. Also, improve the error message so it's clear what `:text` means and include details on how to bypass validation.

2. Instead of whitelisting input types, blacklist certain types instead (e.g. checkbox). This would provide a good error message if typing into something that's blacklisted, but allow users to type into inputs with types that aren't accounted for, just as a browser actually allows.",enhancement
247897574,Setting stubs/spies in before hooks and automatic restoring,"### Context

From Cypress docs:

> Automatic reset/restore between tests
> 
> cy.stub() creates stubs in a sandbox, so all stubs created are automatically reset/restored between tests without you having to explicitly reset/restore them.

How this relates to stubs/spies which were set in `before` hooks ? I would expect that stub/spy which was in `before` won't be reset/restored for each test within the context. This seems to currently happening actually, but is that intended ?

",enhancement
247809532,Extract browserify code / abstract build pipeline,Create an extension API for hooking into the pipeline when preprocessing spec files.,enhancement
246135221,Slack/Email Notifications,"### Is this a Feature or Bug?
Feature

### Desired behavior:
One of the most important things about automated testing is to know when a change actually caused the tests to fail. It would be nice if there was a out-of-the-box solution to send a message to slack notifying you of the failure. 

Taking it a step further it would be really nice to have a email sent to the git commiter that caused the breaking test.",enhancement
246102138,Environment based configurations,"### Is this a Feature or Bug?
Feature

### Current behavior:
Managing different environments for running cypress requires changes to code, to load different sets of variables.

### Desired behavior:
In the desktop app, and cli you can specify a specific configuration file to use for loading different configurations.

Ideally, you could create different environment based configurations via `cypress.qa.json` `cypress.dev.json` `cypress.prod.json` with your environment based configurations set there. Then tell cypress which environment variable file you wanna use.

For the desktop app this could be done with a selectable menu, or input.
For the cli this could be done with a command argument, such as `--config cypress.qa.json`

",enhancement
245441167,Don't fail visit calls on other than 2xx response codes,"### Is this a Feature or Bug?
Feature

### Current behavior:
When testing our error page the response code was 404 i.s.o. 200 and when using the `visit()` command this fails as it requires a 2xx response.

### Desired behavior:
Don't fail tests when a response code other then 2xx is fired upon visiting an url. Or make it explicit that you expect another code than 2xx. 

### How to reproduce:
Visit a 404/500 page to reproduce
",enhancement
244147151,Add `keystrokeDelay` configuration option,"Currently Cypress uses a `setTimeout` between keystrokes to mimic how a user would press each key.

## Concern 1:
We should enable this property to be globally configurable such as `keystrokeDelay`.

## Concern 2:
When set to `false` or `0`, instead of making each key press be async, we should make it synchronous. This would be helpful to not only type faster but could make things easier for 3rd party JS frameworks such as react.

Currently as it stands since keypresses as async - its indeterminate whether or not your JS framework has finished 'processing' all of the keystrokes. For instance it may fire its change events while typing vs after all characters have been typed. See issue #534 for more detail.

## Concern 3:
When typing very long sequences its often useful just to have it all ""type at once"" and not have to wait. Give developers the choice to decide.

## Recommendation
- set `keystrokeDelay` to `true` by default (which is the minimum `setImmediate` async between key presses)
- if `keystrokeDelay` is set to `false` or `0` typing all characters synchronously
- if `keystrokeDelay` is set to a number then use this as the `setTimeout` value

Passing the `delay` option to `cy.type()` will override anything globally set in config.
",enhancement
241771011,Assertion chaining should never change the subject,"Because Cypress follows the underlying rules of the assertion engine, we automatically follow subject changes in assertions.

This leads to extremely confusing behavior and causes you to have to rewrite assertions awkwardly.

When failures due to this happen they fail in deep chai / assertion code and so the stack traces are very confusing.

## Current Behavior
```js
cy
  .get('a')
  .should('have.prop', 'href', '/foo')
  .and('have.class', 'active') // fails because subject is now a string
```

## Proposed Behavior
```js
cy
  .get('a')
  .should('have.prop', 'href', '/foo')
  .and('have.class', 'active') // passes, subject is unchanged
```

When you do want to chain off of an existing subject you can simply use an assertion callback function and explicitly pass in the subject.

```js
cy.get('a').should(($a) => {
  expect($a).to.have.prop('href').and.match(/foo/) // continues to work naturally in chai
  expect($a).to.have.class('active')
})",enhancement
239586493,"make ""cypress help"" show same output as ""cypress --help""","""git help"" works
""npm help"" works
etc etc

I keep trying ""cypress help"" every now and then and it prints nothing.
It would be an easy cli ergonomics win to make ""cypress help"" output the same as ""cypress --help"".",enhancement
239525476,Improve reporter's responsive design so controls still show at narrower widths,,enhancement
238955487,Add organization name to invitation e-mail,"> < username > has requested to become a member of your Cypress.io organization.

I have multiple organisations. Please put the organization name in the e-mail template so I can see which organization the user want access to.",enhancement
237889076,Update Cypress CLI command interface,"Currently Cypress has two main commands `cypress open` and `cypress run`. Other testing tools (like `mocha`) have just one execution mode. For example, the command `mocha spec.js` runs the given spec file. Maybe it is time for us to rethink what the expected Cypress workflow should be.

I see the following:

1. User installs Cypress as dev dependency `npm i -D cypress`
2. User writes a spec file `spec.js`
3. User runs Cypress to execute this `spec.js` file with `cypress spec.js`.
   - this opens the Cypress GUI, runs the tests and if there are no errors, closes the GUI
   - if the user wants to run Cypress without GUI, need to use `cypress --headless spec.js`
   - on CI, the headless mode is assumed by default
4. If the user wants to bootstrap `cypress` folder, setup options, etc we need separate command 
`cypress --init`
5. We still have a command to open GUI without running tests `cypress open` just like today.

What do you think?",enhancement
234933716,"ensure up-to-date page state when finishes ""type"" command in react/redux apps","* Operating System: MacOS
* Cypress Version: 0.19.2
* Browser/Browser Version: Electron 53

### Are you requesting a feature or reporting a bug?

Requesting a feature. Please advice a better solution for the following case.

### Case Description:

*Context*

the page is built with react/redux

*Scenario*

Assume there's a form to update current user first name, it has a ""first name"" input box and a submit button.

```
cy
  .get('#first_name'))
    .type(""abcd"")
  .get('#submit')
    .click()
```

*Problem*

the first name received by server is **not stable**, sometimes it is ""abc"" and sometimes it can be ""abcd"".

*Root Cause Analysis*

In the above assumed redux app, an input box change will trigger an action to be dispatched, and be processed by the root reducer to create a new ""page state object"".
If user typing happens really fast, the following scenario can happen:

1. user types abcd, which creates 4 actions, with input value ""a"", ""ab"", ""abc"", ""abcd"" as payload respectively
2. at the time user click on 'submit', the first a few actions has been processed, but the last one action with input value ""abcd"" is still in the queue, so the ""page state object"" still has input value ""abc""
3. the callback of submit get ""current"" input value from ""page state object"", and find it to be ""abc""
ajax call with first name value ""abc"" is sent to the server

*Current Solution*

Current solution I have is to add an additional should assertion on the input box itself, which will ""wait until"" the input box actually renders the exact value we want, which is a signal that the ""page state object"" has already been updated:

```
cy
  .get('#first_name')
    .type('abcd')
    .should('have.value', 'abcd')  // use should to wait until input box actually shows the abcd value
  .get('submit')
    .click()
```

",enhancement
234834274,Provide an option to disable test files preprocessing.,"* Operating System: Mac
* Cypress Version: 0.19.2
* Browser/Browser Version: Chrome 58

### Are you requesting a feature or reporting a bug?
Feature.

### Current behavior:
Cypress preprocesses test JavaScript files (using Babel / Browserify). I'd like to use ClojureScript to write tests, which means using a compiler (based on Google Closure) to obtain a final test JS file. However, Google Closure produces JS files that expect `this` to be set when invoked outside of a function (in the global context). Current Cypress' preprocessing makes `this` `undefined`, which breaks code compiled using Google Closure. I don't know of any obvious workaround for this.

### Expected behavior:
To be able to disable test JS files preprocessing, so that I can use ClojureScript / Google Closure compiler.

### How to reproduce the current behavior:
1. Create a ClojureScript test namespace:

```
(ns st.general)

(js/describe ""General"" (fn []
  (js/it ""Page title"" (fn []
    (js/cy.visit ""http://localhost:80"")
    (.should (js/cy.title) ""equal"" ""Page Title"")))))
```
2. Compile it using ClojureScript compiler to `cypress/integration/test.js`

3. Run this test using Cypress. It will hang for a long time, and eventually produce an error that can be tracked down to `this` being unset.

#### Test code:
n/a

### Additional Info (images, notes, stack traces, etc)
[This has been briefly discussed on Gitter on June 9th around 1:30 PM UTC.](https://gitter.im/cypress-io/cypress?at=593aa365f2dd2dba06850eed)",enhancement
234559684,CLI flag --detached on `cypress open`,Instead of `cypress open` always opening a detached process we should change that to *not* open a detached process but accept a new flag `--detached` which will replicate the existing behavior.,enhancement
234559291,New CLI flag --browser,"Enable the user to spawn a specific browser when running from the command line.

`cypress run --browser chrome`

These videos will not be recoded and we should mention that.",enhancement
233985000,Have command text length (for ellipsis ...) be aware of width of Command Log,"* Cypress Version: 0.19.2
* Browser/Browser Version: Chrome

### Current behavior:

The command text is cutoff at a certain length regardless of width of Command Log

### Expected behavior:

If I expand the width of the Command Log, I expect the allowed length of command text to expand.

### How to reproduce the current behavior:

I can't see the entire request Url for each request in the screenshot below even though I've expanded my Command Log's width.

### Additional Info (images, notes, stack traces, etc)

![screen shot 2017-06-06 at 2 33 00 pm](https://user-images.githubusercontent.com/1271364/26845745-7e19a1c8-4ac5-11e7-97a0-67044e821c98.png)
",enhancement
233967238,.should() function usage - err when cy called within callback function,"* Cypress Version: 0.19.2

### Are you requesting a feature or reporting a bug?
Feature

### Current behavior:

When writing `cy` commands within a `.should()` callback function, the following error is given: [on.cypress.io/command-queue-ended-early](on.cypress.io/command-queue-ended-early)

### Expected behavior:

The docs specify that on `.should()` function usage: 

> Just be sure not to include any code that has side effects in your callback function.
> The callback function will be retried over and over again until no assertions within it throw.

Cypress should check if there are any `cy` commands within a `.should()` callback function and give a more specific error warning not to do this.

### How to reproduce the current behavior:

#### Test code:

```js
it('delete row', () => {
  cy.get('.row').should($els => {
    const could = $els.length;

    cy.get('.row:last .delete-btn').click();
    cy.get('.row').should('have.length', could - 1);
  });
});
```",enhancement
232916452,Allow Dynamic Stubbing and Responses,"### Current behavior:

Currently, all mocked responses need to know the response data upfront.

```js
cy
  .server()
  .route(""/users"", [{id: 1, name: ""Kyle""}])
```

The stubbed route can also include dynamic routes, but the response will always be static upon the route being initialized.

```js
cy
  .server()
  .route(/api\.server\.com, SingleFixture)
```

### Expected behavior:

1) The ability to setup fixture responses dynamically.  Perhaps using some sort of controller function.

```js
cy
  .server()
  .route(/api\.server\.com/, FixtureController)

function FixtureController(request, response) {
  if (request.url.contains('users') {
    response.body = [{id: 1, name: ""Pat""}]
    return request
  }

  if (request.url.contains('login') {
    response.body = { token: '123abc' }
    return request
}
```

2) The ability to match all routes, but conditionally allow some responses to be stubbed, and others to request real data.  In the above, perhaps if `response` wasn't set, the request would continue to the server.

#### Test code:

```js
function FixtureController(request, response) {
	if (request.url === 'api.server.com/users') {
		response.body = { hello: ""world"" }
		return response
	}
}
describe(`Dynamic Stubbing`, () => {

	beforeEach(() => {
		cy.server().route(/api\.server\.com/, FixtureController)
	})

	it('should stub a route dynamically', () => {
		cy.request('http://api.server.com/users').then(function(response) {
			expect(response.body).to.have.property(""hello"", ""world"")
		})
	})
})

```

* Operating System: OSX
* Cypress Version: 0.19.2
* Browser/Browser Version: Chrome Latest

",enhancement
232040878,Option to abort on first failure,"### Current behavior:

All tests are run even if one fails.

### Expected behavior:

Providing an option to abort the test suite as soon as a test fails.

### How to reproduce the current behavior:

Make a test fail.

### Environment

* Cypress Version: 0.19.2
",enhancement
231109514,launcher: improve browser detection,"Planned for [0.20.0](https://github.com/cypress-io/cypress/wiki/changelog)

Several issues consolidated:

## Linux

- [x] can we grab `google-chrome-stable` if available? https://github.com/cypress-io/cypress-core-launcher/issues/1
- [x] we should check if alias `/usr/local/bin/chrome` is valid  - this is where user could define an alias with additional command line flags

## Mac 

- [x] if spotlight is off, the Chrome detection fails https://github.com/cypress-io/cypress-core-launcher/issues/2
- [ ] add ability to pass path to the browser, rather than a name to detect",enhancement
230958058,Cypress.config() does not return the complete configuration,"<!--
Thanks for opening an issue!

- Your best chance of getting a bug looked at quickly is to provide a repository with a reproducible bug that can be cloned and run.
- If you need general advice, join our chat: https://gitter.im/cypress-io/cypress
-->

* Operating System: macOS Sierra
* Cypress Version: 0.19.2
* Browser/Browser Version: Chrome 58

### Are you requesting a feature or reporting a bug?
Possible bug

### Current behavior:
My cypress.json is

```js
{
  ""projectId"": ""myId"",
  ""watchForFileChanges"": false,
  ""fileServerFolder"": ""www"",
  ""viewportWidth"": 320,
  ""viewportHeight"": 568,
  ""numTestsKeptInMemory"": 5,
  ""trashAssetsBeforeHeadlessRuns"": false,
  ""videoRecording"": false,
  ""defaultCommandTimeout"": 30000,
  ""pageLoadTimeout"": 30000,
  ""fixturesFolder"": ""/Users/some-custom-folder""
}
```

but Cypress.config() returns:

```js
{
    ""isHeadless"": false,
    ""numTestsKeptInMemory"": 5,
    ""waitForAnimations"": true,
    ""animationDistanceThreshold"": 5,
    ""defaultCommandTimeout"": 30000,
    ""pageLoadTimeout"": 30000,
    ""requestTimeout"": 5000,
    ""responseTimeout"": 30000,
    ""xhrUrl"": ""__cypress/xhrs/"",
    ""baseUrl"": null,
    ""viewportWidth"": 320,
    ""viewportHeight"": 568,
    ""execTimeout"": 60000,
    ""screenshotOnHeadlessFailure"": true,
    ""namespace"": ""__cypress""
}
```
where some keys are missing (fixturesFolder, videoRecording...)
",enhancement
230650931,Feature request - API to get the listing of a directory,"* Operating System: macOS Sierra
* Cypress Version: 0.19.2
* Browser/Browser Version: Chrome 58

### Are you requesting a feature or reporting a bug?
Feature request

### Expected behavior:
It would be great to have a Cypress API to get the content of a directory, similar to fs.readdir, possibly with detailed information about the content of the directory (files or directories) so that multiple files can be loaded using cy.readFile().

",enhancement
229114672,Cypress auto-generated files should have trailing newlines,"## Current behavior:

Frequently (not sure if it's every file), when Cypress auto-generates a file for the user, the files do not include trailing newlines. This is an anti-pattern in general, [see this discussion](http://stackoverflow.com/questions/729692/why-should-text-files-end-with-a-newline), and an added nuisance when using `git`:

![image](https://cloud.githubusercontent.com/assets/17697/26119976/3b62a76e-3a3d-11e7-9b14-abad4a4f3b76.png)

and GitHub:

![pasted image at 2017_05_16 01_12 pm](https://cloud.githubusercontent.com/assets/17697/26120022/6710d78c-3a3d-11e7-86d5-92e9ed481b19.png)

## Expected behavior:

I expect Cypress to be aware of common idioms and not generate extra work for users.

### How to reproduce the current behavior:

Generate files and see what git says! Might be harder to see in CLI since git doesn't get a chance to complain for new files, normally the complaints happen in diffs. GitHub for Mac shows it clearly, though.

* Operating System: MacOS
* Cypress Version: 0.19.2

",enhancement
228769665,cy.click() should allow for more position arguments,"**Current Behavior**
Currently, `cy.click()` only accepts 5 position arguments: `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`.

**Expected Behavior**
Update `cy.click()` command to accept 9 position arguments: `topLeft`, `top`, `topRight`, `left`, `center`, `right`, `bottomLeft`, `bottom`, and `bottomRight`. This will match the behavior of the upcoming `cy.scrollTo()` command's position arguments - #497 ",enhancement
228768069,Add cy.scrollIntoView(),"Add `cy.scrollIntoView()` command to scroll the element found in the previous command into view.

Addresses #313 

Examples:
```js
// last ul will be scrolled into view (to top/leftmost corner)
cy.get(""ul"").last().scrollIntoView()

// last ul will be scrolled into view - 50px on top
cy.get(""ul"").last().scrollIntoView({offset: ""-50px""})

// last ul will be scrolled into view + 50px on top & 50px on bottom
cy.get(""ul"").last().scrollIntoView({offset: {top: ""50px"", left: ""50px"";}})

//  last ul will be scrolled into view over 200ms (default is 0 ms??)
cy.get(""ul"").last().scrollIntoView({duration: 200})

//  last ul will be scrolled to it's center (of it's height)
cy.get(""ul"").last().scrollIntoView({align: ""50%""})

//  last ul will be scrolled to it's very bottom
cy.get(""ul"").last().scrollIntoView({align: {top: ""100%"", left: ""100%""}})
```",enhancement
228767008,Add cy.scrollTo() command,"Add command `cy.scrollTo()` to allow scrolling to a specific position in the window or in the element found in the previous command. The DOM element or window must be in a ""scrollable"" state prior to the scroll happening. 

Addresses #313 

Valid positions are `topLeft`, `top`, `topRight`, `left`, `center`, `right`, `bottomLeft`, `bottom`, and `bottomRight`.

Examples:
```js
// window will scroll 250px to the right
cy.scrollTo(250)

// window will scroll 250px to the right
cy.scrollTo(""250px"")

// window will scroll to 50% of it's width
cy.scrollTo(""50%"")

// window will scroll to center of window's height and center of window's width
cy.scrollTo(""center"")

// scrollable el "".infinite-list"" will scroll 250px to the right
cy.get("".infinite-list"").scrollTo(""250px"")

// window will scroll 250px to the right and 50px down
cy.scrollTo(250, 50)

// window will scroll 250px to the right and 50px down
cy.scrollTo(""250px"", ""50px"")

// window will scroll down 60% of window's width and 60% of window's height
cy.scrollTo(""60%"", ""60%"")

// window will scroll down to window's bottom and rightmost point
cy.scrollTo(""bottomRight"")

// window will scroll 250px to the right over 200ms (default is 0 ms)
cy.scrollTo(""250px"", {duration: 200})

// window will scroll 250px to the right with swing easing animation
cy.scrollTo(""250px"", {easing: ""swing""})
```
",enhancement
227721684,Proposal: Visual Regression / Screenshot Diffing,"We probably will not do this as a built-in feature in Cypress just yet. Instead please consider using open source plugins or commercial systems that built on top of Cypress test runner. 

Here is our documentation guide: https://on.cypress.io/visual-testing

Find image diffing plugins in https://on.cypress.io/plugins#visual-testing",enhancement
227539714,cypress run --record should print the URL to the cypress.io dashboard,"### Are you requesting a feature or reporting a bug?

Feature request.

### Current behavior:

Running `cypress run --record ...` does not print the URL of the report it created in the cypress.io dashboard.

### Expected behavior:

Running `cypress run --record ...` should print the URL of the report it created in the cypress.io dashboard. (`https://dashboard.cypress.io/#/projects/.../run/....`)

### Additional Info

This feature would be very useful when working in large teams. Right now you have to check all recent reports until you find your own.",enhancement
224221135,[Feature Request] Support for Chrome in headless mode,"### Current behavior:

It is not possible to run tests in headless mode with browser extensions installed, because the only supported browser in headless mode is Electron, and Electron doesn't support extensions as stated in the documentation. 

### Expected behavior:

Either allow choosing another browser for running in headless mode or add support for third-party extensions in Electron browser.

###  Use case scenario:
My web project has several environments (development, beta, production) that share the same URLs and are distinguished by custom headers (say, `X-FooApp-Environment: Beta`).

To achieve this currently, we set the headers in an extension using headless Chrome and Selenium WebDriver.

* Operating System: Linux
* Cypress Version: 0.19.2



",enhancement
222776154,Improve clicking with modifier(s),"The current experience issuing a ctrl-click , cmd-click, etc could use some improvement. 

First, add a section to the `cy.click` doc concerning modifiers, with an example or two. 

Second, consider updating the `cy.click` command to accept modifiers directly instead of needing `cy.type` command first. 

Currently you need this to ctrl-click:

```javascript
cy.get('body').type('{ctrl}', { release: false })
cy.get('#some-el').click()
```

Something like this would be a lot better:

```javascript
cy.get('#some-el').click({ ctrlKey: true })
```

",enhancement
217118990,Handle global spec file errors which prevent tests from being parsed or run,"## Problem
Currently when there is a synchronous global error in a `spec` file - we will display the misleading message:

![screen shot 2017-03-26 at 10 10 30 pm](https://cloud.githubusercontent.com/assets/1268976/24338156/2c00c952-1271-11e7-8aba-d16fb4dfe276.png)

This can happen due to incorrectly calling methods, or anything else that busts JS during runtime.

The user then has to check their console for the specific error and then go debug it:

![screen shot 2017-03-26 at 10 10 40 pm](https://cloud.githubusercontent.com/assets/1268976/24338180/5324583c-1271-11e7-860b-acc1479d0724.png)

## Solution

It's possible for us to detect global errors in the spec code and provide a really great error message indicating this error happened in a spec file and not the remote application.",enhancement
216508095,Add file menu option to desktop app that opens app data directory,"![screen shot of desktop app with file menu open](https://cloud.githubusercontent.com/assets/1157043/24264873/0fb4d2ca-0fd8-11e7-81fb-a38b5b462bdc.png)
",enhancement
215828440,Create Cypress.Commands.overwrite API,"Instead of obliterating existing commands, there should be an easy way to overwrite existing ones in order to modify their logic.

Something like this...

```js
Cypress.Commands.overwrite(""visit"", function(orig, url, options){
  // modify url or options here...
  return orig(url, options)
})
```",enhancement
215821132,Create + document cy.subject() which synchronously returns current subject,"- [ ] Add `cy.subject`
- [ ] Document `cy.subject` to explain when you'd want to use this method https://github.com/cypress-io/cypress-documentation/issues/109",enhancement
215820915,Create + document formal API's around cy internal properties,"- [ ] Rename the internal `cy.prop` to `cy.state` and move store to a private property.
- [ ] Rename the internal `cy.private` to `cy.privateState` and move store to a private property.
- [ ] Throw a very specific error message when accessing the old properties directly (which was never supported or documented)
- [ ] Throwing on `cy.props` or `cy.privates` should tell the user to go through `cy.state(...)` or `cy.privateState(...)`
- [ ] Document `cy.state` and why you'd use it https://github.com/cypress-io/cypress-documentation/issues/108

",enhancement
215585980,Warn when a promise is returned from an `it` mocha test during an e2e / integration test,"Related to #435 and #463.

This is almost the same issue except:
- we will throw a slightly more explicit error message
- we will only throw if `cy` was ever invoked

Example:

```js
it(""should throw"", function(){
  // this should explode
  return new Promise((resolve, reject) => {
    cy.request(""/foo"").then(resolve)
  })
})

it(""does not throw"", function(){
  // if cy is not invoked then we're good to go
  return new Promise.delay(1000)
  .then(function(){
     // nothing wrong with this since
     // we never invoked cy
   })
})
```",enhancement
215583639,Throw when a value other than `cy` is returned from a test or command function,"During an `e2e` or `integration` test, we should throw a specific error message when:
  1.  a value is returned to a callback function
  2. in either a mocha `it` test or in a custom command 
  3. and a `cy` command was invoked.

We're going to opt for a stricter API up front contract instead of being magical behind the scenes and forcing return values unbeknownst to the developer.

The following situations should throw:

```js
Cypress.Commands.addParent(""foo"", function(){
  cy.get(""body"").should(""have.class"", ""foo"")

  return ""foobarbaz""
})

it(""should throw"", function(){
  cy.get(""body"").should(""have.class"", ""foo"")
   
  // currently Cypress detects this and forcibly
  // returns 'cy'. Instead we should throw.
  return ""foobarbaz""
})

it(""should also throw"", function(){
  cy.foo()
})

it(""does not throw"", function(){
  // this is okay since no cy commands were invoked!
  expect(true).to.be.true
})
```",enhancement
215002187,Ability to pass browser to headless cypress run,"### Are you requesting a feature or reporting a bug?
Feature

### Current behavior:
Currently, headless runs of Cypress invoked using `cypress run` always run on Electron. 

### Expected behavior:

I'd like the ability to pass a `--browser` option to the CLI's `cypress run`, specifying a locally installed browser by name to run Cypress within. Cypress could also optionally accept `--browser-path` where the path of the locally installed browser is passed in (so that if there are any logically issues w/ Cypress' behavior of finding a locally installed browser, this can be overridden until the issue is fixed.)

",enhancement
214489453,Add option to allow LocalStorage entries to persist between tests,Similar to the mechanism available to whitelist cookies so that these entries will not be cleared between test,enhancement
214238619,Add option to only upload videos if there is a failure,"Compressing and uploading videos takes a long time, and If the tests pass, the video is usually not interesting, so It would be good to have an option to only save, compress and upload the video if there was a test failure.",enhancement
214109082,Feature Request: Allow alias for record keys to aid in managing multiple keys,"Current use cases in mind include having reserved keys for CI and other automated tasks, while also having general use keys for teams to run/record/share for subsets of total tests.  Being able to provide an alias for each key would help keep them straight.",enhancement
213779215,Watch non-spec files for changes and reload specs,"Many of our users express the need to want to watch files on their system other than the `*spec` files that we normally watch.

Although we currently watch the `spec` file you're currently working in (and all of the subdependencies) many of our users express the need to watch other files (like their src files) for e2e/integration tests.

We should do one or both options:

a) give you the ability to specific additional glob paths via `cypress.json`
b) give you the ability to watch things yourself and signal to cypress when to reload

With our upcoming CLI refactor we could offer something like this...

```javascript
const chokidar = require('chokidar')
const cypress = require('cypress')

chokidar.watch(FILES)
.on('update', () => {
  cypress.reload()
})

cypress.open()
```",enhancement
213777076,"Provide a way to correlate multiple instances to a single ""run"" in the Dashboard","Our Dashboard supports the ability the have multiple instances associated to a single run.

This is useful when you are:

- Splitting up individual instances by spec file
- Running across multiple docker containers for parallelization
- Doing cross browser testing (in the future)

We need a way from the CLI and from the cypress `node_module` to make this possible. Some internal changes in the Desktop App have to be made, but it's fairly straightforward.",enhancement
213461781,Add electron as available browser for running tests,"This may help with debugging tests that only fail in CI, since it's the browser used in CI.

![browser dropdown screenshot](https://cloud.githubusercontent.com/assets/1157043/23814429/7a35bba4-05b1-11e7-8aa8-bc8fbce37acf.png)

![running electron browser screenshot](https://cloud.githubusercontent.com/assets/1157043/23814589/15917dcc-05b2-11e7-930d-6dd29715dd68.png)
",enhancement
213084423,Capture + Display all logs for everything that happens in Cypress,"### Problem
Many of our users express the desire to see `console.log` statements when running headlessly. Typically you'd be able to see these when you're working in Dev Tools (in headed GUI mode).

We can pretty easily display `console.log` statements by mixing them into `stdout` when running headlessly, but we don't think this is really a ""true"" solution. It's kind of a hack and it still doesn't really tell you ""everything"" that's happening. For instance, when a `console.log` happens, how would you know when it happened in relation to everything else that's going on in a test?

So, we think to **truly** solve this problem, we need a comprehensive way of displaying not just `console.log` statements but also capturing:

- Network Traffic
- Commands
- Retries
- Under the hood Cypress wizardry
- DOM snapshots on failure

By providing **all** of this, the entire picture of what happened during a test is revealed and now you actually have even **more** information at your disposal than even what the GUI headed version provides you.

### Solution
We're going to make these logs available both in our [Dashboard](https://on.cypress.io/dashboard), and in the Desktop App itself.

Once we capture and parse these logs, it will unlock an enormous amount of power in Cypress. We'll also be able to analyze the logs and deliver things like:

- Analytics into your tests
- Comparing a failing test to a previously passing one
- Diffing the logs for changes in response bodies, etc
- Understanding why tests are slow
- Discovering command anti patterns (like explicit waits in your code)

The logs could also be interactive - for instance they should ""sync"" up to the video and enable you to playback everything that actually happened in a Cypress test.

Here is an example comp of what we're going for.

<img width=""1349"" alt=""logs 1"" src=""https://cloud.githubusercontent.com/assets/1268976/23758542/2479a79c-04b8-11e7-87c7-7d3313bf5161.png"">

We're still working on communicating the `start` and `end` of logs, and also communicating that a log event acts as ""a stream"" but that events are connected to other events.

For instance when a HTTP request starts - that's a 'start' event. When the response comes back, thats a separate 'end' event. However these are connected and you likely need to be able to view the data for both events from either the `start` or `end` event.

Another example:

A command starts. It retries 65x times. It eventually finishes. The duration of the retry events, the reason its retrying, and the eventual delta between a `start` and an `end` needs to be communicated intelligently.

These log files end up being a massive amount of data, but we already have the infrastructure in place to capture, parse and deliver them. At this point we're just iterating on a UI that's intuitive and doesn't overwhelm the user.

We're going to be providing a new `Logs` tab, but also for individual test failures, we'll just be providing the logs for that one independent test.

### Feedback

...is welcome ;-)
",enhancement
212935140,Cypress should set a mocha slow threshold for more reasonable reporting,"I realize that this is something I can set, and that test speeds will probably be all over the map depending on what I'm testing, but I assume right now that cypress is using the default slow threshold which prints that red (123ms) after a ""slow"" test.  Right now our non-cypress users on our team look at CI and say, ""wow your tests are having some issues""

So I guess I'm wondering if there's a better threshold to set it to where it might provide meaning for the general case.. and if so, can that be the default in cypress?",enhancement
211483739,Add <datalist> support to cy.select,[`<datalist>` elements](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/datalist) are similar to `<select>` elements and it would be a natural extension of `cy.select()` to support them.,enhancement
211406706,Preserve position and size of desktop app,"It would be nice to store the screen position and size of the desktop app, so that when closing and opening it, it appears in the same place with the same size.",enhancement
211245118,Add blacklisting of requests made to specific hosts,"Would be nice to stop requests made to other domains than my own, for example scripts/css loaded from other CDNs.",enhancement
210052887,Add option to cy.visit() to complete on DOMContentLoaded instead of onLoad ,"I'm testing a site that has a lot of scripts loaded on it and even though the elements I want to test for are present quickly, the test has to wait for everything on the page to load.",enhancement
209187308,Ignore node_modules when watching files,"To potentially prevent issues such as https://github.com/cypress-io/cypress/issues/369, only watch the user's source files and ignore `node_modules` (and maybe other directories? https://github.com/novemberborn/ignore-by-default/blob/master/index.js).",enhancement
208699688,Improve tone of error messages,"<img width=""485"" alt=""screen shot 2017-02-18 at 11 57 19 pm"" src=""https://cloud.githubusercontent.com/assets/1500684/23100158/eea6848a-f636-11e6-9a9f-01435d138bb3.png"">

This error message feels a little passive aggressive. It seems to be placing blame on me, the developer (where it probably belongs), but I think that it could be worded in a more friendly/helpful tone. I've found that to be one of the things many developers love about tools they use. Where the communication style of the tool they're using is one of helpful friendliness, rather than assigning blame.

This is more of an ongoing thing than a single issue. Not sure when you can say this issue is ""closed"" :-/",enhancement
208243462,Cypress tests hang waiting on user to interact with download dialog,"Sorry if this is addressed in the documentation – I couldn't find anything on it. When I run a spec, programmatically clicking on a link that downloads a file triggers a download dialog. However, in order to make the test progress, I have to manually dismiss the dialog.

Is there an option that will close download dialogs automatically?",enhancement
207274940,Improve driver build process,"* Remove Bower
* Browserify
* Replace underscore with lodash
* Upgrade bluebird?
* Upgrade chai
* Use node EventEmitter
  - Change `trigger` to `emit`
  - Implement `emitThen` method",enhancement
206998975,Warn when using an old version of the CLI tools,"There are some breaking changes in the latest version of the CLI tools and even though Cypress will continue working on older versions we should yell about it.

",enhancement
206847248,Update error messages related to failing record keys,"Currently we have some pretty bad error messages when it comes to failures related to recording your runs.

We're going to update failures related to `keys` and `projectIds` to be much clearer.",enhancement
206774213,Allow `cy.visit` to work on 404 pages (option `failOnStatusCode`),"Right now I can't do any of the `cy.visit()`-enabled BDD on our HTTP 404 pages. I can test it crudely with:
```js
cy.request({url: '/abcde', failOnStatusCode: false})
  .its('body').should('.include', 'Oops, something went wrong!');
```
But I _(think I)_ can't do any clicking etc.

If `cy.visit()` options allowed for the `failOnStatusCode: bool` option, I could do something like:

```js
cy.visit('/abcde', {failOnStatusCode: false});
cy.get('#email').type('my@email.com');
cy.get('#submit').click();
cy.url().should('contain','/form-success');
```",enhancement
206032033,--spec flag should accept array of files or glob pattern,"Currently the `--spec` argument accepts only a single spec file to run, and this could be upgraded to accept an array of files and/or a glob pattern.

Related to #64 ",enhancement
205695696,Clear sessionStorage in between tests,"Currently we clear `cookies` and `localStorage` but somehow we missed automatically clearing `sessionStorage` as well.

This needs to be added, and we likely need to add a new `cy.clearSessionStorage` API command.

Thanks to @abadstubner for finding this one.

Currently as a workaround you can manually clear `sessionStorage` like this:

```javascript
cy.window().then((win) => {
  win.sessionStorage.clear()
})
```",enhancement
204699055,cy.clearCookies should clear *ALL* cookies of all domains,"After extensive R&D we've decided to deviate from the **Webdriver spec** and enhance clearing cookies to include all domains.

By default, Webdriver will only ever clear cookies based on the current domain context. So if you are visiting `http://localhost` and you issue HTTP requests to other domains (which set cookies) - those cookies will not be cleared.

We currently respect this spec, and our own cookie implementations also have this same restriction.

However, this is really just a limitation of Webdriver - and not necessarily something Cypress ever has to abide to. We've built Cypress with cross browser functionality in mind, and any time we deviate from the Webdriver spec, we are forced to ensure we can create compatibility across all other browsers.

Even though we don't support cross browsers *now*, it's a fundamental part of our strategy and we intend to support them down the road.

## What is the proposed change?
- `cy.clearCookies` will clear all cookies on all domains, irrespective of the current browsing context
- Between tests Cypress automatically clears cookies as well, and it will also clear all cookies across all domains.

## How will Cypress be able to consistently clear all cookies?
Cypress's architecture is completely different than that of Webdriver, which puts us in a unique situation to do lots of low level network tricks to pull this off.

While this is subject to change, the way this can be done is by inspecting all of the network traffic that goes through the browser (and therefore Cypress, as we already do), and for all domains, we can manually keep track of all the domains with cookies having been set on them.

At the end of the test, or on a `cy.clearCookies` command, we can then issue multiple HTTP requests out of the browser (through the Cypress driver) to these various endpoints.

Instead of allowing those requests to pass onto the remote server, Cypress will trap the requests, and automatically respond to the requests by issuing a `Set-Cookie` header for each cookie that needs to be cleared by setting the `Max-Age` or `Expires` directive.

The browser will then run its natural course and clear all of the cookies. This will be a bit slower than programatic API's, but will only have to be done when the browser does not expose any kind of automation API to achieve the same result programatically.

## Related issues
- https://github.com/cypress-io/cypress/issues/391",enhancement
204419368,Add cy.trigger(),"Create a `cy.trigger()` command that makes it easy to trigger an event on a dom element. This will help to simulate actions such as [drag-n-drop](https://github.com/cypress-io/cypress/issues/386), [hover](https://github.com/cypress-io/cypress/issues/10), and [input range interaction](https://github.com/cypress-io/cypress/issues/287). 

`cy.trigger()` will take care of setting coordinates and sensible default properties such as `cancelable` and `bubbles`, allowing those properties to be overridden by the caller if needed.",enhancement
204140921,Cypress version property in the browser,"It would be nice to have the current Cypress version property available inside the text, since we have so many releases. Something like read only `Cypress.version` equal to ""0.18.6"" for example would do",enhancement
203914003,Display the full scaffolded files tree,"Currently we only show the `example_spec.js` file, and since we scaffold 5 files in total, kinda makes sense to display them all.",enhancement
203913184,Validate all values in `cypress.json` for correct types,"Invalid values in `cypress.json` can cause all kinds of problems and lead to crashes.

We should validate `cypress.json` prior to running tests or booting the server, and display those for you nicely.

",enhancement
203506113,Check installed version on run,"We want to cache the installation **and** install the latest version when an older version is installed.
Currently the CLI doesn't check if there is already a version installed and if this is the latest.

Some suggestions to improve this behavior:
- On `cypress install` only download/install when the app is not installed
- On `cypress update` only download/install when the app is not installed or it is installed but it is not the latest version
- On `cypress update`/`install` and when a specific version is requested via CLI parameters or CYPRESS_VERSION environment variables, download/install that version if that version of the app is not installed.",enhancement
202931810,Cookies for third-party domains aren't cleared upon exit,"When I use `cy.request` to hit a 3rd party domain to login using oauth, the cookies for this domain remain after the session exists.  So when i re-run my test, it thinks I'm still logged in.  Would be nice to have all session data removed upon test exit of the browser.",enhancement
202826692,Ability to run spec files in a specific order,"How can I run all tests in a order without rename the files using a number to determine the order to execute?

There is a another way that can I run the tests in a custom order?

For now, I’m renaming the files using the prefix 1_xxx.js, 2_xxx.js",enhancement
202539640,Allow dynamically matching requests with a function,"To allow highly flexible matching of which requests you want to stub, we could add the option to accept a function instead of a fixed method/URL. This would recieve the request object (or some wrapper around it). The motivation is that I have and SPA that uses a GraphQL backend where all requests have the same URL and I want to filter them by the query name which is sent as a parameter in the POST body.

```js
cy.route({
  matcher: (request) => !! request.body.match(//)
})
```
",enhancement
201919448,"When baseUrl is set, validate that this server is first up and running via net.connect","One of the more annoying things about Cypress is that when you forget to start your webserver and try to run your tests - you will get a HUGE cascade of the same error repeating itself over again.

If `baseUrl` is set, we should validate that this server is accessible via `net.connect` and if not, prevent Cypress from opening.

This would guarantee you start the proper webserver(s) ahead of trying to run Cypress.

![screen shot 2017-01-19 at 12 07 12 pm](https://cloud.githubusercontent.com/assets/1268976/22116871/ddf8df02-de3f-11e6-8d74-415476f8d9e8.png)
",enhancement
201912674,"When baseUrl is set, spawn cypress directly to this domain","In every single spec file, when Cypress first opens, it will open on localhost + a random port.

When Cypress begins processing the first spec file it will almost always encounter a `cy.visit(...)` to a different host and/or port.

This causes Cypress to change to the new host + port which is an unnecessary waste of time.

If `baseUrl` is set in `cypress.json` we should immediately open Cypress to this superdomain. This would avoid the initial page reload.",enhancement
201379311,Expose Cypress Binary path via CLI,Useful for instance when a user needs to call the absolute path to Cypress.,enhancement
200640271,Improve sinon integration,"Currently, sinon.js integration is hidden behind the undocumented `cy.agents()` API. Deprecate/remove that API and add the following first-class methods:

* `cy.stub()`
* `cy.spy()`
* `cy.clock()`

These methods will be automatically sandboxed and reset between tests.",enhancement
199481326,Enable cy.route to set a fixtures encoding,"Currenly when you use the `fx:path_to_fixture` or `fixture:path_to_fixture` we automatically set encoding to `utf8`.

It would be ideal to be able to control the encoding.

Since we are kind of conflating the `cy.fixture` encoding signature, we'll just go with a `pathToFile,[encoding]` signature.

```javascript
cy.route({
  url: ""image.png"",
  response: ""fx:path/to/file,binary"" //<--- pass ,binary to signify binary encoding
  headers: {
    ""content-type"": ""binary/octet-stream"" // <-- TODO, we should automatically be setting these content-type headers when the encoding is manually specified
  }
})
```",enhancement
199480941,Enable cy.fixture to pass encoding for images,"Currently even though we accept `encoding` argument for `cy.fixture`, we hardcode in `base64` when the fixture references an image.

It's possible you may need to send the image as a different encoding type.

In other words this should work:

```javascript
cy.fixture(""my/image.png"", ""binary"")
```",enhancement
199383468,Enable turning off videoCompression,"On long runs (> 20min) and on CPU throttled instances (like on Circle/Travis) the video compression can take a long time, sometimes as slow as 50% of the overall test run.

So on a 20 minute run, an additional 8-9 minutes can be spent compressing the video.

Video compression reduces overall video size by about 50-500%, which is a tradeoff but one that users should likely make.

In our upcoming dashboard we could detect that videos were not compressed and recompress them (likely with a Lambda process).",enhancement
197762328,modify user-agent on each call,"Should be able to modify user-agent string on each request.
This would give us more flexibility to work on apps that are modified version of chrome.
",enhancement
196195648,cy.title should not query for <title> and instead use document.title,,enhancement
196160229,Recover from renderer / browser crashes,"Related to #348.

It is actually possible for Cypress to implement strategies when the renderer (or browser process) crashes during a test run - something like `recoverFromRendererCrashes: true` by default.

There is already a mechanism for Cypress to ""reload"" mid-run, rebuild the state of every previous run test, skip over previously run tests, and continue with the next one in line.

In fact this is exactly what `cy.visit` already does under the hood.

We can utilize this same process upon a renderer / browser process crashing to continue on with the run.

So it may look something like this:

```bash
(Running Tests)

✓ test 1 - foo
✓ test 2 - bar
✓ test 3 - baz

Oh noes the renderer process crashed... we will attempt to recover

...Restarting tests at 'test 4 - quux'

✓ test 4 - quux
✓ test 5 - ipsum
```

Taking this a step further, we are starting to see several patterns emerge with how and why renderer processes crash - it is almost always related to extremely long test runs in a memory starved environment (such as Docker).

It may even be a good idea for us to always preemptively ""break up"" headless runs by spec file. 

In other words, we could have an option like `restartBrowserBetweenSpecFiles: true` which would automatically kill the renderer / browser process before moving on to a different spec file (but still rebuild the state of the UI correctly, and still have a single contiguous video recording). 

To the user it would look like nothing is really different, but internally the renderer process would be killed and then restarted.

This would forcefully purge primed memory from the process, which could keep environments like `docker` from ever crashing to begin with.

Depends on: #6170
",enhancement
195572330,Cannot select and copy error message text from left UI column,"When there is an error, the left UI column shows a link to the docs, but I cannot select the link text.
Instead shows popup that the output has been printed to the console, but there is nothing in the console. It would be nice if I could just click on the link and open it

<img width=""427"" alt=""screen shot 2016-12-14 at 11 04 08 am"" src=""https://cloud.githubusercontent.com/assets/2212006/21189644/5bc99fbc-c1ed-11e6-8e15-26678dd93432.png"">
",enhancement
195340725,Add support for customizing babel configuration,"Add support for specifying babel presets and plugins, so users can override the default ones. 

Implementation notes:

Potentially auto-load a `.babelrc` in the project root. Keep in mind that a user could have an older version of babel installed for their project that isn't compatible with Cypress's version. 

Support having a `.babelrc` in the `cypress` directory that is preferred over one in the project root. Also, explore if there's a need/use case for specifying the preset/plugins in `cypress.json` under a `babel` namespace.

Write documentation detailing the current defaults and how to override them.",enhancement
195319090,Cy.log to print to the UI left column,"Sometimes it is hard to understand which part of the test is executing, especially if there are a lot of commands. It would be nice to include simple text messages in the left output column of the UI
Something like this

```js
cy.get(...)
cy.log('testing login')
cy.get(...)
```

Currently I print to the dev tools console using
```js
cy.then(() => console.log('something something')
```",enhancement
195156186,cy.request does not include the full raw headers on error / debug information,It is specifically missing the `host` property.,enhancement
195096094,when cy.request times out include more useful information in the error,,enhancement
194521586,When Cypress does not connect in CI it should exit with 1,"The exit should happen immediately after timing out waiting for the remote client / browser to connect.

![screen shot 2016-12-09 at 1 11 17 am](https://cloud.githubusercontent.com/assets/1268976/21039529/836cfef0-bdac-11e6-9349-3d6af2545860.png)
",enhancement
194167309,title() returns empty string,"Noticed in one of our basic tests a sudden error, seems > 0.17.5 (somewhere)
the `cy.title()` returning empty string. When replacing with document property started working again
```js
// used to be cy.title()
cy.document().its('title')
   .should('include', 'My App')
```",enhancement
193392032,cy.request should include more console log debugging information related to the underlying request(s) and response(s),"Currently we display the final `response` information from a `cy.request`.

This is problematic for the following reasons:

1. If `cy.request` was redirected, only the final `response` is sent
2. The actual underlying `request` headers / body is not accessible

To add parity with the Dev Tools Network tab, we need to go out of our way to display **all** of the response/response details.

This will include an array of request/responses for redirects, and provide the underlying request details per response.

The current console.log debugging output is:

![screen shot 2016-12-04 at 8 25 31 pm](https://cloud.githubusercontent.com/assets/1268976/20871121/ee6a5112-ba5f-11e6-8766-20d08917e837.png)
",enhancement
193391862,"cy.request improve errors, include the real headers, body, and redirects","When we display failures with `cy.request` they need to be better formatted like `cy.visit` errors, and we need to include more actual information in the error.

We should at the very least stringify the ""real"" request headers, and include information about redirects.

Also we need to use the error template of `cy.visit` for `cy.request` failures on underlying HTTP failures and for status code errors.
",enhancement
193376272,"cy.request clarify on status code failures, enable 3xx to be successful","Currently the `failOnStatus` property can be passed to `cy.request` to turn off failing based on a non `2xx` status code.

This needs to be upgraded to also not fail on `3xx` status code, and we should rename this property to be `failOnStatusCode` to clarify what this property does.

We'll keep the old property name backwards compatible for now and log a deprecation warning.",enhancement
193330513,cy.request should `followAllRedirects` to mimic actual browser behavior,"Currently `cy.request` will not follow redirects on a non-GET request which was redirected.

This behavior differs from the way a real browser would work, and it needs to automatically follow this redirect, and by default use the `GET` method for the redirects.",enhancement
193326540,cy.request should accept the `qs` option,There should be a `qs: { foo: 'bar'} ` convenience property for `cy.request` which will automatically convert an object of key/vals into the appropriate querystring for the url.,enhancement
193326028,cy.request remove the `cookie` option,"We always send all browser cookies on `cy.request` for the associated URL and it makes no sense to ever turn this off.

Also make sure to update the documentation for this.",enhancement
193323525,cy.request should accept `form: true` to send x-www-form-urlencoded content ,"There should be a `form: true` property for `cy.request` which will automatically set `x-www-form-urlencoded` headers and convert `body` into this format.

This will match what `HTML` forms do under the hood and allow you to use `cy.request` to log in when your backend API expects an HTML form.",enhancement
192683341,Handle dependency failures in Linux when attempting to run Cypress,"Related to #315 and #316 and #457.

There is a longstanding issue with Cypress and it failing to run when there are missing system dependencies in Linux.

The short answer is that the CLI tool automatically ignores `stderr` because Chromium is an unfathomably noisy process and there is no way to tell dependency errors apart from all the normal crap that is logged. This gives the appearance that Cypress just ""hangs"". It's not really hanging, in fact it could not run.

**Workaround**
To check to see if this is happening just invoke the Cypress binary directly after installing:

```bash
## install cypress
cypress install

## invoke binary directly
/home/YOUR_USER/.cypress/Cypress/Cypress
```

If there are dependency errors they will be immediately logged out to you. Just `sudo apt-get install` them.

**Actual Solution**
The solution for this is very do-able, and has been done by other types of applications in our same situation.

1. Whenever we detect that a ""new"" version of Cypress has been installed but has not been run the first time we attempt to launch the application.
2. While we do this, we capture `stderr` and if the output fails then we know the system is missing dependencies.
3. We then display the stored `stderr` which hopefully only displays dependency problems. Alternatively as long as we know what dependencies are required ahead of time for each OS we could list them all out or possibly even figure out whether the system has them installed ahead of time. We could also tell the user exactly what to do, like: `sudo apt-get install dep1 dep2 dep3`
4. Once the application runs on the ""new"" version, we cache this somewhere and don't do this check again (it is quite time consuming).",enhancement
192494056,Command for scrolling into the page,"Hi, thanks for cypress, it's a great tool.

For the moment I use the trick that when click on an element, the page will scroll. Not really the more natural thing. Is it possible to get something like cypress.scrollTo? 

It could be very useful to test parallax and other UX features",enhancement
191595709,Support for Native Browser Events,"### click

- [x] simulated click fixes #2956 
- [x] on text-editable click in center move the cursor to the end
  - [x] ensure possible in `IE11` without causing side effects
- [x] `cy.body().type()`:
  - `blur` focused element, send events to `body`
- [x] support `.rightClick()` :new: 

#### possible:
- [ ] move cursor to beginning if `click('left')` or `click('topleft')` :warning: 
#### not fixed:
- [ ] document.execCommand(""copy"") does not work in cypress #2851 (execCommand will not work with untrusted events)

### type
- [x] by default issues native events
- [x] `force:true` skips actionability and uses simulated keys
- [ ] simulated keys have no delay :warning: change from 50ms
- [x] native keys by default have no delay :warning: change from 50ms
- [x] support new special `.type()` sequences: `{moveToEnd}`,`{moveToStart}` :new:
- [x] support new special `.type()` sequences: `{tab}`,`{shift+tab}` :new:  
- [x] type follows focus :warning: 
- [x] trusted native keyboard events :new: 
  - checkValidity() returns true instead of false for min length on input #1930
<details markdown><summary><code>
{moveToEnd}/{moveToStart}</code></summary>

- IE: setSelectionRange on all inputs
- chrome/ff: setSelectionRange except for email/number inputs. For those we use `execCommand('selectAll') + selection.modify('...')`
- branch logic based on `browserFeatures` object. For ex)
```js
{
  setSelectionRangeOnAllInputTypes: true
}
```

</details>

### focus
- `.focus` behavior on certain text editable elements
  - [ ] command should first focusable element :warning: change from subject
  - [ ] focus host contenteditable #2717
### contenteditable
- treated as any other text-editable in the commands above. 
- By default move cursor to end
- [x] support `{moveToEnd}`/`{moveToStart}`
- [x] support `{tab}`

### file uploads :new: 
- proposal https://github.com/cypress-io/cypress/issues/170
- [ ] tbd

### cy.hover :new:
- proposal https://github.com/cypress-io/cypress/issues/10
- [ ] tbd

### scroll behavior
- [ ] scroll into view only if needed :warning: 
  - use getElementFromPoint on the pixel needing click
- [ ] scroll into center by default :warning: 
- [ ] allow user to configure scroll position (center, bottom, top) Enable users to change the scrolling strategy #871 :new: 
**For IE:**
  - scrollIntoView can't center, so calculate coords and try to center it manually


## Considerations / Research    
 
### select text command? :new: 
- allow user to make arbitrary text selection

### mouse state
- [ ] tbd

### ~for mouse actions that involve mouse state:~
- in open mode, warn if potentially affected test
- includes click (since hover before click), hover, drag-and-drop


For IE11 & firefox, see branch [issue-311-ie-ff](https://github.com/cypress-io/cypress/tree/issue-311-ie-ff)



",enhancement
191595673,Proposal: Support for Cross Browser Testing,"# UPDATES: February 7th, 2020

📦 We have added support for Firefox and MS Edge in **Cypress v4.0.0**.
- [📣 Read Announcement](https://www.cypress.io/blog/2020/02/06/introducing-firefox-and-edge-support-in-cypress-4-0/)
- [📘 Read Cross Browser Testing Guide](https://on.cypress.io/cross-browser-testing)
- [📋 Changelog](https://on.cypress.io/changelog#4-0-0)
- [🛠 Migration Guide](https://on.cypress.io/migration-guide#Migrating-to-Cypress-4-0)

# UPDATES: Oct 20th, 2018

I gave more updates on the work we've been doing for cross browser support and other features on a webinar we gave.

https://youtu.be/FfqD1ExUGlw?t=2079

# UPDATES: Sept 8th, 2018

Cross browser testing is now a front and center major focus here at Cypress. We've been experimenting over the last few months and have a working implementation to add native event support for Chrome, Firefox, Edge, and IE11. We also believe adding Mobile Safari and Android should also be straightforward - with Safari actually being the most difficult to get.

The architecture by which we are doing cross browser testing is a best-of-breed design where we tap into the native API's for Chrome and Firefox (avoiding the use of webdriver) and for Edge and IE11 we only use a minimal set of Webdriver API's - none of which are the traditional `sendKeys` or `value` endpoints, which avoids the network latency problem entirely. We plan to eventually publish this architecture so people understand how Cypress is different than Webdriver. None of the other core components of the Cypress architecture are affected by this change, it is simply how to enable native events in a consistent manner across all browsers without introducing the latency / flaky / non-determinism of Webdriver.

In additional to all these things, we are also adding Sauce Labs support (at a minimum) and will also have a proof of concept prepared for that.

As we add support for native events we are subsequently adding support for the browsers at the same time to ensure all of our algorithms are normalized correctly. However, you'll likely first see us release native event support in Chrome + Firefox, followed by IE11 sometime after that.	

...below is the original post from 2016...

## Does Cypress support cross browser testing?

Currently the answer is: **No**

Right now, we only support Chrome* variants such as `Chrome`, `Chromium`, and `Canary`.

## Will you ever support other browsers?

**Yes.**

We will be able to support other Desktop Browsers and Mobile Browsers (using Webviews).

We have built Cypress from day 1 with cross browser testing in mind, and are very conscientious to ensure the API's we write today will work in the future.

# The Technical Details

## Why do you only support Chrome today?

- Cypress taps into the underlying browser Automation API's of Chrome to do things like modify cookies, take screenshots, focusing the browser window, etc.
- We also launch the browser using very specific command line flags to turn off things that get in the way of automated testing.
- We have synchronized these Automation API's when Cypress runs headlessly (in Electron). This means running headlessly behaves identically to a real headed Chrome browser.

## What do you mean by ""Automation API's""?

- Automation API's describe the functions that a browser exposes to do things outside of the **Javascript Sandbox**.
- Currently Cypress comes with its own universal **Driver** which implements most of the `cy` commands using Javascript - in the same run loop as your application. This is superior in the sense that Cypress can understand, know, wait for and modify its behavior based on how your application reacts to its commands in real time.
- The downside is its impossible to fully automate a browser entirely in Javascript. Javascript is a security sandbox which restricts what you can do.
- To fully automate a browser you must extend beyond the sandbox and tap into the underlying Automation API's which do not have these restrictions.

## What will it take to support cross browsers?

- We have to port commands which need to extend outside of the sandbox to each other browser we are attempting to support.

## How will you port these Automation API's?

- Either manually by hand
- Or by using the existing browser drivers

## What do you mean by ""existing browser drivers""?

- Each browser has built its own driver to the [Webdriver Spec](https://www.w3.org/TR/webdriver/).
- Here are some examples of drivers:
- Google Chrome Driver (ChromeDriver)
- Micosoft Edge Driver
- SafariDriver
- Mozilla GeckoDriver (Firefox)
- Internet Explorer Driver
- Appium

## Why would you port these by hand?

- Because using the existing drivers comes with a host of problems.

## What's wrong with the existing browser drivers?

- They are built for and thus limited to the Webdriver spec.

## What is the Webdriver spec?

- It's a HTTP API spec which defines a common interface to drive all browsers consistently.
- It enables developers to abstract away the details of how each different browser implements its Automation API's

## What is the problem with Webdriver?

- It's slow
- It's async
- It's stateless
- It's exposed over an HTTP server
- It's a lowest common denominator
- It's limited in scope and features
- There are small inconsistencies
- There are various driver bugs

## What do you mean by ""lowest common denominator""?

- The spec is essentially limited to only including ""all the things that every browser can do"".
- This leaves a tremendous amount of *power* and capability off the table that more modern browsers provide.

## Can you give me some examples?

- In Webdriver you cannot clear all cookies for all domains - you can only clear cookies for the current domain context under test.
- There is no way to tell the browser to clear its cache.
- Chromedriver [cannot run tests with Dev Tools open](https://sites.google.com/a/chromium.org/chromedriver/help/devtools-window-keeps-closing).
- Oftentimes the drivers may [miss elements](https://sites.google.com/a/chromium.org/chromedriver/help/clicking-issues) you're trying to interact with.
- You cannot easily control the application under test.
- You don't have native access to `window`, you're limited to stringifying objects over the wire.

## Does Cypress currently use Webdriver?

- No. We wrote our own universal driver.

## What would be the benefit of using Webdriver?

- We could possibly use the existing drivers to port over various commands without having to write the manual integrations by hand.
- This would allow us to support cross browsers much faster.

## If you use Webdriver won't Cypress also inherit these limitations?

- In *most* cases - **no**.
- In *some* cases - **possibly**.

## How can you avoid these limitations?

- By using our universal driver to do as much automation as possible and only go outside of the browser for a limited set of commands.
- The whole point of Cypress is to exceed the boundaries of the current testing ecosystem.
- Because we automate the browser with a completely different architecture we are in a position to extend beyond the Webdriver Spec and also normalize its behavior consistently across all browsers.

## Can you give me an example of this?

- Cypress can [clear all cookies of all domains](../issues/408) instead of just the current domain under test.
- We perform work outside of the browser but then synchronize it seamlessly like with [cy.request](https://on.cypress.io/api/request).
- We have many commands which work outside of the browser which don't need to be ported.

## But won't you still be limited by Webdrivers flakiness?

- No. Even if we were to issue native events through Webdriver, because your application is always tested *through* Cypress, that means Cypress can respond synchronously to events that take place, and modify its behavior accordingly.
- The vast majority of commands do not ever have to leave the browser anyway.

## Can you give me an example of what you're talking about?

- Imagine this scenario: you have a modal opening which animates in, and you want to click the ""Submit"" button.
- In Webdriver, because its an HTTP API which often involves multiple network hops, there is usually a significant delay.
- Let's assume you're attempting to issue a native ""click"" to the submit button.
- When you issue the ""click"" command, the browser driver calculates the center coordinates of the button at say: `{clientX: 50, clientY: 100}`.
- It then issues the native click event with those coordinates.
- By the time your application ""receives"" this event, it could possibly ""miss"" the button altogether.
- Your test fails because your button was never clicked, and the modal was never dismissed.
- What happened?
- Because the modal was animating it, its coordinates were changing rapidly. Webdriver has no idea or concept of this, it only takes a coordinate snapshot at the moment in time and because it asynchronously dispatches the native event, it misses.

## Why isn't this a problem with Cypress?

- Because Cypress is in the same run loop as your application, its impossible for it to ""miss"".
- It can synchrously run calculations, and it already automatically figures out if an element is animating beyond a certain threshold - and therefore wait until it stops.
- If it did issue a native event, it could detect that this event has yet to happen, and if the element moved from the coordinate, immediately attempt to recover by either canceling the click event or issuing another click at new coordinates.

## When do you think you'll support other browsers?

- We really don't know, its not a priority for us right now.

## Why isn't it a priority? This is super important!

- We disagree, cross browser testing is **not as important** as you think it is.

...

### The reasoning and examples behind this are a WIP. We'll be updating this doc when they are ready.",enhancement
191113620,cy.request(): turning off automatic redirect,No description needed.,enhancement
191113450,cy.request(): allow cy.request not to fail under non 2xx/3xx status codes,I need to strip out a token from a request that returns HTTP 401. That is currently not possible.,enhancement
190890835,Improve headless run output,"1. when there is nothing to upload, indicate that instead of having a ""blank"" area.
2. output the Cypress Version in the final aggregation stats 
3. when processing long videos (30min+) its possible this may take a REALLY long time and can trigger the 10 minute no stdout output failure of both Travis + Circle. we should output a progress indicator every 10s so the user knows we're still working on it.
4. indicate the total duration of the processing time as a helpful reference for the overall duration of the CI build

![screen shot 2016-11-21 at 8 52 55 pm](https://cloud.githubusercontent.com/assets/1268976/20507999/806c1e12-b02c-11e6-80d6-2db2fc25ec6c.png)

![screen shot 2016-11-21 at 8 55 57 pm](https://cloud.githubusercontent.com/assets/1268976/20508059/eadfcdde-b02c-11e6-839f-a9981ffc151d.png)

![screen shot 2016-11-21 at 9 23 08 pm](https://cloud.githubusercontent.com/assets/1268976/20508607/b8fd1ae8-b030-11e6-96da-9a1a145695c4.png)
",enhancement
190882826,Updating from version < 0.17.11 should not require logging in again,This is due to an internal API change and we need to manually migrate existing user data to the new spec.,enhancement
190584112,Print browser console information to Command Log (console.log/info/warn/error),Is it possible to get output from the console? Especially warnings and errors. We are using it as a very simple and quick check that the commit didn't introduce any runtime error.,enhancement
189951728,Need tab support,"**Description**
As mentioned here https://docs.cypress.io/v1.0/docs/type#section-typing-tab-key-does-not-work. For accessibility testing I need to be able to tell the keyboard to press tab. If `cy.tab` is not currently supported is there some way to work around this?

",enhancement
189790455,Add support for testing chrome extensions,"**Description**
*Add support for testing chrome extensions.*

**Code**
`cy.visit('chrome-extension://ojdhgjfbbonanlpdejcbmiledkcedbdo/popup.html');`

**Additional Info**
Right now, it doesn't navigate to url and throws error with message:
'Sorry, we could not load: chrome-extension://ojdhgjfbbonanlpdejcbmiledkcedbdo/popup.html' 

Since you get questions about testing chrome extensions, maybe include more verbose error message or info that you don't support that yet.
",enhancement
189762728,Screenshot names should include the full test title including parents,"Currently when a `cy.screenshot` is used (or during a failure when running headlessly) we name the file off of the current runnable's title.

This means there is a high chance for collision, and looking at the title by itself there is no easy way to see what parent it was nested under.

**Fixes**
- Include the full test title (including parents).
- Separate parent / test with ` -- `
- Scrub invalid file system characters",enhancement
189450443,No longer artificially restrict running on an 'valid' CI environment,"`cypress ci` currently artificially checks for a valid CI environment prior to running. 

This needs to be removed.",enhancement
189443966,Running headlessly should never scaffold / seed the project,"We should never generate the example kitchen sink `app_spec.js` file, nor generate `support` or `fixtures` folders when running headlessly.",enhancement
189443701,'cypress run' should not prompt the user to add the project,"To complement the new `cypress ci` functionality we need to give users a way to opt out of asset uploading.

To make this happen we need to prevent `cypress run` from prompting the user (thus making running in CI impossible).

Since adding the project only updates local Cypress app data cache there is no reason not to automatically do this.",enhancement
189359292,Files with syntax errors are ignored,"`cypress run` ignores files with syntax errors and the tests pass without any indication of a problem. The tests should fail instead.

Also when you run tests on a single file with syntax errors `cypress run --spec file.js`, cypress just displays the message ""Tests should begin momentarily..."" and hangs.

```
$ cypress version
Cypress CLI: 0.12.0
Cypress App: 0.17.10
```",enhancement
189167648,'cypress ci' should upload all build assets,,enhancement
188390763,Write permissions required on `resources/app/node_modules/@cypress/core-extension/dist/background.js`,"It seems a bit odd to me that Cypress would always rewrite the port in `HOST` (l14) when I open a project. That means I have to allow a regular user to write to that file if I want to install it globally. I came across this when creating a package for AUR: https://aur.archlinux.org/packages/cypress

This is the package build file:
https://aur.archlinux.org/cgit/aur.git/tree/PKGBUILD?h=cypress#n23",enhancement
188095171,Supporting form parameters in request(),"I need to post a request where the body is sent as urlencoded form parameters. Either add support to cy.request to automatically convert body into form serializeable properties - or support a ""form: true"" option.",enhancement
187839057,Input range interaction,Support interactions with input ranges - i.e. setting a value and firing the appropriate events.,enhancement
187160092,Remove magic support folder script handling,"* Remove cypress.json `supportFolder` option
* Add `supportScripts` cypress.json option
  - Creates separate script bundle(s) that is/are included before the spec file bundle
  - Can be a string or an array of strings
  - Each string can be path to file or glob pattern
  - If does not exist, error on project boot
    * This will catch current users that need to transition
    * Tell user they need to create `support/index.(js|coffee)` or explicitly set `supportScripts` option
    * Tell user they can disable with `supportScripts: false`
    * Link user to error docs for this message
",enhancement
187156289,Improve scaffolding,"New rules:

* Stop scaffolding every time by default
* Only scaffold when project is new
* Do not scaffold if `integrationFolder` option has been modified in cypress.json

This will prevent having to pass `integrationFolder: false`, etc.

Take into account that `config.integrationFolder` may have value, but the folder at that path may not exist. ",enhancement
186786080,Please add support for ava testing assertions :),This is a must! Ava is the future of javascript testing :),enhancement
186429672,Jest support,"Jest has surpassed mocha in terms of performance as well as some features (snapshot testing specifically). 

Is mocha hard-coded to Cypress or is it possible to have support for Jest in the not too distant future? ",enhancement
186371528,Expose mocha and chai instance on Cypress,"Attach the bona fide mocha and chai instances to the `Cypress` namespace as `Cypress.mocha` and `Cypress.chai`. Rename the internally-used wrappers to `Cypress._mocha` and `Cypress._chai`.

Add documentation and a recipe for extending chai (`chai.use()`, etc).",enhancement
184882252,Verbiage on `visible` error message is wrong when asserting an element to NOT be visible,"The sentence ""Cypress could not determine why this element is **not** visible"" does not make sense when the actual assertion is for the element to not be visible. The element is actually visible at the time of error.

**Example Test Code**

``` javascript
cy.get('.modal-content').should('not.be.visible')
```

**Command Log Screenshot**
![screen shot 2016-10-24 at 10 58 44 am](https://cloud.githubusercontent.com/assets/1271364/19652973/c931ba06-99e0-11e6-985f-f87945892492.png)
",enhancement
184531308,Proxing requests should timeout matching cypress.json `responseTimeout`,"Currently we do not add a timeout for proxied requests, which can lead to socket pooling exhaustion in the case where the 3rd party servers do not respond in a timely fashion.

Eventually they will time out by the host OS.

We're going to automatically use whatever is set in `cypress.json` for `responseTimeout` since that should ""just make sense"".
",enhancement
183974763,"If cypress doesn't know the number of failures, exit with 1 instead of 0","This addresses the case where the headless browser crashes unexpectedly before cypress accumulates any errors, and then cypress (wrongly) exits with code 0 as though everything passed successfully.

related: https://github.com/cypress-io/cypress/wiki/changelog#0165-07312016

from @brian-mann in chat:

> likely we'd also need to log out a message saying that
> Cypress sub-process exited without a valid number of failures. We're assuming something went wrong or crashed and so we're exiting with 1 to indicate this run failed.
",enhancement
182628257,Currently there exists no way to run a suite of spec files in Cypress,"Mocha has a --grep option that takes in a pattern and runs all spec files that match it. I would like cypress to support this feature as there are times where i want to group together a few spec files in my CI build but not run all the spec files at once.

The --spec option allows you to run a single spec file but not a combination.
",enhancement
182572414,Enable users to turn off web security,"Chrome gives us the ability to turn off origin security (used specifically for testing purposes). Additionally we can turn of https -> http request restrictions.

While this will _not_ be a cross browser fix, it will work in both headed and headless modes, which could provide users a temporary workaround in the case of a Cypress bug, or a permanent workaround in other situations.

There is an inherent restriction in Cypress that a single test can never span across two different *_super domains_. Different subdomains are okay, different superdomains are not.

It's possible such as the case with single-sign-on (SSO) that users may need this behavior. While there are generally always work-arounds in Cypress-land, many users immediately hit this barrier and assume Cypress does not work.

Therefore this option could also be helpful for those situations.

We'll likely expose this in `cypress.json` as something like `{ chromeWebSecurity: false }`. 
",enhancement
180963569,Convert and consolidate all core-* repos into a Monorepo™,"Cypress is currently spawned across nearly **two dozen repos** and it has become unbearable to keep them all together. We see no real value in publishing separate `core-*` packages to `npm` because they are unusable outside of the Cypress context.

We are going to instead consolidate all of these into one `monorepo` which means we don't have to worry about `npm linking` different repos, different braches, managing different issues, etc.

This will make it much easier for our own development team, and of course works well as part of our larger overall goal and strategy when it comes to open source. We want to make outside contributions as simple and painless as possible.

Here's an in depth summary of the idea:
# Cypress Monorepo
## Why?
- We no longer have to worry about keeping a dozen different repos in sync
- Branching happens and applies to all projects once, its impossible to get out of sync
- No more pulling from a dozen different repos
- No more having 10 tabs open building 10 different projects
- Enables easier setup which makes it easier for developers (external or internal) to contribute
- A single issue tracking repo which avoids the problems of: ""should i open an issue here or in another repo?""
- A single repo where all the stars will go which avoids dilution
- It becomes much easier for the community to track updates and code changes
- Setting dependencies becomes sane. Example: setting branched `driver` and `server` peer dependencies would otherwise be impossible
## Tradeoffs (negative)
- All tests get run in CI in bulk which means a single failure could be in any package
- Bigger / more intimidating repo size
- ? what else ?
## What goes in it?
- Code that is not re-usable in other projects or is not useful to the community in any context outside of Cypress
- Code that in order for it to be updated a new Cypress version would be ‘cut’
- Examples: `https-proxy`, `extension`, `launcher`, `runner`, `reporter`, `desktop-gui`, `electron`, `cli`, `driver`, `server`
## What does not go in it?
- Example: `cypress-adapter-node` does not belong in the monorepo because it can be distributed without causing an update to the desktop application such as bug fixes, enhancements, etc
- Example: `cypress-example-kitchensink` should run in its own CI environment and thus requires a separate repo
- Example: `cypress-plugin-socket-io` can be independently updated and downloaded from within Cypress along with issues open specific to its functionality
- Example: `cypress-api` because its a separate service which can be updated independently and its also private code
- Example: `cypress-releaser` because its a common shared lib used by many independent projects and could be useful outside of just Cypress
## How should code be organized?
- in `cypress/packages/...`
- Each should have a `package.json` + `readme.md`
- Each should be named with `cypress-core-*` since they are part of the core cypress product
## Should documentation go in there?
- No because documentation can be released independently of cypress desktop app
## What about packages which require building?
- There should be a cascading `npm start` command which auto invokes the sub start commands
## What about tests?
- Tests will be written independently in each package but able to be run from a single `npm test` command
- Additionally we should be able to pass a flag to `npm test` which filters the tests and only runs those applicable to a single package. `TEST_ONLY=runner npm test`
- We will store all `e2e` tests (which test comprehensively across all packages) in the root `cypress/spec` directory, but all other tests `unit` and `integration` will go underneath each appropriate package.
## What about distribution?
- We will _NOT_ publish sub packages to npm or version them independently.
- We could either omit the version number or simply bump them all at the same time to the same version.
- There will only be a single master changelog.
## Changes
- rename `cypress-core-icons` to `cypress-icons` since this is reusable outside of `cypress` and can be updated independently without issuing a new version of cypress
- rename `cypress-core-releaser` to `cypress-releaser` for the same reasons above
",enhancement
180754599,A way to disable Cypress global exception handler,"It would be nice to turn off the Cypress global exception handler per test.
For example, we have our own exception handler that sends the errors to the remote crash reporting server. We could write an e2e test to make sure it works as expected. We can
stub the server route and then raise an error in the window's context on purpose.

``` js
cy.window()
        .then(win => {
          function raise () {
            throw new Error(`E2E test error`)
          }
          win.setTimeout(raise, 100)
        })
        .wait('@error')
```

The route is working, but the Cypress own crash handler thinks this error was unhandled and fails the test. If we could turn the Cypress crash handler just for this test, it would make a lot of sense.
",enhancement
179644265,Configurable pause/delay between commands to help with debugging,"ability to slow down the execution of a test via a configurable delay, e.g.

Cypress.config(""waitAfterEachCommand"", 2000)
",enhancement
179614197,Add keyboard shortcuts,"Add keyboard shortcuts for common actions in the Cypress UI. Examples (with possible shortcuts) are:
- ~Re-running the tests (R)~ Added in https://github.com/cypress-io/cypress/pull/3943
- ~Stopping the tests (S)~ Added in https://github.com/cypress-io/cypress/pull/3943
- Controlling the tests when paused (next: N, continue: C)
- Toggle auto-scrolling (A)
- ~Focus the tests (F)~ Added in https://github.com/cypress-io/cypress/pull/3943
- Pinning a command while it's focused or moused over (P)
- Explain what keyboard shortcuts are available within the UI buttons.

Also, evaluate the keyboard-friendliness of the UI. Is it easy to tab through various UI elements? Do UI elements have proper focus styles? We may need to add enhancements like responding to down arrow, left arrow, etc to focus tests and commands, move through them, expand/collapse them, etc.

---

Since the shortcuts map exactly to the UI elements we already have - there should be updates to the UI to help indicate to users which key to press. As it stands, there's no way for users to have any idea these exist at all (or what they do).",enhancement
179612367,Add snapshot pinning,"Currently, snapshots are ephemeral and can only be viewed while mousing over a command, and as soon as you mouse out, the snapshot is replaced by another snapshot or the original state of the DOM. This leaves something to be desired, as it may be useful to inspect the DOM of a snapshot or interact with the page (e.g. by scrolling).

Snapshot pinning would add a button (with a pin icon) to each command, that when clicked, locks the snapshot so that it is not reverted on mouse out and no other snapshots are shown while it is pinned. 

Some requirements:
- A pin button on each command. It should probably only appear on hover
- An indication on the pinned command that it is pinned
- UI over or near the App Under Test, perhaps utilizing the current snapshot message, that indicates that a snapshot is pinned
- UI for unpinning. This should probably be in 2 places:
  - The pin button on the command, which will unpin the snapshot if clicked a 2nd time
  - A universal location, probably near the message mentioned in the previous bullet
- UI for switching between different states of the snapshot (e.g. before and after)
- UI for toggling on/off hitboxes and element highlighting
",enhancement
179568578,Automatic ES6 support with babel,"Cypress should support ES6.
",enhancement
179132798,Skipped tests should be visually indicative,"Currently when Mocha skips tests (such as failed hooks, uncaught exceptions, etc) you can't really visually ""tell"" that the tests were skipped.

They just look like they haven't run yet.

We should visually indicate they're skipped by ~~strikethrough~~ or something else.
",enhancement
179131537,"Uncaught errors should indicate the error instance, and bypass mocha's built in uncaught error handler","On newer browsers `window.onerror` fires 5 arguments, not 3 - including the actual error instance as the last argument.

Currently mocha automatically slurps up uncaught errors, and assumes there are only 3 arguments. It re-instantiates the error and we lose all kinds of valuable information (like the stack trace).

We need to automatically bypass mocha's built in exception handler and correctly handle the error.

This will enable uncaught errors to behave identically to all other caught errors. Users will be able to jump directly to the line causing the failure.
",enhancement
179131021,Cross origin script errors should be clearly explained,"When uncaught errors occur which come from 3rd party script files, the browser does not make the error information available.

This means we don't have access to:
- the error message
- the stack trace
- the line number
- the column number

However the error will be displayed in the console, and its possible to turn on this behavior by setting up the `crossorigin` attribute on the `<script>` tag and setting a CORS header on the webserver.

We should properly indicate this to the user and tell them to check the console.
",enhancement
179130836,Explain mocha behavior on hook errors,"Current Mocha will do two different things when it encounters hook errors.
- If the error was an uncaught exception, the entire run is aborted and all remaining tests are skipped
- If the error was caught, only the remaining test(s) within the suite that the hook is found in are skipped

We can automatically predict its behavior and communicate more effectively to the user (in the error message) what the specific behavior is.
",enhancement
179015978,allow configuring `forbid-only` in CI,"It would be nice to be able to configure `cypress ci` to fail if there is `it.only` in the specs to prevent successful builds because of accidental undesired commits.
",enhancement
178692381,Ability to run tests locally in Desktop GUI without logging in.,"As part of our open sourcing strategy and release of the Admin area, we are removing the artificially enforced limitations that you must be logged into Cypress to work in it.

Instead we are moving logging in to the parts that really only require logging in, such as configuring your project for CI usage.
",enhancement
178691215,See CI builds per project,"We are adding the ability to see CI builds directly from within the Desktop App like this:
![Image](https://cloud.githubusercontent.com/assets/1271364/18716558/46048082-7feb-11e6-957d-5a88e389aea6.png)

Clicking through a project will go into the Admin interface which will enable you to see the build details:

See CI Build failures ![build](https://cloud.githubusercontent.com/assets/1271364/18716731/ccb0391e-7feb-11e6-8501-12ad5a84ac22.jpg)
",enhancement
178678978,Simulate offline mode,"**Description**
Offline support is becoming important to web applications. It would be nice to switch the browser to the offline mode from Cypress either by test or for all tests and run it. If might be difficult and might require Cypress to handle ServiceWorkers very well.

**Additional Info**
",enhancement
178076270,Add support for custom reporters,"Add support for any mocha reporter, whether installed via npm or available locally in a user's project. Also, add support for the [mocha junit reporter](https://www.npmjs.com/package/mocha-junit-reporter) by default.

As has been the case until now, specifying a reporter only works in headless mode.

This partially addresses #203. 
",enhancement
177960038,Headless runs need to be recorded to a video,"Currently there is no easy way to debug a headless run. We should add a recording and dump it in `cypress/videos`.

The name of the video should likely be the browser name, version and maybe resolution and timestamp?

Just like screenshots, this should be the default but be able to be turned off in `cypress.json`.
",enhancement
177959384,Commands are not scrolled into view on long test runs,"Commands are being cut off when there is a long test run instead of being scrolled into view.

![vlcsnap-2016-09-20-00h09m22s864](https://cloud.githubusercontent.com/assets/1268976/18657276/8e3d7122-7ec6-11e6-8e45-f97ebead63a7.png)

I've also included a video and you'll see everything starting from `0:32` will be cut off.

[headless.zip](https://github.com/cypress-io/cypress/files/481616/headless.zip)
",enhancement
173061571,Add ability to see full test name in Test Result UI,"Currently if you have a long test name you get ellipsis:

![screen shot 2016-08-24 at 5 19 06 pm](https://cloud.githubusercontent.com/assets/1994838/17948582/60f1cc24-6a1f-11e6-8ab7-1188aa7a0229.png)

would be great if we could see the full text.  This is mainly a problem when you are on smaller screens such as a Macbook Air 13"" 😉 

@chrisbreiding 
",enhancement
172137871,enter title in cypress.json,"I have several small projects all called `cypress`, because the folder is named that way. I would like to name test project by entering a `title` somewhere, for instance in the `cypress.json`. This would help me distinguish between the projects in a more friendly manor than moving project to a differently named folder. :D
",enhancement
171598867,Use `.csv` as fixture,"Currently `.csv` files (`text/csv`) aren't accepted as such (""invalid fixture extension""). As a workaround I renamed mine to `.txt` for now. I suspect they can be handled/accepted like normal text files
",enhancement
168734141,key combinations,"**Description** 
Would be useful to allow typing key combinations for testing keyboard shortcuts (we have a shortcut ctrl-/ for example)
",enhancement
168347268,Screenshot on failure should scroll the command list,"When capturing the screenshot on failure, it would be nice if the left column with
the command list scrolled to the bottom to show the latest failure
",enhancement
166834363,Ability to set default browser to run tests. ,"Currently, Chrome is set as the default browser to run the tests. I'd like a way to make Canary the default choice in the app. 
",enhancement
165832566,Modify headers and status code but not stubbing response,"I have an XHR request that responds normally with a status 200 and some data.
There is one case where the response is enriched with some header data. I want to simulate this case.

This is the mock setup:

``` js
cy.server().route({
  method: 'POST',
  url: /some-url/,
  headers: { key: 'value' }
});
```

The resulting call is a non stubbed call but also the `key: value` headers are missing. They are not missing when I add a stubbed response to the route config.
The same happens with `status`.
",enhancement
164070285,Cy.screenshot should only capture the app,"The screenshot captures the entire chrome viewport. It should only capture the app.

Will this be fixed for free with 17?

![pythagorean](https://cloud.githubusercontent.com/assets/254562/16618627/46cb05ec-4358-11e6-81c3-96896264ec76.png)
",enhancement
163203100,Add a feature from within cypress that helps with writing to a file,"Currently I am trying to setup my test suite and want to write the response object received into a file in the fixture directory for future comparisons. This helps me bypass the manual process of having to copy the object to a file, which is tedious in any case from the console.

The VCR mode might be an option, but what if I am not using the cy.server directly and have my own tool that is making the request from within cypress. Having an independent writeToFile option would be a good addition imo
",enhancement
162492946,Add JUnit XML Reporter to Cypress,"When you're running Cypress through the command line, we can only generate outputs in JSON format right now.  We need to be able to generate the same outputs in JUnit XML format.  This is the standard output format for Jenkins.

There's a Mocha JUnit reporter available [here](https://github.com/michaelleeallen/mocha-junit-reporter)
",enhancement
162009617,Cypress Server Routes Are Lost After Page Load If Not Using cy.visit(),"When I have XHR requests go out on initial page load and need to have Cypress watch for those requests, I have to use `cy.visit()` to get to the page I want to test.  I cannot get directed to that page or else the routes I tell Cypress about are lost.

Example:

``` javascript
cy.visit('https://mydomain.com');
// I am looking for these two XHR requests that are immediately started after my page loads
cy.server().route('GET', /getUsers/).as('getUsers')
           .route('GET', /getApples/).as('getApples');
// By clicking on an element with href value of ""/apples"", I get directed to a new page
// Cypress will lose the routes I've defined just before this because I've loaded a whole new page
cy.get('#links [href=""/apples""]').click().wait(['@getUsers', '@getApples']);
```

We need a feature where even if a new page loads, the routes you define are not lost.  This gives testing a more ""natural"" flow.  `cy.visit()` is the equivalent of typing in a browser URL.  We should be testing how users actually get from page to page, which is usually clicking on a button, or an image, etc...
",enhancement
161745028,cy.select() Should Look For Trimmed Value Inside of <option></option>,"When an option element is formatted with line breaks:

``` html
<option value=""someNumber"">
    Gold package
</option>
```

`cy.select()` is unable to find the option by element text because of the line breaks.  `cy.select()` should trim the `text()` value of `<option>` before trying to match it with the parameter passed in.
",enhancement
160693563,Cannot type on arbitrary elements,"Any element can receive keydown events if it has a tabindex. However, the cypress type command only works on input text elements and textareas. In order to fire keydown events on arbitrary elements, for example if we want to test keyboard shortcuts in an app, we have to manually create a KeyboardEvent and call dispatchEvent on the element. While this is a viable workaround, a solution in cypress would be preferred.
",enhancement
160522256,Adding Ability to Submit File to Input Element From Local Filesystem (file upload),"**Description**
Our app takes a file from an user, does some work with it, and produces outputs based on the input the user provides.  A bunch of things happen in the system during the processing and we expect project pages to be generated in a certain fashion after a project successfully completes.  We need to be able to submit files through our webpage to test the affects of this process.
",enhancement
160035810,Build Cypress docker image for simple CI,"Most CI allow using custom Docker image as base. It would be really cool to have official public Cypress docker image. We have built one, here is our docker file

```
FROM node:6
RUN apt-get update
RUN apt-get install libgtk2.0-0 libnotify4 libgconf2-4 libnss3 xvfb --yes
RUN npm set progress=false
RUN npm i -g cypress-cli
ARG CYPRESS_VERSION
ENV CYPRESS_VERSION ${CYPRESS_VERSION:-0.16.2}
RUN echo Cypress version to install $CYPRESS_VERSION
RUN cypress install
RUN cypress verify
```

One could use specific `cypress-cli` version inside if needed.

To build and tag the image, we use this script

``` sh
set e+x

# build image with everything needed to run Cypress
VERSION=0.16.2
LOCAL_NAME=front-end/cypress-ci
docker build --build-arg CYPRESS_VERSION=${VERSION} -t $LOCAL_NAME .

# tag and push the build to the registry
# https://docs.docker.com/mac/step_six/
IMAGE_ID=$(docker images -q $LOCAL_NAME)
NAME=<docker hub>/$LOCAL_NAME:$VERSION
docker tag $IMAGE_ID $NAME
docker push $NAME
```

We are pushing to internal Docker hub, but public is obviously the goal here.
Then a Gitlab CI runner just uses that image as the base

``` yaml
image: <docker hub>/front-end/cypress-ci:0.16.2
# caching node_modules folder
# https://about.gitlab.com/2016/03/01/gitlab-runner-with-docker/
cache:
  paths:
  - node_modules/
before_script:
  - cypress verify
stages:
  - test
e2e_test:
  stage: test
  script:
    - npm install
    - npm test
    - npm run build
    - cypress ci
```

We have spec file bundle build step, otherwise we could just do

``` yaml
e2e_test:
  stage: test
  script:
    - cypress ci
```
",enhancement
160010692,Seems `cypress ci` does not respect or handle integrationFolder parameter,"When passing custom path to the integration folder (to allow running just some tests), cypress just initializes the Kitchen Sink example and runs its own tests, not mine.
",enhancement
159703985,cy.contains() error when specifying selector should be more specific.,"When `cy.get('ul').contains('foo')` errors, it prints:

```
Expected to find content: 'foo' within the element: 'ul' but never did.
```

When `cy.get('ul').contains('li', 'foo')` errors, it prints:

```
Expected to find content: 'foo' within the selector: 'li' but never did.
```

In the second scenario, when a selector is passed to contains, it would be helpful to also print the current subject with the selector (esp since we could be in an unexpected scope). This error message is preferable:

```
Expected to find content: 'foo' within the selector: 'li' within the element: 'ul' but never did.
```
",enhancement
159677820,UI shows *.hot-update.js files in list of tests,"I have a relatively specific use case for my Cypress setup but I'll try to explain it as best I can. I'm using webpack to bundle individual tests and the bundles for these tests spit out into the /integration directory. My Cypress test renders a React component into the DOM of an index file and I run my tests on that component from there.  In webpack I have hot module reloading set up so I can effectively edit my component and it reloads in the Chrome window, edit the test to re-run it, and everything is gravy.  The only issue is that webpack outputs these *.hot-update.js files into the same directory as your bundle lives, so now my file structure looks like this: https://www.dropbox.com/s/cvkd8yhr659039r/Screenshot%202016-06-10%2011.54.33.png?dl=0

It would be nice to be able to ignore these as a glob in the config so that they don't show up there and pollute the UI with what aren't actually executable specs.
",enhancement
159409420,Add {downarrow} and {uparrow} to cy.type method,"Since you already have left and right arrow methods, it makes sense to add down and up so different UI widgets with a list of options can be tested quickly.
",enhancement
159409203,Add cy.each method to the API,"We wanted to validate / perform actions for a each element in the list, and for this we used the suggested manual code

``` js
cy.get(""li"").then(function($lis){
  $lis.each(function(i, el){
    cy.wrap(Cypress.$(el)).click()
  })
})
```

Seems, this has a little boilerplate that can be avoided if there was a built-in `cy.each` method. It would work on a list of objects returned by `cy.get()` or `cy.find()` and would automatically wrap each element

``` js
cy.get(""li"")
  .each(function($el){
    // $el is wrapped element
    $el.click()
  })
```
",enhancement
158985312,Improve `cy.exec()` console output on errors,"When the `cy.exec()` process exits with a non-zero code, the stdout and stderr are truncated for the sake of the UI ouput, but that also results in them being truncated when the user clicks the error to view it in the console. The console output should include the full stdout and stderr.
",enhancement
158450754,Accept a function for a cy.route response,"Passing response data to a `cy.route` should accept a function, and optionally await promises returned from the function
Doing so enables easier access to properties such as aliased fixtures.

Now:

``` js
cy.server()
  .fixture('foos').as('fxFoos')
  .then(function() {
    cy.route('GET', /foo\/\d/, {
      data: {
        foo: _.first(this.fxFoos)
      }
    });
  });
```

``` js
cy.server()
   .fixture('foos').as('fxFoos')
   .route('GET', /foo\/\d/, function() {
     return {
       data: {
         foo: _.first(this.fxFoos)
        }
       };
     });
   });
```

Particularly useful for:

``` js
function fooRoute(resultCount) {
  _.initial(this.fxFoos, resultCount);
}

cy.server()
   .fixture('foos').as('fxFoos')
   .route('GET', /foo\/\d/, _.partial(fooRoute, 4));
```
",enhancement
157979354,Allow running multiple projects in Cypress,"I want to easily compare projects while both projects are visible in the test runner in Cypress. I'm currently able to run multiple Cypress apps through the CLI and can start multiple projects by changing the port on one of the projects, but when they both run in the browser the second app runs into multiple problems. 
- [ ] The second app opens in a new tab within the same test runner (even though multiple tabs is advised against). It should open in it's own window.
- [ ] The test runner says that it cannot connect to the Cypress extension
- [ ] The tests will not run because a message claims that the browser was not launched through Cypress.
- [ ] The Cypress desktop app doesn't disable the ""run browser"" button to indicate it as running.
",enhancement
156042812,"Add support to cy.type() for ""typing into document""","Allowing the document to be the subject when using `cy.type()` will allow typing that doesn't need a text field (namely, keyboard shortcut capturing) to be tested. So a user can write the following test, for example:

``` javascript
// for this example, assume there's a listener on `document` that
// opens a modal when 'abcd' is typed
cy
  .document().type('abcd')
  .get('.modal').should('have.text', 'A modal!');
```
",enhancement
155776917,Passing two arguments to cy.its() should throw an err to instead use cy.invoke(),"asserting off of a value on an attr in `cy.its()` is returns a function a Function instead of the actual value, need to throw error to the user that they really want to use `cy.invoke()`.

**Example Code**

```
cy.get(""img"").its(""attr"", ""src"").should(""match"", /logo/)
```

**Example Error**

```
expected: [Function] to match /logo/
```

<img width=""447"" alt=""screen shot 2016-05-19 at 12 13 44 pm"" src=""https://cloud.githubusercontent.com/assets/1271364/15400863/26276f96-1dbb-11e6-85eb-45e862341845.png"">

**Example Code**

```
cy.get(""a"").its(""attr"", ""data-js"").should(""eq"", ""edit-company"")
```

**Example Error**

```
expected: [Function] to eq ""edit-company""
```
",enhancement
155767632,"""Login"" is a noun, not a verb (grammar)","The Cypress login button should read ""Log In with Github"" instead of ""Login with Github"":
![image](https://cloud.githubusercontent.com/assets/17697/15399321/2dd3b87c-1db5-11e6-8a55-f67deffec94e.png)

When I get confused which is which, I think of how I would ask to be logged in. ""Login me"" or ""Log me in""? Ah, right.

Reference:
http://grammarist.com/spelling/log-in-login/
",enhancement
155610013,Add support for shadow dom,"Currently, Cypress fails for various reasons when dealing with the shadow dom. So far, I've seen three issues. 

1) Cypress considers the shadow root to be a non-DOM subject.

``` coffeescript
cy.get(""#root"")
  .then ($root) ->
    return Cypress.$($root[0].shadowRoot)
  .find('.child-2')
  .should('have.text', 'I am child 2')
```

![shadow root is non-dom](https://cloud.githubusercontent.com/assets/1157043/15376011/806ab184-1d20-11e6-9659-9ac7951a63c0.png)

Moving the `.find` into the `.then` gets past this issue, but is not ideal:

``` coffeescript
cy.get(""#root"")
  .then ($root) ->
    return Cypress.$($root[0].shadowRoot).find('.child-2')
  .should('have.text', 'I am child 2')
```

It might be nice and maybe even necessary to have a convenience method like `cy.getShadowRoot()` that could be chained off other dom commands. 

2) When you try to assert something on an element inside a shadow root, Cypress reports that the element is detached from the dom. This stems from the fact that `$.contains(el1, el2)` returns false when el1 is outside the shadow root and el2 is inside it. [Some discussion here](https://github.com/jquery/jquery/issues/1784). 

``` coffeescript
cy.get(""#root"")
  .then ($root) ->
    return Cypress.$($root[0].shadowRoot).find('.child-1')
  .should(""have.text"", ""I am child 1"")
```

![shadow child detached from dom](https://cloud.githubusercontent.com/assets/1157043/15375685/7d4d3b40-1d1e-11e6-8187-3ed21b2154d9.png)

3) Commands that cause Cypress to check if the subject is hidden by ancestors trigger infinite recursion and blow the call stack because it never hits the `<body>` or `<html>` elements while walking up the chain of ancestors.

``` coffeescript
cy.get(""#root"")
  .then ($root) ->
    return Cypress.$($root[0].shadowRoot).find('.child-2')
  .contains('button', 'Go')
```

![shadow dom infinite recursion](https://cloud.githubusercontent.com/assets/1157043/15375881/b95d009c-1d1f-11e6-8be2-9c2ac00ce720.png)
",enhancement
154278075,Improve `cy.visit()` errors,"- [ ] Explicitly state that `cy.visit()` failed
- [ ] Try to give more useful information about the failure
",enhancement
154277500,Improve command errors,"- [x] Make errors consistent (always use `cy.command()`, etc)
- [x] Move all errors into one file
- [x] Update `throwErrors` to look up error based on key
- [x] Move `throwErr` to Cypress and update other calls to `new Error`
",enhancement
154241654,Iframe support,"**Updated Feb 9, 2021 - see note below or https://github.com/cypress-io/cypress/issues/136#issuecomment-773765339**

Currently the Test Runner does not support selecting or accessing elements from within an iframe.

## What users want

Users of Cypress need to access elements in an `<iframe>` and additionally access an API to ""switch into"" and switch back out of different iframes. Currently the Test Runner thinks the element has been detached from the DOM (because its `parent` document is not the expected one).

## What we need to do

- Add new `cy` commands to switch into iframes and then also switch back to the ""main"" frame.
- Cypress must inject itself into iframes so things like XHR's work just like the main frame. This will ideally use something like `Mutation Observers` to be notified when new iframes are being pushed into the DOM.

- [ ] Add API to navigate between frames
- [ ] Update the Driver to take into account element document references to known frames

## Things to consider

- How will we handle snapshotting? Currently we don't take snapshots for anything inside of an `<iframe>`.
- How will we handle cross origin frames? It's possible to enable these with `{ chromeWebSecurity: false }` (Chromium-based browsers only).
- How will we show context switching in the Command Log? It should probably look / be colored differently than the 'normal' main commands

## Examples of how we could do this

```js
// switch to an iframe subject
cy
  .get('#iframe-foo').switchToIframe() 
  .get('#button').click() // executed in <iframe id='iframe-foo' />

// or pass in $iframe object in hand
cy
  .get('#iframe-foo').then(($iframe) => {
    cy.switchToIframe($iframe)
    cy.get('#button').click()
  })

// now switch back to the main frame
cy
  .switchToMain()
  .get(':checkbox').check() // issued on the main frame
```

## Workaround

It's possible to run `cy.*` commands on iframe elements like below:

```js
cy.get('iframe')
  .then(($iframe) => {
    const $body = $iframe.contents().find('body')

    cy.wrap($body)
      .find('input')
      .type('fake@email.com')
})
```

## ⚠️ Updates

**Updates as of Feb 9, 2021**

Pasting some snippets from our technical brief on iframe support that we are currently planning. As always, things can change as we move forward with implementation, but this is what we are currently planning.

If there's any feedback/criticism on these specific proposed APIs, we'd be happy to hear it.

### .switchToFrame([...args], callback)

Switches into an iframe and evals callback in the iframe. Doesn’t matter whether the iframe is same-origin or cross-origin.

#### Stripe payment example

```js
// ❗️ This is planned work and does not currently work
cy.visit('someshop.com')
// ... add stuff to cart
// ... get to payment page
cy.get('iframe').switchToFrame(() => {
  cy.get('#name').type('name')
  cy.get('#number').type('1234-5678...')
  cy.contains('Pay').click()
})
// go on with cypress commands in the main frame
cy.contains('Thanks for your order')
```

#### Same-origin iframe

Example where a site uses a same-domain iframe as a date-picker widget

```js
// ❗️ This is planned work and does not currently work
cy.visit('https://date-picker.com')
cy.get('iframe').switchToFrame(() => {
  cy.get('.next-month').click()
  cy.contains('24').click()
})
// switch out of iframe context because callback is finished
cy.get('.date').should('have.text', '2/24/2021')
```

We also intend to support [snapshots of iframes](https://github.com/cypress-io/cypress/issues/1433). 



",enhancement
153817287,cy.request failures are not obvious,"When `cy.request` fails we get a stack trace that looks like this:

``` bash
2) Todo MVC ""before each"" hook:
     CypressError: Error: connect ECONNREFUSED 127.0.0.1:9002
      at Object.$Cypress.Utils._.cypressError (http://localhost:2020/__cypress/static/js/cypress.js:4377:15)
      at $Cypress.Cy.extend.cypressErr (http://localhost:2020/__cypress/static/js/cypress.js:5027:31)
      at $Cypress.Cy.extend.throwErr (http://localhost:2020/__cypress/static/js/cypress.js:5032:22)
      at http://localhost:2020/__cypress/static/js/cypress.js:9092:21
      at i (http://localhost:2020/__cypress/static/js/vendor.js:588:27)
      at e._settlePromiseFromHandler (http://localhost:2020/__cypress/static/js/vendor.js:587:5260)
      at e._settlePromiseAt (http://localhost:2020/__cypress/static/js/vendor.js:587:6529)
      at e._settlePromises (http://localhost:2020/__cypress/static/js/vendor.js:587:8394)
      at i._drainQueue (http://localhost:2020/__cypress/static/js/vendor.js:586:3183)
      at i._drainQueues (http://localhost:2020/__cypress/static/js/vendor.js:586:3244)
      at MutationObserver.drainQueues (http://localhost:2020/__cypress/static/js/vendor.js:586:1186)
```

We should at explain that it was caused by the `cy.request` and additionally print out request data and/or response data as a nicely formatted (truncated) object.

This will help users debug `cy.request` failures.
",enhancement
153539528,Whitelist .svg,"It'd be nice to suppress showing svgs in the reporter.

![screen-shot-2016-05-05-at-9 57 18-am](https://cloud.githubusercontent.com/assets/254562/15086339/f903416e-13ad-11e6-8ba9-f8a0e504950b.png)
",enhancement
153486913,Console log should display when subject is changed in an assertion (or print return),"When writing assertions that change the subject, ie:

``` javascript
cy.get(""a"").should(""have.attr"", ""title"", ""Help"")
```

In the command log on click of the command, the subject in the code above only displays the original subject `<a>`. It'd be nice if the command log indicated that the subject changed, or even just printed the return of the assertion (in this case `""Help""`).
",enhancement
152873332,I would like some way to run a CLI command from Cypress,"### Problem

Right now I have to rely on an API to be available use cy.request to hit an endpoint to perform the actions I need. However, we do have some functionality that can only be done through the CLI and it would be nice to have access to that through Cypress.
### Suggestion

It would be nice to be able to run a CLI command from Cypress, e.g. with `cy.spawn`.

An example usage could be to ssh into a host and kill a certain process. It could look something like this:

``` js
cy.spawn('ssh {host_ip}', 'kill -9 {process_id}');
```

I'm not sure that's the best API, but this is just to give an idea of what I am looking for.
",enhancement
150389670,Git error while installing cypress-cli,"cypress-cli needs git to be installed for fetching node-xvfb but after installing git, i get this error. 
IMO it should just fetch the dependency from github/release instead of checking it out.

```
# npm install -g cypress-cli
npm WARN addRemoteGit Error: Command failed: git config --get remote.origin.url
npm WARN addRemoteGit 
npm WARN addRemoteGit     at ChildProcess.exithandler (child_process.js:213:12)
npm WARN addRemoteGit     at emitTwo (events.js:87:13)
npm WARN addRemoteGit     at ChildProcess.emit (events.js:172:7)
npm WARN addRemoteGit     at maybeClose (internal/child_process.js:827:16)
npm WARN addRemoteGit     at Process.ChildProcess._handle.onexit (internal/child_process.js:211:5)
npm WARN addRemoteGit  cypress-io/node-xvfb resetting remote /root/.npm/_git-remotes/git-github-com-cypress-io-node-xvfb-git-7b167375 because of error: { [Error: Command failed: git config --get remote.origin.url
npm WARN addRemoteGit ]
npm WARN addRemoteGit   killed: false,
npm WARN addRemoteGit   code: 1,
npm WARN addRemoteGit   signal: null,
npm WARN addRemoteGit   cmd: 'git config --get remote.origin.url' }
/usr/bin/cypress -> /usr/lib/node_modules/cypress-cli/bin/cypress
cypress-cli@0.11.0 /usr/lib/node_modules/cypress-cli
├── xvfb@0.3.0
├── human-interval@0.1.5
├── progress@1.1.8
├── home-or-tmp@2.0.0 (os-homedir@1.0.1, os-tmpdir@1.0.1)
├── commander@2.9.0 (graceful-readlink@1.0.1)
├── coffee-script@1.10.0
├── request-progress@0.3.1 (throttleit@0.0.2)
├── chalk@1.1.3 (supports-color@2.0.0, escape-string-regexp@1.0.5, ansi-styles@2.2.1, has-ansi@2.0.0, strip-ansi@3.0.1)
├── bluebird@3.3.4
├── yauzl@2.4.1 (fd-slicer@1.0.1)
├── through2@2.0.1 (xtend@4.0.1, readable-stream@2.0.6)
├── extract-zip@1.5.0 (debug@0.7.4, mkdirp@0.5.0, concat-stream@1.5.0)
├── fs-extra@0.22.1 (graceful-fs@4.1.3, jsonfile@2.3.0, rimraf@2.5.2)
├── request@2.72.0 (aws-sign2@0.6.0, forever-agent@0.6.1, tunnel-agent@0.4.2, caseless@0.11.0, oauth-sign@0.8.1, is-typedarray@1.0.0, stringstream@0.0.5, isstream@0.1.2, json-stringify-safe@5.0.1, extend@3.0.0, tough-cookie@2.2.2, node-uuid@1.4.7, qs@6.1.0, combined-stream@1.0.5, mime-types@2.1.10, form-data@1.0.0-rc4, bl@1.1.2, aws4@1.3.2, hawk@3.1.3, http-signature@1.1.1, har-validator@2.0.6)
├── update-notifier@0.5.0 (is-npm@1.0.0, string-length@1.0.1, semver-diff@2.1.0, repeating@1.1.3, configstore@1.4.0, latest-version@1.0.1)
└── lodash@3.10.1
```
",enhancement
147523830,`cy.its` does not handle object functions,"`cy.its(""one"").its(""two"")` seems to invoke the function `one()` instead of getting it's property.
",enhancement
145279931,Option to disable auto-rerun,"Currently, the re-runs automatically every time the the test code changes. For some tests this is undesirable, particularly if test data is being created with every test run. Would be great to be able to disable this feature.
",enhancement
144084124,cy.dblclick() should accept same options as cy.click(),"`cy.dblclick()` currently will serially double click all of the current subjects. `cy.dblclick()` needs to accept options:
- `multiple`
- `force`

It also needs to accept `position` and `x`,`y` coordinate arguments. 
",enhancement
136086376,cy.then needs to support {timeout: N} options,"Currently there is no way to extend a `cy.then` timeout on the fly like other commands. It needs to accept timeout options with the default being `commandTimeout`.
",enhancement
134729446,Better error messages when a promise never resolves which causes cy.then to timeout,"Currently if we have a promise inside of a `cy.then` which does not resolve we don't get a good error message.

<img width=""594"" alt=""screen shot 2016-02-18 at 6 31 11 pm"" src=""https://cloud.githubusercontent.com/assets/1271364/13161767/e01dc048-d66d-11e5-942e-171a9c0c935d.png"">

``` coffeescript
it.only ""goes back to projects view on cancel [00q]"", ->
  cy
    .contains("".btn"", ""Cancel"").click().then ->
      @ipc.handle(""get:project:paths"", null, [])
```
",enhancement
132766310,Add chainable cy.getCookies() command that returns an object.,"`cy.clearCookies` returns an object representation of the document's cookie. I'd like a `cy.getCookies()` that returns an object representation of the document's cookie that I can chain off of to make assertions about the cookie.

Currently I have to go into the `.document().its('cookies')` or go into the Cypress API Cookies, which is awkward.

**Example**

``` javascript
cy.getCookies().should('have.property', 'token', '123ABC')
cy.clearCookies().should('not.have.property', 'token')
```
",enhancement
132535671,There's no way to turn off 'fixtureFolders' and 'supportFolders' ,"There is a config option for `fixtureFolders` and `supportFolders` that accepts a string of the path to the folders that you want, but there's no way to turn this off. 

It would be ideal if `false` could be passed to these options to turn off the folders altogher.
",enhancement
131705268,"Add support for ""focus"" assertion (to work effectively as Chai jQuery assertion does)","Chai jQuery added a [`focus`](https://github.com/chaijs/chai-jquery/commit/4551346946bb2e76c2cf6cd67f6369fd77b5da16) assertion recently.

Cypress needs support for focus assertions so I can assert whether a DOM element has or does not have focus.

**Example**

``` javascript
cy
  .get('input')
    .type('Foo').should('have.focus')
    .blur().should('not.have.focus')
```
",enhancement
131687560,Improve assertion matching message to when array in subject,"The assertion message for matching can be confusing when there is a match for an element that is not the first element of the array in the subject.

``` javascript
cy.get('.traversal-cite').parents().should('match', 'blockquote')
```

**Command Line**
![screen shot 2016-02-05 at 11 09 37 am](https://cloud.githubusercontent.com/assets/1271364/12852043/0ea6f722-cbfb-11e5-9cc5-94a5dc530b33.png)

**Console Log**
![screen shot 2016-02-05 at 11 10 02 am](https://cloud.githubusercontent.com/assets/1271364/12852044/122f1816-cbfb-11e5-9a59-fc48cced8c6e.png)

**Suggested Wording**
`expected [<footer>, ...] to match blockquote`
",enhancement
128632095,implement `window.fetch` capturing/mocking,"Many developers are migrating to `window.fetch` from XHRs due to the simplified async interface it exposes. I happen to be one of those developers.

Cypress should support `window.fetch` with similar abilities to those of XHRs: I should be able to query  the request and response, wait on them, and mock with data and fixtures.

## Cypress team edit

This feature will work seamlessly once [Full network stubbing](https://github.com/cypress-io/cypress/issues/687) is implemented.

### Workarounds

- use experimental fetch polyfill available in [v4.9.0](https://on.cypress.io/changelog#4-9-0)

or do it yourself:

- delete `window.fetch` before visiting the page to force your application to polyfill it on top of XHR. If the application does not include a polyfill, you can load one from your tests.
- stub `window.fetch` directly in JavaScript

See these solutions in [Stubbing `window.fetch`](https://github.com/cypress-io/cypress-example-recipes/tree/master/examples/stubbing-spying__window-fetch#readme) example recipe
",enhancement
117225803,Favicon isn't retina-ready,"My eyes!!!!

<img width=""192"" alt=""screen shot 2015-11-16 at 21 48 30"" src=""https://cloud.githubusercontent.com/assets/1239616/11195799/cdb1675e-8cab-11e5-96d2-2970f47df231.png"">
",enhancement
114638932,Allow silencing of cy.server() in Command Log,"I don't want any of the routes to be logged when running unit tests. Can you allow for option `{log: false}` on `cy.server()` to silence these in command log?
",enhancement
113409654,Console output with suggested test from selector (record/wizard mode),"Easiest way to explain is a demo:  https://db.tt/skFnp7gz

In other words, when you start interacting with your page, a mode that outputs a potential test for what you did, so a user can copy / paste it in to their test.
",enhancement
113382883,No longer running unit tests,"Admittedly when loren sit up the environment for me he said unit testing was sort of a hack. I noticed today with one of the later releases of cypress it no longer runs the unit tests and is giving me a no tests found in x file message. I only have one unit tests file right now and it looks like this:

``` coffeescript
#= require ../../../app/bower_components/jquery/dist/jquery.js
#= require ../../../.tmp/scripts/app.js
#= require ../../../app/bower_components/angular-mocks/angular-mocks.js
#= require ../../../app/bower_components/sinon-1.12.2/index.js
describe ""Timer"", ->
 ....Tests Here...
```

![Imgur](http://i.imgur.com/ft0EdhE.png)
",enhancement
109338994,warn on misspelling of 'fixture' within response of route,"I defined a route and misspelled the word fixture within the response. Example:

```
cy.route(/^\/users\/\d+/, ""fiture:user"")
```

The response ended up being the string `""fiture:users""`, which caused some strange app behavior. Was just wondering if you could run Levenshtein distance on response definitions and send a warning if the response definition was meant to contain ""fixture"" in the string.
",enhancement
106833781,Any plans to run tests in parallel?,"Currently working on a very timer based heavy application and my current test suite is taking ~ 200 seconds to run fully which isn't too horrible since I don't run the full thing every single cycle. I was just curious if there were plans to run tests concurrently to help speed up the wait time.
",enhancement
101978841,log in console the target el of cy.root() command,"When I click on a `.root()` command in the commands log, the console doesn't log anything useful:

**Console log of .root()**
<img width=""277"" alt=""screen shot 2015-08-19 at 3 25 23 pm"" src=""https://cloud.githubusercontent.com/assets/1271364/9366690/bf41c99a-4686-11e5-8d59-d65b80def689.png"">

I would like the console log to display the DOM element that the root command returns (similar to what `.get()` command logs.
",enhancement
95516200,"Preferences: add ability to ""start Cypress on system startup""","I'd like the ability for Cypress to start automatically on startup/login. I can set this up by going into my System Preferences, but it's kind of a pain.

In the ""Preferences"" window, I'd like to just select a checkbox that says ""start Cypress on system startup"" and it save my preference. 
",enhancement
95267773,"Need a ""rightclick"" command","I need the ability to right click an element within Cypress so that it triggers the `contextmenu` event and all that entails. 
",enhancement
93327067,Need ability to navigate 'back' / simulate history's previous routes,"I want to be able to test my application's behavior of updating the url on a user's click of the back button within their browser. I'd like to be able to have a way to do this in cypress commands.
",enhancement
92671927,Specifying coordinates for a click event on DOM elements,"Is it possible to add the option to specify coordinates for a click event on certain types of DOM elements, like canvas?

For example
`cy.get(""canvas"").click(50, 200);`
would trigger a click event 50px from the left and 200px from the top of the specified canvas element.
",enhancement
90108680,Error grouping,"Is it possible to get Cypress to group errors (of the same type) together?

Want to avoid the same error being repeated (for example when using cy.wait()).
![screen shot 2015-06-22 at 09 13 39](https://cloud.githubusercontent.com/assets/1506750/8283702/13c6e5c4-18f9-11e5-9c3b-5bda8c251cd4.png)
",enhancement
76724214,Ability to quickly see current version of Cypress,"I want to be able to quickly see the version of Cypress that I am on. Perhaps print this in a window when clicking ""About"" in the Cypress app.
",enhancement
72484260,cy.confirm() behavior,"1. I'd like the ability to conditionally accept / cancel a `cy.confirm()` command.
2. `cy.confirm` accept / cancel should log out in the commands UI.
3. After all tests are run, the default browser behavior should be restored (so that confirmation appears).
",enhancement
68956605,console.log on click of cy.focused() should more closely match console.log of click on cy.get(),"When I click on `cy.focused()` from command UI, only the command is logged in console. I would like the console to more closely match the console log of click on `cy.get()` from command UI including:
- Selector
- Returned
- Elements

**Console.log of cy.focused()**
![screen shot 2015-04-16 at 12 02 52 pm](https://cloud.githubusercontent.com/assets/1271364/7185499/f0698f2a-e430-11e4-8f0b-318d8eae90d6.png)

**Console.log of cy.get()**
![screen shot 2015-04-16 at 12 06 20 pm](https://cloud.githubusercontent.com/assets/1271364/7185513/09e43c0c-e431-11e4-852d-aa5506422d61.png)
",enhancement
67641103,OSX Menubar icon doesn't Cmd+drag,"I would like to be able to drag the cypress icon to a different position on the menu bar (because I have too many already and my screen is too small sometimes.)

Many applications (especially built-in ones from Apple) allow you to Cmd+Click+Drag to re-organize. I noticed that Cypress does not support this, but thought it might be a trivial bit of polish to drop in.
",enhancement
67439986,Better error message for shortform cy.routes(),"My actual mistake was that I did not define a response to the route, but the error message is telling me to define a url although I have defined a url.

**My route:**

``` js
cy.route(/answers/)
```

**The error:**
![screen shot 2015-04-09 at 4 02 38 pm](https://cloud.githubusercontent.com/assets/1271364/7075686/f0a97842-ded1-11e4-9a97-d8a562378145.png)
",enhancement
67270942,cy.server() should work even before cy.visit(),"Currently `cy.server` can only be started after you `cy.visit` a remote page.

```
cy
  .visit(""http://localhost:7000/dashboard"")
  .server()
  .route(...)
```

This is problematic because many pages make XHR requests `onLoad`.  Because `cy.visit` resolves when the page's `load` event fires, by this time it is often too late.  XHR requests may have gone out.

Therefore `cy.server` should be able to be invoked prior to a page loading (even though one does not exist).

Any `routes` attached to the server should also be carried over.
",enhancement
67153518,add command cy.not(),"Add command `cy.not()` to filter out elements from a set of matched elements. This will provide an opposite command to the already implemented `cy.filter()`.

**Example:**

``` html
<ul>
  <li>list item 1</li>
  <li class=""active"">list item 2</li>
  <li>list item 3</li>
</ul>
```

``` js
cy.get(""li"").not("".active"")
```
",enhancement
66655933,Control for when and if cy.route() responds,"I want to be able to control when and if a route responds. My biggest use case is testing loading logic in my app. Currently, if I write the example below, Cypress will auto respond to the image route (with a 404) before my assertion.

``` coffee
it ""displays loading gif on image load"", ->
  cy.route
    url: /image/
    response: {http://cdn.morguefile.com/imageData/public/files/g/g3c59w/03/l/1427371209n1lyb.jpg}

  cy.get(""a"").click()
  cy.get(""img"").should(""have.attr"", ""src"").to(""match"", /ajax.gif/)
```

**Some suggestions:**
- Allow for option of `autoRespond: false` to be passed into `cy.route()`
- Have a way to tell the route to respond at a later point in the test.
- Allow for a specific delay time before auto responding (allow this is probably a separate issue)
",enhancement
66005245,Improve error message on jquery traversal methods when elements aren't found,"jQuery child commands should output a similar error to `cy.contains` when their command fails finding their elements.

``` html
<input type=""text"" name=""search"">
<i class=""fa-spinner""></i>
```

``` js
cy.get(""input"").find("".fa-spinner"")
```

**Display Error:**

```
could not find `.fa-spinner` within the element: input
```
",enhancement
65469518,Add cy.hover(),"Need to be able to hover in/out of DOM elements.
##### Example for hover

```js
cy.get(""@firstRow"").hover()
```

I'm not sure what a stop hover command would look like. 

Currently I would achieve this with `mouseOver` and `mouseOut` events. The hover command could follow a similar convention.

**Other considerations:**
- In what direction does the mouse come from for hover
- How long should the hover occur.
- How do you ""pause"" a hover to allow for possible css animations.
- Which actions cause you no longer to hover.
",enhancement
65270033,Incorrect error msg for traversing DOM elements w/ no selector and options,"When traversing a DOM element and passing in options but no selector, the error msg is not formatted correctly.
##### Examples of commands that will give incorrect error message:

```js
cy.get(""#header"").next(visible: false)
```

```js
cy.get(""#header"").children(visible: false)
```
##### Error Message

![screen shot 2015-03-30 at 2 13 00 pm](https://cloud.githubusercontent.com/assets/1271364/6903271/21f5128c-d6e7-11e4-9676-f48f0596561d.png)
",enhancement
65257947,Simulate DOM input event on .type(),"The DOM input event should be fired when the value of an `<input>` or `<textarea>` element is changed through `cy.type()`.

For IE9 < support, the `propertychange` event should be fired when value of an `<input>` or `<textarea>` element is changed through `cy.type()`.
",enhancement
64812691,"When doing 2 requests to the same cy.route alias, 2nd request isn't waited on","``` js
cy.route(/accounts/, {}).as(""accountsGet"")

cy.get(""input"")
  .type(""Spring"").wait(""@accountsGet"")
  .clear().type(""Spring2"").wait(""@accountsGet"")
```

The first `.type` causes an XHR (which we explicitly wait for)
Then the 2nd `.type` causes a 2nd XHR (which we also explicitly wait for)
The problem is that the 2nd XHR request is not waited on because Cypress waits for the 1st, which has already resolved.
",enhancement
64801275,Integration with Travis CI,"Would love support and documentation for automatically running the Cypress tests with Travis.
",enhancement
